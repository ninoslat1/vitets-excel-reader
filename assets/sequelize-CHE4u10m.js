import ha from"pg-hstore";import{b as fa,a as da}from"./debug-V-k-uJcK.js";import{r as Ae,p as pa}from"./pg-connection-string-CVG-28Ap.js";import{d as ya}from"./retry-as-promised-BaViJk9v.js";import{l as re,_ as ma,i as Ea}from"./lodash-K5lXZLU5.js";import{w as ar}from"./wkx-Cz1yawXc.js";import{r as ga}from"./validator-CZweWs7S.js";import{r as ze}from"./moment-DLUtp8hM.js";import{m as ke}from"./moment-timezone-De_4VMZ8.js";import{r as Qt}from"./uuid-DTIeZo51.js";import{i as _a}from"./inflection-DRksmm_G.js";import{d as wn}from"./dottie-Bf3mrdq9.js";import{t as Aa}from"./toposort-class-CK8ELnb8.js";import{r as yt}from"./semver-B0oH4Cuq.js";import{r as Oa}from"./sequelize-pool-DTeEbsc3.js";var or={exports:{}},ee={},Or={exports:{}},ce={},Se={};(function(S){var e=Object.defineProperty,t=T=>e(T,"__esModule",{value:!0}),n=(T,E)=>{t(T);for(var w in E)e(T,w,{get:E[w],enumerable:!0})};n(S,{default:()=>O});class f extends Error{constructor(E){super(E),this.name="SequelizeBaseError"}}var O=f})(Se);var mt={};(function(S){var e=Object.create,t=Object.defineProperty,n=Object.getOwnPropertyDescriptor,f=Object.getOwnPropertyNames,O=Object.getPrototypeOf,T=Object.prototype.hasOwnProperty,E=(r,i,s)=>i in r?t(r,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[i]=s,w=r=>t(r,"__esModule",{value:!0}),R=(r,i)=>{w(r);for(var s in i)t(r,s,{get:i[s],enumerable:!0})},_=(r,i,s)=>{if(i&&typeof i=="object"||typeof i=="function")for(let a of f(i))!T.call(r,a)&&a!=="default"&&t(r,a,{get:()=>i[a],enumerable:!(s=n(i,a))||s.enumerable});return r},m=r=>_(w(t(r!=null?e(O(r)):{},"default",r&&r.__esModule&&"default"in r?{get:()=>r.default,enumerable:!0}:{value:r,enumerable:!0})),r),g=(r,i,s)=>(E(r,typeof i!="symbol"?i+"":i,s),s);R(S,{default:()=>l});var N=m(Se);class c extends N.default{constructor(i,s={}){super(i.message),g(this,"parent"),g(this,"original"),g(this,"sql"),g(this,"parameters");var a;this.name="SequelizeDatabaseError",this.parent=i,this.original=i,this.sql=i.sql,this.parameters=(a=i.parameters)!=null?a:{},s.stack&&(this.stack=s.stack)}}var l=c})(mt);var In={};(function(S){var e=Object.create,t=Object.defineProperty,n=Object.getOwnPropertyDescriptor,f=Object.getOwnPropertyNames,O=Object.getPrototypeOf,T=Object.prototype.hasOwnProperty,E=(r,i,s)=>i in r?t(r,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[i]=s,w=r=>t(r,"__esModule",{value:!0}),R=(r,i)=>{w(r);for(var s in i)t(r,s,{get:i[s],enumerable:!0})},_=(r,i,s)=>{if(i&&typeof i=="object"||typeof i=="function")for(let a of f(i))!T.call(r,a)&&a!=="default"&&t(r,a,{get:()=>i[a],enumerable:!(s=n(i,a))||s.enumerable});return r},m=r=>_(w(t(r!=null?e(O(r)):{},"default",r&&r.__esModule&&"default"in r?{get:()=>r.default,enumerable:!0}:{value:r,enumerable:!0})),r),g=(r,i,s)=>(E(r,typeof i!="symbol"?i+"":i,s),s);R(S,{default:()=>l});var N=m(Se);class c extends N.default{constructor(i){super(),g(this,"errors"),this.errors=i,this.name="AggregateError"}toString(){return`AggregateError of:
${this.errors.map(s=>s===this?"[Circular AggregateError]":s instanceof c?String(s).replace(/\n$/,"").replace(/^/gm,"  "):String(s).replace(/^/gm,"    ").substring(2)).join(`
`)}
`}}var l=c})(In);var Sn={};(function(S){var e=Object.create,t=Object.defineProperty,n=Object.getOwnPropertyDescriptor,f=Object.getOwnPropertyNames,O=Object.getPrototypeOf,T=Object.prototype.hasOwnProperty,E=c=>t(c,"__esModule",{value:!0}),w=(c,l)=>{E(c);for(var r in l)t(c,r,{get:l[r],enumerable:!0})},R=(c,l,r)=>{if(l&&typeof l=="object"||typeof l=="function")for(let i of f(l))!T.call(c,i)&&i!=="default"&&t(c,i,{get:()=>l[i],enumerable:!(r=n(l,i))||r.enumerable});return c},_=c=>R(E(t(c!=null?e(O(c)):{},"default",c&&c.__esModule&&"default"in c?{get:()=>c.default,enumerable:!0}:{value:c,enumerable:!0})),c);w(S,{default:()=>N});var m=_(Se);class g extends m.default{constructor(l){super(l),this.name="SequelizeAssociationError"}}var N=g})(Sn);var Rn={};(function(S){var e=Object.create,t=Object.defineProperty,n=Object.getOwnPropertyDescriptor,f=Object.getOwnPropertyNames,O=Object.getPrototypeOf,T=Object.prototype.hasOwnProperty,E=(r,i,s)=>i in r?t(r,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[i]=s,w=r=>t(r,"__esModule",{value:!0}),R=(r,i)=>{w(r);for(var s in i)t(r,s,{get:i[s],enumerable:!0})},_=(r,i,s)=>{if(i&&typeof i=="object"||typeof i=="function")for(let a of f(i))!T.call(r,a)&&a!=="default"&&t(r,a,{get:()=>i[a],enumerable:!(s=n(i,a))||s.enumerable});return r},m=r=>_(w(t(r!=null?e(O(r)):{},"default",r&&r.__esModule&&"default"in r?{get:()=>r.default,enumerable:!0}:{value:r,enumerable:!0})),r),g=(r,i,s)=>(E(r,typeof i!="symbol"?i+"":i,s),s);R(S,{default:()=>l});var N=m(Se);class c extends N.default{constructor(i,s){super(i.message),g(this,"errors"),g(this,"record"),this.name="SequelizeBulkRecordError",this.errors=i,this.record=s}}var l=c})(Rn);var Ue={};(function(S){var e=Object.create,t=Object.defineProperty,n=Object.getOwnPropertyDescriptor,f=Object.getOwnPropertyNames,O=Object.getPrototypeOf,T=Object.prototype.hasOwnProperty,E=(r,i,s)=>i in r?t(r,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[i]=s,w=r=>t(r,"__esModule",{value:!0}),R=(r,i)=>{w(r);for(var s in i)t(r,s,{get:i[s],enumerable:!0})},_=(r,i,s)=>{if(i&&typeof i=="object"||typeof i=="function")for(let a of f(i))!T.call(r,a)&&a!=="default"&&t(r,a,{get:()=>i[a],enumerable:!(s=n(i,a))||s.enumerable});return r},m=r=>_(w(t(r!=null?e(O(r)):{},"default",r&&r.__esModule&&"default"in r?{get:()=>r.default,enumerable:!0}:{value:r,enumerable:!0})),r),g=(r,i,s)=>(E(r,typeof i!="symbol"?i+"":i,s),s);R(S,{default:()=>l});var N=m(Se);class c extends N.default{constructor(i){super(i?i.message:""),g(this,"parent"),g(this,"original"),this.name="SequelizeConnectionError",this.parent=i,this.original=i}}var l=c})(Ue);var qn={};(function(S){var e=Object.create,t=Object.defineProperty,n=Object.getOwnPropertyDescriptor,f=Object.getOwnPropertyNames,O=Object.getPrototypeOf,T=Object.prototype.hasOwnProperty,E=c=>t(c,"__esModule",{value:!0}),w=(c,l)=>{E(c);for(var r in l)t(c,r,{get:l[r],enumerable:!0})},R=(c,l,r)=>{if(l&&typeof l=="object"||typeof l=="function")for(let i of f(l))!T.call(c,i)&&i!=="default"&&t(c,i,{get:()=>l[i],enumerable:!(r=n(l,i))||r.enumerable});return c},_=c=>R(E(t(c!=null?e(O(c)):{},"default",c&&c.__esModule&&"default"in c?{get:()=>c.default,enumerable:!0}:{value:c,enumerable:!0})),c);w(S,{default:()=>N});var m=_(Se);class g extends m.default{constructor(l){super(l),this.name="SequelizeEagerLoadingError"}}var N=g})(qn);var Cn={};(function(S){var e=Object.create,t=Object.defineProperty,n=Object.getOwnPropertyDescriptor,f=Object.getOwnPropertyNames,O=Object.getPrototypeOf,T=Object.prototype.hasOwnProperty,E=c=>t(c,"__esModule",{value:!0}),w=(c,l)=>{E(c);for(var r in l)t(c,r,{get:l[r],enumerable:!0})},R=(c,l,r)=>{if(l&&typeof l=="object"||typeof l=="function")for(let i of f(l))!T.call(c,i)&&i!=="default"&&t(c,i,{get:()=>l[i],enumerable:!(r=n(l,i))||r.enumerable});return c},_=c=>R(E(t(c!=null?e(O(c)):{},"default",c&&c.__esModule&&"default"in c?{get:()=>c.default,enumerable:!0}:{value:c,enumerable:!0})),c);w(S,{default:()=>N});var m=_(Se);class g extends m.default{constructor(l){super(l),this.name="SequelizeEmptyResultError"}}var N=g})(Cn);var Ln={};(function(S){var e=Object.create,t=Object.defineProperty,n=Object.getOwnPropertyDescriptor,f=Object.getOwnPropertyNames,O=Object.getPrototypeOf,T=Object.prototype.hasOwnProperty,E=c=>t(c,"__esModule",{value:!0}),w=(c,l)=>{E(c);for(var r in l)t(c,r,{get:l[r],enumerable:!0})},R=(c,l,r)=>{if(l&&typeof l=="object"||typeof l=="function")for(let i of f(l))!T.call(c,i)&&i!=="default"&&t(c,i,{get:()=>l[i],enumerable:!(r=n(l,i))||r.enumerable});return c},_=c=>R(E(t(c!=null?e(O(c)):{},"default",c&&c.__esModule&&"default"in c?{get:()=>c.default,enumerable:!0}:{value:c,enumerable:!0})),c);w(S,{default:()=>N});var m=_(Se);class g extends m.default{constructor(l){super(l),this.name="SequelizeInstanceError"}}var N=g})(Ln);var Dn={};(function(S){var e=Object.create,t=Object.defineProperty,n=Object.getOwnPropertyDescriptor,f=Object.getOwnPropertyNames,O=Object.getPrototypeOf,T=Object.prototype.hasOwnProperty,E=(r,i,s)=>i in r?t(r,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[i]=s,w=r=>t(r,"__esModule",{value:!0}),R=(r,i)=>{w(r);for(var s in i)t(r,s,{get:i[s],enumerable:!0})},_=(r,i,s)=>{if(i&&typeof i=="object"||typeof i=="function")for(let a of f(i))!T.call(r,a)&&a!=="default"&&t(r,a,{get:()=>i[a],enumerable:!(s=n(i,a))||s.enumerable});return r},m=r=>_(w(t(r!=null?e(O(r)):{},"default",r&&r.__esModule&&"default"in r?{get:()=>r.default,enumerable:!0}:{value:r,enumerable:!0})),r),g=(r,i,s)=>(E(r,typeof i!="symbol"?i+"":i,s),s);R(S,{default:()=>l});var N=m(Se);class c extends N.default{constructor(i){i=i||{},i.message=i.message||`Attempting to update a stale model instance: ${i.modelName}`,super(i.message),g(this,"modelName"),g(this,"values"),g(this,"where"),this.name="SequelizeOptimisticLockError",this.modelName=i.modelName,this.values=i.values,this.where=i.where}}var l=c})(Dn);var Mn={};(function(S){var e=Object.create,t=Object.defineProperty,n=Object.getOwnPropertyDescriptor,f=Object.getOwnPropertyNames,O=Object.getPrototypeOf,T=Object.prototype.hasOwnProperty,E=c=>t(c,"__esModule",{value:!0}),w=(c,l)=>{E(c);for(var r in l)t(c,r,{get:l[r],enumerable:!0})},R=(c,l,r)=>{if(l&&typeof l=="object"||typeof l=="function")for(let i of f(l))!T.call(c,i)&&i!=="default"&&t(c,i,{get:()=>l[i],enumerable:!(r=n(l,i))||r.enumerable});return c},_=c=>R(E(t(c!=null?e(O(c)):{},"default",c&&c.__esModule&&"default"in c?{get:()=>c.default,enumerable:!0}:{value:c,enumerable:!0})),c);w(S,{default:()=>N});var m=_(Se);class g extends m.default{constructor(l){super(l),this.name="SequelizeQueryError"}}var N=g})(Mn);var $n={};(function(S){var e=Object.create,t=Object.defineProperty,n=Object.getOwnPropertyDescriptor,f=Object.getOwnPropertyNames,O=Object.getPrototypeOf,T=Object.prototype.hasOwnProperty,E=c=>t(c,"__esModule",{value:!0}),w=(c,l)=>{E(c);for(var r in l)t(c,r,{get:l[r],enumerable:!0})},R=(c,l,r)=>{if(l&&typeof l=="object"||typeof l=="function")for(let i of f(l))!T.call(c,i)&&i!=="default"&&t(c,i,{get:()=>l[i],enumerable:!(r=n(l,i))||r.enumerable});return c},_=c=>R(E(t(c!=null?e(O(c)):{},"default",c&&c.__esModule&&"default"in c?{get:()=>c.default,enumerable:!0}:{value:c,enumerable:!0})),c);w(S,{default:()=>N});var m=_(Se);class g extends m.default{constructor(l){super(l),this.name="SequelizeScopeError"}}var N=g})($n);var Is={};(function(S){var e=Object.create,t=Object.defineProperty,n=Object.getOwnPropertyDescriptor,f=Object.getOwnPropertyNames,O=Object.getPrototypeOf,T=Object.prototype.hasOwnProperty,E=(a,d,y)=>d in a?t(a,d,{enumerable:!0,configurable:!0,writable:!0,value:y}):a[d]=y,w=a=>t(a,"__esModule",{value:!0}),R=(a,d)=>{w(a);for(var y in d)t(a,y,{get:d[y],enumerable:!0})},_=(a,d,y)=>{if(d&&typeof d=="object"||typeof d=="function")for(let o of f(d))!T.call(a,o)&&o!=="default"&&t(a,o,{get:()=>d[o],enumerable:!(y=n(d,o))||y.enumerable});return a},m=a=>_(w(t(a!=null?e(O(a)):{},"default",a&&a.__esModule&&"default"in a?{get:()=>a.default,enumerable:!0}:{value:a,enumerable:!0})),a),g=(a,d,y)=>(E(a,typeof d!="symbol"?d+"":d,y),y);R(S,{ValidationErrorItem:()=>r,ValidationErrorItemOrigin:()=>l,ValidationErrorItemType:()=>c,default:()=>s});var N=m(Se),c=(a=>(a["notnull violation"]="CORE",a["string violation"]="CORE",a["unique violation"]="DB",a["validation error"]="FUNCTION",a))(c||{}),l=(a=>(a.CORE="CORE",a.DB="DB",a.FUNCTION="FUNCTION",a))(l||{});class r{constructor(d,y,o,p,b,u,h,A){if(g(this,"message"),g(this,"type"),g(this,"path"),g(this,"value"),g(this,"origin"),g(this,"instance"),g(this,"validatorKey"),g(this,"validatorName"),g(this,"validatorArgs"),this.message=d||"",this.type=null,this.path=o||null,this.value=p!==void 0?p:null,this.origin=null,this.instance=b||null,this.validatorKey=u||null,this.validatorName=h||null,this.validatorArgs=A||[],y)if(this.isValidationErrorItemOrigin(y))this.origin=y;else{const I=this.normalizeString(y),q=c[I];q&&l[q]&&(this.origin=q,this.type=y)}}isValidationErrorItemOrigin(d){return l[d]!==void 0}normalizeString(d){return d.toLowerCase().trim()}getValidatorKey(d,y){const o=d===void 0||!!d,p=y===void 0?".":y,b=this.origin,u=this.validatorKey||this.validatorName,h=o&&b&&l[b];if(h&&(typeof p!="string"||!p.length))throw new Error("Invalid namespace separator given, must be a non-empty string");return typeof u=="string"&&u.length?(h?[this.origin,u].join(p):u).toLowerCase().trim():""}}g(r,"TypeStringMap",c),g(r,"Origins",l);class i extends N.default{constructor(d,y,o={}){super(d),g(this,"errors"),this.name="SequelizeValidationError",this.message="Validation Error",this.errors=y||[],d?this.message=d:this.errors.length>0&&this.errors[0].message&&(this.message=this.errors.map(p=>`${p.type||p.origin}: ${p.message}`).join(`,
`)),o.stack&&(this.stack=o.stack)}get(d){return this.errors.reduce((y,o)=>(o.path===d&&y.push(o),y),[])}}var s=i})(Is);var Pn={};(function(S){var e=Object.create,t=Object.defineProperty,n=Object.getOwnPropertyDescriptor,f=Object.getOwnPropertyNames,O=Object.getPrototypeOf,T=Object.prototype.hasOwnProperty,E=c=>t(c,"__esModule",{value:!0}),w=(c,l)=>{E(c);for(var r in l)t(c,r,{get:l[r],enumerable:!0})},R=(c,l,r)=>{if(l&&typeof l=="object"||typeof l=="function")for(let i of f(l))!T.call(c,i)&&i!=="default"&&t(c,i,{get:()=>l[i],enumerable:!(r=n(l,i))||r.enumerable});return c},_=c=>R(E(t(c!=null?e(O(c)):{},"default",c&&c.__esModule&&"default"in c?{get:()=>c.default,enumerable:!0}:{value:c,enumerable:!0})),c);w(S,{default:()=>N});var m=_(Ue);class g extends m.default{constructor(l){super(l),this.name="SequelizeAccessDeniedError"}}var N=g})(Pn);var vn={};(function(S){var e=Object.create,t=Object.defineProperty,n=Object.getOwnPropertyDescriptor,f=Object.getOwnPropertyNames,O=Object.getPrototypeOf,T=Object.prototype.hasOwnProperty,E=c=>t(c,"__esModule",{value:!0}),w=(c,l)=>{E(c);for(var r in l)t(c,r,{get:l[r],enumerable:!0})},R=(c,l,r)=>{if(l&&typeof l=="object"||typeof l=="function")for(let i of f(l))!T.call(c,i)&&i!=="default"&&t(c,i,{get:()=>l[i],enumerable:!(r=n(l,i))||r.enumerable});return c},_=c=>R(E(t(c!=null?e(O(c)):{},"default",c&&c.__esModule&&"default"in c?{get:()=>c.default,enumerable:!0}:{value:c,enumerable:!0})),c);w(S,{default:()=>N});var m=_(Ue);class g extends m.default{constructor(l){super(l),this.name="SequelizeConnectionAcquireTimeoutError"}}var N=g})(vn);var jn={};(function(S){var e=Object.create,t=Object.defineProperty,n=Object.getOwnPropertyDescriptor,f=Object.getOwnPropertyNames,O=Object.getPrototypeOf,T=Object.prototype.hasOwnProperty,E=c=>t(c,"__esModule",{value:!0}),w=(c,l)=>{E(c);for(var r in l)t(c,r,{get:l[r],enumerable:!0})},R=(c,l,r)=>{if(l&&typeof l=="object"||typeof l=="function")for(let i of f(l))!T.call(c,i)&&i!=="default"&&t(c,i,{get:()=>l[i],enumerable:!(r=n(l,i))||r.enumerable});return c},_=c=>R(E(t(c!=null?e(O(c)):{},"default",c&&c.__esModule&&"default"in c?{get:()=>c.default,enumerable:!0}:{value:c,enumerable:!0})),c);w(S,{default:()=>N});var m=_(Ue);class g extends m.default{constructor(l){super(l),this.name="SequelizeConnectionRefusedError"}}var N=g})(jn);var xn={};(function(S){var e=Object.create,t=Object.defineProperty,n=Object.getOwnPropertyDescriptor,f=Object.getOwnPropertyNames,O=Object.getPrototypeOf,T=Object.prototype.hasOwnProperty,E=c=>t(c,"__esModule",{value:!0}),w=(c,l)=>{E(c);for(var r in l)t(c,r,{get:l[r],enumerable:!0})},R=(c,l,r)=>{if(l&&typeof l=="object"||typeof l=="function")for(let i of f(l))!T.call(c,i)&&i!=="default"&&t(c,i,{get:()=>l[i],enumerable:!(r=n(l,i))||r.enumerable});return c},_=c=>R(E(t(c!=null?e(O(c)):{},"default",c&&c.__esModule&&"default"in c?{get:()=>c.default,enumerable:!0}:{value:c,enumerable:!0})),c);w(S,{default:()=>N});var m=_(Ue);class g extends m.default{constructor(l){super(l),this.name="SequelizeConnectionTimedOutError"}}var N=g})(xn);var Qn={};(function(S){var e=Object.create,t=Object.defineProperty,n=Object.getOwnPropertyDescriptor,f=Object.getOwnPropertyNames,O=Object.getPrototypeOf,T=Object.prototype.hasOwnProperty,E=c=>t(c,"__esModule",{value:!0}),w=(c,l)=>{E(c);for(var r in l)t(c,r,{get:l[r],enumerable:!0})},R=(c,l,r)=>{if(l&&typeof l=="object"||typeof l=="function")for(let i of f(l))!T.call(c,i)&&i!=="default"&&t(c,i,{get:()=>l[i],enumerable:!(r=n(l,i))||r.enumerable});return c},_=c=>R(E(t(c!=null?e(O(c)):{},"default",c&&c.__esModule&&"default"in c?{get:()=>c.default,enumerable:!0}:{value:c,enumerable:!0})),c);w(S,{default:()=>N});var m=_(Ue);class g extends m.default{constructor(l){super(l),this.name="SequelizeHostNotFoundError"}}var N=g})(Qn);var Fn={};(function(S){var e=Object.create,t=Object.defineProperty,n=Object.getOwnPropertyDescriptor,f=Object.getOwnPropertyNames,O=Object.getPrototypeOf,T=Object.prototype.hasOwnProperty,E=c=>t(c,"__esModule",{value:!0}),w=(c,l)=>{E(c);for(var r in l)t(c,r,{get:l[r],enumerable:!0})},R=(c,l,r)=>{if(l&&typeof l=="object"||typeof l=="function")for(let i of f(l))!T.call(c,i)&&i!=="default"&&t(c,i,{get:()=>l[i],enumerable:!(r=n(l,i))||r.enumerable});return c},_=c=>R(E(t(c!=null?e(O(c)):{},"default",c&&c.__esModule&&"default"in c?{get:()=>c.default,enumerable:!0}:{value:c,enumerable:!0})),c);w(S,{default:()=>N});var m=_(Ue);class g extends m.default{constructor(l){super(l),this.name="SequelizeHostNotReachableError"}}var N=g})(Fn);var Un={};(function(S){var e=Object.create,t=Object.defineProperty,n=Object.getOwnPropertyDescriptor,f=Object.getOwnPropertyNames,O=Object.getPrototypeOf,T=Object.prototype.hasOwnProperty,E=c=>t(c,"__esModule",{value:!0}),w=(c,l)=>{E(c);for(var r in l)t(c,r,{get:l[r],enumerable:!0})},R=(c,l,r)=>{if(l&&typeof l=="object"||typeof l=="function")for(let i of f(l))!T.call(c,i)&&i!=="default"&&t(c,i,{get:()=>l[i],enumerable:!(r=n(l,i))||r.enumerable});return c},_=c=>R(E(t(c!=null?e(O(c)):{},"default",c&&c.__esModule&&"default"in c?{get:()=>c.default,enumerable:!0}:{value:c,enumerable:!0})),c);w(S,{default:()=>N});var m=_(Ue);class g extends m.default{constructor(l){super(l),this.name="SequelizeInvalidConnectionError"}}var N=g})(Un);var Kn={};(function(S){var e=Object.create,t=Object.defineProperty,n=Object.getOwnPropertyDescriptor,f=Object.getOwnPropertyNames,O=Object.getPrototypeOf,T=Object.prototype.hasOwnProperty,E=(r,i,s)=>i in r?t(r,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[i]=s,w=r=>t(r,"__esModule",{value:!0}),R=(r,i)=>{w(r);for(var s in i)t(r,s,{get:i[s],enumerable:!0})},_=(r,i,s)=>{if(i&&typeof i=="object"||typeof i=="function")for(let a of f(i))!T.call(r,a)&&a!=="default"&&t(r,a,{get:()=>i[a],enumerable:!(s=n(i,a))||s.enumerable});return r},m=r=>_(w(t(r!=null?e(O(r)):{},"default",r&&r.__esModule&&"default"in r?{get:()=>r.default,enumerable:!0}:{value:r,enumerable:!0})),r),g=(r,i,s)=>(E(r,typeof i!="symbol"?i+"":i,s),s);R(S,{default:()=>l});var N=m(mt);class c extends N.default{constructor(i){i=i||{},i.parent=i.parent||{sql:"",name:"",message:""},super(i.parent,{stack:i.stack}),g(this,"constraint"),g(this,"fields"),g(this,"table"),this.name="SequelizeExclusionConstraintError",this.message=i.message||i.parent.message||"",this.constraint=i.constraint,this.fields=i.fields,this.table=i.table}}var l=c})(Kn);var Bn={};(function(S){var e=Object.create,t=Object.defineProperty,n=Object.getOwnPropertyDescriptor,f=Object.getOwnPropertyNames,O=Object.getPrototypeOf,T=Object.prototype.hasOwnProperty,E=(i,s,a)=>s in i?t(i,s,{enumerable:!0,configurable:!0,writable:!0,value:a}):i[s]=a,w=i=>t(i,"__esModule",{value:!0}),R=(i,s)=>{w(i);for(var a in s)t(i,a,{get:s[a],enumerable:!0})},_=(i,s,a)=>{if(s&&typeof s=="object"||typeof s=="function")for(let d of f(s))!T.call(i,d)&&d!=="default"&&t(i,d,{get:()=>s[d],enumerable:!(a=n(s,d))||a.enumerable});return i},m=i=>_(w(t(i!=null?e(O(i)):{},"default",i&&i.__esModule&&"default"in i?{get:()=>i.default,enumerable:!0}:{value:i,enumerable:!0})),i),g=(i,s,a)=>(E(i,typeof s!="symbol"?s+"":s,a),a);R(S,{RelationshipType:()=>c,default:()=>r});var N=m(mt),c=(i=>(i.parent="parent",i.child="child",i))(c||{});class l extends N.default{constructor(s){s=s||{},s.parent=s.parent||{sql:"",name:"",message:""},super(s.parent,{stack:s.stack}),g(this,"table"),g(this,"fields"),g(this,"value"),g(this,"index"),g(this,"reltype"),this.name="SequelizeForeignKeyConstraintError",this.message=s.message||s.parent.message||"Database Error",this.fields=s.fields,this.table=s.table,this.value=s.value,this.index=s.index,this.reltype=s.reltype}}var r=l})(Bn);var zn={};(function(S){var e=Object.create,t=Object.defineProperty,n=Object.getOwnPropertyDescriptor,f=Object.getOwnPropertyNames,O=Object.getPrototypeOf,T=Object.prototype.hasOwnProperty,E=c=>t(c,"__esModule",{value:!0}),w=(c,l)=>{E(c);for(var r in l)t(c,r,{get:l[r],enumerable:!0})},R=(c,l,r)=>{if(l&&typeof l=="object"||typeof l=="function")for(let i of f(l))!T.call(c,i)&&i!=="default"&&t(c,i,{get:()=>l[i],enumerable:!(r=n(l,i))||r.enumerable});return c},_=c=>R(E(t(c!=null?e(O(c)):{},"default",c&&c.__esModule&&"default"in c?{get:()=>c.default,enumerable:!0}:{value:c,enumerable:!0})),c);w(S,{default:()=>N});var m=_(mt);class g extends m.default{constructor(l,r={}){super(l,r),this.name="SequelizeTimeoutError"}}var N=g})(zn);var kn={};(function(S){var e=Object.create,t=Object.defineProperty,n=Object.getOwnPropertyDescriptor,f=Object.getOwnPropertyNames,O=Object.getPrototypeOf,T=Object.prototype.hasOwnProperty,E=(r,i,s)=>i in r?t(r,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[i]=s,w=r=>t(r,"__esModule",{value:!0}),R=(r,i)=>{w(r);for(var s in i)t(r,s,{get:i[s],enumerable:!0})},_=(r,i,s)=>{if(i&&typeof i=="object"||typeof i=="function")for(let a of f(i))!T.call(r,a)&&a!=="default"&&t(r,a,{get:()=>i[a],enumerable:!(s=n(i,a))||s.enumerable});return r},m=r=>_(w(t(r!=null?e(O(r)):{},"default",r&&r.__esModule&&"default"in r?{get:()=>r.default,enumerable:!0}:{value:r,enumerable:!0})),r),g=(r,i,s)=>(E(r,typeof i!="symbol"?i+"":i,s),s);R(S,{default:()=>l});var N=m(mt);class c extends N.default{constructor(i){i=i||{},i.parent=i.parent||{sql:"",name:"",message:""},super(i.parent,{stack:i.stack}),g(this,"constraint"),g(this,"fields"),g(this,"table"),this.name="SequelizeUnknownConstraintError",this.message=i.message||"The specified constraint does not exist",this.constraint=i.constraint,this.fields=i.fields,this.table=i.table}}var l=c})(kn);var Hn={};(function(S){var e=Object.create,t=Object.defineProperty,n=Object.getOwnPropertyDescriptor,f=Object.getOwnPropertyNames,O=Object.getPrototypeOf,T=Object.prototype.hasOwnProperty,E=(r,i,s)=>i in r?t(r,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[i]=s,w=r=>t(r,"__esModule",{value:!0}),R=(r,i)=>{w(r);for(var s in i)t(r,s,{get:i[s],enumerable:!0})},_=(r,i,s)=>{if(i&&typeof i=="object"||typeof i=="function")for(let a of f(i))!T.call(r,a)&&a!=="default"&&t(r,a,{get:()=>i[a],enumerable:!(s=n(i,a))||s.enumerable});return r},m=r=>_(w(t(r!=null?e(O(r)):{},"default",r&&r.__esModule&&"default"in r?{get:()=>r.default,enumerable:!0}:{value:r,enumerable:!0})),r),g=(r,i,s)=>(E(r,typeof i!="symbol"?i+"":i,s),s);R(S,{default:()=>l});var N=m(Is);class c extends N.default{constructor(i){var s,a,d;i=i??{},i.parent=(s=i.parent)!=null?s:{sql:"",name:"",message:""},i.message=i.message||i.parent.message||"Validation Error",i.errors=(a=i.errors)!=null?a:[],super(i.message,i.errors,{stack:i.stack}),g(this,"parent"),g(this,"original"),g(this,"fields"),g(this,"sql"),this.name="SequelizeUniqueConstraintError",this.fields=(d=i.fields)!=null?d:{},this.parent=i.parent,this.original=i.parent,this.sql=i.parent.sql}}var l=c})(Hn);var Ss={};(function(S){var e=Object.create,t=Object.defineProperty,n=Object.getOwnPropertyDescriptor,f=Object.getOwnPropertyNames,O=Object.getPrototypeOf,T=Object.prototype.hasOwnProperty,E=(s,a,d)=>a in s?t(s,a,{enumerable:!0,configurable:!0,writable:!0,value:d}):s[a]=d,w=s=>t(s,"__esModule",{value:!0}),R=(s,a)=>{w(s);for(var d in a)t(s,d,{get:a[d],enumerable:!0})},_=(s,a,d)=>{if(a&&typeof a=="object"||typeof a=="function")for(let y of f(a))!T.call(s,y)&&y!=="default"&&t(s,y,{get:()=>a[y],enumerable:!(d=n(a,y))||d.enumerable});return s},m=s=>_(w(t(s!=null?e(O(s)):{},"default",s&&s.__esModule&&"default"in s?{get:()=>s.default,enumerable:!0}:{value:s,enumerable:!0})),s),g=(s,a,d)=>(E(s,typeof a!="symbol"?a+"":a,d),d);R(S,{AsyncQueueError:()=>l,default:()=>i});var N=m(Se),c=m(Ue);class l extends N.default{constructor(a){super(a),this.name="SequelizeAsyncQueueError"}}class r{constructor(){g(this,"previous"),g(this,"closed"),g(this,"rejectCurrent"),this.previous=Promise.resolve(),this.closed=!1,this.rejectCurrent=()=>{}}close(){this.closed=!0,this.rejectCurrent(new c.default(new l("the connection was closed before this query could finish executing")))}enqueue(a){return new Promise((d,y)=>{this.previous=this.previous.then(()=>(this.rejectCurrent=y,this.closed?y(new c.default(new l("the connection was closed before this query could be executed"))):a().then(d,y)))})}}var i=r})(Ss);(function(S){var e=Object.create,t=Object.defineProperty,n=Object.getOwnPropertyDescriptor,f=Object.getOwnPropertyNames,O=Object.getPrototypeOf,T=Object.prototype.hasOwnProperty,E=B=>t(B,"__esModule",{value:!0}),w=(B,F)=>{E(B);for(var x in F)t(B,x,{get:F[x],enumerable:!0})},R=(B,F,x)=>{if(F&&typeof F=="object"||typeof F=="function")for(let k of f(F))!T.call(B,k)&&k!=="default"&&t(B,k,{get:()=>F[k],enumerable:!(x=n(F,k))||x.enumerable});return B},_=B=>R(E(t(B!=null?e(O(B)):{},"default",B&&B.__esModule&&"default"in B?{get:()=>B.default,enumerable:!0}:{value:B,enumerable:!0})),B);w(S,{AccessDeniedError:()=>b.default,AggregateError:()=>N.default,AssociationError:()=>c.default,AsyncQueueError:()=>j.AsyncQueueError,BaseError:()=>m.default,BulkRecordError:()=>l.default,ConnectionAcquireTimeoutError:()=>u.default,ConnectionError:()=>r.default,ConnectionRefusedError:()=>h.default,ConnectionTimedOutError:()=>A.default,DatabaseError:()=>g.default,EagerLoadingError:()=>i.default,EmptyResultError:()=>s.default,ExclusionConstraintError:()=>D.default,ForeignKeyConstraintError:()=>C.default,HostNotFoundError:()=>I.default,HostNotReachableError:()=>q.default,InstanceError:()=>a.default,InvalidConnectionError:()=>L.default,OptimisticLockError:()=>d.default,QueryError:()=>y.default,SequelizeScopeError:()=>o.default,TimeoutError:()=>$.default,UniqueConstraintError:()=>Q.default,UnknownConstraintError:()=>P.default,ValidationError:()=>p.default,ValidationErrorItem:()=>p.ValidationErrorItem,ValidationErrorItemOrigin:()=>p.ValidationErrorItemOrigin,ValidationErrorItemType:()=>p.ValidationErrorItemType});var m=_(Se),g=_(mt),N=_(In),c=_(Sn),l=_(Rn),r=_(Ue),i=_(qn),s=_(Cn),a=_(Ln),d=_(Dn),y=_(Mn),o=_($n),p=_(Is),b=_(Pn),u=_(vn),h=_(jn),A=_(xn),I=_(Qn),q=_(Fn),L=_(Un),D=_(Kn),C=_(Bn),$=_(zn),P=_(kn),Q=_(Hn),j=_(Ss)})(ce);var Ft={};const Gn=re,rt=Gn.cloneDeep(ga()),ba=ze,Vn={extend(S,e){return this[S]=e,this},notEmpty(S){return!S.match(/^[\s\t\r\n]*$/)},len(S,e,t){return this.isLength(S,e,t)},isUrl(S){return this.isURL(S)},isIPv6(S){return this.isIP(S,6)},isIPv4(S){return this.isIP(S,4)},notIn(S,e){return!this.isIn(S,e)},regex(S,e,t){return S+="",Object.prototype.toString.call(e).slice(8,-1)!=="RegExp"&&(e=new RegExp(e,t)),S.match(e)},notRegex(S,e,t){return!this.regex(S,e,t)},isDecimal(S){return S!==""&&!!S.match(/^(?:-?(?:[0-9]+))?(?:\.[0-9]*)?(?:[eE][+-]?(?:[0-9]+))?$/)},min(S,e){const t=parseFloat(S);return isNaN(t)||t>=e},max(S,e){const t=parseFloat(S);return isNaN(t)||t<=e},not(S,e,t){return this.notRegex(S,e,t)},contains(S,e){return!!e&&S.includes(e)},notContains(S,e){return!this.contains(S,e)},is(S,e,t){return this.regex(S,e,t)}};Ft.extensions=Vn;rt.isImmutable=function(S,e,t,n){return n.isNewRecord||n.dataValues[t]===n._previousDataValues[t]};rt.notNull=function(S){return S!=null};Gn.forEach(Vn,(S,e)=>{rt[e]=S});rt.isNull=rt.isEmpty;rt.isDate=function(S){const e=Date.parse(S);if(isNaN(e))return!1;const t=new Date(e);return ba(t.toISOString()).isValid()};Ft.validator=rt;var ge={};(function(S){var e=Object.create,t=Object.defineProperty,n=Object.getOwnPropertyDescriptor,f=Object.getOwnPropertyNames,O=Object.getOwnPropertySymbols,T=Object.getPrototypeOf,E=Object.prototype.hasOwnProperty,w=Object.prototype.propertyIsEnumerable,R=(y,o,p)=>o in y?t(y,o,{enumerable:!0,configurable:!0,writable:!0,value:p}):y[o]=p,_=(y,o)=>{for(var p in o||(o={}))E.call(o,p)&&R(y,p,o[p]);if(O)for(var p of O(o))w.call(o,p)&&R(y,p,o[p]);return y},m=y=>t(y,"__esModule",{value:!0}),g=(y,o)=>{var p={};for(var b in y)E.call(y,b)&&o.indexOf(b)<0&&(p[b]=y[b]);if(y!=null&&O)for(var b of O(y))o.indexOf(b)<0&&w.call(y,b)&&(p[b]=y[b]);return p},N=(y,o)=>{m(y);for(var p in o)t(y,p,{get:o[p],enumerable:!0})},c=(y,o,p)=>{if(o&&typeof o=="object"||typeof o=="function")for(let b of f(o))!E.call(y,b)&&b!=="default"&&t(y,b,{get:()=>o[b],enumerable:!(p=n(o,b))||p.enumerable});return y},l=y=>c(m(t(y!=null?e(T(y)):{},"default",y&&y.__esModule&&"default"in y?{get:()=>y.default,enumerable:!0}:{value:y,enumerable:!0})),y),r=(y,o,p)=>(R(y,typeof o!="symbol"?o+"":o,p),p);N(S,{Logger:()=>a,logger:()=>d});var i=l(fa),s=l(Ae);class a{constructor(o={}){r(this,"config");var p=o,{context:b="sequelize"}=p,u=g(p,["context"]);this.config=_({context:b},u)}warn(o){console.warn(`(${this.config.context}) Warning: ${o}`)}inspect(o){return s.default.inspect(o,{showHidden:!1,depth:1})}debugContext(o){return(0,i.default)(`${this.config.context}:${o}`)}}const d=new a})(ge);var Rs={};(function(S){var e=Object.defineProperty,t=O=>e(O,"__esModule",{value:!0}),n=(O,T)=>{t(O);for(var E in T)e(O,E,{get:T[E],enumerable:!0})};n(S,{classToInvokable:()=>f});function f(O){return new Proxy(O,{apply(T,E,w){return new O(...w)},construct(T,E){return new O(...E)}})}})(Rs);var qs={};(function(S){var e=Object.defineProperty,t=(m,g,N)=>g in m?e(m,g,{enumerable:!0,configurable:!0,writable:!0,value:N}):m[g]=N,n=m=>e(m,"__esModule",{value:!0}),f=(m,g)=>{n(m);for(var N in g)e(m,N,{get:g[N],enumerable:!0})},O=(m,g,N)=>(t(m,typeof g!="symbol"?g+"":g,N),N);f(S,{JoinSQLFragmentsError:()=>_,joinSQLFragments:()=>R});function T(m){return/^[;,)]/.test(m)}function E(m){return/\($/.test(m)}function w(m){return m.reduce(({skipNextLeadingSpace:g,result:N},c)=>(g||T(c)?N+=c.trim():N+=` ${c.trim()}`,{skipNextLeadingSpace:E(c),result:N}),{skipNextLeadingSpace:!0,result:""}).result}function R(m){if(m.length===0)return"";const N=m.filter(r=>!!r).map(r=>Array.isArray(r)?R(r):r);for(const r of N)if(r&&typeof r!="string")throw new _(N,r,`Tried to construct a SQL string with a non-string, non-falsy fragment (${r}).`);const l=N.map(r=>r.trim()).filter(r=>r!=="");return w(l)}class _ extends TypeError{constructor(g,N,c){super(c),O(this,"args"),O(this,"fragment"),this.args=g,this.fragment=N,this.name="JoinSQLFragmentsError"}}})(qs);var kt={},js;function br(){if(js)return kt;js=1;const S=ha({sanitize:!0});function e(n){return n===null?null:S.stringify(n)}kt.stringify=e;function t(n){return n===null?null:S.parse(n)}return kt.parse=t,kt}var Ht={},xs;function Ta(){if(xs)return Ht;xs=1;const S=re;function e(O){return O===null?"":O===1/0||O===-1/0?O.toString().toLowerCase():JSON.stringify(O)}function t(O,T){return O?O==="infinity"?1/0:O==="-infinity"?-1/0:T(O):null}function n(O){if(O===null)return null;if(!Array.isArray(O))throw new Error("range must be an array");if(!O.length)return"empty";if(O.length!==2)throw new Error("range array length must be 0 (empty) or 2 (lower and upper bounds)");Object.prototype.hasOwnProperty.call(O,"inclusive")?O.inclusive===!1?O.inclusive=[!1,!1]:O.inclusive?O.inclusive===!0&&(O.inclusive=[!0,!0]):O.inclusive=[!0,!1]:O.inclusive=[!0,!1],S.each(O,(w,R)=>{S.isObject(w)&&(Object.prototype.hasOwnProperty.call(w,"inclusive")&&(O.inclusive[R]=!!w.inclusive),Object.prototype.hasOwnProperty.call(w,"value")&&(O[R]=w.value))});const T=e(O[0]),E=e(O[1]);return`${(O.inclusive[0]?"[":"(")+T},${E}${O.inclusive[1]?"]":")"}`}Ht.stringify=n;function f(O,T){if(O===null)return null;if(O==="empty")return[];let E=O.substring(1,O.length-1).split(",",2);return E.length!==2?O:(E=E.map((w,R)=>({value:t(w,T),inclusive:R===0?O[0]==="[":O[O.length-1]==="]"})),E)}return Ht.parse=f,Ht}var Tr,Qs;function Na(){if(Qs)return Tr;Qs=1;const S=re,e=ar;return Tr=t=>{const n=t.ABSTRACT.warn.bind(void 0,"http://www.postgresql.org/docs/9.4/static/datatype.html");function f(I){(I._length||I.options.length||I._unsigned||I._zerofill)&&(n(`PostgresSQL does not support '${I.key}' with LENGTH, UNSIGNED or ZEROFILL. Plain '${I.key}' will be used instead.`),I._length=void 0,I.options.length=void 0,I._unsigned=void 0,I._zerofill=void 0)}t.UUID.types.postgres=["uuid"],t.CIDR.types.postgres=["cidr"],t.INET.types.postgres=["inet"],t.MACADDR.types.postgres=["macaddr"],t.TSVECTOR.types.postgres=["tsvector"],t.JSON.types.postgres=["json"],t.JSONB.types.postgres=["jsonb"],t.TIME.types.postgres=["time"];class O extends t.DATEONLY{_stringify(q,L){return q===1/0?"Infinity":q===-1/0?"-Infinity":super._stringify(q,L)}_sanitize(q,L){if((!L||L&&!L.raw)&&q!==1/0&&q!==-1/0){if(typeof q=="string"){const D=q.toLowerCase();if(D==="infinity")return 1/0;if(D==="-infinity")return-1/0}return super._sanitize(q)}return q}static parse(q){return q==="infinity"?1/0:q==="-infinity"?-1/0:q}}t.DATEONLY.types.postgres=["date"];class T extends t.DECIMAL{static parse(q){return q}}t.DECIMAL.types.postgres=["numeric"];class E extends t.STRING{toSql(){return this._binary?"BYTEA":super.toSql()}}t.STRING.types.postgres=["varchar"];class w extends t.TEXT{toSql(){return this._length&&(n("PostgreSQL does not support TEXT with options. Plain `TEXT` will be used instead."),this._length=void 0),"TEXT"}}t.TEXT.types.postgres=["text"];class R extends t.CITEXT{static parse(q){return q}}t.CITEXT.types.postgres=["citext"];class _ extends t.CHAR{toSql(){return this._binary?"BYTEA":super.toSql()}}t.CHAR.types.postgres=["char","bpchar"];class m extends t.BOOLEAN{toSql(){return"BOOLEAN"}_sanitize(q){if(q!=null){if(Buffer.isBuffer(q)&&q.length===1&&(q=q[0]),typeof q=="string")return["true","t"].includes(q)?!0:["false","f"].includes(q)?!1:q;if(typeof q=="number")return q===1?!0:q===0?!1:q}return q}}m.parse=m.prototype._sanitize,t.BOOLEAN.types.postgres=["bool"];class g extends t.DATE{toSql(){return"TIMESTAMP WITH TIME ZONE"}validate(q){return q!==1/0&&q!==-1/0?super.validate(q):!0}_stringify(q,L){return q===1/0?"Infinity":q===-1/0?"-Infinity":super._stringify(q,L)}_sanitize(q,L){if((!L||L&&!L.raw)&&!(q instanceof Date)&&q&&q!==1/0&&q!==-1/0){if(typeof q=="string"){const D=q.toLowerCase();if(D==="infinity")return 1/0;if(D==="-infinity")return-1/0}return new Date(q)}return q}}t.DATE.types.postgres=["timestamptz"];class N extends t.TINYINT{constructor(q){super(q),f(this)}}t.TINYINT.types.postgres=["int2"];class c extends t.SMALLINT{constructor(q){super(q),f(this)}}t.SMALLINT.types.postgres=["int2"];class l extends t.INTEGER{constructor(q){super(q),f(this)}}l.parse=function(q){return parseInt(q,10)},t.INTEGER.types.postgres=["int4"];class r extends t.BIGINT{constructor(q){super(q),f(this)}}t.BIGINT.types.postgres=["int8"];class i extends t.REAL{constructor(q){super(q),f(this)}}t.REAL.types.postgres=["float4"];class s extends t.DOUBLE{constructor(q){super(q),f(this)}}t.DOUBLE.types.postgres=["float8"];class a extends t.FLOAT{constructor(q,L){super(q,L),this._decimals&&(n("PostgreSQL does not support FLOAT with decimals. Plain `FLOAT` will be used instead."),this._length=void 0,this.options.length=void 0,this._decimals=void 0),this._unsigned&&(n("PostgreSQL does not support FLOAT unsigned. `UNSIGNED` was removed."),this._unsigned=void 0),this._zerofill&&(n("PostgreSQL does not support FLOAT zerofill. `ZEROFILL` was removed."),this._zerofill=void 0)}}delete a.parse;class d extends t.BLOB{toSql(){return this._length&&(n("PostgreSQL does not support BLOB (BYTEA) with options. Plain `BYTEA` will be used instead."),this._length=void 0),"BYTEA"}_hexify(q){return`E'\\\\x${q}'`}}t.BLOB.types.postgres=["bytea"];class y extends t.GEOMETRY{toSql(){let q=this.key;return this.type&&(q+=`(${this.type}`,this.srid&&(q+=`,${this.srid}`),q+=")"),q}static parse(q){const L=Buffer.from(q,"hex");return e.Geometry.parse(L).toGeoJSON({shortCrs:!0})}_stringify(q,L){return`ST_GeomFromGeoJSON(${L.escape(JSON.stringify(q))})`}_bindParam(q,L){return`ST_GeomFromGeoJSON(${L.bindParam(q)})`}}t.GEOMETRY.types.postgres=["geometry"];class o extends t.GEOGRAPHY{toSql(){let q="GEOGRAPHY";return this.type&&(q+=`(${this.type}`,this.srid&&(q+=`,${this.srid}`),q+=")"),q}static parse(q){const L=Buffer.from(q,"hex");return e.Geometry.parse(L).toGeoJSON({shortCrs:!0})}_stringify(q,L){return`ST_GeomFromGeoJSON(${L.escape(JSON.stringify(q))})`}bindParam(q,L){return`ST_GeomFromGeoJSON(${L.bindParam(q)})`}}t.GEOGRAPHY.types.postgres=["geography"];let p;class b extends t.HSTORE{constructor(){super(),p||(p=br())}_value(q){return p||(p=br()),p.stringify(q)}_stringify(q){return`'${this._value(q)}'`}_bindParam(q,L){return L.bindParam(this._value(q))}static parse(q){return p||(p=br()),p.parse(q)}}b.prototype.escape=!1,t.HSTORE.types.postgres=["hstore"];class u extends t.RANGE{_value(q,L){if(!Array.isArray(q))return this.options.subtype.stringify(q,L);const D=[!0,!1],C=q.map(($,P)=>(S.isObject($)&&Object.prototype.hasOwnProperty.call($,"value")&&(Object.prototype.hasOwnProperty.call($,"inclusive")&&(D[P]=$.inclusive),$=$.value),$===null||$===-1/0||$===1/0?$:this.options.subtype.stringify?this.options.subtype.stringify($,L):L.escape($)));return C.inclusive=D,h.stringify(C)}_stringify(q,L){const D=this._value(q,L);return Array.isArray(q)?`'${D}'`:`'${D}'::${this.toCastType()}`}_bindParam(q,L){const D=this._value(q,L);return Array.isArray(q)?L.bindParam(D):`${L.bindParam(D)}::${this.toCastType()}`}toSql(){return t.RANGE.types.postgres.subtypes[this._subtype.toLowerCase()]}toCastType(){return t.RANGE.types.postgres.castTypes[this._subtype.toLowerCase()]}static parse(q,L={parser:D=>D}){return h.parse(q,L.parser)}}const h=Ta();u.prototype.escape=!1,t.RANGE.types.postgres={subtypes:{integer:"int4range",decimal:"numrange",date:"tstzrange",dateonly:"daterange",bigint:"int8range"},castTypes:{integer:"int4",decimal:"numeric",date:"timestamptz",dateonly:"date",bigint:"int8"}},t.ARRAY.prototype.escape=!1,t.ARRAY.prototype._value=function(q,L){return q.map(D=>L&&L.bindParam&&this.type&&this.type._value?this.type._value(D,L):this.type&&this.type.stringify&&(D=this.type.stringify(D,L),this.type.escape===!1)?D:L.escape(D),this)},t.ARRAY.prototype._stringify=function(q,L){let D=`ARRAY[${this._value(q,L).join(",")}]`;if(this.type){const C=fe();let $=this.toSql();if(this.type instanceof t.ENUM){const P=L.field.Model.getTableName(),Q=P.schema!==void 0,j=Q?`${C.addTicks(P.schema,'"')}${P.delimiter}`:"";$=`${C.addTicks(C.generateEnumName(Q?P.tableName:P,L.field.field),'"')}[]`,D+=`::${j}${$}`}else D+=`::${$}`}return D},t.ARRAY.prototype._bindParam=function(q,L){return L.bindParam(this._value(q,L))};class A extends t.ENUM{static parse(q){return q}}return t.ENUM.types.postgres=[null],{DECIMAL:T,BLOB:d,STRING:E,CHAR:_,TEXT:w,CITEXT:R,TINYINT:N,SMALLINT:c,INTEGER:l,BIGINT:r,BOOLEAN:m,DATE:g,DATEONLY:O,REAL:i,"DOUBLE PRECISION":s,FLOAT:a,GEOMETRY:y,GEOGRAPHY:o,HSTORE:b,RANGE:u,ENUM:A}},Tr}var Nr,Fs;function wa(){if(Fs)return Nr;Fs=1;const S=ar,e=re,t=ke,n=ze;return Nr=f=>{f.ABSTRACT.prototype.dialectTypes="https://dev.mysql.com/doc/refman/5.7/en/data-types.html",f.DATE.types.mysql=["DATETIME"],f.STRING.types.mysql=["VAR_STRING"],f.CHAR.types.mysql=["STRING"],f.TEXT.types.mysql=["BLOB"],f.TINYINT.types.mysql=["TINY"],f.SMALLINT.types.mysql=["SHORT"],f.MEDIUMINT.types.mysql=["INT24"],f.INTEGER.types.mysql=["LONG"],f.BIGINT.types.mysql=["LONGLONG"],f.FLOAT.types.mysql=["FLOAT"],f.TIME.types.mysql=["TIME"],f.DATEONLY.types.mysql=["DATE"],f.BOOLEAN.types.mysql=["TINY"],f.BLOB.types.mysql=["TINYBLOB","BLOB","LONGBLOB"],f.DECIMAL.types.mysql=["NEWDECIMAL"],f.UUID.types.mysql=!1,f.ENUM.types.mysql=!1,f.REAL.types.mysql=["DOUBLE"],f.DOUBLE.types.mysql=["DOUBLE"],f.GEOMETRY.types.mysql=["GEOMETRY"],f.JSON.types.mysql=["JSON"];class O extends f.DECIMAL{toSql(){let c=super.toSql();return this._unsigned&&(c+=" UNSIGNED"),this._zerofill&&(c+=" ZEROFILL"),c}}class T extends f.DATE{toSql(){return this._length?`DATETIME(${this._length})`:"DATETIME"}_stringify(c,l){return n.isMoment(c)||(c=this._applyTimezone(c,l)),this._length?c.format("YYYY-MM-DD HH:mm:ss.SSS"):c.format("YYYY-MM-DD HH:mm:ss")}static parse(c,l){return c=c.string(),c===null||(t.tz.zone(l.timezone)?c=t.tz(c,l.timezone).toDate():c=new Date(`${c} ${l.timezone}`)),c}}class E extends f.DATEONLY{static parse(c){return c.string()}}class w extends f.UUID{toSql(){return"CHAR(36) BINARY"}}const R=["POINT","LINESTRING","POLYGON"];class _ extends f.GEOMETRY{constructor(c,l){if(super(c,l),e.isEmpty(this.type)){this.sqlType=this.key;return}if(R.includes(this.type)){this.sqlType=this.type;return}throw new Error(`Supported geometry types are: ${R.join(", ")}`)}static parse(c){return c=c.buffer(),!c||c.length===0?null:(c=c.slice(4),S.Geometry.parse(c).toGeoJSON({shortCrs:!0}))}toSql(){return this.sqlType}}class m extends f.ENUM{toSql(c){return`ENUM(${this.values.map(l=>c.escape(l)).join(", ")})`}}class g extends f.JSON{_stringify(c,l){return l.operation==="where"&&typeof c=="string"?c:JSON.stringify(c)}}return{ENUM:m,DATE:T,DATEONLY:E,UUID:w,GEOMETRY:_,DECIMAL:O,JSON:g}},Nr}var wr,Us;function Ia(){if(Us)return wr;Us=1;const S=ar,e=re,t=ke,n=ze;return wr=f=>{f.ABSTRACT.prototype.dialectTypes="https://mariadb.com/kb/en/library/resultset/#field-types",f.DATE.types.mariadb=["DATETIME"],f.STRING.types.mariadb=["VAR_STRING"],f.CHAR.types.mariadb=["STRING"],f.TEXT.types.mariadb=["BLOB"],f.TINYINT.types.mariadb=["TINY"],f.SMALLINT.types.mariadb=["SHORT"],f.MEDIUMINT.types.mariadb=["INT24"],f.INTEGER.types.mariadb=["LONG"],f.BIGINT.types.mariadb=["LONGLONG"],f.FLOAT.types.mariadb=["FLOAT"],f.TIME.types.mariadb=["TIME"],f.DATEONLY.types.mariadb=["DATE"],f.BOOLEAN.types.mariadb=["TINY"],f.BLOB.types.mariadb=["TINYBLOB","BLOB","LONGBLOB"],f.DECIMAL.types.mariadb=["NEWDECIMAL"],f.UUID.types.mariadb=!1,f.ENUM.types.mariadb=!1,f.REAL.types.mariadb=["DOUBLE"],f.DOUBLE.types.mariadb=["DOUBLE"],f.GEOMETRY.types.mariadb=["GEOMETRY"],f.JSON.types.mariadb=["JSON"];class O extends f.DECIMAL{toSql(){let N=super.toSql();return this._unsigned&&(N+=" UNSIGNED"),this._zerofill&&(N+=" ZEROFILL"),N}}class T extends f.DATE{toSql(){return this._length?`DATETIME(${this._length})`:"DATETIME"}_stringify(N,c){return n.isMoment(N)||(N=this._applyTimezone(N,c)),N.format("YYYY-MM-DD HH:mm:ss.SSS")}static parse(N,c){return N=N.string(),N===null||(t.tz.zone(c.timezone)?N=t.tz(N,c.timezone).toDate():N=new Date(`${N} ${c.timezone}`)),N}}class E extends f.DATEONLY{static parse(N){return N.string()}}class w extends f.UUID{toSql(){return"CHAR(36) BINARY"}}class R extends f.GEOMETRY{constructor(N,c){super(N,c),e.isEmpty(this.type)?this.sqlType=this.key:this.sqlType=this.type}static parse(N){return N=N.buffer(),!N||N.length===0?null:(N=N.slice(4),S.Geometry.parse(N).toGeoJSON({shortCrs:!0}))}toSql(){return this.sqlType}}class _ extends f.ENUM{toSql(N){return`ENUM(${this.values.map(c=>N.escape(c)).join(", ")})`}}class m extends f.JSON{_stringify(N,c){return c.operation==="where"&&typeof N=="string"?N:JSON.stringify(N)}}return{ENUM:_,DATE:T,DATEONLY:E,UUID:w,GEOMETRY:R,DECIMAL:O,JSON:m}},wr}var Ir,Ks;function Sa(){return Ks||(Ks=1,Ir=S=>{const e=S.ABSTRACT.warn.bind(void 0,"https://www.sqlite.org/datatype3.html");function t(y){(y._zerofill||y._unsigned)&&(e(`SQLite does not support '${y.key}' with UNSIGNED or ZEROFILL. Plain '${y.key}' will be used instead.`),y._unsigned=void 0,y._zerofill=void 0)}S.DATE.types.sqlite=["DATETIME"],S.STRING.types.sqlite=["VARCHAR","VARCHAR BINARY"],S.CHAR.types.sqlite=["CHAR","CHAR BINARY"],S.TEXT.types.sqlite=["TEXT"],S.TINYINT.types.sqlite=["TINYINT"],S.SMALLINT.types.sqlite=["SMALLINT"],S.MEDIUMINT.types.sqlite=["MEDIUMINT"],S.INTEGER.types.sqlite=["INTEGER"],S.BIGINT.types.sqlite=["BIGINT"],S.FLOAT.types.sqlite=["FLOAT"],S.TIME.types.sqlite=["TIME"],S.DATEONLY.types.sqlite=["DATE"],S.BOOLEAN.types.sqlite=["TINYINT"],S.BLOB.types.sqlite=["TINYBLOB","BLOB","LONGBLOB"],S.DECIMAL.types.sqlite=["DECIMAL"],S.UUID.types.sqlite=["UUID"],S.ENUM.types.sqlite=!1,S.REAL.types.sqlite=["REAL"],S.DOUBLE.types.sqlite=["DOUBLE PRECISION"],S.GEOMETRY.types.sqlite=!1,S.JSON.types.sqlite=["JSON","JSONB"];class n extends S.JSON{static parse(o){return JSON.parse(o)}}class f extends S.DATE{static parse(o,p){return o.includes("+")?new Date(o):new Date(o+p.timezone)}}class O extends S.DATEONLY{static parse(o){return o}}class T extends S.STRING{toSql(){return this._binary?`VARCHAR BINARY(${this._length})`:super.toSql(this)}}class E extends S.TEXT{toSql(){return this._length&&(e("SQLite does not support TEXT with options. Plain `TEXT` will be used instead."),this._length=void 0),"TEXT"}}class w extends S.CITEXT{toSql(){return"TEXT COLLATE NOCASE"}}class R extends S.CHAR{toSql(){return this._binary?`CHAR BINARY(${this._length})`:super.toSql()}}class _ extends S.NUMBER{toSql(){let o=this.key;return this._unsigned&&(o+=" UNSIGNED"),this._zerofill&&(o+=" ZEROFILL"),this._length&&(o+=`(${this._length}`,typeof this._decimals=="number"&&(o+=`,${this._decimals}`),o+=")"),o}}class m extends S.TINYINT{constructor(o){super(o),t(this)}}class g extends S.SMALLINT{constructor(o){super(o),t(this)}}class N extends S.MEDIUMINT{constructor(o){super(o),t(this)}}class c extends S.INTEGER{constructor(o){super(o),t(this)}}class l extends S.BIGINT{constructor(o){super(o),t(this)}}class r extends S.FLOAT{}class i extends S.DOUBLE{}class s extends S.REAL{}function a(y){if(typeof y!="string")return y;if(y==="NaN")return NaN;if(y==="Infinity")return 1/0;if(y==="-Infinity")return-1/0}for(const y of[r,i,s])y.parse=a;for(const y of[r,i,s,m,g,N,c,l])y.prototype.toSql=_.prototype.toSql;class d extends S.ENUM{toSql(){return"TEXT"}}return{DATE:f,DATEONLY:O,STRING:T,CHAR:R,NUMBER:_,FLOAT:r,REAL:s,"DOUBLE PRECISION":i,TINYINT:m,SMALLINT:g,MEDIUMINT:N,INTEGER:c,BIGINT:l,TEXT:E,ENUM:d,JSON:n,CITEXT:w}}),Ir}var Sr,Bs;function Ra(){if(Bs)return Sr;Bs=1;const S=ze;return Sr=e=>{const t=e.ABSTRACT.warn.bind(void 0,"https://msdn.microsoft.com/en-us/library/ms187752%28v=sql.110%29.aspx");function n(a){(a._length||a.options.length||a._unsigned||a._zerofill)&&(t(`MSSQL does not support '${a.key}' with options. Plain '${a.key}' will be used instead.`),a._length=void 0,a.options.length=void 0,a._unsigned=void 0,a._zerofill=void 0)}e.DATE.types.mssql=[43],e.STRING.types.mssql=[231,173],e.CHAR.types.mssql=[175],e.TEXT.types.mssql=!1,e.TINYINT.types.mssql=[30],e.SMALLINT.types.mssql=[34],e.MEDIUMINT.types.mssql=!1,e.INTEGER.types.mssql=[38],e.BIGINT.types.mssql=!1,e.FLOAT.types.mssql=[109],e.TIME.types.mssql=[41],e.DATEONLY.types.mssql=[40],e.BOOLEAN.types.mssql=[104],e.BLOB.types.mssql=[165],e.DECIMAL.types.mssql=[106],e.UUID.types.mssql=!1,e.ENUM.types.mssql=!1,e.REAL.types.mssql=[109],e.DOUBLE.types.mssql=[109],e.GEOMETRY.types.mssql=!1;class f extends e.BLOB{toSql(){if(this._length){if(this._length.toLowerCase()==="tiny")return t("MSSQL does not support BLOB with the `length` = `tiny` option. `VARBINARY(256)` will be used instead."),"VARBINARY(256)";t("MSSQL does not support BLOB with the `length` option. `VARBINARY(MAX)` will be used instead.")}return"VARBINARY(MAX)"}_hexify(d){return`0x${d}`}}class O extends e.STRING{toSql(){return this._binary?`BINARY(${this._length})`:`NVARCHAR(${this._length})`}_stringify(d,y){return this._binary?f.prototype._stringify(d):y.escape(d)}_bindParam(d,y){return y.bindParam(this._binary?Buffer.from(d):d)}}O.prototype.escape=!1;class T extends e.TEXT{toSql(){if(this._length){if(this._length.toLowerCase()==="tiny")return t("MSSQL does not support TEXT with the `length` = `tiny` option. `NVARCHAR(256)` will be used instead."),"NVARCHAR(256)";t("MSSQL does not support TEXT with the `length` option. `NVARCHAR(MAX)` will be used instead.")}return"NVARCHAR(MAX)"}}class E extends e.BOOLEAN{toSql(){return"BIT"}}class w extends e.UUID{toSql(){return"CHAR(36)"}}class R extends e.NOW{toSql(){return"GETDATE()"}}class _ extends e.DATE{toSql(){return"DATETIMEOFFSET"}}class m extends e.DATEONLY{static parse(d){return S(d).format("YYYY-MM-DD")}}class g extends e.INTEGER{constructor(d){super(d),n(this)}}class N extends e.TINYINT{constructor(d){super(d),n(this)}}class c extends e.SMALLINT{constructor(d){super(d),n(this)}}class l extends e.BIGINT{constructor(d){super(d),n(this)}}class r extends e.REAL{constructor(d,y){super(d,y),(this._length||this.options.length||this._unsigned||this._zerofill)&&(t("MSSQL does not support REAL with options. Plain `REAL` will be used instead."),this._length=void 0,this.options.length=void 0,this._unsigned=void 0,this._zerofill=void 0)}}class i extends e.FLOAT{constructor(d,y){super(d,y),this._decimals&&(t("MSSQL does not support Float with decimals. Plain `FLOAT` will be used instead."),this._length=void 0,this.options.length=void 0),this._unsigned&&(t("MSSQL does not support Float unsigned. `UNSIGNED` was removed."),this._unsigned=void 0),this._zerofill&&(t("MSSQL does not support Float zerofill. `ZEROFILL` was removed."),this._zerofill=void 0)}}class s extends e.ENUM{toSql(){return"VARCHAR(255)"}}return{BLOB:f,BOOLEAN:E,ENUM:s,STRING:O,UUID:w,DATE:_,DATEONLY:m,NOW:R,TINYINT:N,SMALLINT:c,INTEGER:g,BIGINT:l,REAL:r,FLOAT:i,TEXT:T}},Sr}var Rr,zs;function qa(){if(zs)return Rr;zs=1;const S=ke,e=ze;return Rr=t=>{const n=t.ABSTRACT.warn.bind(void 0,"https://www.ibm.com/support/knowledgecenter/SSEPGG_11.1.0/com.ibm.db2.luw.sql.ref.doc/doc/r0008478.html");function f(y){(y._length||y.options.length||y._unsigned||y._zerofill)&&(n(`Db2 does not support '${y.key}' with options. Plain '${y.key}' will be used instead.`),y._length=void 0,y.options.length=void 0,y._unsigned=void 0,y._zerofill=void 0)}t.DATE.types.db2=["TIMESTAMP"],t.STRING.types.db2=["VARCHAR"],t.CHAR.types.db2=["CHAR"],t.TEXT.types.db2=["VARCHAR","CLOB"],t.TINYINT.types.db2=["SMALLINT"],t.SMALLINT.types.db2=["SMALLINT"],t.MEDIUMINT.types.db2=["INTEGER"],t.INTEGER.types.db2=["INTEGER"],t.BIGINT.types.db2=["BIGINT"],t.FLOAT.types.db2=["DOUBLE","REAL","FLOAT"],t.TIME.types.db2=["TIME"],t.DATEONLY.types.db2=["DATE"],t.BOOLEAN.types.db2=["BOOLEAN","BOOL","SMALLINT","BIT"],t.BLOB.types.db2=["BLOB"],t.DECIMAL.types.db2=["DECIMAL"],t.UUID.types.db2=["CHAR () FOR BIT DATA"],t.ENUM.types.db2=["VARCHAR"],t.REAL.types.db2=["REAL"],t.DOUBLE.types.db2=["DOUBLE"],t.GEOMETRY.types.db2=!1;class O extends t.BLOB{toSql(){return this._length?this._length.toLowerCase()==="tiny"?"BLOB(255)":this._length.toLowerCase()==="medium"?"BLOB(16M)":this._length.toLowerCase()==="long"?"BLOB(2G)":`BLOB(${this._length})`:"BLOB"}escape(o){return`BLOB('${o.toString().replace(/'/g,"''")}')`}_stringify(o){if(Buffer.isBuffer(o))return`BLOB('${o.toString().replace(/'/g,"''")}')`;Array.isArray(o)?o=Buffer.from(o):o=Buffer.from(o.toString());const p=o.toString("hex");return this._hexify(p)}_hexify(o){return`x'${o}'`}}class T extends t.STRING{toSql(){return this._binary?this._length<255?`CHAR(${this._length}) FOR BIT DATA`:this._length<=4e3?`VARCHAR(${this._length}) FOR BIT DATA`:`BLOB(${this._length})`:this._length<=4e3?`VARCHAR(${this._length})`:`CLOB(${this._length})`}_stringify(o,p){return this._binary?O.prototype._hexify(o.toString("hex")):p.escape(o)}_bindParam(o,p){return p.bindParam(this._binary?Buffer.from(o):o)}}T.prototype.escape=!1;class E extends t.TEXT{toSql(){let o=0;if(this._length){switch(this._length.toLowerCase()){case"tiny":o=256;break;case"medium":o=8192;break;case"long":o=65536;break}isNaN(this._length)&&(this._length=32672),o>0&&(this._length=o)}else this._length=32672;return this._length>32672?o=`CLOB(${this._length})`:o=`VARCHAR(${this._length})`,n(`Db2 does not support TEXT datatype. ${o} will be used instead.`),o}}class w extends t.BOOLEAN{toSql(){return"BOOLEAN"}_sanitize(o){return o!=null&&(Buffer.isBuffer(o)&&o.length===1&&(o=o[0]),typeof o=="string"?(o=o==="true"?!0:o==="false"?!1:o,o=o===""?!0:o==="\0"?!1:o):typeof o=="number"&&(o=o===1?!0:o===0?!1:o)),o}}w.parse=w.prototype._sanitize;class R extends t.UUID{toSql(){return"CHAR(36) FOR BIT DATA"}}class _ extends t.NOW{toSql(){return"CURRENT TIME"}}class m extends t.DATE{toSql(){return this._length<0&&(this._length=0),this._length>6&&(this._length=6),`TIMESTAMP${this._length?`(${this._length})`:""}`}_stringify(o,p){if(e.isMoment(o)||(o=this._applyTimezone(o,p)),this._length>0){let b=".";for(let u=0;u<this._length&&u<6;u++)b+="S";return o.format(`YYYY-MM-DD HH:mm:ss${b}`)}return o.format("YYYY-MM-DD HH:mm:ss")}static parse(o){return typeof o!="string"&&(o=o.string()),o===null||(o=new Date(S.utc(o))),o}}class g extends t.DATEONLY{static parse(o){return S(o).format("YYYY-MM-DD")}}class N extends t.INTEGER{constructor(o){super(o),f(this)}}class c extends t.TINYINT{constructor(o){super(o),f(this)}}class l extends t.SMALLINT{constructor(o){super(o),f(this)}}class r extends t.BIGINT{constructor(o){super(o),f(this)}}class i extends t.REAL{constructor(o,p){super(o,p),(this._length||this.options.length||this._unsigned||this._zerofill)&&(n("Db2 does not support REAL with options. Plain `REAL` will be used instead."),this._length=void 0,this.options.length=void 0,this._unsigned=void 0,this._zerofill=void 0)}}class s extends t.FLOAT{constructor(o,p){super(o,p),this._decimals&&(n("Db2 does not support Float with decimals. Plain `FLOAT` will be used instead."),this._length=void 0,this.options.length=void 0),this._unsigned&&(n("Db2 does not support Float unsigned. `UNSIGNED` was removed."),this._unsigned=void 0),this._zerofill&&(n("Db2 does not support Float zerofill. `ZEROFILL` was removed."),this._zerofill=void 0)}}class a extends t.ENUM{toSql(){return"VARCHAR(255)"}}class d extends t.DOUBLE{constructor(o,p){super(o,p),(this._length||this.options.length||this._unsigned||this._zerofill)&&(n("db2 does not support DOUBLE with options. Plain DOUBLE will be used instead."),this._length=void 0,this.options.length=void 0,this._unsigned=void 0,this._zerofill=void 0)}toSql(){return"DOUBLE"}}return d.prototype.key=d.key="DOUBLE",{BLOB:O,BOOLEAN:w,ENUM:a,STRING:T,UUID:R,DATE:m,DATEONLY:g,NOW:_,TINYINT:c,SMALLINT:l,INTEGER:N,DOUBLE:d,"DOUBLE PRECISION":d,BIGINT:r,REAL:i,FLOAT:s,TEXT:E}},Rr}var qr,ks;function Ca(){if(ks)return qr;ks=1;const S=ke,e=ze;return qr=t=>{t.ABSTRACT.prototype.dialectTypes="https://dev.snowflake.com/doc/refman/5.7/en/data-types.html",t.DATE.types.snowflake=["DATETIME"],t.STRING.types.snowflake=["VAR_STRING"],t.CHAR.types.snowflake=["STRING"],t.TEXT.types.snowflake=["BLOB"],t.TINYINT.types.snowflake=["TINY"],t.SMALLINT.types.snowflake=["SHORT"],t.MEDIUMINT.types.snowflake=["INT24"],t.INTEGER.types.snowflake=["LONG"],t.BIGINT.types.snowflake=["LONGLONG"],t.FLOAT.types.snowflake=["FLOAT"],t.TIME.types.snowflake=["TIME"],t.DATEONLY.types.snowflake=["DATE"],t.BOOLEAN.types.snowflake=["TINY"],t.BLOB.types.snowflake=["TINYBLOB","BLOB","LONGBLOB"],t.DECIMAL.types.snowflake=["NEWDECIMAL"],t.UUID.types.snowflake=!1,t.ENUM.types.snowflake=!1,t.REAL.types.snowflake=["DOUBLE"],t.DOUBLE.types.snowflake=["DOUBLE"],t.GEOMETRY.types.snowflake=["GEOMETRY"],t.JSON.types.snowflake=["JSON"];class n extends t.DATE{toSql(){return"TIMESTAMP"}_stringify(_,m){return e.isMoment(_)||(_=this._applyTimezone(_,m)),this._length?_.format("YYYY-MM-DD HH:mm:ss.SSS"):_.format("YYYY-MM-DD HH:mm:ss")}static parse(_,m){return _=_.string(),_===null||(S.tz.zone(m.timezone)?_=S.tz(_,m.timezone).toDate():_=new Date(`${_} ${m.timezone}`)),_}}class f extends t.DATEONLY{static parse(_){return _.string()}}class O extends t.UUID{toSql(){return"VARCHAR(36)"}}class T extends t.TEXT{toSql(){return"TEXT"}}class E extends t.BOOLEAN{toSql(){return"BOOLEAN"}}class w extends t.JSON{_stringify(_,m){return m.operation==="where"&&typeof _=="string"?_:JSON.stringify(_)}}return{TEXT:T,DATE:n,BOOLEAN:E,DATEONLY:f,UUID:O,JSON:w}},qr}var Cr,Hs;function La(){if(Hs)return Cr;Hs=1;const S=ze,e=ke;return Cr=t=>{const n=t.ABSTRACT.warn.bind(void 0,"https://www.oracle.com/pls/topic/lookup?ctx=dblatest&id=GUID-D424D23B-0933-425F-BC69-9C0E6724693C");t.DATE.types.oracle=["TIMESTAMP","TIMESTAMP WITH LOCAL TIME ZONE"],t.STRING.types.oracle=["VARCHAR2","NVARCHAR2"],t.CHAR.types.oracle=["CHAR","RAW"],t.TEXT.types.oracle=["CLOB"],t.TINYINT.types.oracle=["NUMBER"],t.SMALLINT.types.oracle=["NUMBER"],t.MEDIUMINT.types.oracle=["NUMBER"],t.INTEGER.types.oracle=["INTEGER"],t.BIGINT.types.oracle=["NUMBER"],t.FLOAT.types.oracle=["BINARY_FLOAT"],t.DATEONLY.types.oracle=["DATE"],t.BOOLEAN.types.oracle=["CHAR(1)"],t.BLOB.types.oracle=["BLOB"],t.DECIMAL.types.oracle=["NUMBER"],t.UUID.types.oracle=["VARCHAR2"],t.ENUM.types.oracle=["VARCHAR2"],t.REAL.types.oracle=["BINARY_DOUBLE"],t.DOUBLE.types.oracle=["BINARY_DOUBLE"],t.JSON.types.oracle=["BLOB"],t.GEOMETRY.types.oracle=!1;class f extends t.STRING{toSql(){return(this.length>4e3||this._binary&&this._length>2e3)&&n("Oracle supports length up to 32764 bytes or characters; Be sure that your administrator has extended the MAX_STRING_SIZE parameter. Check https://docs.oracle.com/pls/topic/lookup?ctx=dblatest&id=GUID-7B72E154-677A-4342-A1EA-C74C1EA928E6"),this._binary?`RAW(${this._length})`:`NVARCHAR2(${this._length})`}_stringify(h,A){return this._binary?A.escape(h.toString("hex")):A.escape(h)}_getBindDef(h){return this._binary?{type:h.DB_TYPE_RAW,maxSize:this._length}:{type:h.DB_TYPE_VARCHAR,maxSize:this._length}}_bindParam(h,A){return A.bindParam(h)}}f.prototype.escape=!1;class O extends t.BOOLEAN{toSql(){return"CHAR(1)"}_getBindDef(h){return{type:h.DB_TYPE_CHAR,maxSize:1}}_stringify(h){return h===!0?"1":h===!1?"0":h}_sanitize(h){return typeof h=="string"?h==="1"||h==="true"?!0:h==="0"||h==="false"?!1:h:super._sanitize(h)}}class T extends t.UUID{toSql(){return"VARCHAR2(36)"}_getBindDef(h){return{type:h.DB_TYPE_VARCHAR,maxSize:36}}}class E extends t.NOW{toSql(){return"SYSDATE"}_stringify(){return"SYSDATE"}}class w extends t.ENUM{toSql(){return"VARCHAR2(512)"}_getBindDef(h){return{type:h.DB_TYPE_VARCHAR,maxSize:512}}}class R extends t.TEXT{toSql(){return"CLOB"}_getBindDef(h){return{type:h.DB_TYPE_CLOB}}}class _ extends t.CHAR{toSql(){return this._binary?(n("Oracle CHAR.BINARY datatype is not of Fixed Length."),`RAW(${this._length})`):super.toSql()}_getBindDef(h){return this._binary?{type:h.DB_TYPE_RAW,maxSize:this._length}:{type:h.DB_TYPE_CHAR,maxSize:this._length}}_bindParam(h,A){return A.bindParam(h)}}class m extends t.DATE{toSql(){return"TIMESTAMP WITH LOCAL TIME ZONE"}_getBindDef(h){return{type:h.DB_TYPE_TIMESTAMP_LTZ}}_stringify(h,A){const I="YYYY-MM-DD HH24:MI:SS.FFTZH:TZM";return h=this._applyTimezone(h,A),`TO_TIMESTAMP_TZ('${h.format("YYYY-MM-DD HH:mm:ss.SSS Z")}','${I}')`}_applyTimezone(h,A){return A.timezone?e.tz.zone(A.timezone)?h=e(h).tz(A.timezone):h=S(h).utcOffset(A.timezone):h=e(h),h}static parse(h,A){return h===null||A&&S.tz.zone(A.timezone)&&(h=S.tz(h.toString(),A.timezone).toDate()),h}_bindParam(h,A){return A.bindParam(h)}}m.prototype.escape=!1;class g extends t.DECIMAL{toSql(){let h="";return this._length&&(h+=`(${this._length}`,typeof this._decimals=="number"&&(h+=`,${this._decimals}`),h+=")"),!this._length&&this._precision&&(h+=`(${this._precision}`,typeof this._scale=="number"&&(h+=`,${this._scale}`),h+=")"),`NUMBER${h}`}_getBindDef(h){return{type:h.DB_TYPE_NUMBER}}}class N extends t.TINYINT{toSql(){return"NUMBER(3)"}_getBindDef(h){return{type:h.DB_TYPE_NUMBER}}}class c extends t.SMALLINT{toSql(){return this._length?`NUMBER(${this._length},0)`:"SMALLINT"}_getBindDef(h){return{type:h.DB_TYPE_NUMBER}}}class l extends t.MEDIUMINT{toSql(){return"NUMBER(8)"}_getBindDef(h){return{type:h.DB_TYPE_NUMBER}}}class r extends t.BIGINT{constructor(h){if(super(h),!(this instanceof r))return new r(h);t.BIGINT.apply(this,arguments),(this._length||this.options.length||this._unsigned||this._zerofill)&&(n("Oracle does not support BIGINT with options"),this._length=void 0,this.options.length=void 0,this._unsigned=void 0,this._zerofill=void 0)}toSql(){return"NUMBER(19)"}_getBindDef(h){return{type:h.DB_TYPE_NUMBER}}_sanitize(h){return typeof h=="bigint"||typeof h=="number"?h.toString():h}}class i extends t.NUMBER{_getBindDef(h){return{type:h.DB_TYPE_NUMBER}}}class s extends t.INTEGER{toSql(){return this._length?`NUMBER(${this._length},0)`:"INTEGER"}_getBindDef(h){return{type:h.DB_TYPE_NUMBER}}}class a extends t.FLOAT{toSql(){return"BINARY_FLOAT"}_getBindDef(h){return{type:h.DB_TYPE_BINARY_FLOAT}}}class d extends t.REAL{toSql(){return"BINARY_DOUBLE"}_stringify(h){return h===Number.POSITIVE_INFINITY?"inf":h===Number.NEGATIVE_INFINITY?"-inf":h}_getBindDef(h){return{type:h.DB_TYPE_BINARY_DOUBLE}}}class y extends t.BLOB{_hexify(h){return`'${h}'`}toSql(){return"BLOB"}_getBindDef(h){return{type:h.DB_TYPE_BLOB}}}class o extends t.JSON{toSql(){return"BLOB"}_getBindDef(h){return{type:h.DB_TYPE_BLOB}}_stringify(h,A){return A.operation==="where"&&typeof h=="string"?h:JSON.stringify(h)}_bindParam(h,A){return A.bindParam(Buffer.from(JSON.stringify(h)))}}class p extends t.DOUBLE{constructor(h,A){if(super(h,A),!(this instanceof p))return new t.DOUBLE(h,A);t.DOUBLE.apply(this,arguments),(this._length||this._unsigned||this._zerofill)&&(n("Oracle does not support DOUBLE with options."),this._length=void 0,this.options.length=void 0,this._unsigned=void 0,this._zerofill=void 0),this.key="DOUBLE PRECISION"}_getBindDef(h){return{type:h.DB_TYPE_BINARY_DOUBLE}}toSql(){return"BINARY_DOUBLE"}}class b extends t.DATEONLY{parse(h){return S(h).format("YYYY-MM-DD")}_sanitize(h){return h&&S(h).format("YYYY-MM-DD")}_stringify(h,A){return h?A.escape(`TO_DATE('${h}','YYYY/MM/DD')`):A.escape(h)}_getBindDef(h){return{type:h.DB_TYPE_DATE}}_bindParam(h,A){return typeof h=="string"?A.bindParam(new Date(h)):A.bindParam(h)}}return b.prototype.escape=!1,{BOOLEAN:O,"DOUBLE PRECISION":p,DOUBLE:p,STRING:f,TINYINT:N,SMALLINT:c,MEDIUMINT:l,BIGINT:r,NUMBER:i,INTEGER:s,FLOAT:a,UUID:T,DATEONLY:b,DATE:m,NOW:E,BLOB:y,ENUM:w,TEXT:R,CHAR:_,JSON:o,REAL:d,DECIMAL:g}},Cr}var Gs;function he(){if(Gs)return Or.exports;Gs=1;const S=Ae,e=re,t=ar,n=ce,f=Ft.validator,O=ke,T=ze,{logger:E}=ge,w={},{classToInvokable:R}=Rs,{joinSQLFragments:_}=qs;class m{toString(M){return this.toSql(M)}toSql(){return this.key}stringify(M,K){return this._stringify?this._stringify(M,K):M}bindParam(M,K){return this._bindParam?this._bindParam(M,K):K.bindParam(this.stringify(M,K))}static toString(){return this.name}static warn(M,K){w[K]||(w[K]=!0,E.warn(`${K} 
>> Check: ${M}`))}static extend(M){return new this(M.options)}}m.prototype.dialectTypes="";class g extends m{constructor(M,K){super();const be=typeof M=="object"&&M||{length:M,binary:K};this.options=be,this._binary=be.binary,this._length=be.length||255}toSql(){return _([`VARCHAR(${this._length})`,this._binary&&"BINARY"])}validate(M){if(Object.prototype.toString.call(M)!=="[object String]"){if(this.options.binary&&Buffer.isBuffer(M)||typeof M=="number")return!0;throw new n.ValidationError(S.format("%j is not a valid string",M))}return!0}get BINARY(){return this._binary=!0,this.options.binary=!0,this}static get BINARY(){return new this().BINARY}}class N extends g{constructor(M,K){super(typeof M=="object"&&M||{length:M,binary:K})}toSql(){return _([`CHAR(${this._length})`,this._binary&&"BINARY"])}}class c extends m{constructor(M){super();const K=typeof M=="object"&&M||{length:M};this.options=K,this._length=K.length||""}toSql(){switch(this._length.toLowerCase()){case"tiny":return"TINYTEXT";case"medium":return"MEDIUMTEXT";case"long":return"LONGTEXT";default:return this.key}}validate(M){if(typeof M!="string")throw new n.ValidationError(S.format("%j is not a valid string",M));return!0}}class l extends m{toSql(){return"CITEXT"}validate(M){if(typeof M!="string")throw new n.ValidationError(S.format("%j is not a valid string",M));return!0}}class r extends m{constructor(M={}){super(),typeof M=="number"&&(M={length:M}),this.options=M,this._length=M.length,this._zerofill=M.zerofill,this._decimals=M.decimals,this._precision=M.precision,this._scale=M.scale,this._unsigned=M.unsigned}toSql(){let M=this.key;return this._length&&(M+=`(${this._length}`,typeof this._decimals=="number"&&(M+=`,${this._decimals}`),M+=")"),this._unsigned&&(M+=" UNSIGNED"),this._zerofill&&(M+=" ZEROFILL"),M}validate(M){if(!f.isFloat(String(M)))throw new n.ValidationError(S.format(`%j is not a valid ${this.key.toLowerCase()}`,M));return!0}_stringify(M){return typeof M=="number"||typeof M=="bigint"||typeof M=="boolean"||M===null||M===void 0?M:typeof M.toString=="function"?M.toString():M}get UNSIGNED(){return this._unsigned=!0,this.options.unsigned=!0,this}get ZEROFILL(){return this._zerofill=!0,this.options.zerofill=!0,this}static get UNSIGNED(){return new this().UNSIGNED}static get ZEROFILL(){return new this().ZEROFILL}}class i extends r{validate(M){if(!f.isInt(String(M)))throw new n.ValidationError(S.format(`%j is not a valid ${this.key.toLowerCase()}`,M));return!0}}class s extends i{}class a extends i{}class d extends i{}class y extends i{}class o extends r{constructor(M,K){super(typeof M=="object"&&M||{length:M,decimals:K})}validate(M){if(!f.isFloat(String(M)))throw new n.ValidationError(S.format("%j is not a valid float",M));return!0}}class p extends r{constructor(M,K){super(typeof M=="object"&&M||{length:M,decimals:K})}}class b extends r{constructor(M,K){super(typeof M=="object"&&M||{length:M,decimals:K})}}class u extends r{constructor(M,K){super(typeof M=="object"&&M||{precision:M,scale:K})}toSql(){return this._precision||this._scale?`DECIMAL(${[this._precision,this._scale].filter(e.identity).join(",")})`:"DECIMAL"}validate(M){if(!f.isDecimal(String(M)))throw new n.ValidationError(S.format("%j is not a valid decimal",M));return!0}}const h={escape:!1,_value(J){return isNaN(J)?"NaN":isFinite(J)?J:`${J<0?"-":""}Infinity`},_stringify(J){return`'${this._value(J)}'`},_bindParam(J,M){return M.bindParam(this._value(J))}};for(const J of[o,b,p])Object.assign(J.prototype,h);class A extends m{toSql(){return"TINYINT(1)"}validate(M){if(!f.isBoolean(String(M)))throw new n.ValidationError(S.format("%j is not a valid boolean",M));return!0}_sanitize(M){if(M!=null){Buffer.isBuffer(M)&&M.length===1&&(M=M[0]);const K=typeof M;if(K==="string")return M==="true"?!0:M==="false"?!1:M;if(K==="number")return M===1?!0:M===0?!1:M}return M}}A.parse=A.prototype._sanitize;class I extends m{toSql(){return"TIME"}}class q extends m{constructor(M){super();const K=typeof M=="object"&&M||{length:M};this.options=K,this._length=K.length||""}toSql(){return"DATETIME"}validate(M){if(!f.isDate(String(M)))throw new n.ValidationError(S.format("%j is not a valid date",M));return!0}_sanitize(M,K){return(!K||K&&!K.raw)&&!(M instanceof Date)&&M?new Date(M):M}_isChanged(M,K){return!(K&&M&&(M===K||M instanceof Date&&K instanceof Date&&M.getTime()===K.getTime())||!K&&!M&&K===M)}_applyTimezone(M,K){return K.timezone?O.tz.zone(K.timezone)?O(M).tz(K.timezone):M=T(M).utcOffset(K.timezone):O(M)}_stringify(M,K){return T.isMoment(M)||(M=this._applyTimezone(M,K)),M.format("YYYY-MM-DD HH:mm:ss.SSS Z")}}class L extends m{toSql(){return"DATE"}_stringify(M){return T(M).format("YYYY-MM-DD")}_sanitize(M,K){return(!K||K&&!K.raw)&&M?T(M).format("YYYY-MM-DD"):M}_isChanged(M,K){return!(K&&M&&K===M||!K&&!M&&K===M)}}class D extends m{validate(M){if(!e.isPlainObject(M))throw new n.ValidationError(S.format("%j is not a valid hstore",M));return!0}}class C extends m{validate(){return!0}_stringify(M){return JSON.stringify(M)}}class $ extends C{}class P extends m{}class Q extends m{constructor(M){super();const K=typeof M=="object"&&M||{length:M};this.options=K,this._length=K.length||""}toSql(){switch(this._length.toLowerCase()){case"tiny":return"TINYBLOB";case"medium":return"MEDIUMBLOB";case"long":return"LONGBLOB";default:return this.key}}validate(M){if(typeof M!="string"&&!Buffer.isBuffer(M))throw new n.ValidationError(S.format("%j is not a valid blob",M));return!0}_stringify(M){Buffer.isBuffer(M)||(Array.isArray(M)?M=Buffer.from(M):M=Buffer.from(M.toString()));const K=M.toString("hex");return this._hexify(K)}_hexify(M){return`X'${M}'`}_bindParam(M,K){return Buffer.isBuffer(M)||(Array.isArray(M)?M=Buffer.from(M):M=Buffer.from(M.toString())),K.bindParam(M)}}Q.prototype.escape=!1;class j extends m{constructor(M){super();const K=e.isPlainObject(M)?M:{subtype:M};K.subtype||(K.subtype=new i),typeof K.subtype=="function"&&(K.subtype=new K.subtype),this._subtype=K.subtype.key,this.options=K}validate(M){if(!Array.isArray(M))throw new n.ValidationError(S.format("%j is not a valid range",M));if(M.length!==2)throw new n.ValidationError("A range must be an array with two elements");return!0}}class B extends m{validate(M,K){if(typeof M!="string"||!f.isUUID(M)&&(!K||!K.acceptStrings))throw new n.ValidationError(S.format("%j is not a valid uuid",M));return!0}}class F extends m{validate(M,K){if(typeof M!="string"||!f.isUUID(M)&&(!K||!K.acceptStrings))throw new n.ValidationError(S.format("%j is not a valid uuid",M));return!0}}class x extends m{validate(M,K){if(typeof M!="string"||!f.isUUID(M,4)&&(!K||!K.acceptStrings))throw new n.ValidationError(S.format("%j is not a valid uuidv4",M));return!0}}class k extends m{constructor(M,K){super(),typeof M=="function"&&(M=new M),this.returnType=M,this.fields=K}}class X extends m{constructor(...M){super();const K=M[0],be=typeof K=="object"&&!Array.isArray(K)&&K||{values:M.reduce((xe,qe)=>xe.concat(Array.isArray(qe)?qe:[qe]),[])};this.values=be.values,this.options=be}validate(M){if(!this.values.includes(M))throw new n.ValidationError(S.format("%j is not a valid choice in %j",M,this.values));return!0}}class H extends m{constructor(M){super();const K=e.isPlainObject(M)?M:{type:M};this.options=K,this.type=typeof K.type=="function"?new K.type:K.type}toSql(){return`${this.type.toSql()}[]`}validate(M){if(!Array.isArray(M))throw new n.ValidationError(S.format("%j is not a valid array",M));return!0}static is(M,K){return M instanceof H&&M.type instanceof K}}class W extends m{constructor(M,K){super();const be=e.isPlainObject(M)?M:{type:M,srid:K};this.options=be,this.type=be.type,this.srid=be.srid}_stringify(M,K){return`ST_GeomFromText(${K.escape(t.Geometry.parseGeoJSON(M).toWkt())})`}_bindParam(M,K){return`ST_GeomFromText(${K.bindParam(t.Geometry.parseGeoJSON(M).toWkt())})`}}W.prototype.escape=!1;class se extends m{constructor(M,K){super();const be=e.isPlainObject(M)?M:{type:M,srid:K};this.options=be,this.type=be.type,this.srid=be.srid}_stringify(M,K){return`ST_GeomFromText(${K.escape(t.Geometry.parseGeoJSON(M).toWkt())})`}_bindParam(M,K){return`ST_GeomFromText(${K.bindParam(t.Geometry.parseGeoJSON(M).toWkt())})`}}se.prototype.escape=!1;class le extends m{validate(M){if(typeof M!="string"||!f.isIPRange(M))throw new n.ValidationError(S.format("%j is not a valid CIDR",M));return!0}}class pe extends m{validate(M){if(typeof M!="string"||!f.isIP(M))throw new n.ValidationError(S.format("%j is not a valid INET",M));return!0}}class Oe extends m{validate(M){if(typeof M!="string"||!f.isMACAddress(M))throw new n.ValidationError(S.format("%j is not a valid MACADDR",M));return!0}}class ie extends m{validate(M){if(typeof M!="string")throw new n.ValidationError(S.format("%j is not a valid string",M));return!0}}const ne=Or.exports={ABSTRACT:m,STRING:g,CHAR:N,TEXT:c,NUMBER:r,TINYINT:s,SMALLINT:a,MEDIUMINT:d,INTEGER:i,BIGINT:y,FLOAT:o,TIME:I,DATE:q,DATEONLY:L,BOOLEAN:A,NOW:P,BLOB:Q,DECIMAL:u,NUMERIC:u,UUID:B,UUIDV1:F,UUIDV4:x,HSTORE:D,JSON:C,JSONB:$,VIRTUAL:k,ARRAY:H,ENUM:X,RANGE:j,REAL:p,"DOUBLE PRECISION":b,DOUBLE:b,GEOMETRY:W,GEOGRAPHY:se,CIDR:le,INET:pe,MACADDR:Oe,CITEXT:l,TSVECTOR:ie};e.each(ne,(J,M)=>{Object.prototype.hasOwnProperty.call(J,"key")||(J.types={},J.key=J.prototype.key=M)});const oe={};oe.postgres=Na()(ne),oe.mysql=wa()(ne),oe.mariadb=Ia()(ne),oe.sqlite=Sa()(ne),oe.mssql=Ra()(ne),oe.db2=qa()(ne),oe.snowflake=Ca()(ne),oe.oracle=La()(ne);const _e=Object.values(oe);for(const J of _e)e.each(J,(M,K)=>{M.key||(M.key=M.prototype.key=K)});for(const J of[ne,..._e])e.each(J,(M,K)=>{J[K]=R(M)});return Object.assign(ne,oe),Or.exports}var ct={},Vs;function ur(){if(Vs)return ct;Vs=1;const S=he(),{logger:e}=ge;function t(T,E,w,R){return T.reduce((_,m,g)=>(g!==0&&(_+=", "),Array.isArray(m)?_+=`(${t(m,E,w,R)})`:_+=n(m,E,w,R),_),"")}ct.arrayToList=t;function n(T,E,w,R){let _=!1;if(T==null)return"NULL";switch(typeof T){case"boolean":return["sqlite","mssql","oracle"].includes(w)?+!!T:(!!T).toString();case"number":case"bigint":return T.toString();case"string":_=w==="mssql";break}if(T instanceof Date&&(T=S[w].DATE.prototype.stringify(T,{timezone:E})),Buffer.isBuffer(T))return S[w].BLOB?S[w].BLOB.prototype.stringify(T):S.BLOB.prototype.stringify(T);if(Array.isArray(T)){const m=g=>n(g,E,w,R);return w==="postgres"&&!R?S.ARRAY.prototype.stringify(T,{escape:m}):t(T,E,w,R)}if(!T.replace)throw new Error(`Invalid value ${e.inspect(T)}`);if(["postgres","sqlite","mssql","snowflake","db2"].includes(w))T=T.replace(/'/g,"''"),w==="postgres"&&(T=T.replace(/\0/g,"\\0"));else if(w==="oracle"&&typeof T=="string"){if(T.startsWith("TO_TIMESTAMP")||T.startsWith("TO_DATE"))return T;T=T.replace(/'/g,"''")}else T=T.replace(/[\0\n\r\b\t\\'"\x1a]/g,m=>{switch(m){case"\0":return"\\0";case`
`:return"\\n";case"\r":return"\\r";case"\b":return"\\b";case"	":return"\\t";case"":return"\\Z";default:return`\\${m}`}});return`${(_?"N'":"'")+T}'`}ct.escape=n;function f(T,E,w,R){if(E=[].concat(E),typeof T!="string")throw new Error(`Invalid SQL string provided: ${T}`);return T.replace(/\?/g,_=>E.length?n(E.shift(),w,R,!0):_)}ct.format=f;function O(T,E,w,R){return T.replace(/:+(?!\d)(\w+)/g,(_,m)=>{if(R==="postgres"&&_.slice(0,2)==="::")return _;if(E[m]!==void 0)return n(E[m],w,R,!0);throw new Error(`Named parameter "${_}" has no value in the given object.`)})}return ct.formatNamedParameters=O,ct}var As={exports:{}};(function(S,e){var t=Object.defineProperty,n=E=>t(E,"__esModule",{value:!0}),f=(E,w)=>{n(E);for(var R in w)t(E,R,{get:w[R],enumerable:!0})};f(e,{Op:()=>O,default:()=>T});const O={eq:Symbol.for("eq"),ne:Symbol.for("ne"),gte:Symbol.for("gte"),gt:Symbol.for("gt"),lte:Symbol.for("lte"),lt:Symbol.for("lt"),not:Symbol.for("not"),is:Symbol.for("is"),in:Symbol.for("in"),notIn:Symbol.for("notIn"),like:Symbol.for("like"),notLike:Symbol.for("notLike"),iLike:Symbol.for("iLike"),notILike:Symbol.for("notILike"),startsWith:Symbol.for("startsWith"),endsWith:Symbol.for("endsWith"),substring:Symbol.for("substring"),regexp:Symbol.for("regexp"),notRegexp:Symbol.for("notRegexp"),iRegexp:Symbol.for("iRegexp"),notIRegexp:Symbol.for("notIRegexp"),between:Symbol.for("between"),notBetween:Symbol.for("notBetween"),overlap:Symbol.for("overlap"),contains:Symbol.for("contains"),contained:Symbol.for("contained"),adjacent:Symbol.for("adjacent"),strictLeft:Symbol.for("strictLeft"),strictRight:Symbol.for("strictRight"),noExtendRight:Symbol.for("noExtendRight"),noExtendLeft:Symbol.for("noExtendLeft"),and:Symbol.for("and"),or:Symbol.for("or"),any:Symbol.for("any"),all:Symbol.for("all"),values:Symbol.for("values"),col:Symbol.for("col"),placeholder:Symbol.for("placeholder"),join:Symbol.for("join"),match:Symbol.for("match")};var T=O;S.exports=O})(As,As.exports);var Re=As.exports,Ys;function fe(){if(Ys)return ee;Ys=1;var S=Object.defineProperty,e=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,f=(v,G,U)=>G in v?S(v,G,{enumerable:!0,configurable:!0,writable:!0,value:U}):v[G]=U,O=(v,G)=>{for(var U in G||(G={}))t.call(G,U)&&f(v,U,G[U]);if(e)for(var U of e(G))n.call(G,U)&&f(v,U,G[U]);return v};const T=he(),E=ur(),w=re,R=ma,_=Qt.v1,m=Qt.v4,g=Re,N=new Set(Object.values(g));let c=_a;ee.classToInvokable=Rs.classToInvokable,ee.joinSQLFragments=qs.joinSQLFragments;function l(v){c=v}ee.useInflection=l;function r(v,G){let U=v;return G&&(U=o(v)),U}ee.camelizeIf=r;function i(v,G){let U=v;return G&&(U=p(v)),U}ee.underscoredIf=i;function s(v){const G=typeof v;return["string","number","boolean"].includes(G)}ee.isPrimitive=s;function a(v,G){return w.mergeWith(v,G,(U,Z)=>{if(!w.isPlainObject(U)&&U!==void 0)return w.isFunction(U)&&R(U)&&Z||U})}ee.mergeDefaults=a;function d(){const v={};for(const G of arguments)w.forOwn(G,(U,Z)=>{U!==void 0&&(v[Z]?w.isPlainObject(U)&&w.isPlainObject(v[Z])?v[Z]=d(v[Z],U):Array.isArray(U)&&Array.isArray(v[Z])?v[Z]=U.concat(v[Z]):v[Z]=U:v[Z]=U)});return v}ee.merge=d;function y(v,G,U,Z){return v.slice(0,G)+Z+v.slice(G+U)}ee.spliceStr=y;function o(v){return v.trim().replace(/[-_\s]+(.)?/g,(G,U)=>U.toUpperCase())}ee.camelize=o;function p(v){return c.underscore(v)}ee.underscore=p;function b(v){return c.singularize(v)}ee.singularize=b;function u(v){return c.pluralize(v)}ee.pluralize=u;function h(v,G){return E.format(v[0],v.slice(1),null,G)}ee.format=h;function A(v,G,U){return E.formatNamedParameters(v,G,null,U)}ee.formatNamedParameters=A;function I(v,G){return v=v||{},w.cloneDeepWith(v,U=>{if(!(Array.isArray(U)||w.isPlainObject(U))){if(G||typeof U=="object")return U;if(U&&typeof U.clone=="function")return U.clone()}})}ee.cloneDeep=I;function q(v,G){return v.attributes&&Array.isArray(v.attributes)&&(v.attributes=G._injectDependentVirtualAttributes(v.attributes),v.attributes=v.attributes.filter(U=>!G._virtualAttributes.has(U))),L(v,G),v}ee.mapFinderOptions=q;function L(v,G){return Array.isArray(v.attributes)&&(v.attributes=v.attributes.map(U=>typeof U!="string"?U:G.rawAttributes[U]&&U!==G.rawAttributes[U].field?[G.rawAttributes[U].field,U]:U)),v.where&&w.isPlainObject(v.where)&&(v.where=D(v.where,G)),v}ee.mapOptionFieldNames=L;function D(v,G){return v&&(v=I(v),M(v).forEach(U=>{const Z=G.rawAttributes[U];Z&&Z.field!==Z.fieldName&&(v[Z.field]=v[U],delete v[U]),w.isPlainObject(v[U])&&!(Z&&(Z.type instanceof T.HSTORE||Z.type instanceof T.JSON))&&(v[U]=L({where:v[U]},G).where),Array.isArray(v[U])&&v[U].forEach((Ee,$e)=>{w.isPlainObject(Ee)&&(v[U][$e]=D(Ee,G))})})),v}ee.mapWhereFieldNames=D;function C(v,G,U){const Z={};for(const Ee of G)v[Ee]!==void 0&&!U._virtualAttributes.has(Ee)&&(U.rawAttributes[Ee]&&U.rawAttributes[Ee].field&&U.rawAttributes[Ee].field!==Ee?Z[U.rawAttributes[Ee].field]=v[Ee]:Z[Ee]=v[Ee]);return Z}ee.mapValueFieldNames=C;function $(v){return typeof v=="string"&&v[0]==="$"&&v[v.length-1]==="$"}ee.isColString=$;function P(v){return v.some(G=>w.isPlainObject(G)||G instanceof _e)}ee.canTreatArrayAsAnd=P;function Q(v,G){return v.toLowerCase()<G.toLowerCase()?v+G:G+v}ee.combineTableNames=Q;function j(v,G){if(typeof v=="function"){const U=v();return U instanceof T.ABSTRACT?U.toSql():U}return v instanceof T.UUIDV1?_():v instanceof T.UUIDV4?m():v instanceof T.NOW?k(G):Array.isArray(v)?v.slice():w.isPlainObject(v)?O({},v):v}ee.toDefaultValue=j;function B(v){return v===void 0||v instanceof T.NOW||v instanceof T.UUIDV1||v instanceof T.UUIDV4?!1:typeof v!="function"}ee.defaultValueSchemable=B;function F(v,G,U){let Z=v;if(U=U||{},U.allowNull=U.allowNull||[],G){const Ee={};w.forIn(v,($e,lt)=>{(U.allowNull.includes(lt)||lt.endsWith("Id")||$e!=null)&&(Ee[lt]=$e)}),Z=Ee}return Z}ee.removeNullValuesFromHash=F;const x=new Set(["mariadb","mysql","postgres","sqlite","mssql","db2","oracle"]);function k(v){const G=new Date;return x.has(v)||G.setMilliseconds(0),G}ee.now=k;const X="`";ee.TICK_CHAR=X;function H(v,G){return G=G||X,G+W(v,G)+G}ee.addTicks=H;function W(v,G){return G=G||X,v.replace(new RegExp(G,"g"),"")}ee.removeTicks=W;function se(v){if(!w.isPlainObject(v))return v;const G={};function U(Z,Ee){return Object.keys(Z).forEach($e=>{const lt=Ee?`${Ee}.${$e}`:$e;typeof Z[$e]=="object"&&Z[$e]!==null?U(Z[$e],lt):G[lt]=w.get(Z,$e)}),G}return U(v,void 0)}ee.flattenObjectDeep=se;class le{}ee.SequelizeMethod=le;class pe extends le{constructor(G,U){super(),this.fn=G,this.args=U}clone(){return new pe(this.fn,this.args)}}ee.Fn=pe;class Oe extends le{constructor(G,...U){super(),U.length>0&&(G=U),this.col=G}}ee.Col=Oe;class ie extends le{constructor(G,U,Z){super(),this.val=G,this.type=(U||"").trim(),this.json=Z||!1}}ee.Cast=ie;class ne extends le{constructor(G){super(),this.val=G}}ee.Literal=ne;class oe extends le{constructor(G,U){super(),w.isObject(G)?this.conditions=G:(this.path=G,U&&(this.value=U))}}ee.Json=oe;class _e extends le{constructor(G,U,Z){super(),Z===void 0&&(Z=U,U="="),this.attribute=G,this.comparator=U,this.logic=Z}}ee.Where=_e;function J(v){return Object.getOwnPropertySymbols(v).filter(G=>N.has(G))}ee.getOperators=J;function M(v){return J(v).concat(Object.keys(v))}ee.getComplexKeys=M;function K(v){return Array.isArray(v)?v.length:M(v).length}ee.getComplexSize=K;function be(v){return!!v&&w.isEmpty(v)&&J(v).length===0}ee.isWhereEmpty=be;function xe(v,G){return`enum_${v}_${G}`}ee.generateEnumName=xe;function qe(v){const G=new Object;return Object.keys(v).forEach(U=>{G[o(U)]=v[U]}),G}ee.camelizeObjectKeys=qe;function ve(v,...G){return v=Object(v),G.forEach(U=>{U&&(U=Object(U),M(U).forEach(Z=>{const Ee=v[Z];(Ee===void 0||w.eq(Ee,Object.prototype[Z])&&!Object.prototype.hasOwnProperty.call(v,Z))&&(v[Z]=U[Z])}))}),v}ee.defaults=ve;function Te(v,G){if(G.tableName&&(G=G.tableName),!Object.prototype.hasOwnProperty.call(v,"name")){const U=v.fields.map(Z=>typeof Z=="string"?Z:Z.name||Z.attribute);v.name=p(`${G}_${U.join("_")}`)}return v}ee.nameIndex=Te;function ue(v,G){return v.some(U=>G.includes(U))}ee.intersects=ue;function me(v){return JSON.stringify(v,(G,U)=>typeof U=="bigint"?String(U):U)}return ee.safeStringifyJson=me,ee}var lr={exports:{}},it={};function Da(S){if(Object.prototype.hasOwnProperty.call(S.source.rawAttributes,S.as))throw new Error(`Naming collision between attribute '${S.as}' and association '${S.as}' on model ${S.source.name}. To remedy this, change either foreignKey or as in your association definition`)}it.checkNamingCollision=Da;function Ma(S,e,t,n,f){if(n.foreignKeyConstraint||n.onDelete||n.onUpdate){const O=Object.keys(e.primaryKeys).map(T=>e.rawAttributes[T].field||T);(O.length===1||!O.includes(f))&&(S.references={model:e.getTableName(),key:f||O[0]},S.onDelete=n.onDelete,S.onUpdate=n.onUpdate)}}it.addForeignKeyConstraints=Ma;function $a(S,e,t,n){n=n||{};for(const f of t)if(!Object.prototype.hasOwnProperty.call(e,S.accessors[f])){const O=n[f]||f;e[S.accessors[f]]=function(){return S[O](this,...Array.from(arguments))}}}it.mixinMethods=$a;const{AssociationError:Pa}=ce;let va=class{constructor(e,t,n={}){if(this.source=e,this.target=t,this.options=n,this.scope=n.scope,this.isSelfAssociation=this.source===this.target,this.as=n.as,this.associationType="",e.hasAlias(n.as))throw new Pa(`You have used the alias ${n.as} in two separate associations. Aliased associations must have unique aliases.`)}toInstanceArray(e){return Array.isArray(e)||(e=[e]),e.map(t=>{if(t instanceof this.target)return t;const n={};return n[this.target.primaryKeyAttribute]=t,this.target.build(n,{isNewRecord:!1})})}[Symbol.for("nodejs.util.inspect.custom")](){return this.as}};var nt=va,ja=Object.defineProperty,Ws=Object.getOwnPropertySymbols,xa=Object.prototype.hasOwnProperty,Qa=Object.prototype.propertyIsEnumerable,Js=(S,e,t)=>e in S?ja(S,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):S[e]=t,Xs=(S,e)=>{for(var t in e||(e={}))xa.call(e,t)&&Js(S,t,e[t]);if(Ws)for(var t of Ws(e))Qa.call(e,t)&&Js(S,t,e[t]);return S};const Lr=fe(),Dr=it,Zs=re,Fa=nt,ei=Re;let Cs=class extends Fa{constructor(e,t,n){if(super(e,t,n),this.associationType="BelongsTo",this.isSingleAssociation=!0,this.foreignKeyAttribute={},this.as?(this.isAliased=!0,this.options.name={singular:this.as}):(this.as=this.target.options.name.singular,this.options.name=this.target.options.name),Zs.isObject(this.options.foreignKey)?(this.foreignKeyAttribute=this.options.foreignKey,this.foreignKey=this.foreignKeyAttribute.name||this.foreignKeyAttribute.fieldName):this.options.foreignKey&&(this.foreignKey=this.options.foreignKey),this.foreignKey||(this.foreignKey=Lr.camelize([this.as,this.target.primaryKeyAttribute].join("_"))),this.identifier=this.foreignKey,this.source.rawAttributes[this.identifier]&&(this.identifierField=this.source.rawAttributes[this.identifier].field||this.identifier),this.options.targetKey&&!this.target.rawAttributes[this.options.targetKey])throw new Error(`Unknown attribute "${this.options.targetKey}" passed as targetKey, define this attribute on model "${this.target.name}" first`);this.targetKey=this.options.targetKey||this.target.primaryKeyAttribute,this.targetKeyField=this.target.rawAttributes[this.targetKey].field||this.targetKey,this.targetKeyIsPrimary=this.targetKey===this.target.primaryKeyAttribute,this.targetIdentifier=this.targetKey,this.associationAccessor=this.as,this.options.useHooks=n.useHooks;const f=Zs.upperFirst(this.options.name.singular);this.accessors={get:`get${f}`,set:`set${f}`,create:`create${f}`}}_injectAttributes(){const e={[this.foreignKey]:Xs({type:this.options.keyType||this.target.rawAttributes[this.targetKey].type,allowNull:!0},this.foreignKeyAttribute)};if(this.options.constraints!==!1){const t=this.source.rawAttributes[this.foreignKey]||e[this.foreignKey];this.options.onDelete=this.options.onDelete||(t.allowNull?"SET NULL":"NO ACTION"),this.options.onUpdate=this.options.onUpdate||"CASCADE"}return Dr.addForeignKeyConstraints(e[this.foreignKey],this.target,this.source,this.options,this.targetKeyField),Lr.mergeDefaults(this.source.rawAttributes,e),this.source.refreshAttributes(),this.identifierField=this.source.rawAttributes[this.foreignKey].field||this.foreignKey,Dr.checkNamingCollision(this),this}mixin(e){const t=["get","set","create"];Dr.mixinMethods(this,e,t)}async get(e,t){const n={};let f=this.target,O;if(t=Lr.cloneDeep(t),Object.prototype.hasOwnProperty.call(t,"scope")&&(t.scope?f=f.scope(t.scope):f=f.unscoped()),Object.prototype.hasOwnProperty.call(t,"schema")&&(f=f.schema(t.schema,t.schemaDelimiter)),Array.isArray(e)||(O=e,e=void 0),e)n[this.targetKey]={[ei.in]:e.map(T=>T.get(this.foreignKey))};else{if(this.targetKeyIsPrimary&&!t.where)return f.findByPk(O.get(this.foreignKey),t);n[this.targetKey]=O.get(this.foreignKey),t.limit=null}if(t.where=t.where?{[ei.and]:[n,t.where]}:n,e){const T=await f.findAll(t),E={};for(const w of e)E[w.get(this.foreignKey,{raw:!0})]=null;for(const w of T)E[w.get(this.targetKey,{raw:!0})]=w;return E}return f.findOne(t)}async set(e,t,n={}){let f=t;if(t instanceof this.target&&(f=t[this.targetKey]),e.set(this.foreignKey,f),n.save!==!1)return n=Xs({fields:[this.foreignKey],allowNull:[this.foreignKey],association:!0},n),await e.save(n)}async create(e,t,n){t=t||{},n=n||{};const f=await this.target.create(t,n);return await e[this.accessors.set](f,n),f}verifyAssociationAlias(e){return typeof e=="string"?this.as===e:e&&e.singular?this.as===e.singular:!this.isAliased}};lr.exports=Cs;lr.exports.BelongsTo=Cs;lr.exports.default=Cs;var at=lr.exports,cr={exports:{}},hr={exports:{}},Ua=Object.defineProperty,Ka=Object.defineProperties,Ba=Object.getOwnPropertyDescriptors,ti=Object.getOwnPropertySymbols,za=Object.prototype.hasOwnProperty,ka=Object.prototype.propertyIsEnumerable,ri=(S,e,t)=>e in S?Ua(S,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):S[e]=t,Qe=(S,e)=>{for(var t in e||(e={}))za.call(e,t)&&ri(S,t,e[t]);if(ti)for(var t of ti(e))ka.call(e,t)&&ri(S,t,e[t]);return S},ht=(S,e)=>Ka(S,Ba(e));const Gt=fe(),Mr=it,Vt=re,Ha=nt,Yt=Re;let Ls=class extends Ha{constructor(e,t,n){if(super(e,t,n),this.associationType="HasMany",this.targetAssociation=null,this.sequelize=e.sequelize,this.isMultiAssociation=!0,this.foreignKeyAttribute={},this.options.through)throw new Error("N:M associations are not supported with hasMany. Use belongsToMany instead");this.isSelfAssociation&&(this.targetAssociation=this),this.as?(this.isAliased=!0,Vt.isPlainObject(this.as)?(this.options.name=this.as,this.as=this.as.plural):this.options.name={plural:this.as,singular:Gt.singularize(this.as)}):(this.as=this.target.options.name.plural,this.options.name=this.target.options.name),Vt.isObject(this.options.foreignKey)?(this.foreignKeyAttribute=this.options.foreignKey,this.foreignKey=this.foreignKeyAttribute.name||this.foreignKeyAttribute.fieldName):this.options.foreignKey&&(this.foreignKey=this.options.foreignKey),this.foreignKey||(this.foreignKey=Gt.camelize([this.source.options.name.singular,this.source.primaryKeyAttribute].join("_"))),this.target.rawAttributes[this.foreignKey]&&(this.identifierField=this.target.rawAttributes[this.foreignKey].field||this.foreignKey,this.foreignKeyField=this.target.rawAttributes[this.foreignKey].field||this.foreignKey),this.sourceKey=this.options.sourceKey||this.source.primaryKeyAttribute,this.source.rawAttributes[this.sourceKey]?(this.sourceKeyAttribute=this.sourceKey,this.sourceKeyField=this.source.rawAttributes[this.sourceKey].field||this.sourceKey):(this.sourceKeyAttribute=this.source.primaryKeyAttribute,this.sourceKeyField=this.source.primaryKeyField);const f=Vt.upperFirst(this.options.name.plural),O=Vt.upperFirst(this.options.name.singular);this.associationAccessor=this.as,this.accessors={get:`get${f}`,set:`set${f}`,addMultiple:`add${f}`,add:`add${O}`,create:`create${O}`,remove:`remove${O}`,removeMultiple:`remove${f}`,hasSingle:`has${O}`,hasAll:`has${f}`,count:`count${f}`}}_injectAttributes(){const e={[this.foreignKey]:Qe({type:this.options.keyType||this.source.rawAttributes[this.sourceKeyAttribute].type,allowNull:!0},this.foreignKeyAttribute)},t=Qe({},this.options);if(this.options.constraints!==!1){const n=this.target.rawAttributes[this.foreignKey]||e[this.foreignKey];t.onDelete=t.onDelete||(n.allowNull?"SET NULL":"CASCADE"),t.onUpdate=t.onUpdate||"CASCADE"}return Mr.addForeignKeyConstraints(e[this.foreignKey],this.source,this.target,t,this.sourceKeyField),Gt.mergeDefaults(this.target.rawAttributes,e),this.target.refreshAttributes(),this.source.refreshAttributes(),this.identifierField=this.target.rawAttributes[this.foreignKey].field||this.foreignKey,this.foreignKeyField=this.target.rawAttributes[this.foreignKey].field||this.foreignKey,this.sourceKeyField=this.source.rawAttributes[this.sourceKey].field||this.sourceKey,Mr.checkNamingCollision(this),this}mixin(e){const t=["get","count","hasSingle","hasAll","set","add","addMultiple","remove","removeMultiple","create"],n={hasSingle:"has",hasAll:"has",addMultiple:"add",removeMultiple:"remove"};Mr.mixinMethods(this,e,t,n)}async get(e,t={}){const n={};let f=this.target,O,T;Array.isArray(e)||(O=e,e=void 0),t=Qe({},t),this.scope&&Object.assign(n,this.scope),e?(T=e.map(R=>R.get(this.sourceKey,{raw:!0})),t.limit&&e.length>1?(t.groupedLimit={limit:t.limit,on:this,values:T},delete t.limit):(n[this.foreignKey]={[Yt.in]:T},delete t.groupedLimit)):n[this.foreignKey]=O.get(this.sourceKey,{raw:!0}),t.where=t.where?{[Yt.and]:[n,t.where]}:n,Object.prototype.hasOwnProperty.call(t,"scope")&&(t.scope?f=f.scope(t.scope):f=f.unscoped()),Object.prototype.hasOwnProperty.call(t,"schema")&&(f=f.schema(t.schema,t.schemaDelimiter));const E=await f.findAll(t);if(O)return E;const w={};for(const R of e)w[R.get(this.sourceKey,{raw:!0})]=[];for(const R of E)w[R.get(this.foreignKey,{raw:!0})].push(R);return w}async count(e,t){t=Gt.cloneDeep(t),t.attributes=[[this.sequelize.fn("COUNT",this.sequelize.col(`${this.target.name}.${this.target.primaryKeyField}`)),"count"]],t.raw=!0,t.plain=!0;const n=await this.get(e,t);return parseInt(n.count,10)}async has(e,t,n){const f={};return Array.isArray(t)||(t=[t]),n=ht(Qe({},n),{scope:!1,attributes:[this.target.primaryKeyAttribute],raw:!0}),f[Yt.or]=t.map(T=>T instanceof this.target?T.where():{[this.target.primaryKeyAttribute]:T}),n.where={[Yt.and]:[f,n.where]},(await this.get(e,n)).length===t.length}async set(e,t,n){t===null?t=[]:t=this.toInstanceArray(t);const f=await this.get(e,ht(Qe({},n),{scope:!1,raw:!0})),O=[],T=f.filter(_=>!t.find(m=>m[this.target.primaryKeyAttribute]===_[this.target.primaryKeyAttribute])),E=t.filter(_=>!f.find(m=>_[this.target.primaryKeyAttribute]===m[this.target.primaryKeyAttribute]));let w,R;return T.length>0&&(R={},R[this.foreignKey]=null,w={[this.target.primaryKeyAttribute]:T.map(_=>_[this.target.primaryKeyAttribute])},O.push(this.target.unscoped().update(R,ht(Qe({},n),{where:w})))),E.length>0&&(w={},R={},R[this.foreignKey]=e.get(this.sourceKey),Object.assign(R,this.scope),w[this.target.primaryKeyAttribute]=E.map(_=>_[this.target.primaryKeyAttribute]),O.push(this.target.unscoped().update(R,ht(Qe({},n),{where:w})))),await Promise.all(O),e}async add(e,t,n={}){if(!t)return Promise.resolve();t=this.toInstanceArray(t);const f=Qe({[this.foreignKey]:e.get(this.sourceKey)},this.scope),O={[this.target.primaryKeyAttribute]:t.map(T=>T.get(this.target.primaryKeyAttribute))};return await this.target.unscoped().update(f,ht(Qe({},n),{where:O})),e}async remove(e,t,n={}){const f={[this.foreignKey]:null};t=this.toInstanceArray(t);const O={[this.foreignKey]:e.get(this.sourceKey),[this.target.primaryKeyAttribute]:t.map(T=>T.get(this.target.primaryKeyAttribute))};return await this.target.unscoped().update(f,ht(Qe({},n),{where:O})),this}async create(e,t,n={}){if(Array.isArray(n)&&(n={fields:n}),t===void 0&&(t={}),this.scope)for(const f of Object.keys(this.scope))t[f]=this.scope[f],n.fields&&n.fields.push(f);return t[this.foreignKey]=e.get(this.sourceKey),n.fields&&n.fields.push(this.foreignKey),await this.target.create(t,n)}verifyAssociationAlias(e){return typeof e=="string"?this.as===e:e&&e.plural?this.as===e.plural:!this.isAliased}};hr.exports=Ls;hr.exports.HasMany=Ls;hr.exports.default=Ls;var Et=hr.exports,Ga=Object.defineProperty,Va=Object.defineProperties,Ya=Object.getOwnPropertyDescriptors,si=Object.getOwnPropertySymbols,Wa=Object.prototype.hasOwnProperty,Ja=Object.prototype.propertyIsEnumerable,ii=(S,e,t)=>e in S?Ga(S,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):S[e]=t,$r=(S,e)=>{for(var t in e||(e={}))Wa.call(e,t)&&ii(S,t,e[t]);if(si)for(var t of si(e))Ja.call(e,t)&&ii(S,t,e[t]);return S},ni=(S,e)=>Va(S,Ya(e));const Wt=fe(),Pr=it,ai=re,Xa=nt,oi=Re;let Za=class extends Xa{constructor(e,t,n){if(super(e,t,n),this.associationType="HasOne",this.isSingleAssociation=!0,this.foreignKeyAttribute={},this.as?(this.isAliased=!0,this.options.name={singular:this.as}):(this.as=this.target.options.name.singular,this.options.name=this.target.options.name),ai.isObject(this.options.foreignKey)?(this.foreignKeyAttribute=this.options.foreignKey,this.foreignKey=this.foreignKeyAttribute.name||this.foreignKeyAttribute.fieldName):this.options.foreignKey&&(this.foreignKey=this.options.foreignKey),this.foreignKey||(this.foreignKey=Wt.camelize([Wt.singularize(this.options.as||this.source.name),this.source.primaryKeyAttribute].join("_"))),this.options.sourceKey&&!this.source.rawAttributes[this.options.sourceKey])throw new Error(`Unknown attribute "${this.options.sourceKey}" passed as sourceKey, define this attribute on model "${this.source.name}" first`);this.sourceKey=this.sourceKeyAttribute=this.options.sourceKey||this.source.primaryKeyAttribute,this.sourceKeyField=this.source.rawAttributes[this.sourceKey].field||this.sourceKey,this.sourceKeyIsPrimary=this.sourceKey===this.source.primaryKeyAttribute,this.associationAccessor=this.as,this.options.useHooks=n.useHooks,this.target.rawAttributes[this.foreignKey]&&(this.identifierField=this.target.rawAttributes[this.foreignKey].field||this.foreignKey);const f=ai.upperFirst(this.options.name.singular);this.accessors={get:`get${f}`,set:`set${f}`,create:`create${f}`}}_injectAttributes(){const e={[this.foreignKey]:$r({type:this.options.keyType||this.source.rawAttributes[this.sourceKey].type,allowNull:!0},this.foreignKeyAttribute)};if(this.options.constraints!==!1){const t=this.target.rawAttributes[this.foreignKey]||e[this.foreignKey];this.options.onDelete=this.options.onDelete||(t.allowNull?"SET NULL":"CASCADE"),this.options.onUpdate=this.options.onUpdate||"CASCADE"}return Pr.addForeignKeyConstraints(e[this.foreignKey],this.source,this.target,this.options,this.sourceKeyField),Wt.mergeDefaults(this.target.rawAttributes,e),this.target.refreshAttributes(),this.identifierField=this.target.rawAttributes[this.foreignKey].field||this.foreignKey,Pr.checkNamingCollision(this),this}mixin(e){const t=["get","set","create"];Pr.mixinMethods(this,e,t)}async get(e,t){const n={};let f=this.target,O;if(t=Wt.cloneDeep(t),Object.prototype.hasOwnProperty.call(t,"scope")&&(t.scope?f=f.scope(t.scope):f=f.unscoped()),Object.prototype.hasOwnProperty.call(t,"schema")&&(f=f.schema(t.schema,t.schemaDelimiter)),Array.isArray(e)||(O=e,e=void 0),e?n[this.foreignKey]={[oi.in]:e.map(T=>T.get(this.sourceKey))}:n[this.foreignKey]=O.get(this.sourceKey),this.scope&&Object.assign(n,this.scope),t.where=t.where?{[oi.and]:[n,t.where]}:n,e){const T=await f.findAll(t),E={};for(const w of e)E[w.get(this.sourceKey,{raw:!0})]=null;for(const w of T)E[w.get(this.foreignKey,{raw:!0})]=w;return E}return f.findOne(t)}async set(e,t,n){n=ni($r({},n),{scope:!1});const f=await e[this.accessors.get](n),O=f&&t&&this.target.primaryKeyAttributes.every(T=>f.get(T,{raw:!0})===(t.get?t.get(T,{raw:!0}):t));if(f&&!O&&(f[this.foreignKey]=null,await f.save(ni($r({},n),{fields:[this.foreignKey],allowNull:[this.foreignKey],association:!0}))),t&&!O){if(!(t instanceof this.target)){const T={};T[this.target.primaryKeyAttribute]=t,t=this.target.build(T,{isNewRecord:!1})}return Object.assign(t,this.scope),t.set(this.foreignKey,e.get(this.sourceKeyAttribute)),t.save(n)}return null}async create(e,t,n){if(t=t||{},n=n||{},this.scope)for(const f of Object.keys(this.scope))t[f]=this.scope[f],n.fields&&n.fields.push(f);return t[this.foreignKey]=e.get(this.sourceKeyAttribute),n.fields&&n.fields.push(this.foreignKey),await this.target.create(t,n)}verifyAssociationAlias(e){return typeof e=="string"?this.as===e:e&&e.singular?this.as===e.singular:!this.isAliased}};var fr=Za,eo=Object.defineProperty,to=Object.defineProperties,ro=Object.getOwnPropertyDescriptors,ui=Object.getOwnPropertySymbols,so=Object.prototype.hasOwnProperty,io=Object.prototype.propertyIsEnumerable,li=(S,e,t)=>e in S?eo(S,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):S[e]=t,de=(S,e)=>{for(var t in e||(e={}))so.call(e,t)&&li(S,t,e[t]);if(ui)for(var t of ui(e))io.call(e,t)&&li(S,t,e[t]);return S},ft=(S,e)=>to(S,ro(e));const tt=fe(),ci=it,Pe=re,no=nt,vr=at,hi=Et,jr=fr,fi=ce.AssociationError,di=ce.EmptyResultError,Jt=Re;let Ds=class extends no{constructor(e,t,n){if(super(e,t,n),this.options.through===void 0||this.options.through===!0||this.options.through===null)throw new fi(`${e.name}.belongsToMany(${t.name}) requires through option, pass either a string or a model`);if(this.options.through.model||(this.options.through={model:n.through}),this.associationType="BelongsToMany",this.targetAssociation=null,this.sequelize=e.sequelize,this.through=de({},this.options.through),this.isMultiAssociation=!0,this.doubleLinked=!1,!this.as&&this.isSelfAssociation)throw new fi("'as' must be defined for many-to-many self-associations");if(this.as?(this.isAliased=!0,Pe.isPlainObject(this.as)?(this.options.name=this.as,this.as=this.as.plural):this.options.name={plural:this.as,singular:tt.singularize(this.as)}):(this.as=this.target.options.name.plural,this.options.name=this.target.options.name),this.combinedTableName=tt.combineTableNames(this.source.tableName,this.isSelfAssociation?this.as||this.target.tableName:this.target.tableName),this.isSelfAssociation&&(this.targetAssociation=this),Pe.each(this.target.associations,T=>{T.associationType==="BelongsToMany"&&T.target===this.source&&this.options.through.model===T.options.through.model&&(this.paired=T,T.paired=this)}),this.sourceKey=this.options.sourceKey||this.source.primaryKeyAttribute,this.sourceKeyField=this.source.rawAttributes[this.sourceKey].field||this.sourceKey,this.options.targetKey?(this.targetKey=this.options.targetKey,this.targetKeyField=this.target.rawAttributes[this.targetKey].field||this.targetKey):(this.targetKeyDefault=!0,this.targetKey=this.target.primaryKeyAttribute,this.targetKeyField=this.target.rawAttributes[this.targetKey].field||this.targetKey),this._createForeignAndOtherKeys(),typeof this.through.model=="string"&&(this.sequelize.isDefined(this.through.model)?this.through.model=this.sequelize.model(this.through.model):this.through.model=this.sequelize.define(this.through.model,{},Object.assign(this.options,{tableName:this.through.model,indexes:[],paranoid:this.through.paranoid?this.through.paranoid:!1,validate:{}}))),Object.assign(this.options,Pe.pick(this.through.model.options,["timestamps","createdAt","updatedAt","deletedAt","paranoid"])),this.paired){let T=!1;this.targetKeyDefault&&(this.targetKey=this.paired.sourceKey,this.targetKeyField=this.paired.sourceKeyField,this._createForeignAndOtherKeys()),this.paired.targetKeyDefault&&this.paired.targetKey!==this.sourceKey&&(delete this.through.model.rawAttributes[this.paired.otherKey],this.paired.targetKey=this.sourceKey,this.paired.targetKeyField=this.sourceKeyField,this.paired._createForeignAndOtherKeys(),T=!0),this.otherKeyDefault&&(this.otherKey=this.paired.foreignKey),this.paired.otherKeyDefault&&this.paired.otherKey!==this.foreignKey&&(delete this.through.model.rawAttributes[this.paired.otherKey],this.paired.otherKey=this.foreignKey,T=!0),T&&this.paired._injectAttributes()}this.through&&(this.throughModel=this.through.model),this.options.tableName=this.combinedName=this.through.model===Object(this.through.model)?this.through.model.tableName:this.through.model,this.associationAccessor=this.as;const f=Pe.upperFirst(this.options.name.plural),O=Pe.upperFirst(this.options.name.singular);this.accessors={get:`get${f}`,set:`set${f}`,addMultiple:`add${f}`,add:`add${O}`,create:`create${O}`,remove:`remove${O}`,removeMultiple:`remove${f}`,hasSingle:`has${O}`,hasAll:`has${f}`,count:`count${f}`}}_createForeignAndOtherKeys(){Pe.isObject(this.options.foreignKey)?(this.foreignKeyAttribute=this.options.foreignKey,this.foreignKey=this.foreignKeyAttribute.name||this.foreignKeyAttribute.fieldName):(this.foreignKeyAttribute={},this.foreignKey=this.options.foreignKey||tt.camelize([this.source.options.name.singular,this.sourceKey].join("_"))),Pe.isObject(this.options.otherKey)?(this.otherKeyAttribute=this.options.otherKey,this.otherKey=this.otherKeyAttribute.name||this.otherKeyAttribute.fieldName):(this.options.otherKey||(this.otherKeyDefault=!0),this.otherKeyAttribute={},this.otherKey=this.options.otherKey||tt.camelize([this.isSelfAssociation?tt.singularize(this.as):this.target.options.name.singular,this.targetKey].join("_")))}_injectAttributes(){this.identifier=this.foreignKey,this.foreignIdentifier=this.otherKey,Pe.each(this.through.model.rawAttributes,(R,_)=>{R.primaryKey===!0&&R._autoGenerated===!0&&([this.foreignKey,this.otherKey].includes(_)?R.primaryKey=!1:delete this.through.model.rawAttributes[_],this.primaryKeyDeleted=!0)});const t=this.source.rawAttributes[this.sourceKey].type,n=this.sourceKeyField,O=this.target.rawAttributes[this.targetKey].type,T=this.targetKeyField,E=de({type:t},this.foreignKeyAttribute),w=de({type:O},this.otherKeyAttribute);if(this.primaryKeyDeleted===!0)w.primaryKey=E.primaryKey=!0;else if(this.through.unique!==!1){let R;typeof this.options.uniqueKey=="string"&&this.options.uniqueKey!==""?R=this.options.uniqueKey:R=[this.through.model.tableName,this.foreignKey,this.otherKey,"unique"].join("_"),w.unique=E.unique=R}return this.through.model.rawAttributes[this.foreignKey]||(this.through.model.rawAttributes[this.foreignKey]={_autoGenerated:!0}),this.through.model.rawAttributes[this.otherKey]||(this.through.model.rawAttributes[this.otherKey]={_autoGenerated:!0}),this.options.constraints!==!1&&(E.references={model:this.source.getTableName(),key:n},E.onDelete=this.options.onDelete||this.through.model.rawAttributes[this.foreignKey].onDelete,E.onUpdate=this.options.onUpdate||this.through.model.rawAttributes[this.foreignKey].onUpdate,E.onDelete||(E.onDelete="CASCADE"),E.onUpdate||(E.onUpdate="CASCADE"),w.references={model:this.target.getTableName(),key:T},w.onDelete=this.through.model.rawAttributes[this.otherKey].onDelete||this.options.onDelete,w.onUpdate=this.through.model.rawAttributes[this.otherKey].onUpdate||this.options.onUpdate,w.onDelete||(w.onDelete="CASCADE"),w.onUpdate||(w.onUpdate="CASCADE")),Object.assign(this.through.model.rawAttributes[this.foreignKey],E),Object.assign(this.through.model.rawAttributes[this.otherKey],w),this.through.model.refreshAttributes(),this.identifierField=this.through.model.rawAttributes[this.foreignKey].field||this.foreignKey,this.foreignIdentifierField=this.through.model.rawAttributes[this.otherKey].field||this.otherKey,this.options.sequelize.options.dialect==="db2"&&this.source.rawAttributes[this.sourceKey].primaryKey!==!0&&(this.source.rawAttributes[this.sourceKey].unique=!0),this.paired&&!this.paired.foreignIdentifierField&&(this.paired.foreignIdentifierField=this.through.model.rawAttributes[this.paired.otherKey].field||this.paired.otherKey),this.toSource=new vr(this.through.model,this.source,{foreignKey:this.foreignKey}),this.manyFromSource=new hi(this.source,this.through.model,{foreignKey:this.foreignKey}),this.oneFromSource=new jr(this.source,this.through.model,{foreignKey:this.foreignKey,sourceKey:this.sourceKey,as:this.through.model.name}),this.toTarget=new vr(this.through.model,this.target,{foreignKey:this.otherKey}),this.manyFromTarget=new hi(this.target,this.through.model,{foreignKey:this.otherKey}),this.oneFromTarget=new jr(this.target,this.through.model,{foreignKey:this.otherKey,sourceKey:this.targetKey,as:this.through.model.name}),this.paired&&this.paired.otherKeyDefault&&(this.paired.toTarget=new vr(this.paired.through.model,this.paired.target,{foreignKey:this.paired.otherKey}),this.paired.oneFromTarget=new jr(this.paired.target,this.paired.through.model,{foreignKey:this.paired.otherKey,sourceKey:this.paired.targetKey,as:this.paired.through.model.name})),ci.checkNamingCollision(this),this}mixin(e){const t=["get","count","hasSingle","hasAll","set","add","addMultiple","remove","removeMultiple","create"],n={hasSingle:"has",hasAll:"has",addMultiple:"add",removeMultiple:"remove"};ci.mixinMethods(this,e,t,n)}async get(e,t){t=tt.cloneDeep(t)||{};const n=this.through;let f,O;this.scope&&(f=de({},this.scope)),t.where={[Jt.and]:[f,t.where]},Object(n.model)===n.model&&(O={},O[this.foreignKey]=e.get(this.sourceKey),n.scope&&Object.assign(O,n.scope),t.through&&t.through.where&&(O={[Jt.and]:[O,t.through.where]}),t.include=t.include||[],t.include.push({association:this.oneFromTarget,attributes:t.joinTableAttributes,required:!0,paranoid:Pe.get(t.through,"paranoid",!0),where:O}));let T=this.target;return Object.prototype.hasOwnProperty.call(t,"scope")&&(t.scope?T=T.scope(t.scope):T=T.unscoped()),Object.prototype.hasOwnProperty.call(t,"schema")&&(T=T.schema(t.schema,t.schemaDelimiter)),T.findAll(t)}async count(e,t){const n=this.target.sequelize;t=tt.cloneDeep(t),t.attributes=[[n.fn("COUNT",n.col([this.target.name,this.targetKeyField].join("."))),"count"]],t.joinTableAttributes=[],t.raw=!0,t.plain=!0;const f=await this.get(e,t);return parseInt(f.count,10)}async has(e,t,n){Array.isArray(t)||(t=[t]),n=ft(de({raw:!0},n),{scope:!1,attributes:[this.targetKey],joinTableAttributes:[]});const f=t.map(T=>T instanceof this.target?T.where():{[this.targetKey]:T});n.where={[Jt.and]:[{[Jt.or]:f},n.where]};const O=await this.get(e,n);return Pe.differenceWith(f,O,(T,E)=>Pe.isEqual(T[this.targetKey],E[this.targetKey])).length===0}async set(e,t,n){n=n||{};const f=this.sourceKey,O=this.targetKey,T=this.identifier,E=this.foreignIdentifier;t===null?t=[]:t=this.toInstanceArray(t);const w=de({[T]:e.get(f)},this.through.scope),R=_=>{const m=[],g=[],N=n.through||{},c=t.filter(l=>!_.some(r=>r[E]===l.get(O)));for(const l of _){const r=t.find(i=>l[E]===i.get(O));if(!r)m.push(l);else{let i=r[this.through.model.name];i instanceof this.through.model&&(i={});const s=de(de({},N),i);Object.keys(s).length&&g.push(this.through.model.update(s,Object.assign(n,{where:{[T]:e.get(f),[E]:r.get(O)}})))}}if(m.length>0&&g.push(this.through.model.destroy(ft(de({},n),{where:de({[T]:e.get(f),[E]:m.map(l=>l[E])},this.through.scope)}))),c.length>0){const l=c.map(r=>de(ft(de(de({},N),r[this.through.model.name]),{[T]:e.get(f),[E]:r.get(O)}),this.through.scope));g.push(this.through.model.bulkCreate(l,de({validate:!0},n)))}return Promise.all(g)};try{const _=await this.through.model.findAll(ft(de({},n),{where:w,raw:!0}));return await R(_)}catch(_){if(_ instanceof di)return R([]);throw _}}async add(e,t,n){if(!t)return Promise.resolve();n=de({},n);const f=this,O=f.sourceKey,T=f.targetKey,E=f.identifier,w=f.foreignIdentifier,R=n.through||{};t=f.toInstanceArray(t);const _=de({[E]:e.get(O),[w]:t.map(g=>g.get(T))},f.through.scope),m=g=>{const N=[],c=[],l=[];for(const r of t){const i=g&&g.find(s=>s[w]===r.get(T));if(!i)c.push(r);else{const s=r[f.through.model.name],a=de(de({},R),s);Object.keys(a).some(d=>a[d]!==i[d])&&l.push(r)}}if(c.length>0){const r=c.map(i=>{const s=i[f.through.model.name],a=de(de({},R),s);return a[E]=e.get(O),a[w]=i.get(T),Object.assign(a,f.through.scope),a});N.push(f.through.model.bulkCreate(r,de({validate:!0},n)))}for(const r of l){let i=r[f.through.model.name];const s=de(de({},R),i);i instanceof f.through.model&&(i={}),N.push(f.through.model.update(s,Object.assign(n,{where:{[E]:e.get(O),[w]:r.get(T)}})))}return Promise.all(N)};try{const g=await f.through.model.findAll(ft(de({},n),{where:_,raw:!0})),[N]=await m(g);return N}catch(g){if(g instanceof di)return m();throw g}}remove(e,t,n){const f=this;n=n||{},t=f.toInstanceArray(t);const O={[f.identifier]:e.get(f.sourceKey),[f.foreignIdentifier]:t.map(T=>T.get(f.targetKey))};return f.through.model.destroy(ft(de({},n),{where:O}))}async create(e,t,n){const f=this;n=n||{},t=t||{},Array.isArray(n)&&(n={fields:n}),f.scope&&(Object.assign(t,f.scope),n.fields&&(n.fields=n.fields.concat(Object.keys(f.scope))));const O=await f.target.create(t,n);return await e[f.accessors.add](O,Pe.omit(n,["fields"])),O}verifyAssociationAlias(e){return typeof e=="string"?this.as===e:e&&e.plural?this.as===e.plural:!this.isAliased}};cr.exports=Ds;cr.exports.BelongsToMany=Ds;cr.exports.default=Ds;var Ut=cr.exports,dr={exports:{}},ao=Object.defineProperty,pi=Object.getOwnPropertySymbols,oo=Object.prototype.hasOwnProperty,uo=Object.prototype.propertyIsEnumerable,yi=(S,e,t)=>e in S?ao(S,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):S[e]=t,lo=(S,e)=>{for(var t in e||(e={}))oo.call(e,t)&&yi(S,t,e[t]);if(pi)for(var t of pi(e))uo.call(e,t)&&yi(S,t,e[t]);return S};const dt=re,mi=fe(),Xt=ce,xr=he(),co=at,Qr=Ft.validator,{promisify:Ei}=Ae;let pr=class Yn{constructor(e,t){t=lo({hooks:!0},t),t.fields&&!t.skip?t.skip=dt.difference(Object.keys(e.constructor.rawAttributes),t.fields):t.skip=t.skip||[],this.options=t,this.modelInstance=e,this.validator=Qr,this.errors=[],this.inProgress=!1}async _validate(){if(this.inProgress)throw new Error("Validations already in progress.");if(this.inProgress=!0,await Promise.all([this._perAttributeValidators(),this._customValidators()]),this.errors.length)throw new Xt.ValidationError(null,this.errors)}async validate(){return await(this.options.hooks?this._validateAndRunHooks():this._validate())}async _validateAndRunHooks(){const e=this.modelInstance.constructor.runHooks.bind(this.modelInstance.constructor);await e("beforeValidate",this.modelInstance,this.options);try{await this._validate()}catch(t){throw await e("validationFailed",this.modelInstance,this.options,t)||t}return await e("afterValidate",this.modelInstance,this.options),this.modelInstance}async _perAttributeValidators(){const e=[];return dt.forIn(this.modelInstance.rawAttributes,(t,n)=>{if(this.options.skip.includes(n))return;const f=this.modelInstance.dataValues[n];f instanceof mi.SequelizeMethod||(!t._autoGenerated&&!t.autoIncrement&&this._validateSchema(t,n,f),Object.prototype.hasOwnProperty.call(this.modelInstance.validators,n)&&e.push(this._singleAttrValidate(f,n,t.allowNull)))}),await Promise.all(e)}async _customValidators(){const e=[];return dt.each(this.modelInstance.constructor.options.validate,(t,n)=>{if(this.options.skip.includes(n))return;const f=this._invokeCustomValidator(t,n).catch(()=>{});e.push(f)}),await Promise.all(e)}async _singleAttrValidate(e,t,n){if(e==null&&!n)return;const f=[];return dt.forIn(this.modelInstance.validators[t],(O,T)=>{if(["isUrl","isURL","isEmail"].includes(T)&&(typeof O=="object"&&O!==null&&O.msg?O={msg:O.msg}:O===!0&&(O={})),typeof O=="function"){f.push(this._invokeCustomValidator(O,T,!0,e,t));return}if(e==null)return;const E=this._invokeBuiltinValidator(e,O,T,t);E.catch(()=>{}),f.push(E)}),Promise.all(f.map(O=>O.catch(T=>{const E=!!T.validatorName;this._pushError(E,t,T,e,T.validatorName,T.validatorArgs)})))}async _invokeCustomValidator(e,t,n,f,O){let T=!1;const E=e.length;let w=1,R=t,_;if(n&&(w=2,_=f,R=O),E===w&&(T=!0),T)try{return n?await Ei(e.bind(this.modelInstance,_))():await Ei(e.bind(this.modelInstance))()}catch(m){return this._pushError(!1,R,m,f,t)}try{return await e.call(this.modelInstance,_)}catch(m){return this._pushError(!1,R,m,f,t)}}async _invokeBuiltinValidator(e,t,n,f){const O=String(e);if(typeof Qr[n]!="function")throw new Error(`Invalid validator function: ${n}`);const T=this._extractValidatorArgs(t,n,f);if(!Qr[n](O,...T))throw Object.assign(new Error(t.msg||`Validation ${n} on ${f} failed`),{validatorName:n,validatorArgs:T})}_extractValidatorArgs(e,t,n){let f=e.args||e;const O=typeof f!="string"&&["isAlpha","isAlphanumeric","isMobilePhone"].includes(t);return Array.isArray(f)?f=f.slice(0):t==="isImmutable"?f=[f,n,this.modelInstance]:O||t==="isIP"?f=[]:f=[f],f}_validateSchema(e,t,n){if(e.allowNull===!1&&n==null){const f=Object.values(this.modelInstance.constructor.associations).find(O=>O instanceof co&&O.foreignKey===e.fieldName);if(!f||!this.modelInstance.get(f.associationAccessor)){const O=this.modelInstance.validators[t],T=dt.get(O,"notNull.msg",`${this.modelInstance.constructor.name}.${t} cannot be null`);this.errors.push(new Xt.ValidationErrorItem(T,"notNull Violation",t,n,this.modelInstance,"is_null"))}}(e.type instanceof xr.STRING||e.type instanceof xr.TEXT||e.type instanceof xr.CITEXT)&&(Array.isArray(n)||dt.isObject(n)&&!(n instanceof mi.SequelizeMethod)&&!Buffer.isBuffer(n))&&this.errors.push(new Xt.ValidationErrorItem(`${t} cannot be an array or an object`,"string violation",t,n,this.modelInstance,"not_a_string"))}_pushError(e,t,n,f,O,T){const E=n.message||n||"Validation error",w=new Xt.ValidationErrorItem(E,"Validation error",t,f,this.modelInstance,O,e?O:void 0,e?T:void 0);w[Yn.RAW_KEY_NAME]=n,this.errors.push(w)}};pr.RAW_KEY_NAME="original";dr.exports=pr;dr.exports.InstanceValidator=pr;dr.exports.default=pr;var ho=dr.exports,Wn={exports:{}};Wn.exports={SELECT:"SELECT",INSERT:"INSERT",UPDATE:"UPDATE",BULKUPDATE:"BULKUPDATE",BULKDELETE:"BULKDELETE",DELETE:"DELETE",UPSERT:"UPSERT",VERSION:"VERSION",SHOWTABLES:"SHOWTABLES",SHOWINDEXES:"SHOWINDEXES",DESCRIBE:"DESCRIBE",RAW:"RAW",FOREIGNKEYS:"FOREIGNKEYS",SHOWCONSTRAINTS:"SHOWCONSTRAINTS"};var Me=Wn.exports,yr={};const Jn=re,{logger:fo}=ge,Zt=fo.debugContext("hooks"),st={beforeValidate:{params:2},afterValidate:{params:2},validationFailed:{params:3},beforeCreate:{params:2},afterCreate:{params:2},beforeDestroy:{params:2},afterDestroy:{params:2},beforeRestore:{params:2},afterRestore:{params:2},beforeUpdate:{params:2},afterUpdate:{params:2},beforeSave:{params:2,proxies:["beforeUpdate","beforeCreate"]},afterSave:{params:2,proxies:["afterUpdate","afterCreate"]},beforeUpsert:{params:2},afterUpsert:{params:2},beforeBulkCreate:{params:2},afterBulkCreate:{params:2},beforeBulkDestroy:{params:1},afterBulkDestroy:{params:1},beforeBulkRestore:{params:1},afterBulkRestore:{params:1},beforeBulkUpdate:{params:1},afterBulkUpdate:{params:1},beforeFind:{params:1},beforeFindAfterExpandIncludeAll:{params:1},beforeFindAfterOptions:{params:1},afterFind:{params:2},beforeCount:{params:1},beforeDefine:{params:2,sync:!0,noModel:!0},afterDefine:{params:1,sync:!0,noModel:!0},beforeInit:{params:2,sync:!0,noModel:!0},afterInit:{params:1,sync:!0,noModel:!0},beforeAssociate:{params:2,sync:!0},afterAssociate:{params:2,sync:!0},beforeConnect:{params:1,noModel:!0},afterConnect:{params:2,noModel:!0},beforeDisconnect:{params:1,noModel:!0},afterDisconnect:{params:1,noModel:!0},beforePoolAcquire:{params:1,noModel:!0},afterPoolAcquire:{params:2,noModel:!0},beforeSync:{params:1},afterSync:{params:1},beforeBulkSync:{params:1},afterBulkSync:{params:1},beforeQuery:{params:2},afterQuery:{params:2}};yr.hooks=st;const gi=S=>st[S].proxies?st[S].proxies.concat(S):[S];function Fr(S,e){return(S.options.hooks||{})[e]||[]}const Os={_setupHooks(S){this.options.hooks={},Jn.map(S||{},(e,t)=>{Array.isArray(e)||(e=[e]),e.forEach(n=>this.addHook(t,n))})},async runHooks(S,...e){if(!S)throw new Error("runHooks requires at least 1 argument");let t;if(typeof S=="string"&&(t=S,S=Fr(this,t),this.sequelize&&(S=S.concat(Fr(this.sequelize,t)))),Array.isArray(S)||(S=[S]),st[t]&&st[t].sync){for(let n of S)typeof n=="object"&&(n=n.fn),Zt(`running hook(sync) ${t}`),n.apply(this,e);return}for(let n of S)typeof n=="object"&&(n=n.fn),Zt(`running hook ${t}`),await n.apply(this,e)},addHook(S,e,t){return typeof e=="function"&&(t=e,e=null),Zt(`adding hook ${S}`),S=gi(S),S.forEach(n=>{const f=Fr(this,n);f.push(e?{name:e,fn:t}:t),this.options.hooks[n]=f}),this},removeHook(S,e){const t=typeof e=="function";if(!this.hasHook(S))return this;Zt(`removing hook ${S}`),S=gi(S);for(const n of S)this.options.hooks[n]=this.options.hooks[n].filter(f=>t&&typeof f=="function"?f!==e:!t&&typeof f=="object"?f.name!==e:!0);return this},hasHook(S){return this.options.hooks[S]&&!!this.options.hooks[S].length}};Os.hasHooks=Os.hasHook;function po(S,e=!1){Jn.mixin(S,Os);for(const t of Object.keys(st))e&&st[t].noModel||(S[t]=function(n,f){return this.addHook(t,n,f)})}yr.applyTo=po;var mr={exports:{}};const bs=re,yo=fr,Ur=Et,Kr=Ut,mo=at;function Ts(S,e){return S&&S.prototype&&S.prototype instanceof e.Sequelize.Model}const Kt={hasMany(S,e={}){if(!Ts(S,this.sequelize))throw new Error(`${this.name}.hasMany called with something that's not a subclass of Sequelize.Model`);const t=this;e.hooks=e.hooks===void 0?!1:!!e.hooks,e.useHooks=e.hooks,Object.assign(e,bs.omit(t.options,["hooks"])),e.useHooks&&this.runHooks("beforeAssociate",{source:t,target:S,type:Ur},e);const n=new Ur(t,S,e);return t.associations[n.associationAccessor]=n,n._injectAttributes(),n.mixin(t.prototype),e.useHooks&&this.runHooks("afterAssociate",{source:t,target:S,type:Ur,association:n},e),n},belongsToMany(S,e={}){if(!Ts(S,this.sequelize))throw new Error(`${this.name}.belongsToMany called with something that's not a subclass of Sequelize.Model`);const t=this;e.hooks=e.hooks===void 0?!1:!!e.hooks,e.useHooks=e.hooks,e.timestamps=e.timestamps===void 0?this.sequelize.options.timestamps:e.timestamps,Object.assign(e,bs.omit(t.options,["hooks","timestamps","scopes","defaultScope"])),e.useHooks&&this.runHooks("beforeAssociate",{source:t,target:S,type:Kr},e);const n=new Kr(t,S,e);return t.associations[n.associationAccessor]=n,n._injectAttributes(),n.mixin(t.prototype),e.useHooks&&this.runHooks("afterAssociate",{source:t,target:S,type:Kr,association:n},e),n},getAssociations(S){return Object.values(this.associations).filter(e=>e.target.name===S.name)},getAssociationForAlias(S,e){return this.getAssociations(S).find(t=>t.verifyAssociationAlias(e))||null}};function Xn(S){return function(e,t={}){const n=this;if(!Ts(e,n.sequelize))throw new Error(`${n.name}.${bs.lowerFirst(S.name)} called with something that's not a subclass of Sequelize.Model`);t.hooks=t.hooks===void 0?!1:!!t.hooks,t.useHooks=t.hooks,t.useHooks&&n.runHooks("beforeAssociate",{source:n,target:e,type:S},t);const f=new S(n,e,Object.assign(t,n.options));return n.associations[f.associationAccessor]=f,f._injectAttributes(),f.mixin(n.prototype),t.useHooks&&n.runHooks("afterAssociate",{source:n,target:e,type:S,association:f},t),f}}Kt.hasOne=Xn(yo);Kt.belongsTo=Xn(mo);mr.exports=Kt;mr.exports.Mixin=Kt;mr.exports.default=Kt;var Eo=mr.exports,Bt={};(function(S){var e=Object.create,t=Object.defineProperty,n=Object.getOwnPropertyDescriptor,f=Object.getOwnPropertyNames,O=Object.getPrototypeOf,T=Object.prototype.hasOwnProperty,E=s=>t(s,"__esModule",{value:!0}),w=(s,a)=>{E(s);for(var d in a)t(s,d,{get:a[d],enumerable:!0})},R=(s,a,d)=>{if(a&&typeof a=="object"||typeof a=="function")for(let y of f(a))!T.call(s,y)&&y!=="default"&&t(s,y,{get:()=>a[y],enumerable:!(d=n(a,y))||d.enumerable});return s},_=s=>R(E(t(s!=null?e(O(s)):{},"default",s&&s.__esModule&&"default"in s?{get:()=>s.default,enumerable:!0}:{value:s,enumerable:!0})),s);w(S,{noBoolOperatorAliases:()=>l,noDoubleNestedGroup:()=>r,noStringOperators:()=>c,noTrueLogging:()=>N,unsupportedEngine:()=>i});var m=_(Ae);const g=()=>{},N=(0,m.deprecate)(g,"The logging-option should be either a function or false. Default: console.log","SEQUELIZE0002"),c=(0,m.deprecate)(g,"String based operators are deprecated. Please use Symbol based operators for better security, read more at https://sequelize.org/master/manual/querying.html#operators","SEQUELIZE0003"),l=(0,m.deprecate)(g,"A boolean value was passed to options.operatorsAliases. This is a no-op with v5 and should be removed.","SEQUELIZE0004"),r=(0,m.deprecate)(g,"Passing a double nested nested array to `group` is unsupported and will be removed in v6.","SEQUELIZE0005"),i=(0,m.deprecate)(g,"This database engine version is not supported, please update your database server. More information https://github.com/sequelize/sequelize/blob/main/ENGINE.md","SEQUELIZE0006")})(Bt);var go=Object.defineProperty,_o=Object.defineProperties,Ao=Object.getOwnPropertyDescriptors,_i=Object.getOwnPropertySymbols,Oo=Object.prototype.hasOwnProperty,bo=Object.prototype.propertyIsEnumerable,Ai=(S,e,t)=>e in S?go(S,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):S[e]=t,ae=(S,e)=>{for(var t in e||(e={}))Oo.call(e,t)&&Ai(S,t,e[t]);if(_i)for(var t of _i(e))bo.call(e,t)&&Ai(S,t,e[t]);return S},Ke=(S,e)=>_o(S,Ao(e));const Oi=Ae,z=re,bi=wn,Y=fe(),{logger:Br}=ge,er=at,gt=Ut,To=ho,_t=Me,Ne=ce,No=nt,wo=Et,Le=he(),Io=yr,So=Eo,Je=Re,{noDoubleNestedGroup:Ro}=Bt,qo=new Set(["where","attributes","paranoid","include","order","limit","offset","transaction","lock","raw","logging","benchmark","having","searchPath","rejectOnEmpty","plain","scope","group","through","defaults","distinct","primary","exception","type","hooks","force","name"]),Co=["include","attributes","originalAttributes","order","where","limit","offset","plain","group","having"];let Ms=class Ve{static get queryInterface(){return this.sequelize.getQueryInterface()}static get queryGenerator(){return this.queryInterface.queryGenerator}get sequelize(){return this.constructor.sequelize}constructor(e={},t={}){this.constructor._overwrittenAttributesChecked||(this.constructor._overwrittenAttributesChecked=!0,setTimeout(()=>{const n=[];for(const f of Object.keys(this.constructor._attributeManipulation))Object.prototype.hasOwnProperty.call(this,f)&&n.push(f);n.length>0&&Br.warn(`Model ${JSON.stringify(this.constructor.name)} is declaring public class fields for attribute(s): ${n.map(f=>JSON.stringify(f)).join(", ")}.
These class fields are shadowing Sequelize's attribute getters & setters.
See https://sequelize.org/main/manual/model-basics.html#caveat-with-public-class-fields`)},0)),t=ae({isNewRecord:!0,_schema:this.constructor._schema,_schemaDelimiter:this.constructor._schemaDelimiter},t),t.attributes&&(t.attributes=t.attributes.map(n=>Array.isArray(n)?n[1]:n)),t.includeValidated||(this.constructor._conformIncludes(t,this.constructor),t.include&&(this.constructor._expandIncludeAll(t),this.constructor._validateIncludedElements(t))),this.dataValues={},this._previousDataValues={},this.uniqno=1,this._changed=new Set,this._options=t,this.isNewRecord=t.isNewRecord,this._initValues(e,t)}_initValues(e,t){let n,f;if(e=ae({},e),t.isNewRecord){n={},this.constructor._hasDefaultValues&&(n=z.mapValues(this.constructor._defaultValues,O=>{const T=O();return T&&T instanceof Y.SequelizeMethod?T:z.cloneDeep(T)})),this.constructor.primaryKeyAttributes.length&&this.constructor.primaryKeyAttributes.forEach(O=>{Object.prototype.hasOwnProperty.call(n,O)||(n[O]=null)}),this.constructor._timestampAttributes.createdAt&&n[this.constructor._timestampAttributes.createdAt]&&(this.dataValues[this.constructor._timestampAttributes.createdAt]=Y.toDefaultValue(n[this.constructor._timestampAttributes.createdAt],this.sequelize.options.dialect),delete n[this.constructor._timestampAttributes.createdAt]),this.constructor._timestampAttributes.updatedAt&&n[this.constructor._timestampAttributes.updatedAt]&&(this.dataValues[this.constructor._timestampAttributes.updatedAt]=Y.toDefaultValue(n[this.constructor._timestampAttributes.updatedAt],this.sequelize.options.dialect),delete n[this.constructor._timestampAttributes.updatedAt]),this.constructor._timestampAttributes.deletedAt&&n[this.constructor._timestampAttributes.deletedAt]&&(this.dataValues[this.constructor._timestampAttributes.deletedAt]=Y.toDefaultValue(n[this.constructor._timestampAttributes.deletedAt],this.sequelize.options.dialect),delete n[this.constructor._timestampAttributes.deletedAt]);for(f in n)e[f]===void 0&&(this.set(f,Y.toDefaultValue(n[f],this.sequelize.options.dialect),{raw:!0}),delete e[f])}this.set(e,t)}static _paranoidClause(e,t={}){if(t.include)for(const E of t.include)this._paranoidClause(E.model,E);if(z.get(t,"groupedLimit.on.options.paranoid")){const E=z.get(t,"groupedLimit.on.through.model");E&&(t.groupedLimit.through=this._paranoidClause(E,t.groupedLimit.through))}if(!e.options.timestamps||!e.options.paranoid||t.paranoid===!1)return t;const n=e._timestampAttributes.deletedAt,f=e.rawAttributes[n],O={};let T=Object.prototype.hasOwnProperty.call(f,"defaultValue")?f.defaultValue:null;return T=T||{[Je.eq]:null},O[f.field||n]=T,Y.isWhereEmpty(t.where)?t.where=O:t.where={[Je.and]:[O,t.where]},t}static _addDefaultAttributes(){const e={};let t={};if(!z.some(this.rawAttributes,"primaryKey")){if("id"in this.rawAttributes)throw new Error(`A column called 'id' was added to the attributes of '${this.tableName}' but not marked with 'primaryKey: true'`);t={id:{type:new Le.INTEGER,allowNull:!1,primaryKey:!0,autoIncrement:!0,_autoGenerated:!0}}}this._timestampAttributes.createdAt&&(e[this._timestampAttributes.createdAt]={type:Le.DATE,allowNull:!1,_autoGenerated:!0}),this._timestampAttributes.updatedAt&&(e[this._timestampAttributes.updatedAt]={type:Le.DATE,allowNull:!1,_autoGenerated:!0}),this._timestampAttributes.deletedAt&&(e[this._timestampAttributes.deletedAt]={type:Le.DATE,_autoGenerated:!0}),this._versionAttribute&&(e[this._versionAttribute]={type:Le.INTEGER,allowNull:!1,defaultValue:0,_autoGenerated:!0});const n=ae(ae({},t),this.rawAttributes);z.each(e,(f,O)=>{n[O]===void 0&&(n[O]=f)}),this.rawAttributes=n,Object.keys(this.primaryKeys).length||(this.primaryKeys.id=this.rawAttributes.id)}static getAttributes(){return this.rawAttributes}static _findAutoIncrementAttribute(){this.autoIncrementAttribute=null;for(const e in this.rawAttributes)if(Object.prototype.hasOwnProperty.call(this.rawAttributes,e)){const t=this.rawAttributes[e];if(t&&t.autoIncrement){if(this.autoIncrementAttribute)throw new Error("Invalid Instance definition. Only one autoincrement field allowed.");this.autoIncrementAttribute=e}}}static _conformIncludes(e,t){if(e.include){if(!Array.isArray(e.include))e.include=[e.include];else if(!e.include.length){delete e.include;return}e.include=e.include.map(n=>this._conformInclude(n,t))}}static _transformStringAssociation(e,t){if(t&&typeof e=="string"){if(!Object.prototype.hasOwnProperty.call(t.associations,e))throw new Error(`Association with alias "${e}" does not exist on ${t.name}`);return t.associations[e]}return e}static _conformInclude(e,t){if(e){let n;if(e._pseudo)return e;if(e=this._transformStringAssociation(e,t),e instanceof No)return t&&e.target.name===t.name?n=e.source:n=e.target,{model:n,association:e,as:e.as};if(e.prototype&&e.prototype instanceof Ve)return{model:e};if(z.isPlainObject(e)){if(e.association)return e.association=this._transformStringAssociation(e.association,t),t&&e.association.target.name===t.name?n=e.association.source:n=e.association.target,e.model||(e.model=n),e.as||(e.as=e.association.as),this._conformIncludes(e,n),e;if(e.model)return this._conformIncludes(e,e.model),e;if(e.all)return this._conformIncludes(e),e}}throw new Error("Include unexpected. Element has to be either a Model, an Association or an object.")}static _expandIncludeAllElement(e,t){let n=t.all;if(delete t.all,n!==!0){Array.isArray(n)||(n=[n]);const T={BelongsTo:!0,HasOne:!0,HasMany:!0,One:["BelongsTo","HasOne"],Has:["HasOne","HasMany"],Many:["HasMany"]};for(let E=0;E<n.length;E++){const w=n[E];if(w==="All"){n=!0;break}const R=T[w];if(!R)throw new Ne.EagerLoadingError(`include all '${w}' is not valid - must be BelongsTo, HasOne, HasMany, One, Has, Many or All`);if(R!==!0){n.splice(E,1),E--;for(let _=0;_<R.length;_++)n.includes(R[_])||(n.unshift(R[_]),E++)}}}const f=t.nested;f&&(delete t.nested,t.include?Array.isArray(t.include)||(t.include=[t.include]):t.include=[]);const O=[];(function T(E,w){z.forEach(E.associations,R=>{if(n!==!0&&!n.includes(R.associationType))return;const _=R.target,m=R.options.as,g={model:_};if(m&&(g.as=m),z.some(w,g)||f&&O.includes(_))return;O.push(E);const N=Y.cloneDeep(t);N.model=_,m&&(N.as=m),w.push(N),f&&(T(_,N.include),N.include.length===0&&delete N.include)}),O.pop()})(this,e)}static _validateIncludedElements(e,t){e.model||(e.model=this),t=t||{},e.includeNames=[],e.includeMap={},e.hasSingleAssociation=!1,e.hasMultiAssociation=!1,e.parent||(e.topModel=e.model,e.topLimit=e.limit),e.include=e.include.map(n=>(n=this._conformInclude(n),n.parent=e,n.topLimit=e.topLimit,this._validateIncludedElement.call(e.model,n,t,e),n.duplicating===void 0&&(n.duplicating=n.association.isMultiAssociation),n.hasDuplicating=n.hasDuplicating||n.duplicating,n.hasRequired=n.hasRequired||n.required,e.hasDuplicating=e.hasDuplicating||n.hasDuplicating,e.hasRequired=e.hasRequired||n.required,e.hasWhere=e.hasWhere||n.hasWhere||!!n.where,n));for(const n of e.include)n.hasParentWhere=e.hasParentWhere||!!e.where,n.hasParentRequired=e.hasParentRequired||!!e.required,n.subQuery!==!1&&e.hasDuplicating&&e.topLimit?n.duplicating?(n.subQuery=n.subQuery||!1,n.subQueryFilter=n.hasRequired):(n.subQuery=n.hasRequired,n.subQueryFilter=!1):(n.subQuery=n.subQuery||!1,n.duplicating?n.subQueryFilter=n.subQuery:(n.subQueryFilter=!1,n.subQuery=n.subQuery||n.hasParentRequired&&n.hasRequired&&!n.separate)),e.includeMap[n.as]=n,e.includeNames.push(n.as),e.topModel===e.model&&e.subQuery===void 0&&e.topLimit&&(n.subQuery?e.subQuery=n.subQuery:n.hasDuplicating&&(e.subQuery=!0)),e.hasIncludeWhere=e.hasIncludeWhere||n.hasIncludeWhere||!!n.where,e.hasIncludeRequired=e.hasIncludeRequired||n.hasIncludeRequired||!!n.required,(n.association.isMultiAssociation||n.hasMultiAssociation)&&(e.hasMultiAssociation=!0),(n.association.isSingleAssociation||n.hasSingleAssociation)&&(e.hasSingleAssociation=!0);return e.topModel===e.model&&e.subQuery===void 0&&(e.subQuery=!1),e}static _validateIncludedElement(e,t,n){if(t[e.model.getTableName()]=!0,e.attributes&&!n.raw?(e.model._expandAttributes(e),e.originalAttributes=e.model._injectDependentVirtualAttributes(e.attributes),e=Y.mapFinderOptions(e,e.model),e.attributes.length&&z.each(e.model.primaryKeys,(T,E)=>{e.attributes.some(w=>T.field!==E?Array.isArray(w)&&w[0]===T.field&&w[1]===E:w===E)||e.attributes.unshift(E)})):e=Y.mapFinderOptions(e,e.model),e._pseudo)return e.attributes||(e.attributes=Object.keys(e.model.tableAttributes)),Y.mapFinderOptions(e,e.model);const f=e.association||this._getIncludedAssociation(e.model,e.as);if(e.association=f,e.as=f.as,e.association.through&&Object(e.association.through.model)===e.association.through.model){e.include||(e.include=[]);const T=e.association.through;e.through=z.defaults(e.through||{},{model:T.model,as:T.model.name,association:{isSingleAssociation:!0},_pseudo:!0,parent:e}),T.scope&&(e.through.where=e.through.where?{[Je.and]:[e.through.where,T.scope]}:T.scope),e.include.push(e.through),t[T.tableName]=!0}let O;if(e.model.scoped===!0?O=e.model:O=e.association.target.name===e.model.name?e.association.target:e.association.source,O._injectScope(e),e.attributes||(e.attributes=Object.keys(e.model.tableAttributes)),e=Y.mapFinderOptions(e,e.model),e.required===void 0&&(e.required=!!e.where),e.association.scope&&(e.where=e.where?{[Je.and]:[e.where,e.association.scope]}:e.association.scope),e.limit&&e.separate===void 0&&(e.separate=!0),e.separate===!0){if(!(e.association instanceof wo))throw new Error("Only HasMany associations support include.separate");e.duplicating=!1,n.attributes&&n.attributes.length&&!z.flattenDepth(n.attributes,2).includes(f.sourceKey)&&n.attributes.push(f.sourceKey),e.attributes&&e.attributes.length&&!z.flattenDepth(e.attributes,2).includes(f.foreignKey)&&e.attributes.push(f.foreignKey)}return Object.prototype.hasOwnProperty.call(e,"include")&&this._validateIncludedElements.call(e.model,e,t),e}static _getIncludedAssociation(e,t){const n=this.getAssociations(e);let f=null;if(n.length===0)throw new Ne.EagerLoadingError(`${e.name} is not associated to ${this.name}!`);if(n.length===1){if(f=this.getAssociationForAlias(e,t),f)return f;if(t){const O=this.getAssociations(e).map(T=>T.as);throw new Ne.EagerLoadingError(`${e.name} is associated to ${this.name} using an alias. You've included an alias (${t}), but it does not match the alias(es) defined in your association (${O.join(", ")}).`)}throw new Ne.EagerLoadingError(`${e.name} is associated to ${this.name} using an alias. You must use the 'as' keyword to specify the alias within your include statement.`)}if(f=this.getAssociationForAlias(e,t),!f)throw new Ne.EagerLoadingError(`${e.name} is associated to ${this.name} multiple times. To identify the correct association, you must use the 'as' keyword to specify the alias of the association you want to include.`);return f}static _expandIncludeAll(e){const t=e.include;if(t){for(let n=0;n<t.length;n++){const f=t[n];f.all&&(t.splice(n,1),n--,this._expandIncludeAllElement(t,f))}t.forEach(n=>{this._expandIncludeAll.call(n.model,n)})}}static _conformIndex(e){if(!e.fields)throw new Error('Missing "fields" property for index definition');return e=z.defaults(e,{type:"",parser:null}),e.type&&e.type.toLowerCase()==="unique"&&(e.unique=!0,delete e.type),e}static _uniqIncludes(e){e.include&&(e.include=z(e.include).groupBy(t=>`${t.model&&t.model.name}-${t.as}`).map(t=>this._assignOptions(...t)).value())}static _baseMerge(...e){return z.assignWith(...e),this._conformIncludes(e[0],this),this._uniqIncludes(e[0]),e[0]}static _mergeFunction(e,t,n){if(Array.isArray(e)&&Array.isArray(t))return z.union(e,t);if(["where","having"].includes(n)){if(this.options&&this.options.whereMergeStrategy==="and")return Lo(e,t);if(t instanceof Y.SequelizeMethod&&(t={[Je.and]:t}),z.isPlainObject(e)&&z.isPlainObject(t))return Object.assign(e,t)}else if(n==="attributes"&&z.isPlainObject(e)&&z.isPlainObject(t))return z.assignWith(e,t,(f,O)=>{if(Array.isArray(f)&&Array.isArray(O))return z.union(f,O)});return t?Y.cloneDeep(t,!0):t===void 0?e:t}static _assignOptions(...e){return this._baseMerge(...e,this._mergeFunction.bind(this))}static _defaultsOptions(e,t){return this._baseMerge(e,t,(n,f,O)=>this._mergeFunction(f,n,O))}static init(e,t={}){if(!t.sequelize)throw new Error("No Sequelize instance passed");this.sequelize=t.sequelize;const n=this.sequelize.options;if(t=Y.merge(z.cloneDeep(n.define),t),t.modelName||(t.modelName=this.name),t=Y.merge({name:{plural:Y.pluralize(t.modelName),singular:Y.singularize(t.modelName)},indexes:[],omitNull:n.omitNull,schema:n.schema},t),this.sequelize.runHooks("beforeDefine",e,t),t.modelName!==this.name&&Object.defineProperty(this,"name",{value:t.modelName}),delete t.modelName,this.options=ae({timestamps:!0,validate:{},freezeTableName:!1,underscored:!1,paranoid:!1,rejectOnEmpty:!1,whereCollection:null,schema:null,schemaDelimiter:"",defaultScope:{},scopes:{},indexes:[],whereMergeStrategy:"overwrite"},t),this.sequelize.isDefined(this.name)&&this.sequelize.modelManager.removeModel(this.sequelize.modelManager.getModel(this.name)),this.associations={},this._setupHooks(t.hooks),this.underscored=this.options.underscored,this.options.tableName?this.tableName=this.options.tableName:this.tableName=this.options.freezeTableName?this.name:Y.underscoredIf(Y.pluralize(this.name),this.underscored),this._schema=this.options.schema,this._schemaDelimiter=this.options.schemaDelimiter,z.each(t.validate,(O,T)=>{if(Object.prototype.hasOwnProperty.call(e,T))throw new Error(`A model validator function must not have the same name as a field. Model: ${this.name}, field/validation name: ${T}`);if(typeof O!="function")throw new Error(`Members of the validate option must be functions. Model: ${this.name}, error with validate member ${T}`)}),!z.includes(["and","overwrite"],this.options&&this.options.whereMergeStrategy))throw new Error(`Invalid value ${this.options&&this.options.whereMergeStrategy} for whereMergeStrategy. Allowed values are 'and' and 'overwrite'.`);this.rawAttributes=z.mapValues(e,(O,T)=>{if(O=this.sequelize.normalizeAttribute(O),O.type===void 0)throw new Error(`Unrecognized datatype for attribute "${this.name}.${T}"`);if(O.allowNull!==!1&&z.get(O,"validate.notNull"))throw new Error(`Invalid definition for "${this.name}.${T}", "notNull" validator is only allowed with "allowNull:false"`);return z.get(O,"references.model.prototype")instanceof Ve&&(O.references.model=O.references.model.getTableName()),O});const f=this.getTableName();if(this._indexes=this.options.indexes.map(O=>Y.nameIndex(this._conformIndex(O),f)),this.primaryKeys={},this._readOnlyAttributes=new Set,this._timestampAttributes={},this.options.timestamps){for(const O of["createdAt","updatedAt","deletedAt"]){if(!["undefined","string","boolean"].includes(typeof this.options[O]))throw new Error(`Value for "${O}" option must be a string or a boolean, got ${typeof this.options[O]}`);if(this.options[O]==="")throw new Error(`Value for "${O}" option cannot be an empty string`)}this.options.createdAt!==!1&&(this._timestampAttributes.createdAt=typeof this.options.createdAt=="string"?this.options.createdAt:"createdAt",this._readOnlyAttributes.add(this._timestampAttributes.createdAt)),this.options.updatedAt!==!1&&(this._timestampAttributes.updatedAt=typeof this.options.updatedAt=="string"?this.options.updatedAt:"updatedAt",this._readOnlyAttributes.add(this._timestampAttributes.updatedAt)),this.options.paranoid&&this.options.deletedAt!==!1&&(this._timestampAttributes.deletedAt=typeof this.options.deletedAt=="string"?this.options.deletedAt:"deletedAt",this._readOnlyAttributes.add(this._timestampAttributes.deletedAt))}return this.options.version&&(this._versionAttribute=typeof this.options.version=="string"?this.options.version:"version",this._readOnlyAttributes.add(this._versionAttribute)),this._hasReadOnlyAttributes=this._readOnlyAttributes.size>0,this._addDefaultAttributes(),this.refreshAttributes(),this._findAutoIncrementAttribute(),this._scope=this.options.defaultScope,this._scopeNames=["defaultScope"],this.sequelize.modelManager.addModel(this),this.sequelize.runHooks("afterDefine",this),this}static refreshAttributes(){const e={};this.prototype._customGetters={},this.prototype._customSetters={},["get","set"].forEach(t=>{const n=`${t}terMethods`,f=ae({},this.options[n]),O=t==="get"?this.prototype._customGetters:this.prototype._customSetters;z.each(f,(T,E)=>{O[E]=T,t==="get"&&(f[E]=function(){return this.get(E)}),t==="set"&&(f[E]=function(w){return this.set(E,w)})}),z.each(this.rawAttributes,(T,E)=>{Object.prototype.hasOwnProperty.call(T,t)&&(O[E]=T[t]),t==="get"&&(f[E]=function(){return this.get(E)}),t==="set"&&(f[E]=function(w){return this.set(E,w)})}),z.each(f,(T,E)=>{e[E]||(e[E]={configurable:!0}),e[E][t]=T})}),this._dataTypeChanges={},this._dataTypeSanitizers={},this._hasBooleanAttributes=!1,this._hasDateAttributes=!1,this._jsonAttributes=new Set,this._virtualAttributes=new Set,this._defaultValues={},this.prototype.validators={},this.fieldRawAttributesMap={},this.primaryKeys={},this.uniqueKeys={},z.each(this.rawAttributes,(t,n)=>{if(t.type=this.sequelize.normalizeDataType(t.type),t.Model=this,t.fieldName=n,t._modelAttribute=!0,t.field===void 0&&(t.field=Y.underscoredIf(n,this.underscored)),t.primaryKey===!0&&(this.primaryKeys[n]=t),this.fieldRawAttributesMap[t.field]=t,t.type._sanitize&&(this._dataTypeSanitizers[n]=t.type._sanitize),t.type._isChanged&&(this._dataTypeChanges[n]=t.type._isChanged),t.type instanceof Le.BOOLEAN?this._hasBooleanAttributes=!0:t.type instanceof Le.DATE||t.type instanceof Le.DATEONLY?this._hasDateAttributes=!0:t.type instanceof Le.JSON?this._jsonAttributes.add(n):t.type instanceof Le.VIRTUAL&&this._virtualAttributes.add(n),Object.prototype.hasOwnProperty.call(t,"defaultValue")&&(this._defaultValues[n]=()=>Y.toDefaultValue(t.defaultValue,this.sequelize.options.dialect)),Object.prototype.hasOwnProperty.call(t,"unique")&&t.unique){let f;typeof t.unique=="object"&&Object.prototype.hasOwnProperty.call(t.unique,"name")?f=t.unique.name:typeof t.unique=="string"?f=t.unique:f=`${this.tableName}_${n}_unique`;const O=this.uniqueKeys[f]||{fields:[]};O.fields.push(t.field),O.msg=O.msg||t.unique.msg||null,O.name=f||!1,O.column=n,O.customIndex=t.unique!==!0,this.uniqueKeys[f]=O}Object.prototype.hasOwnProperty.call(t,"validate")&&(this.prototype.validators[n]=t.validate),t.index===!0&&t.type instanceof Le.JSONB&&(this._indexes.push(Y.nameIndex(this._conformIndex({fields:[t.field||n],using:"gin"}),this.getTableName())),delete t.index)}),this.fieldAttributeMap=z.reduce(this.fieldRawAttributesMap,(t,n,f)=>(f!==n.fieldName&&(t[f]=n.fieldName),t),{}),this._hasJsonAttributes=!!this._jsonAttributes.size,this._hasVirtualAttributes=!!this._virtualAttributes.size,this._hasDefaultValues=!z.isEmpty(this._defaultValues),this.tableAttributes=z.omitBy(this.rawAttributes,(t,n)=>this._virtualAttributes.has(n)),this.prototype._hasCustomGetters=Object.keys(this.prototype._customGetters).length,this.prototype._hasCustomSetters=Object.keys(this.prototype._customSetters).length;for(const t of Object.keys(e)){if(Object.prototype.hasOwnProperty.call(Ve.prototype,t)){this.sequelize.log(`Not overriding built-in method from model attribute: ${t}`);continue}Object.defineProperty(this.prototype,t,e[t])}this.prototype.rawAttributes=this.rawAttributes,this.prototype._isAttribute=t=>Object.prototype.hasOwnProperty.call(this.prototype.rawAttributes,t),this.primaryKeyAttributes=Object.keys(this.primaryKeys),this.primaryKeyAttribute=this.primaryKeyAttributes[0],this.primaryKeyAttribute&&(this.primaryKeyField=this.rawAttributes[this.primaryKeyAttribute].field||this.primaryKeyAttribute),this._hasPrimaryKeys=this.primaryKeyAttributes.length>0,this._isPrimaryKey=t=>this.primaryKeyAttributes.includes(t),this._attributeManipulation=e}static removeAttribute(e){delete this.rawAttributes[e],this.refreshAttributes()}static async sync(e){e=ae(ae({},this.options),e),e.hooks=e.hooks===void 0?!0:!!e.hooks;const t=this.tableAttributes,n=this.fieldRawAttributesMap;e.hooks&&await this.runHooks("beforeSync",e);const f=this.getTableName(e);let O;if(e.force?(await this.drop(e),O=!1):O=await this.queryInterface.tableExists(f,e),O?await this.queryInterface.ensureEnums(f,t,e,this):await this.queryInterface.createTable(f,t,e,this),O&&e.alter){const w=await Promise.all([this.queryInterface.describeTable(f,e),this.queryInterface.getForeignKeyReferencesForTable(f,e)]),R=w[0],_=w[1],m={};for(const g in t)Object.prototype.hasOwnProperty.call(t,g)&&!R[g]&&!R[t[g].field]&&await this.queryInterface.addColumn(f,t[g].field||g,t[g],e);if(e.alter===!0||typeof e.alter=="object"&&e.alter.drop!==!1)for(const g in R){if(!Object.prototype.hasOwnProperty.call(R,g))continue;const N=n[g];if(!N){await this.queryInterface.removeColumn(f,g,e);continue}if(N.primaryKey)continue;const c=N.references;if(N.references){const l=this.sequelize.config.database,r=this.sequelize.config.schema;for(const i of _){const s=i.constraintName;s&&i.tableCatalog===l&&(!r||i.tableSchema===r)&&i.referencedTableName===c.model&&i.referencedColumnName===c.key&&(!r||i.referencedTableSchema===r)&&!m[s]&&(await this.queryInterface.removeConstraint(f,s,e),m[s]=!0)}}await this.queryInterface.changeColumn(f,g,N,e)}}const T=await this.queryInterface.showIndex(f,e),E=this._indexes.filter(w=>!T.some(R=>w.name===R.name)).sort((w,R)=>{if(this.sequelize.options.dialect==="postgres"){if(w.concurrently===!0)return 1;if(R.concurrently===!0)return-1}return 0});for(const w of E)await this.queryInterface.addIndex(f,ae(ae({},e),w));return e.hooks&&await this.runHooks("afterSync",e),this}static async drop(e){return await this.queryInterface.dropTable(this.getTableName(e),e)}static async dropSchema(e){return await this.queryInterface.dropSchema(e)}static schema(e,t){const n=class extends this{};return Object.defineProperty(n,"name",{value:this.name}),n._schema=e,t&&(typeof t=="string"?n._schemaDelimiter=t:t.schemaDelimiter&&(n._schemaDelimiter=t.schemaDelimiter)),n}static getTableName(){return this.queryGenerator.addSchema(this)}static unscoped(){return this.scope()}static addScope(e,t,n){if(n=ae({override:!1},n),(e==="defaultScope"&&Object.keys(this.options.defaultScope).length>0||e in this.options.scopes)&&n.override===!1)throw new Error(`The scope ${e} already exists. Pass { override: true } as options to silence this error`);e==="defaultScope"?this.options.defaultScope=this._scope=t:this.options.scopes[e]=t}static scope(e){const t=class extends this{};let n,f;if(Object.defineProperty(t,"name",{value:this.name}),t._scope={},t._scopeNames=[],t.scoped=!0,!e)return t;const O=z.flatten(arguments);for(const T of O)if(n=null,f=null,z.isPlainObject(T)?T.method?Array.isArray(T.method)&&t.options.scopes[T.method[0]]?(f=T.method[0],n=t.options.scopes[f].apply(t,T.method.slice(1))):t.options.scopes[T.method]&&(f=T.method,n=t.options.scopes[f].apply(t)):n=T:T==="defaultScope"&&z.isPlainObject(t.options.defaultScope)?n=t.options.defaultScope:(f=T,n=t.options.scopes[f],typeof n=="function"&&(n=n())),n)this._conformIncludes(n,this),this._assignOptions(t._scope,Y.cloneDeep(n)),t._scopeNames.push(f||"defaultScope");else throw new Ne.SequelizeScopeError(`Invalid scope ${f} called.`);return t}static async findAll(e){if(e!==void 0&&!z.isPlainObject(e))throw new Ne.QueryError("The argument passed to findAll must be an options object, use findByPk if you wish to pass a single primary key value");if(e!==void 0&&e.attributes&&!Array.isArray(e.attributes)&&!z.isPlainObject(e.attributes))throw new Ne.QueryError("The attributes option must be an array of column names or an object");this.warnOnInvalidOptions(e,Object.keys(this.rawAttributes));const t={};if(t[this.getTableName(e)]=!0,e=Y.cloneDeep(e),e.transaction===void 0&&this.sequelize.constructor._cls){const O=this.sequelize.constructor._cls.get("transaction");O&&(e.transaction=O)}z.defaults(e,{hooks:!0}),e.rejectOnEmpty=Object.prototype.hasOwnProperty.call(e,"rejectOnEmpty")?e.rejectOnEmpty:this.options.rejectOnEmpty,this._injectScope(e),e.hooks&&await this.runHooks("beforeFind",e),this._conformIncludes(e,this),this._expandAttributes(e),this._expandIncludeAll(e),e.hooks&&await this.runHooks("beforeFindAfterExpandIncludeAll",e),e.originalAttributes=this._injectDependentVirtualAttributes(e.attributes),e.include&&(e.hasJoin=!0,this._validateIncludedElements(e,t),e.attributes&&!e.raw&&this.primaryKeyAttribute&&!e.attributes.includes(this.primaryKeyAttribute)&&(!e.group||!e.hasSingleAssociation||e.hasMultiAssociation)&&(e.attributes=[this.primaryKeyAttribute].concat(e.attributes))),e.attributes||(e.attributes=Object.keys(this.rawAttributes),e.originalAttributes=this._injectDependentVirtualAttributes(e.attributes)),this.options.whereCollection=e.where||null,Y.mapFinderOptions(e,this),e=this._paranoidClause(this,e),e.hooks&&await this.runHooks("beforeFindAfterOptions",e);const n=Ke(ae({},e),{tableNames:Object.keys(t)}),f=await this.queryInterface.select(this,this.getTableName(n),n);if(e.hooks&&await this.runHooks("afterFind",f,e),z.isEmpty(f)&&e.rejectOnEmpty)throw typeof e.rejectOnEmpty=="function"?new e.rejectOnEmpty:typeof e.rejectOnEmpty=="object"?e.rejectOnEmpty:new Ne.EmptyResultError;return await Ve._findSeparate(f,e)}static warnOnInvalidOptions(e,t){if(!z.isPlainObject(e))return;const n=Object.keys(e).filter(O=>!qo.has(O)),f=z.intersection(n,t);!e.where&&f.length>0&&Br.warn(`Model attributes (${f.join(", ")}) passed into finder method options of model ${this.name}, but the options.where object is empty. Did you forget to use options.where?`)}static _injectDependentVirtualAttributes(e){if(!this._hasVirtualAttributes||!e||!Array.isArray(e))return e;for(const t of e)this._virtualAttributes.has(t)&&this.rawAttributes[t].type.fields&&(e=e.concat(this.rawAttributes[t].type.fields));return e=z.uniq(e),e}static async _findSeparate(e,t){if(!t.include||t.raw||!e)return e;const n=e;return t.plain&&(e=[e]),e.length&&await Promise.all(t.include.map(async f=>{if(!f.separate)return await Ve._findSeparate(e.reduce((T,E)=>{let w=E.get(f.association.as);if(!w)return T;Array.isArray(w)||(w=[w]);for(let R=0,_=w.length;R!==_;++R)T.push(w[R]);return T},[]),Ke(ae({},z.omit(t,"include","attributes","order","where","limit","offset","plain","scope")),{include:f.include||[]}));const O=await f.association.get(e,ae(ae({},z.omit(t,Co)),z.omit(f,["parent","association","as","originalAttributes"])));for(const T of e)T.set(f.association.as,O[T.get(f.association.sourceKey)],{raw:!0})})),n}static async findByPk(e,t){if([null,void 0].includes(e))return null;if(t=Y.cloneDeep(t)||{},typeof e=="number"||typeof e=="bigint"||typeof e=="string"||Buffer.isBuffer(e))t.where={[this.primaryKeyAttribute]:e};else throw new Error(`Argument passed to findByPk is invalid: ${e}`);return await this.findOne(t)}static async findOne(e){if(e!==void 0&&!z.isPlainObject(e))throw new Error("The argument passed to findOne must be an options object, use findByPk if you wish to pass a single primary key value");if(e=Y.cloneDeep(e),e.transaction===void 0&&this.sequelize.constructor._cls){const t=this.sequelize.constructor._cls.get("transaction");t&&(e.transaction=t)}if(e.limit===void 0){const t=z.chain(this.uniqueKeys).values().filter(n=>n.fields.length===1).map("column").value();(!e.where||!z.some(e.where,(n,f)=>(f===this.primaryKeyAttribute||t.includes(f))&&(Y.isPrimitive(n)||Buffer.isBuffer(n))))&&(e.limit=1)}return await this.findAll(z.defaults(e,{plain:!0}))}static async aggregate(e,t,n){n=Y.cloneDeep(n);const f=n.attributes;this._injectScope(n),n.attributes=f,this._conformIncludes(n,this),n.include&&(this._expandIncludeAll(n),this._validateIncludedElements(n));const O=this.rawAttributes[e],T=O&&O.field||e;let E=this.sequelize.col(T);n.distinct&&(E=this.sequelize.fn("DISTINCT",E));let{group:w}=n;return Array.isArray(w)&&Array.isArray(w[0])&&(Ro(),w=z.flatten(w)),n.attributes=z.unionBy(n.attributes,w,[[this.sequelize.fn(t,E),t]],_=>Array.isArray(_)?_[1]:_),n.dataType?n.dataType=this.sequelize.normalizeDataType(n.dataType):O?n.dataType=O.type:n.dataType=new Le.FLOAT,Y.mapOptionFieldNames(n,this),n=this._paranoidClause(this,n),await this.queryInterface.rawSelect(this.getTableName(n),n,t,this)}static async count(e){if(e=Y.cloneDeep(e),e=z.defaults(e,{hooks:!0}),e.transaction===void 0&&this.sequelize.constructor._cls){const f=this.sequelize.constructor._cls.get("transaction");f&&(e.transaction=f)}e.raw=!0,e.hooks&&await this.runHooks("beforeCount",e);let t=e.col||"*";e.include&&(t=`${this.name}.${e.col||this.primaryKeyField}`),e.distinct&&t==="*"&&(t=this.primaryKeyField),e.plain=!e.group,e.dataType=new Le.INTEGER,e.includeIgnoreAttributes=!1,e.limit=null,e.offset=null,e.order=null;const n=await this.aggregate(t,"count",e);return Array.isArray(n)?n.map(f=>Ke(ae({},f),{count:Number(f.count)})):n}static async findAndCountAll(e){if(e!==void 0&&!z.isPlainObject(e))throw new Error("The argument passed to findAndCountAll must be an options object, use findByPk if you wish to pass a single primary key value");const t=Y.cloneDeep(e);t.attributes&&(t.attributes=void 0);const[n,f]=await Promise.all([this.count(t),this.findAll(e)]);return{count:n,rows:n===0?[]:f}}static async max(e,t){return await this.aggregate(e,"max",t)}static async min(e,t){return await this.aggregate(e,"min",t)}static async sum(e,t){return await this.aggregate(e,"sum",t)}static build(e,t){return Array.isArray(e)?this.bulkBuild(e,t):new this(e,t)}static bulkBuild(e,t){return t=ae({isNewRecord:!0},t),t.includeValidated||(this._conformIncludes(t,this),t.include&&(this._expandIncludeAll(t),this._validateIncludedElements(t))),t.attributes&&(t.attributes=t.attributes.map(n=>Array.isArray(n)?n[1]:n)),e.map(n=>this.build(n,t))}static async create(e,t){return t=Y.cloneDeep(t||{}),await this.build(e,{isNewRecord:!0,attributes:t.fields,include:t.include,raw:t.raw,silent:t.silent}).save(t)}static async findOrBuild(e){if(!e||!e.where||arguments.length>1)throw new Error("Missing where attribute in the options parameter passed to findOrBuild. Please note that the API has changed, and is now options only (an object with where, defaults keys, transaction etc.)");let t,n=await this.findOne(e);return n===null?(t=ae({},e.defaults),z.isPlainObject(e.where)&&(t=Y.defaults(t,e.where)),n=this.build(t,e),[n,!0]):[n,!1]}static async findOrCreate(e){if(!e||!e.where||arguments.length>1)throw new Error("Missing where attribute in the options parameter passed to findOrCreate. Please note that the API has changed, and is now options only (an object with where, defaults keys, transaction etc.)");if(e=ae({},e),e.defaults){const T=Object.keys(e.defaults).filter(E=>!this.rawAttributes[E]);T.length&&Br.warn(`Unknown attributes (${T}) passed to defaults option of findOrCreate`)}if(e.transaction===void 0&&this.sequelize.constructor._cls){const O=this.sequelize.constructor._cls.get("transaction");O&&(e.transaction=O)}const t=!e.transaction;let n,f;try{const O=await this.sequelize.transaction(e);f=O,e.transaction=O;const T=await this.findOne(Y.defaults({transaction:f},e));if(T!==null)return[T,!1];n=ae({},e.defaults),z.isPlainObject(e.where)&&(n=Y.defaults(n,e.where)),e.exception=!0,e.returning=!0;try{const E=await this.create(n,e);if(E.get(this.primaryKeyAttribute,{raw:!0})===null)throw new Ne.UniqueConstraintError;return[E,!0]}catch(E){if(!(E instanceof Ne.UniqueConstraintError))throw E;const w=Y.flattenObjectDeep(e.where),_=Object.keys(w).map(l=>z.last(l.split("."))).map(l=>z.get(this.rawAttributes,`${l}.field`,l)),m=e.defaults&&Object.keys(e.defaults).filter(l=>this.rawAttributes[l]).map(l=>this.rawAttributes[l].field||l),g=Object.keys(E.fields),N=Y.intersects(g,_);if(m&&!N&&Y.intersects(g,m))throw E;N&&z.each(E.fields,(l,r)=>{const i=this.fieldRawAttributesMap[r].fieldName;if(l.toString()!==e.where[i].toString())throw new Error(`${this.name}#findOrCreate: value used for ${i} was not equal for both the find and the create calls, '${e.where[i]}' vs '${l}'`)});const c=await this.findOne(Y.defaults({transaction:t?null:f},e));if(c===null)throw E;return[c,!1]}}finally{t&&f&&await f.commit()}}static async findCreateFind(e){if(!e||!e.where)throw new Error("Missing where attribute in the options parameter passed to findCreateFind.");let t=ae({},e.defaults);z.isPlainObject(e.where)&&(t=Y.defaults(t,e.where));const n=await this.findOne(e);if(n)return[n,!1];try{const f=ae({},e);return this.sequelize.options.dialect==="postgres"&&e.transaction&&(f.ignoreDuplicates=!0),[await this.create(t,f),!0]}catch(f){if(!(f instanceof Ne.UniqueConstraintError||f instanceof Ne.EmptyResultError))throw f;return[await this.findOne(e),!1]}}static async upsert(e,t){if(t=ae({hooks:!0,returning:!0,validate:!0},Y.cloneDeep(t)),t.transaction===void 0&&this.sequelize.constructor._cls){const c=this.sequelize.constructor._cls.get("transaction");c&&(t.transaction=c)}const n=this._timestampAttributes.createdAt,f=this._timestampAttributes.updatedAt,O=this.primaryKeyField in e||this.primaryKeyAttribute in e,T=this.build(e);t.model=this,t.instance=T;const E=Array.from(T._changed);t.fields||(t.fields=E),t.validate&&await T.validate(t);const w=z.pick(T.dataValues,E),R=Y.mapValueFieldNames(T.dataValues,Object.keys(T.rawAttributes),this),_=Y.mapValueFieldNames(w,t.fields,this),m=Y.now(this.sequelize.options.dialect);if(n&&!R[n]){const c=this.rawAttributes[n].field||n;R[c]=this._getDefaultTimestamp(n)||m}if(f&&!R[f]){const c=this.rawAttributes[f].field||f;R[c]=_[c]=this._getDefaultTimestamp(f)||m}this.sequelize.options.dialect==="db2"&&(this.uniqno=this.sequelize.dialect.queryGenerator.addUniqueFields(R,this.rawAttributes,this.uniqno)),!O&&this.primaryKeyAttribute&&!this.rawAttributes[this.primaryKeyAttribute].defaultValue&&(delete R[this.primaryKeyField],delete _[this.primaryKeyField]),t.hooks&&await this.runHooks("beforeUpsert",e,t);const g=await this.queryInterface.upsert(this.getTableName(t),R,_,T.where(),t),[N]=g;return N.isNewRecord=!1,t.hooks&&await this.runHooks("afterUpsert",g,t),g}static async bulkCreate(e,t={}){if(!e.length)return[];const n=this.sequelize.options.dialect,f=Y.now(this.sequelize.options.dialect);if(t=Y.cloneDeep(t),t.transaction===void 0&&this.sequelize.constructor._cls){const E=this.sequelize.constructor._cls.get("transaction");E&&(t.transaction=E)}t.model=this,t.includeValidated||(this._conformIncludes(t,this),t.include&&(this._expandIncludeAll(t),this._validateIncludedElements(t)));const O=e.map(E=>this.build(E,{isNewRecord:!0,include:t.include})),T=async(E,w)=>{if(w=ae({validate:!1,hooks:!0,individualHooks:!1,ignoreDuplicates:!1},w),w.returning===void 0&&(w.association?w.returning=!1:w.returning=!0),w.ignoreDuplicates&&!this.sequelize.dialect.supports.inserts.ignoreDuplicates&&!this.sequelize.dialect.supports.inserts.onConflictDoNothing)throw new Error(`${n} does not support the ignoreDuplicates option.`);if(w.updateOnDuplicate&&n!=="mysql"&&n!=="mariadb"&&n!=="sqlite"&&n!=="postgres")throw new Error(`${n} does not support the updateOnDuplicate option.`);const R=w.model;w.fields=w.fields||Object.keys(R.rawAttributes);const _=R._timestampAttributes.createdAt,m=R._timestampAttributes.updatedAt;if(w.updateOnDuplicate!==void 0)if(Array.isArray(w.updateOnDuplicate)&&w.updateOnDuplicate.length)w.updateOnDuplicate=z.intersection(z.without(Object.keys(R.tableAttributes),_),w.updateOnDuplicate);else throw new Error("updateOnDuplicate option only supports non-empty array.");if(w.hooks&&await R.runHooks("beforeBulkCreate",E,w),w.validate){const g=[],N=ae({},w);if(N.hooks=w.individualHooks,await Promise.all(E.map(async c=>{try{await c.validate(N)}catch(l){g.push(new Ne.BulkRecordError(l,c))}})),delete w.skip,g.length)throw new Ne.AggregateError(g)}if(w.individualHooks)await Promise.all(E.map(async g=>{const N=Ke(ae({},w),{validate:!1,hooks:!0});delete N.fields,delete N.individualHooks,delete N.ignoreDuplicates,await g.save(N)}));else{w.include&&w.include.length&&await Promise.all(w.include.filter(c=>c.association instanceof er).map(async c=>{const l=[],r=[];for(const a of E){const d=a.get(c.as);d&&(l.push(d),r.push(a))}if(!l.length)return;const i=z(Y.cloneDeep(c)).omit(["association"]).defaults({transaction:w.transaction,logging:w.logging}).value(),s=await T(l,i);for(const a in s){const d=s[a],y=r[a];await c.association.set(y,d,{save:!1,logging:w.logging})}})),e=E.map(c=>{const l=c.dataValues;_&&!l[_]&&(l[_]=f,w.fields.includes(_)||w.fields.push(_)),m&&!l[m]&&(l[m]=f,w.fields.includes(m)||w.fields.push(m));const r=Y.mapValueFieldNames(l,w.fields,R);for(const i of R._virtualAttributes)delete r[i];return r});const g={};for(const c in R.tableAttributes)g[R.rawAttributes[c].field||c]=R.rawAttributes[c];if(w.updateOnDuplicate)if(w.updateOnDuplicate=w.updateOnDuplicate.map(c=>R.rawAttributes[c].field||c),w.conflictAttributes)w.upsertKeys=w.conflictAttributes.map(c=>R.rawAttributes[c].field||c);else{const c=[];for(const r of R._indexes)r.unique&&!r.where&&c.push(...r.fields);const l=Object.values(R.uniqueKeys).find(r=>r.fields.length>0);l&&l.fields&&c.push(...l.fields),w.upsertKeys=c.length>0?c:Object.values(R.primaryKeys).map(r=>r.field)}w.returning&&Array.isArray(w.returning)&&(w.returning=w.returning.map(c=>z.get(R.rawAttributes[c],"field",c)));const N=await R.queryInterface.bulkInsert(R.getTableName(w),e,w,g);Array.isArray(N)&&N.forEach((c,l)=>{const r=E[l];for(const i in c)if(!(!r||i===R.primaryKeyAttribute&&r.get(R.primaryKeyAttribute)&&["mysql","mariadb","sqlite"].includes(n))&&Object.prototype.hasOwnProperty.call(c,i)){const s=c[i],a=z.find(R.rawAttributes,d=>d.fieldName===i||d.field===i);r.dataValues[a&&a.fieldName||i]=s}})}return w.include&&w.include.length&&await Promise.all(w.include.filter(g=>!(g.association instanceof er||g.parent&&g.parent.association instanceof gt)).map(async g=>{const N=[],c=[];for(const i of E){let s=i.get(g.as);Array.isArray(s)||(s=[s]);for(const a of s)a&&(g.association instanceof gt||(a.set(g.association.foreignKey,i.get(g.association.sourceKey||i.constructor.primaryKeyAttribute,{raw:!0}),{raw:!0}),Object.assign(a,g.association.scope)),N.push(a),c.push(i))}if(!N.length)return;const l=z(Y.cloneDeep(g)).omit(["association"]).defaults({transaction:w.transaction,logging:w.logging}).value(),r=await T(N,l);if(g.association instanceof gt){const i=[];for(const d in r){const y=r[d],o=c[d],p=ae({[g.association.foreignKey]:o.get(o.constructor.primaryKeyAttribute,{raw:!0}),[g.association.otherKey]:y.get(y.constructor.primaryKeyAttribute,{raw:!0})},g.association.through.scope);if(y[g.association.through.model.name])for(const b of Object.keys(g.association.through.model.rawAttributes))g.association.through.model.rawAttributes[b]._autoGenerated||b===g.association.foreignKey||b===g.association.otherKey||typeof y[g.association.through.model.name][b]>"u"||(p[b]=y[g.association.through.model.name][b]);i.push(p)}const s=z(Y.cloneDeep(g)).omit(["association","attributes"]).defaults({transaction:w.transaction,logging:w.logging}).value();s.model=g.association.throughModel;const a=g.association.throughModel.bulkBuild(i,s);await T(a,s)}})),E.forEach(g=>{for(const N in R.rawAttributes)R.rawAttributes[N].field&&g.dataValues[R.rawAttributes[N].field]!==void 0&&R.rawAttributes[N].field!==N&&(g.dataValues[N]=g.dataValues[R.rawAttributes[N].field],delete g.dataValues[R.rawAttributes[N].field]),g._previousDataValues[N]=g.dataValues[N],g.changed(N,!1);g.isNewRecord=!1}),w.hooks&&await R.runHooks("afterBulkCreate",E,w),E};return await T(O,t)}static async truncate(e){return e=Y.cloneDeep(e)||{},e.truncate=!0,await this.destroy(e)}static async destroy(e){if(e=Y.cloneDeep(e),e.transaction===void 0&&this.sequelize.constructor._cls){const f=this.sequelize.constructor._cls.get("transaction");f&&(e.transaction=f)}if(this._injectScope(e),!e||!(e.where||e.truncate))throw new Error("Missing where or truncate attribute in the options parameter of model.destroy.");if(!e.truncate&&!z.isPlainObject(e.where)&&!Array.isArray(e.where)&&!(e.where instanceof Y.SequelizeMethod))throw new Error("Expected plain object, array or sequelize method in the options.where parameter of model.destroy.");e=z.defaults(e,{hooks:!0,individualHooks:!1,force:!1,cascade:!1,restartIdentity:!1}),e.type=_t.BULKDELETE,Y.mapOptionFieldNames(e,this),e.model=this,e.hooks&&await this.runHooks("beforeBulkDestroy",e);let t;e.individualHooks&&(t=await this.findAll({where:e.where,transaction:e.transaction,logging:e.logging,benchmark:e.benchmark}),await Promise.all(t.map(f=>this.runHooks("beforeDestroy",f,e))));let n;if(this._timestampAttributes.deletedAt&&!e.force){e.type=_t.BULKUPDATE;const f={},O=this.rawAttributes[this._timestampAttributes.deletedAt],T=this.rawAttributes[this._timestampAttributes.deletedAt].field,E={[T]:Object.prototype.hasOwnProperty.call(O,"defaultValue")?O.defaultValue:null};f[T]=Y.now(this.sequelize.options.dialect),n=await this.queryInterface.bulkUpdate(this.getTableName(e),f,Object.assign(E,e.where),e,this.rawAttributes)}else n=await this.queryInterface.bulkDelete(this.getTableName(e),e.where,e,this);return e.individualHooks&&await Promise.all(t.map(f=>this.runHooks("afterDestroy",f,e))),e.hooks&&await this.runHooks("afterBulkDestroy",e),n}static async restore(e){if(!this._timestampAttributes.deletedAt)throw new Error("Model is not paranoid");if(e=ae({hooks:!0,individualHooks:!1},e),e.transaction===void 0&&this.sequelize.constructor._cls){const w=this.sequelize.constructor._cls.get("transaction");w&&(e.transaction=w)}e.type=_t.RAW,e.model=this,Y.mapOptionFieldNames(e,this),e.hooks&&await this.runHooks("beforeBulkRestore",e);let t;e.individualHooks&&(t=await this.findAll({where:e.where,transaction:e.transaction,logging:e.logging,benchmark:e.benchmark,paranoid:!1}),await Promise.all(t.map(w=>this.runHooks("beforeRestore",w,e))));const n={},f=this._timestampAttributes.deletedAt,O=this.rawAttributes[f],T=Object.prototype.hasOwnProperty.call(O,"defaultValue")?O.defaultValue:null;n[O.field||f]=T,e.omitNull=!1;const E=await this.queryInterface.bulkUpdate(this.getTableName(e),n,e.where,e,this.rawAttributes);return e.individualHooks&&await Promise.all(t.map(w=>this.runHooks("afterRestore",w,e))),e.hooks&&await this.runHooks("afterBulkRestore",e),E}static async update(e,t){if(t=Y.cloneDeep(t),t.transaction===void 0&&this.sequelize.constructor._cls){const E=this.sequelize.constructor._cls.get("transaction");E&&(t.transaction=E)}if(this._injectScope(t),this._optionsMustContainWhere(t),t=this._paranoidClause(this,z.defaults(t,{validate:!0,hooks:!0,individualHooks:!1,returning:!1,force:!1,sideEffects:!0})),t.type=_t.BULKUPDATE,e=z.omitBy(e,E=>E===void 0),t.fields&&t.fields instanceof Array)for(const E of Object.keys(e))t.fields.includes(E)||delete e[E];else{const E=this._timestampAttributes.updatedAt;t.fields=z.intersection(Object.keys(e),Object.keys(this.tableAttributes)),E&&!t.fields.includes(E)&&t.fields.push(E)}this._timestampAttributes.updatedAt&&!t.silent&&(e[this._timestampAttributes.updatedAt]=this._getDefaultTimestamp(this._timestampAttributes.updatedAt)||Y.now(this.sequelize.options.dialect)),t.model=this;let n;if(t.validate){const E=this.build(e);E.set(this._timestampAttributes.updatedAt,e[this._timestampAttributes.updatedAt],{raw:!0}),t.sideEffects&&(Object.assign(e,z.pick(E.get(),E.changed())),t.fields=z.union(t.fields,Object.keys(e))),t.skip=z.difference(Object.keys(this.rawAttributes),Object.keys(e));const w=await E.validate(t);t.skip=void 0,w&&w.dataValues&&(e=z.pick(w.dataValues,Object.keys(e)))}t.hooks&&(t.attributes=e,await this.runHooks("beforeBulkUpdate",t),e=t.attributes,delete t.attributes),n=e;let f,O=!1;if(t.individualHooks&&(f=await this.findAll({where:t.where,transaction:t.transaction,logging:t.logging,benchmark:t.benchmark,paranoid:t.paranoid}),f.length)){let E,w=!1;if(f=await Promise.all(f.map(async R=>{if(Object.assign(R.dataValues,e),z.forIn(n,(_,m)=>{_!==R._previousDataValues[m]&&R.setDataValue(m,_)}),await this.runHooks("beforeUpdate",R,t),!w){const _={};z.forIn(R.dataValues,(m,g)=>{m!==R._previousDataValues[g]&&(_[g]=m)}),E?w=!z.isEqual(E,_):E=_}return R})),w)f=await Promise.all(f.map(async R=>{const _=Ke(ae({},t),{hooks:!1,validate:!1});return delete _.individualHooks,R.save(_)})),O=!0;else{const R=Object.keys(E);R.length&&(n=E,t.fields=z.union(t.fields,R))}}let T;if(O)T=[f.length,f];else if(z.isEmpty(n)||Object.keys(n).length===1&&n[this._timestampAttributes.updatedAt])T=[0];else{n=Y.mapValueFieldNames(n,t.fields,this),t=Y.mapOptionFieldNames(t,this),t.hasTrigger=this.options?this.options.hasTrigger:!1;const E=await this.queryInterface.bulkUpdate(this.getTableName(t),n,t.where,t,this.tableAttributes);t.returning?(T=[E.length,E],f=E):T=[E]}return t.individualHooks&&(await Promise.all(f.map(E=>this.runHooks("afterUpdate",E,t))),T[1]=f),t.hooks&&(t.attributes=e,await this.runHooks("afterBulkUpdate",t),delete t.attributes),T}static async describe(e,t){return await this.queryInterface.describeTable(this.tableName,ae({schema:e||this._schema||void 0},t))}static _getDefaultTimestamp(e){if(this.rawAttributes[e]&&this.rawAttributes[e].defaultValue)return Y.toDefaultValue(this.rawAttributes[e].defaultValue,this.sequelize.options.dialect)}static _expandAttributes(e){if(!z.isPlainObject(e.attributes))return;let t=Object.keys(this.rawAttributes);e.attributes.exclude&&(t=t.filter(n=>!e.attributes.exclude.includes(n))),e.attributes.include&&(t=t.concat(e.attributes.include)),e.attributes=t}static _injectScope(e){const t=Y.cloneDeep(this._scope);this._defaultsOptions(e,t)}static[Symbol.for("nodejs.util.inspect.custom")](){return this.name}static hasAlias(e){return Object.prototype.hasOwnProperty.call(this.associations,e)}static async increment(e,t){t=t||{},typeof e=="string"&&(e=[e]),Array.isArray(e)?e=e.map(_=>this.rawAttributes[_]&&this.rawAttributes[_].field&&this.rawAttributes[_].field!==_?this.rawAttributes[_].field:_):e&&typeof e=="object"&&(e=Object.keys(e).reduce((_,m)=>(this.rawAttributes[m]&&this.rawAttributes[m].field&&this.rawAttributes[m].field!==m?_[this.rawAttributes[m].field]=e[m]:_[m]=e[m],_),{})),this._injectScope(t),this._optionsMustContainWhere(t),t=Y.defaults({},t,{by:1,where:{},increment:!0});const n=!t.increment;Y.mapOptionFieldNames(t,this);const f=ae({},t.where);let O={};if(Array.isArray(e)){O={};for(const _ of e)O[_]=t.by}else O=e;this._versionAttribute&&(O[this._versionAttribute]=n?-1:1);const T={},E=this._timestampAttributes.updatedAt;if(!t.silent&&E&&!O[E]){const _=this.rawAttributes[E].field||E;T[_]=this._getDefaultTimestamp(E)||Y.now(this.sequelize.options.dialect)}const w=this.getTableName(t);let R;return n?R=await this.queryInterface.decrement(this,w,f,O,T,t):R=await this.queryInterface.increment(this,w,f,O,T,t),t.returning?[R,R.length]:[R]}static async decrement(e,t){return this.increment(e,Ke(ae({by:1},t),{increment:!1}))}static _optionsMustContainWhere(e){Oi(e&&e.where,"Missing where attribute in the options parameter"),Oi(z.isPlainObject(e.where)||Array.isArray(e.where)||e.where instanceof Y.SequelizeMethod,"Expected plain object, array or sequelize method in the options.where parameter")}where(e){const t=this.constructor.primaryKeyAttributes.reduce((f,O)=>(f[O]=this.get(O,{raw:!0}),f),{});if(z.size(t)===0)return this.constructor.options.whereCollection;const n=this.constructor._versionAttribute;return e&&n&&(t[n]=this.get(n,{raw:!0})),Y.mapWhereFieldNames(t,this.constructor)}toString(){return`[object SequelizeInstance:${this.constructor.name}]`}getDataValue(e){return this.dataValues[e]}setDataValue(e,t){const n=this._previousDataValues[e];z.isEqual(t,n)||this.changed(e,!0),this.dataValues[e]=t}get(e,t){if(t===void 0&&typeof e=="object"&&(t=e,e=void 0),t=t||{},e)return Object.prototype.hasOwnProperty.call(this._customGetters,e)&&!t.raw?this._customGetters[e].call(this,e,t):t.plain&&this._options.include&&this._options.includeNames.includes(e)?Array.isArray(this.dataValues[e])?this.dataValues[e].map(n=>n.get(t)):this.dataValues[e]instanceof Ve?this.dataValues[e].get(t):this.dataValues[e]:this.dataValues[e];if(this._hasCustomGetters||t.plain&&this._options.include||t.clone){const n={};let f;if(this._hasCustomGetters)for(f in this._customGetters)this._options.attributes&&!this._options.attributes.includes(f)||Object.prototype.hasOwnProperty.call(this._customGetters,f)&&(n[f]=this.get(f,t));for(f in this.dataValues)!Object.prototype.hasOwnProperty.call(n,f)&&Object.prototype.hasOwnProperty.call(this.dataValues,f)&&(n[f]=this.get(f,t));return n}return this.dataValues}set(e,t,n){let f,O;if(typeof e=="object"&&e!==null){if(f=e,n=t||{},n.reset){this.dataValues={};for(const T in f)this.changed(T,!1)}if(n.raw&&!(this._options&&this._options.include)&&!(n&&n.attributes)&&!this.constructor._hasDateAttributes&&!this.constructor._hasBooleanAttributes)Object.keys(this.dataValues).length?Object.assign(this.dataValues,f):this.dataValues=f,this._previousDataValues=ae({},this.dataValues);else{if(n.attributes){const T=E=>{for(const w of E)f[w]!==void 0&&this.set(w,f[w],n)};T(n.attributes),this.constructor._hasVirtualAttributes&&T(this.constructor._virtualAttributes),this._options.includeNames&&T(this._options.includeNames)}else for(const T in f)this.set(T,f[T],n);n.raw&&(this._previousDataValues=ae({},this.dataValues))}return this}if(n||(n={}),n.raw||(O=this.dataValues[e]),!n.raw&&this._customSetters[e]){this._customSetters[e].call(this,t,e);const T=this.dataValues[e];z.isEqual(T,O)||(this._previousDataValues[e]=O,this.changed(e,!0))}else{if(this._options&&this._options.include&&this._options.includeNames.includes(e))return this._setInclude(e,t,n),this;if(!n.raw){if(!this._isAttribute(e)){if(e.includes(".")&&this.constructor._jsonAttributes.has(e.split(".")[0])){const T=bi.get(this.dataValues,e);z.isEqual(T,t)||(bi.set(this.dataValues,e,t),this.changed(e.split(".")[0],!0))}return this}if(this.constructor._hasPrimaryKeys&&O&&this.constructor._isPrimaryKey(e))return this;if(!this.isNewRecord&&this.constructor._hasReadOnlyAttributes&&this.constructor._readOnlyAttributes.has(e))return this}!(t instanceof Y.SequelizeMethod)&&Object.prototype.hasOwnProperty.call(this.constructor._dataTypeSanitizers,e)&&(t=this.constructor._dataTypeSanitizers[e].call(this,t,n)),!n.raw&&(t instanceof Y.SequelizeMethod||!(t instanceof Y.SequelizeMethod)&&this.constructor._dataTypeChanges[e]&&this.constructor._dataTypeChanges[e].call(this,t,O,n)||!this.constructor._dataTypeChanges[e]&&!z.isEqual(t,O))&&(this._previousDataValues[e]=O,this.changed(e,!0)),this.dataValues[e]=t}return this}setAttributes(e){return this.set(e)}changed(e,t){return e===void 0?this._changed.size>0?Array.from(this._changed):!1:t===!0?(this._changed.add(e),this):t===!1?(this._changed.delete(e),this):this._changed.has(e)}previous(e){return e?this._previousDataValues[e]:z.pickBy(this._previousDataValues,(t,n)=>this.changed(n))}_setInclude(e,t,n){Array.isArray(t)||(t=[t]),t[0]instanceof Ve&&(t=t.map(_=>_.dataValues));const f=this._options.includeMap[e],O=f.association,T=e,E=f.model.primaryKeyAttribute,w={isNewRecord:this.isNewRecord,include:f.include,includeNames:f.includeNames,includeMap:f.includeMap,includeValidated:!0,raw:n.raw,attributes:f.originalAttributes};let R;(f.originalAttributes===void 0||f.originalAttributes.length)&&(O.isSingleAssociation?(Array.isArray(t)&&(t=t[0]),R=t&&t[E]===null||t===null,this[T]=this.dataValues[T]=R?null:f.model.build(t,w)):(R=t[0]&&t[0][E]===null,this[T]=this.dataValues[T]=R?[]:f.model.bulkBuild(t,w)))}async save(e){if(arguments.length>1)throw new Error("The second argument was removed in favor of the options object.");if(e=Y.cloneDeep(e),e.transaction===void 0&&this.sequelize.constructor._cls){const s=this.sequelize.constructor._cls.get("transaction");s&&(e.transaction=s)}e=z.defaults(e,{hooks:!0,validate:!0}),e.fields||(this.isNewRecord?e.fields=Object.keys(this.constructor.rawAttributes):e.fields=z.intersection(this.changed(),Object.keys(this.constructor.rawAttributes)),e.defaultFields=e.fields),e.returning===void 0&&(e.association?e.returning=!1:this.isNewRecord&&(e.returning=!0));const t=this.constructor.primaryKeyAttribute,n=t&&this.constructor.rawAttributes[t],f=this.constructor._timestampAttributes.createdAt,O=this.constructor._versionAttribute,T=this.isNewRecord?"Create":"Update",E=this.isNewRecord,w=Y.now(this.sequelize.options.dialect);let R=this.constructor._timestampAttributes.updatedAt;if(R&&e.fields.length>0&&!e.fields.includes(R)&&e.fields.push(R),O&&e.fields.length>0&&!e.fields.includes(O)&&e.fields.push(O),e.silent===!0&&!(this.isNewRecord&&this.get(R,{raw:!0}))&&(z.remove(e.fields,s=>s===R),R=!1),this.isNewRecord===!0&&(f&&!e.fields.includes(f)&&e.fields.push(f),n&&n.defaultValue&&!e.fields.includes(t)&&e.fields.unshift(t)),this.isNewRecord===!1&&t&&this.get(t,{raw:!0})===void 0)throw new Error("You attempted to save an instance with no primary key, this is not allowed since it would result in a global update");if(R&&!e.silent&&e.fields.includes(R)&&(this.dataValues[R]=this.constructor._getDefaultTimestamp(R)||w),this.isNewRecord&&f&&!this.dataValues[f]&&(this.dataValues[f]=this.constructor._getDefaultTimestamp(f)||w),this.sequelize.options.dialect==="db2"&&this.isNewRecord&&(this.uniqno=this.sequelize.dialect.queryGenerator.addUniqueFields(this.dataValues,this.constructor.rawAttributes,this.uniqno)),e.validate&&await this.validate(e),e.hooks){const s=z.pick(this.dataValues,e.fields);let a=z.difference(this.changed(),e.fields),d,y;if(R&&e.fields.includes(R)&&(a=z.without(a,R)),await this.constructor.runHooks(`before${T}`,this,e),e.defaultFields&&!this.isNewRecord){y=z.pick(this.dataValues,z.difference(this.changed(),a)),d=[];for(const o of Object.keys(y))y[o]!==s[o]&&d.push(o);e.fields=z.uniq(e.fields.concat(d))}d&&e.validate&&(e.skip=z.difference(Object.keys(this.constructor.rawAttributes),d),await this.validate(e),delete e.skip)}if(e.fields.length&&this.isNewRecord&&this._options.include&&this._options.include.length&&await Promise.all(this._options.include.filter(s=>s.association instanceof er).map(async s=>{const a=this.get(s.as);if(!a)return;const d=z(Y.cloneDeep(s)).omit(["association"]).defaults({transaction:e.transaction,logging:e.logging,parentRecord:this}).value();await a.save(d),await this[s.association.accessors.set](a,{save:!1,logging:e.logging})})),!e.fields.filter(s=>!this.constructor._virtualAttributes.has(s)).length)return this;if(!this.changed()&&!this.isNewRecord)return this;const m=z.get(this.constructor.rawAttributes[O],"field")||O,g=Y.mapValueFieldNames(this.dataValues,e.fields,this.constructor);let N=null,c=[],l;this.isNewRecord?(N="insert",c=[this,this.constructor.getTableName(e),g,e]):(l=this.where(!0),O&&(g[m]=parseInt(g[m],10)+1),N="update",c=[this,this.constructor.getTableName(e),g,l,e]);const[r,i]=await this.constructor.queryInterface[N](...c);if(O){if(i<1)throw new Ne.OptimisticLockError({modelName:this.constructor.name,values:g,where:l});r.dataValues[O]=g[m]}for(const s of Object.keys(this.constructor.rawAttributes))this.constructor.rawAttributes[s].field&&g[this.constructor.rawAttributes[s].field]!==void 0&&this.constructor.rawAttributes[s].field!==s&&(g[s]=g[this.constructor.rawAttributes[s].field],delete g[this.constructor.rawAttributes[s].field]);Object.assign(g,r.dataValues),Object.assign(r.dataValues,g),E&&this._options.include&&this._options.include.length&&await Promise.all(this._options.include.filter(s=>!(s.association instanceof er||s.parent&&s.parent.association instanceof gt)).map(async s=>{let a=this.get(s.as);if(!a)return;Array.isArray(a)||(a=[a]);const d=z(Y.cloneDeep(s)).omit(["association"]).defaults({transaction:e.transaction,logging:e.logging,parentRecord:this}).value();await Promise.all(a.map(async y=>{if(s.association instanceof gt){await y.save(d);const o=ae({[s.association.foreignKey]:this.get(this.constructor.primaryKeyAttribute,{raw:!0}),[s.association.otherKey]:y.get(y.constructor.primaryKeyAttribute,{raw:!0})},s.association.through.scope);if(y[s.association.through.model.name])for(const p of Object.keys(s.association.through.model.rawAttributes))s.association.through.model.rawAttributes[p]._autoGenerated||p===s.association.foreignKey||p===s.association.otherKey||typeof y[s.association.through.model.name][p]>"u"||(o[p]=y[s.association.through.model.name][p]);await s.association.throughModel.create(o,d)}else y.set(s.association.foreignKey,this.get(s.association.sourceKey||this.constructor.primaryKeyAttribute,{raw:!0}),{raw:!0}),Object.assign(y,s.association.scope),await y.save(d)}))})),e.hooks&&await this.constructor.runHooks(`after${T}`,r,e);for(const s of e.fields)r._previousDataValues[s]=r.dataValues[s],this.changed(s,!1);return this.isNewRecord=!1,r}async reload(e){e=Y.defaults({where:this.where()},e,{include:this._options.include||void 0});const t=await this.constructor.findOne(e);if(!t)throw new Ne.InstanceError("Instance could not be reloaded because it does not exist anymore (find call returned null)");return this._options=t._options,this.set(t.dataValues,{raw:!0,reset:!e.attributes}),this}async validate(e){return new To(this,e).validate()}async update(e,t){e=z.omitBy(e,E=>E===void 0);const n=this.changed()||[];if(t=t||{},Array.isArray(t)&&(t={fields:t}),t=Y.cloneDeep(t),t.transaction===void 0&&this.sequelize.constructor._cls){const E=this.sequelize.constructor._cls.get("transaction");E&&(t.transaction=E)}const f=Y.cloneDeep(t);f.attributes=t.fields,this.set(e,f);const O=z.without(this.changed(),...n),T=z.union(Object.keys(e),O);return t.fields||(t.fields=z.intersection(T,this.changed()),t.defaultFields=t.fields),await this.save(t)}async destroy(e){if(e=ae({hooks:!0,force:!1},e),e.transaction===void 0&&this.sequelize.constructor._cls){const f=this.sequelize.constructor._cls.get("transaction");f&&(e.transaction=f)}e.hooks&&await this.constructor.runHooks("beforeDestroy",this,e);const t=this.where(!0);let n;if(this.constructor._timestampAttributes.deletedAt&&e.force===!1){const f=this.constructor._timestampAttributes.deletedAt,O=this.constructor.rawAttributes[f],T=Object.prototype.hasOwnProperty.call(O,"defaultValue")?O.defaultValue:null,E=this.getDataValue(f);(E==null&&T==null||z.isEqual(E,T))&&this.setDataValue(f,new Date),n=await this.save(Ke(ae({},e),{hooks:!1}))}else n=await this.constructor.queryInterface.delete(this,this.constructor.getTableName(e),t,ae({type:_t.DELETE,limit:null},e));return e.hooks&&await this.constructor.runHooks("afterDestroy",this,e),n}isSoftDeleted(){if(!this.constructor._timestampAttributes.deletedAt)throw new Error("Model is not paranoid");const e=this.constructor.rawAttributes[this.constructor._timestampAttributes.deletedAt],t=Object.prototype.hasOwnProperty.call(e,"defaultValue")?e.defaultValue:null;return(this.get(this.constructor._timestampAttributes.deletedAt)||null)!==t}async restore(e){if(!this.constructor._timestampAttributes.deletedAt)throw new Error("Model is not paranoid");if(e=ae({hooks:!0,force:!1},e),e.transaction===void 0&&this.sequelize.constructor._cls){const T=this.sequelize.constructor._cls.get("transaction");T&&(e.transaction=T)}e.hooks&&await this.constructor.runHooks("beforeRestore",this,e);const t=this.constructor._timestampAttributes.deletedAt,n=this.constructor.rawAttributes[t],f=Object.prototype.hasOwnProperty.call(n,"defaultValue")?n.defaultValue:null;this.setDataValue(t,f);const O=await this.save(Ke(ae({},e),{hooks:!1,omitNull:!1}));return e.hooks&&await this.constructor.runHooks("afterRestore",this,e),O}async increment(e,t){const n=this.where();return t=Y.cloneDeep(t),t.where=ae(ae({},t.where),n),t.instance=this,await this.constructor.increment(e,t),this}async decrement(e,t){return this.increment(e,Ke(ae({by:1},t),{increment:!1}))}equals(e){return!e||!e.constructor||!(e instanceof this.constructor)?!1:this.constructor.primaryKeyAttributes.every(t=>this.get(t,{raw:!0})===e.get(t,{raw:!0}))}equalsOneOf(e){return e.some(t=>this.equals(t))}setValidators(e,t){this.validators[e]=t}toJSON(){return z.cloneDeep(this.get({plain:!0}))}static hasMany(e,t){}static belongsToMany(e,t){}static hasOne(e,t){}static belongsTo(e,t){}};function Ti(S){if(!z.isObject(S))return S;const e=Y.getComplexKeys(S);return e.length===0?void 0:e.length!==1||e[0]!==Je.and?S:S[Je.and]}function Lo(S,e){const t=Ti(S);if(t===void 0)return e;const n=Ti(e);return n===void 0?S:{[Je.and]:z.flatten([t,n])}}Object.assign(Ms,So);Io.applyTo(Ms,!0);var Zn=Ms;const{classToInvokable:At}=fe();class zt{static toString(...e){return new this().toString(...e)}toString(...e){return this.toSql(...e)}toSql(){throw new Error("toSql implementation missing")}}class Do extends zt{toSql(){return"DEFERRABLE INITIALLY DEFERRED"}}class Mo extends zt{toSql(){return"DEFERRABLE INITIALLY IMMEDIATE"}}class $o extends zt{toSql(){return"NOT DEFERRABLE"}}class Po extends zt{constructor(e){super(),this.constraints=e}toSql(e){return e.setDeferredQuery(this.constraints)}}class vo extends zt{constructor(e){super(),this.constraints=e}toSql(e){return e.setImmediateQuery(this.constraints)}}const jo={INITIALLY_DEFERRED:At(Do),INITIALLY_IMMEDIATE:At(Mo),NOT:At($o),SET_DEFERRED:At(Po),SET_IMMEDIATE:At(vo)};var ea=jo,Er={exports:{}};const xo=Aa,tr=re;let $s=class{constructor(e){this.models=[],this.sequelize=e}addModel(e){return this.models.push(e),this.sequelize.models[e.name]=e,e}removeModel(e){this.models=this.models.filter(t=>t.name!==e.name),delete this.sequelize.models[e.name]}getModel(e,t){return t=tr.defaults(t||{},{attribute:"name"}),this.models.find(n=>n[t.attribute]===e)}findModel(e){return this.models.find(e)}get all(){return this.models}getModelsTopoSortedByForeignKey(){const e=new Map,t=new xo;for(const f of this.models){let O=[],T=f.getTableName();tr.isObject(T)&&(T=`${T.schema}.${T.tableName}`),e.set(T,f);for(const E in f.rawAttributes)if(Object.prototype.hasOwnProperty.call(f.rawAttributes,E)){const w=f.rawAttributes[E];if(w.references){let R=w.references.model;tr.isObject(R)&&(R=`${R.schema}.${R.tableName}`),O.push(R)}}O=O.filter(E=>T!==E),t.add(T,O)}let n;try{n=t.sort()}catch(f){if(!f.message.startsWith("Cyclic dependency found."))throw f;return null}return n.map(f=>e.get(f)).filter(Boolean)}forEachModel(e,t){const n=this.getModelsTopoSortedByForeignKey();if(n==null)throw new Error("Cyclic dependency found.");t=tr.defaults(t||{},{reverse:!0}),t.reverse&&n.reverse();for(const f of n)e(f)}};Er.exports=$s;Er.exports.ModelManager=$s;Er.exports.default=$s;var Qo=Er.exports,gr={exports:{}},Fo=Object.defineProperty,Ni=Object.getOwnPropertySymbols,Uo=Object.prototype.hasOwnProperty,Ko=Object.prototype.propertyIsEnumerable,wi=(S,e,t)=>e in S?Fo(S,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):S[e]=t,Bo=(S,e)=>{for(var t in e||(e={}))Uo.call(e,t)&&wi(S,t,e[t]);if(Ni)for(var t of Ni(e))Ko.call(e,t)&&wi(S,t,e[t]);return S};let Ps=class ta{constructor(e,t){this.sequelize=e,this.savepoints=[],this._afterCommitHooks=[];const n=this.sequelize.dialect.queryGenerator.generateTransactionId;this.options=Bo({type:e.options.transactionType,isolationLevel:e.options.isolationLevel,readOnly:!1},t),this.parent=this.options.transaction,this.parent?(this.id=this.parent.id,this.parent.savepoints.push(this),this.name=`${this.id}-sp-${this.parent.savepoints.length}`):this.id=this.name=n(),delete this.options.transaction}async commit(){if(this.finished)throw new Error(`Transaction cannot be committed because it has been finished with state: ${this.finished}`);try{await this.sequelize.getQueryInterface().commitTransaction(this,this.options),this.cleanup()}catch(e){throw console.warn(`Committing transaction ${this.id} failed with error ${JSON.stringify(e.message)}. We are killing its connection as it is now in an undetermined state.`),await this.forceCleanup(),e}finally{this.finished="commit";for(const e of this._afterCommitHooks)await e.apply(this,[this])}}async rollback(){if(this.finished)throw new Error(`Transaction cannot be rolled back because it has been finished with state: ${this.finished}`);if(!this.connection)throw new Error("Transaction cannot be rolled back because it never started");try{await this.sequelize.getQueryInterface().rollbackTransaction(this,this.options),this.cleanup()}catch(e){throw console.warn(`Rolling back transaction ${this.id} failed with error ${JSON.stringify(e.message)}. We are killing its connection as it is now in an undetermined state.`),await this.forceCleanup(),e}}async prepareEnvironment(e=!0){let t;if(this.parent)t=Promise.resolve(this.parent.connection);else{const O={uuid:this.id};this.options.readOnly&&(O.type="SELECT"),t=this.sequelize.connectionManager.getConnection(O)}let n;const f=await t;this.connection=f,this.connection.uuid=this.id;try{await this.begin(),n=await this.setDeferrable()}catch(O){try{n=await this.rollback()}finally{throw O}}return e&&this.sequelize.constructor._cls&&this.sequelize.constructor._cls.set("transaction",this),n}async setDeferrable(){if(this.options.deferrable)return await this.sequelize.getQueryInterface().deferConstraints(this,this.options)}async begin(){const e=this.sequelize.getQueryInterface();return this.sequelize.dialect.supports.settingIsolationLevelDuringTransaction?(await e.startTransaction(this,this.options),e.setIsolationLevel(this,this.options.isolationLevel,this.options)):(await e.setIsolationLevel(this,this.options.isolationLevel,this.options),e.startTransaction(this,this.options))}cleanup(){this.parent||this.connection.uuid===void 0||(this._clearCls(),this.sequelize.connectionManager.releaseConnection(this.connection),this.connection.uuid=void 0)}async forceCleanup(){this.parent||this.connection.uuid===void 0||(this._clearCls(),await this.sequelize.connectionManager.destroyConnection(this.connection),this.connection.uuid=void 0)}_clearCls(){const e=this.sequelize.constructor._cls;e&&e.get("transaction")===this&&e.set("transaction",null)}afterCommit(e){if(!e||typeof e!="function")throw new Error('"fn" must be a function');this._afterCommitHooks.push(e)}static get TYPES(){return{DEFERRED:"DEFERRED",IMMEDIATE:"IMMEDIATE",EXCLUSIVE:"EXCLUSIVE"}}static get ISOLATION_LEVELS(){return{READ_UNCOMMITTED:"READ UNCOMMITTED",READ_COMMITTED:"READ COMMITTED",REPEATABLE_READ:"REPEATABLE READ",SERIALIZABLE:"SERIALIZABLE"}}static get LOCK(){return{UPDATE:"UPDATE",SHARE:"SHARE",KEY_SHARE:"KEY SHARE",NO_KEY_UPDATE:"NO KEY UPDATE"}}get LOCK(){return ta.LOCK}};gr.exports=Ps;gr.exports.Transaction=Ps;gr.exports.default=Ps;var _r=gr.exports,ra={exports:{}};ra.exports={NOLOCK:"NOLOCK",READUNCOMMITTED:"READUNCOMMITTED",UPDLOCK:"UPDLOCK",REPEATABLEREAD:"REPEATABLEREAD",SERIALIZABLE:"SERIALIZABLE",READCOMMITTED:"READCOMMITTED",TABLOCK:"TABLOCK",TABLOCKX:"TABLOCKX",PAGLOCK:"PAGLOCK",ROWLOCK:"ROWLOCK",NOWAIT:"NOWAIT",READPAST:"READPAST",XLOCK:"XLOCK",SNAPSHOT:"SNAPSHOT",NOEXPAND:"NOEXPAND"};var sa=ra.exports,ia={exports:{}};ia.exports={USE:"USE",FORCE:"FORCE",IGNORE:"IGNORE"};var na=ia.exports,Ar={exports:{}};const ot=nt;ot.BelongsTo=at;ot.HasOne=fr;ot.HasMany=Et;ot.BelongsToMany=Ut;Ar.exports=ot;Ar.exports.default=ot;Ar.exports.Association=ot;var zo=Ar.exports,He={},ko=Object.defineProperty,Ho=Object.defineProperties,Go=Object.getOwnPropertyDescriptors,Ii=Object.getOwnPropertySymbols,Vo=Object.prototype.hasOwnProperty,Yo=Object.prototype.propertyIsEnumerable,Si=(S,e,t)=>e in S?ko(S,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):S[e]=t,ye=(S,e)=>{for(var t in e||(e={}))Vo.call(e,t)&&Si(S,t,e[t]);if(Ii)for(var t of Ii(e))Yo.call(e,t)&&Si(S,t,e[t]);return S},we=(S,e)=>Ho(S,Go(e));const Ce=re,Fe=fe(),pt=he(),rr=_r,Ie=Me;let Wo=class{constructor(e,t){this.sequelize=e,this.queryGenerator=t}async createDatabase(e,t){t=t||{};const n=this.queryGenerator.createDatabaseQuery(e,t);return await this.sequelize.query(n,t)}async dropDatabase(e,t){t=t||{};const n=this.queryGenerator.dropDatabaseQuery(e);return await this.sequelize.query(n,t)}async createSchema(e,t){t=t||{};const n=this.queryGenerator.createSchema(e);return await this.sequelize.query(n,t)}async dropSchema(e,t){t=t||{};const n=this.queryGenerator.dropSchema(e);return await this.sequelize.query(n,t)}async dropAllSchemas(e){if(e=e||{},!this.queryGenerator._dialect.supports.schemas)return this.sequelize.drop(e);const t=await this.showAllSchemas(e);return Promise.all(t.map(n=>this.dropSchema(n,e)))}async showAllSchemas(e){e=we(ye({},e),{raw:!0,type:this.sequelize.QueryTypes.SELECT});const t=this.queryGenerator.showSchemasQuery(e),n=await this.sequelize.query(t,e);return Ce.flatten(n.map(f=>f.schema_name?f.schema_name:f))}async databaseVersion(e){return await this.sequelize.query(this.queryGenerator.versionQuery(),we(ye({},e),{type:Ie.VERSION}))}async createTable(e,t,n,f){let O="";return n=ye({},n),n&&n.uniqueKeys&&Ce.forOwn(n.uniqueKeys,T=>{T.customIndex===void 0&&(T.customIndex=!0)}),f&&(n.uniqueKeys=n.uniqueKeys||f.uniqueKeys),t=Ce.mapValues(t,T=>this.sequelize.normalizeAttribute(T)),await this.ensureEnums(e,t,n,f),!e.schema&&(n.schema||f&&f._schema)&&(e=this.queryGenerator.addSchema({tableName:e,_schema:!!f&&f._schema||n.schema})),t=this.queryGenerator.attributesToSQL(t,{table:e,context:"createTable",withoutForeignKeyConstraints:n.withoutForeignKeyConstraints}),O=this.queryGenerator.createTableQuery(e,t,n),await this.sequelize.query(O,n)}async tableExists(e,t){const n=this.queryGenerator.tableExistsQuery(e);return(await this.sequelize.query(n,we(ye({},t),{type:Ie.SHOWTABLES}))).length===1}async dropTable(e,t){t=ye({},t),t.cascade=t.cascade||t.force||!1;const n=this.queryGenerator.dropTableQuery(e,t);await this.sequelize.query(n,t)}async _dropAllTables(e,t,n){for(const f of e)t.includes(f.tableName||f)||await this.dropTable(f,we(ye({},n),{cascade:!0}))}async dropAllTables(e){e=e||{};const t=e.skip||[],n=await this.showAllTables(e),f=await this.getForeignKeysForTables(n,e);for(const O of n){let T=O;Ce.isObject(O)&&(T=`${O.schema}.${O.tableName}`);for(const E of f[T])await this.sequelize.query(this.queryGenerator.dropForeignKeyQuery(O,E))}await this._dropAllTables(n,t,e)}async renameTable(e,t,n){n=n||{};const f=this.queryGenerator.renameTableQuery(e,t);return await this.sequelize.query(f,n)}async showAllTables(e){e=we(ye({},e),{raw:!0,type:Ie.SHOWTABLES});const t=this.queryGenerator.showTablesQuery(this.sequelize.config.database),n=await this.sequelize.query(t,e);return Ce.flatten(n)}async describeTable(e,t){let n=null,f=null;typeof t=="string"?n=t:typeof t=="object"&&t!==null&&(n=t.schema||null,f=t.schemaDelimiter||null),typeof e=="object"&&e!==null&&(n=e.schema,e=e.tableName);const O=this.queryGenerator.describeTableQuery(e,n,f);t=we(ye({},t),{type:Ie.DESCRIBE});try{const T=await this.sequelize.query(O,t);if(Ce.isEmpty(T))throw new Error(`No description found for "${e}" table. Check the table name and schema; remember, they _are_ case sensitive.`);return T}catch(T){throw T.original&&T.original.code==="ER_NO_SUCH_TABLE"?new Error(`No description found for "${e}" table. Check the table name and schema; remember, they _are_ case sensitive.`):T}}async addColumn(e,t,n,f){if(!e||!t||!n)throw new Error("addColumn takes at least 3 arguments (table, attribute name, attribute definition)");return f=f||{},n=this.sequelize.normalizeAttribute(n),await this.sequelize.query(this.queryGenerator.addColumnQuery(e,t,n),f)}async removeColumn(e,t,n){return this.sequelize.query(this.queryGenerator.removeColumnQuery(e,t),n)}normalizeAttribute(e){let t;return Object.values(pt).includes(e)?t={type:e,allowNull:!0}:t=e,this.sequelize.normalizeAttribute(t)}quoteIdentifier(e,t){return this.queryGenerator.quoteIdentifier(e,t)}quoteIdentifiers(e){return this.queryGenerator.quoteIdentifiers(e)}async changeColumn(e,t,n,f){f=f||{};const O=this.queryGenerator.attributesToSQL({[t]:this.normalizeAttribute(n)},{context:"changeColumn",table:e}),T=this.queryGenerator.changeColumnQuery(e,O);return this.sequelize.query(T,f)}async assertTableHasColumn(e,t,n){const f=await this.describeTable(e,n);if(f[t])return f;throw new Error(`Table ${e} doesn't have the column ${t}`)}async renameColumn(e,t,n,f){f=f||{};const O=(await this.assertTableHasColumn(e,t,f))[t],T={};T[n]={attribute:n,type:O.type,allowNull:O.allowNull,defaultValue:O.defaultValue},O.defaultValue===null&&!O.allowNull&&delete T[n].defaultValue;const E=this.queryGenerator.renameColumnQuery(e,t,this.queryGenerator.attributesToSQL(T));return await this.sequelize.query(E,f)}async addIndex(e,t,n,f){Array.isArray(t)||(f=n,n=t,t=n.fields),f||(f=e),n=Fe.cloneDeep(n),n.fields=t;const O=this.queryGenerator.addIndexQuery(e,n,f);return await this.sequelize.query(O,we(ye({},n),{supportsSearchPath:!1}))}async showIndex(e,t){const n=this.queryGenerator.showIndexesQuery(e,t);return await this.sequelize.query(n,we(ye({},t),{type:Ie.SHOWINDEXES}))}async getForeignKeysForTables(e,t){if(e.length===0)return{};t=we(ye({},t),{type:Ie.FOREIGNKEYS});const n=await Promise.all(e.map(O=>this.sequelize.query(this.queryGenerator.getForeignKeysQuery(O,this.sequelize.config.database),t))),f={};return e.forEach((O,T)=>{Ce.isObject(O)&&(O=`${O.schema}.${O.tableName}`),f[O]=Array.isArray(n[T])?n[T].map(E=>E.constraint_name):[n[T]&&n[T].constraint_name],f[O]=f[O].filter(Ce.identity)}),f}async getForeignKeyReferencesForTable(e,t){const n=we(ye({},t),{type:Ie.FOREIGNKEYS}),f=this.queryGenerator.getForeignKeysQuery(e,this.sequelize.config.database);return this.sequelize.query(f,n)}async removeIndex(e,t,n){n=n||{};const f=this.queryGenerator.removeIndexQuery(e,t,n);return await this.sequelize.query(f,n)}async addConstraint(e,t){if(!t.fields)throw new Error("Fields must be specified through options.fields");if(!t.type)throw new Error("Constraint type must be specified through options.type");t=Fe.cloneDeep(t);const n=this.queryGenerator.addConstraintQuery(e,t);return await this.sequelize.query(n,t)}async showConstraint(e,t,n){const f=this.queryGenerator.showConstraintsQuery(e,t);return await this.sequelize.query(f,we(ye({},n),{type:Ie.SHOWCONSTRAINTS}))}async removeConstraint(e,t,n){return this.sequelize.query(this.queryGenerator.removeConstraintQuery(e,t),n)}async insert(e,t,n,f){f=Fe.cloneDeep(f),f.hasTrigger=e&&e.constructor.options.hasTrigger;const O=this.queryGenerator.insertQuery(t,n,e&&e.constructor.rawAttributes,f);f.type=Ie.INSERT,f.instance=e;const T=await this.sequelize.query(O,f);return e&&(T[0].isNewRecord=!1),T}async upsert(e,t,n,f,O){O=ye({},O);const T=O.model;if(O.type=Ie.UPSERT,O.updateOnDuplicate=Object.keys(n),O.upsertKeys=O.conflictFields||[],O.upsertKeys.length===0){const w=Object.values(T.primaryKeys).map(m=>m.field),R=Object.values(T.uniqueKeys).filter(m=>m.fields.length>0).map(m=>m.fields),_=Object.values(T._indexes).filter(m=>m.unique&&m.fields.length>0).map(m=>m.fields);for(const m of O.updateOnDuplicate){const g=R.find(c=>c.includes(m));if(g){O.upsertKeys=g;break}const N=_.find(c=>c.includes(m));if(N){O.upsertKeys=N;break}}(O.upsertKeys.length===0||Ce.intersection(O.updateOnDuplicate,w).length)&&(O.upsertKeys=w),O.upsertKeys=Ce.uniq(O.upsertKeys)}const E=this.queryGenerator.insertQuery(e,t,T.rawAttributes,O);return await this.sequelize.query(E,O)}async bulkInsert(e,t,n,f){return n=ye({},n),n.type=Ie.INSERT,(await this.sequelize.query(this.queryGenerator.bulkInsertQuery(e,t,n,f),n))[0]}async update(e,t,n,f,O){O=ye({},O),O.hasTrigger=e&&e.constructor.options.hasTrigger;const T=this.queryGenerator.updateQuery(t,n,f,O,e.constructor.rawAttributes);return O.type=Ie.UPDATE,O.instance=e,await this.sequelize.query(T,O)}async bulkUpdate(e,t,n,f,O){f=Fe.cloneDeep(f),typeof n=="object"&&(n=Fe.cloneDeep(n));const T=this.queryGenerator.updateQuery(e,t,n,f,O),E=Ce.isObject(e)?e:{tableName:e},w=f.model?f.model:Ce.find(this.sequelize.modelManager.models,{tableName:E.tableName});return f.type=Ie.BULKUPDATE,f.model=w,await this.sequelize.query(T,f)}async delete(e,t,n,f){const O=[],T=this.queryGenerator.deleteQuery(t,n,{},e.constructor);if(f=ye({},f),e.constructor&&e.constructor.associations){const E=Object.keys(e.constructor.associations),w=E.length;let R;for(let _=0;_<w;_++)R=e.constructor.associations[E[_]],R.options&&R.options.onDelete&&R.options.onDelete.toLowerCase()==="cascade"&&R.options.useHooks===!0&&O.push(R.accessors.get)}for(const E of O){let w=await e[E](f);if(w){Array.isArray(w)||(w=[w]);for(const R of w)await R.destroy(f)}}return f.instance=e,await this.sequelize.query(T,f)}async bulkDelete(e,t,n,f){return n=Fe.cloneDeep(n),n=Ce.defaults(n,{limit:null}),n.truncate===!0?this.sequelize.query(this.queryGenerator.truncateTableQuery(e,n),n):(typeof identifier=="object"&&(t=Fe.cloneDeep(t)),await this.sequelize.query(this.queryGenerator.deleteQuery(e,t,n,f),n))}async select(e,t,n){const f=we(ye({},n),{type:Ie.SELECT,model:e});return await this.sequelize.query(this.queryGenerator.selectQuery(t,f,e),f)}async increment(e,t,n,f,O,T){T=Fe.cloneDeep(T);const E=this.queryGenerator.arithmeticQuery("+",t,n,f,O,T);return T.type=Ie.UPDATE,T.model=e,await this.sequelize.query(E,T)}async decrement(e,t,n,f,O,T){T=Fe.cloneDeep(T);const E=this.queryGenerator.arithmeticQuery("-",t,n,f,O,T);return T.type=Ie.UPDATE,T.model=e,await this.sequelize.query(E,T)}async rawSelect(e,t,n,f){t=Fe.cloneDeep(t),t=Ce.defaults(t,{raw:!0,plain:!0,type:Ie.SELECT});const O=this.queryGenerator.selectQuery(e,t,f);if(n===void 0)throw new Error("Please pass an attribute selector!");const T=await this.sequelize.query(O,t);if(!t.plain)return T;const E=T?T[n]:null;if(!t||!t.dataType)return E;const w=t.dataType;return(w instanceof pt.DECIMAL||w instanceof pt.FLOAT)&&E!==null?parseFloat(E):(w instanceof pt.INTEGER||w instanceof pt.BIGINT)&&E!==null?parseInt(E,10):w instanceof pt.DATE&&E!==null&&!(E instanceof Date)?new Date(E):E}async createTrigger(e,t,n,f,O,T,E,w){const R=this.queryGenerator.createTrigger(e,t,n,f,O,T,E);if(w=w||{},R)return await this.sequelize.query(R,w)}async dropTrigger(e,t,n){const f=this.queryGenerator.dropTrigger(e,t);if(n=n||{},f)return await this.sequelize.query(f,n)}async renameTrigger(e,t,n,f){const O=this.queryGenerator.renameTrigger(e,t,n);if(f=f||{},O)return await this.sequelize.query(O,f)}async createFunction(e,t,n,f,O,T,E){const w=this.queryGenerator.createFunction(e,t,n,f,O,T,E);if(E=E||{},w)return await this.sequelize.query(w,E)}async dropFunction(e,t,n){const f=this.queryGenerator.dropFunction(e,t);if(n=n||{},f)return await this.sequelize.query(f,n)}async renameFunction(e,t,n,f){const O=this.queryGenerator.renameFunction(e,t,n);if(f=f||{},O)return await this.sequelize.query(O,f)}ensureEnums(){}async setIsolationLevel(e,t,n){if(!e||!(e instanceof rr))throw new Error("Unable to set isolation level for a transaction without transaction object!");if(e.parent||!t)return;n=we(ye({},n),{transaction:e.parent||e});const f=this.queryGenerator.setIsolationLevelQuery(t,{parent:e.parent});if(f)return await this.sequelize.query(f,n)}async startTransaction(e,t){if(!e||!(e instanceof rr))throw new Error("Unable to start a transaction without transaction object!");t=we(ye({},t),{transaction:e.parent||e}),t.transaction.name=e.parent?e.name:void 0;const n=this.queryGenerator.startTransactionQuery(e);return await this.sequelize.query(n,t)}async deferConstraints(e,t){t=we(ye({},t),{transaction:e.parent||e});const n=this.queryGenerator.deferConstraintsQuery(t);if(n)return await this.sequelize.query(n,t)}async commitTransaction(e,t){if(!e||!(e instanceof rr))throw new Error("Unable to commit a transaction without transaction object!");if(e.parent)return;t=we(ye({},t),{transaction:e.parent||e,supportsSearchPath:!1,completesTransaction:!0});const n=this.queryGenerator.commitTransactionQuery(e),f=this.sequelize.query(n,t);return e.finished="commit",await f}async rollbackTransaction(e,t){if(!e||!(e instanceof rr))throw new Error("Unable to rollback a transaction without transaction object!");t=we(ye({},t),{transaction:e.parent||e,supportsSearchPath:!1,completesTransaction:!0}),t.transaction.name=e.parent?e.name:void 0;const n=this.queryGenerator.rollbackTransactionQuery(e),f=this.sequelize.query(n,t);return e.finished="rollback",await f}};He.QueryInterface=Wo;var aa={};(function(S){var e=Object.defineProperty,t=O=>e(O,"__esModule",{value:!0}),n=(O,T)=>{t(O);for(var E in T)e(O,E,{get:T[E],enumerable:!0})};n(S,{withSqliteForeignKeysOff:()=>f});async function f(O,T,E){try{return await O.query("PRAGMA foreign_keys = OFF",T),await E()}finally{await O.query("PRAGMA foreign_keys = ON",T)}}})(aa);var oa={};(function(S){var e=Object.create,t=Object.defineProperty,n=Object.getOwnPropertyDescriptor,f=Object.getOwnPropertyNames,O=Object.getPrototypeOf,T=Object.prototype.hasOwnProperty,E=r=>t(r,"__esModule",{value:!0}),w=(r,i)=>{E(r);for(var s in i)t(r,s,{get:i[s],enumerable:!0})},R=(r,i,s)=>{if(i&&typeof i=="object"||typeof i=="function")for(let a of f(i))!T.call(r,a)&&a!=="default"&&t(r,a,{get:()=>i[a],enumerable:!(s=n(i,a))||s.enumerable});return r},_=r=>R(E(t(r!=null?e(O(r)):{},"default",r&&r.__esModule&&"default"in r?{get:()=>r.default,enumerable:!0}:{value:r,enumerable:!0})),r);w(S,{injectReplacements:()=>N});var m=_(Ea),g=_(ur());function N(r,i,s){var a,d,y,o;if(s==null)return r;if(!Array.isArray(s)&&!(0,m.default)(s))throw new TypeError(`"replacements" must be an array or a plain object, but received ${JSON.stringify(s)} instead.`);const p=(0,m.default)(s),b=Array.isArray(s);let u=-1,h="",A=null,I=!1,q=!1,L=0,D=!1,C=!1,$=!1;for(let P=0;P<r.length;P++){const Q=r[P];if(q){Q===i.TICK_CHAR_RIGHT&&(q=!1);continue}if(I){Q==="'"&&(!$||!l(r,P-1))&&(I=!1,$=!1);continue}if(A!==null){if(Q!=="$")continue;const B=r.slice(P,r.length).match(/^\$(?<name>[a-z_][0-9a-z_]*)?(\$)/i),F=((a=B==null?void 0:B.groups)==null?void 0:a.name)||"";A===F&&(A=null);continue}if(D){Q===`
`&&(D=!1);continue}if(C){Q==="*"&&r[P+1]==="/"&&(C=!1);continue}if(Q===i.TICK_CHAR_LEFT){q=!0;continue}if(Q==="'"){I=!0,$=i.canBackslashEscape()||i.supports.escapeStringConstants&&(r[P-1]==="E"||r[P-1]==="e")&&c(r[P-2]);continue}if(Q==="-"&&r.slice(P,P+3)==="-- "){D=!0;continue}if(Q==="/"&&r.slice(P,P+2)==="/*"){C=!0;continue}if(Q==="$"){const j=r[P-1];if(/[0-9a-z_]/i.test(j))continue;const F=r.slice(P,r.length).match(/^\$(?<name>[a-z_][0-9a-z_]*)?(\$)/i);if(F){A=(y=(d=F.groups)==null?void 0:d.name)!=null?y:"",P+=F[0].length-1;continue}continue}if(p&&Q===":"){const j=r[P-1];if(!c(j)&&j!=="[")continue;const F=r.slice(P,r.length).match(/^:(?<name>[a-z_][0-9a-z_]*)(?:\)|,|$|\s|::|;|])/i),x=(o=F==null?void 0:F.groups)==null?void 0:o.name;if(!x)continue;const k=s[x];if(!Object.prototype.hasOwnProperty.call(s,x)||k===void 0)throw new Error(`Named replacement ":${x}" has no entry in the replacement map.`);const X=(0,g.escape)(k,void 0,i.name,!0);h+=r.slice(L,P),L=P+x.length+1,h+=X;continue}if(b&&Q==="?"){const j=r[P-1];if(!c(j)&&j!=="[")continue;const B=r[P+1];if(B==="|"||B==="&")continue;const F=++u,x=s[u];if(x===void 0)throw new Error(`Positional replacement (?) ${F} has no entry in the replacement map (replacements[${F}] is undefined).`);const k=(0,g.escape)(x,void 0,i.name,!0);h+=r.slice(L,P),L=P+1,h+=k}}if(I)throw new Error(`The following SQL query includes an unterminated string literal:
${r}`);return h+=r.slice(L,r.length),h}function c(r){return r===void 0||/[\s(>,=]/.test(r)}function l(r,i){let s=!1;for(let a=i;a>=0&&r[a]==="\\";a--)s=!s;return s}})(oa);var Ot={exports:{}},Ri;function Xe(){if(Ri)return Ot.exports;Ri=1;class S{canBackslashEscape(){return!1}}return S.prototype.supports={DEFAULT:!0,"DEFAULT VALUES":!1,"VALUES ()":!1,"LIMIT ON UPDATE":!1,"ON DUPLICATE KEY":!0,"ORDER NULLS":!1,UNION:!0,"UNION ALL":!0,"RIGHT JOIN":!0,returnValues:!1,autoIncrement:{identityInsert:!1,defaultValue:!0,update:!0},bulkDefault:!1,schemas:!1,transactions:!0,settingIsolationLevelDuringTransaction:!0,transactionOptions:{type:!1},migrations:!0,upserts:!0,inserts:{ignoreDuplicates:"",updateOnDuplicate:!1,onConflictDoNothing:"",onConflictWhere:!1,conflictFields:!1},constraints:{restrict:!0,addConstraint:!0,dropConstraint:!0,unique:!0,default:!1,check:!0,foreignKey:!0,primaryKey:!0},index:{collate:!0,length:!1,parser:!1,concurrently:!1,type:!1,using:!0,functionBased:!1,operator:!1},groupedLimit:!0,indexViaAlter:!1,JSON:!1,deferrableConstraints:!1,escapeStringConstants:!1},Ot.exports=S,Ot.exports.AbstractDialect=S,Ot.exports.default=S,Ot.exports}var bt={exports:{}};function qi(S){throw new Error('Could not dynamically require "'+S+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Tt={exports:{}},Ci;function Ze(){if(Ci)return Tt.exports;Ci=1;const{Pool:S,TimeoutError:e}=Oa(),t=re,n=yt(),f=ce,{logger:O}=ge,T=Bt,E=O.debugContext("pool");class w{constructor(_,m){const g=t.cloneDeep(m.config);if(this.sequelize=m,this.config=g,this.dialect=_,this.versionPromise=null,this.dialectName=this.sequelize.options.dialect,g.pool===!1)throw new Error("Support for pool:false was removed in v4.0");g.pool=t.defaults(g.pool||{},{max:5,min:0,idle:1e4,acquire:6e4,evict:1e3,validate:this._validate.bind(this)}),this.initPools()}refreshTypeParser(_){t.each(_,m=>{if(Object.prototype.hasOwnProperty.call(m,"parse"))if(m.types[this.dialectName])this._refreshTypeParser(m);else throw new Error(`Parse function not supported for type ${m.key} in dialect ${this.dialectName}`)})}_loadDialectModule(_){try{return this.sequelize.config.dialectModulePath?qi(this.sequelize.config.dialectModulePath):this.sequelize.config.dialectModule?this.sequelize.config.dialectModule:qi(_)}catch(m){throw m.code==="MODULE_NOT_FOUND"?this.sequelize.config.dialectModulePath?new Error(`Unable to find dialect at ${this.sequelize.config.dialectModulePath}`):new Error(`Please install ${_} package manually`):m}}async _onProcessExit(){if(this.pool)return await this.pool.drain(),E("connection drain due to process exit"),await this.pool.destroyAllNow()}async close(){return this.getConnection=async function(){throw new Error("ConnectionManager.getConnection was called after the connection manager was closed!")},await this._onProcessExit()}initPools(){const _=this.config;if(!_.replication){this.pool=new S({name:"sequelize",create:()=>this._connect(_),destroy:async g=>{const N=await this._disconnect(g);return E("connection destroy"),N},validate:_.pool.validate,max:_.pool.max,min:_.pool.min,acquireTimeoutMillis:_.pool.acquire,idleTimeoutMillis:_.pool.idle,reapIntervalMillis:_.pool.evict,maxUses:_.pool.maxUses}),E(`pool created with max/min: ${_.pool.max}/${_.pool.min}, no replication`);return}Array.isArray(_.replication.read)||(_.replication.read=[_.replication.read]),_.replication.write=t.defaults(_.replication.write,t.omit(_,"replication")),_.replication.read=_.replication.read.map(g=>t.defaults(g,t.omit(this.config,"replication")));let m=0;this.pool={release:g=>{g.queryType==="read"?this.pool.read.release(g):this.pool.write.release(g)},acquire:(g,N)=>(N=N===void 0?!1:N,g==="SELECT"&&!N?this.pool.read.acquire():this.pool.write.acquire()),destroy:g=>{this.pool[g.queryType].destroy(g),E("connection destroy")},destroyAllNow:async()=>{await Promise.all([this.pool.read.destroyAllNow(),this.pool.write.destroyAllNow()]),E("all connections destroyed")},drain:async()=>Promise.all([this.pool.write.drain(),this.pool.read.drain()]),read:new S({name:"sequelize:read",create:async()=>{const g=m++%_.replication.read.length,N=await this._connect(_.replication.read[g]);return N.queryType="read",N},destroy:g=>this._disconnect(g),validate:_.pool.validate,max:_.pool.max,min:_.pool.min,acquireTimeoutMillis:_.pool.acquire,idleTimeoutMillis:_.pool.idle,reapIntervalMillis:_.pool.evict,maxUses:_.pool.maxUses}),write:new S({name:"sequelize:write",create:async()=>{const g=await this._connect(_.replication.write);return g.queryType="write",g},destroy:g=>this._disconnect(g),validate:_.pool.validate,max:_.pool.max,min:_.pool.min,acquireTimeoutMillis:_.pool.acquire,idleTimeoutMillis:_.pool.idle,reapIntervalMillis:_.pool.evict,maxUses:_.pool.maxUses})},E(`pool created with max/min: ${_.pool.max}/${_.pool.min}, with replication`)}async getConnection(_){_=_||{},this.sequelize.options.databaseVersion===0&&(this.versionPromise||(this.versionPromise=(async()=>{try{const g=await this._connect(this.config.replication.write||this.config),N={};if(N.transaction={connection:g},N.logging=()=>{},N.logging.__testLoggingFn=!0,this.sequelize.options.databaseVersion===0){const c=await this.sequelize.databaseVersion(N),l=t.get(n.coerce(c),"version")||c;this.sequelize.options.databaseVersion=n.valid(l)?l:this.dialect.defaultVersion}return n.lt(this.sequelize.options.databaseVersion,this.dialect.defaultVersion)&&(T.unsupportedEngine(),E(`Unsupported database engine version ${this.sequelize.options.databaseVersion}`)),this.versionPromise=null,await this._disconnect(g)}catch(g){throw this.versionPromise=null,g}})()),await this.versionPromise);let m;try{await this.sequelize.runHooks("beforePoolAcquire",_),m=await this.pool.acquire(_.type,_.useMaster),await this.sequelize.runHooks("afterPoolAcquire",m,_)}catch(g){throw g instanceof e?new f.ConnectionAcquireTimeoutError(g):g}return E("connection acquired"),m}releaseConnection(_){this.pool.release(_),E("connection released")}async destroyConnection(_){await this.pool.destroy(_),E(`connection ${_.uuid} destroyed`)}async _connect(_){await this.sequelize.runHooks("beforeConnect",_);const m=await this.dialect.connectionManager.connect(_);return await this.sequelize.runHooks("afterConnect",m,_),m}async _disconnect(_){return await this.sequelize.runHooks("beforeDisconnect",_),await this.dialect.connectionManager.disconnect(_),this.sequelize.runHooks("afterDisconnect",_)}_validate(_){return this.dialect.connectionManager.validate?this.dialect.connectionManager.validate(_):!0}}return Tt.exports=w,Tt.exports.ConnectionManager=w,Tt.exports.default=w,Tt.exports}var zr,Li;function je(){if(Li)return zr;Li=1;const S=new Map;return zr=e=>(S.has(e)||S.set(e,new Map),{clear(){S.get(e).clear()},refresh(t){for(const n of t.types[e])S.get(e).set(n,t.parse)},get(t){return S.get(e).get(t)}}),zr}var Di;function Jo(){if(Di)return bt.exports;Di=1;var S=Object.defineProperty,e=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,f=(l,r,i)=>r in l?S(l,r,{enumerable:!0,configurable:!0,writable:!0,value:i}):l[r]=i,O=(l,r)=>{for(var i in r||(r={}))t.call(r,i)&&f(l,i,r[i]);if(e)for(var i of e(r))n.call(r,i)&&f(l,i,r[i]);return l};const T=yt(),E=Ze(),w=ce,{logger:R}=ge,_=he().mariadb,m=ke,g=R.debugContext("connection:mariadb"),N=je()("mariadb");class c extends E{constructor(r,i){i.config.port=i.config.port||3306,super(r,i),this.lib=this._loadDialectModule("mariadb"),this.refreshTypeParser(_)}static _typecast(r,i){return N.get(r.type)?N.get(r.type)(r,this.sequelize.options,i):i()}_refreshTypeParser(r){N.refresh(r)}_clearTypeParser(){N.clear()}async connect(r){let i=this.sequelize.options.timezone;i=/\//.test(i)?m.tz(i).format("Z"):i;const s=O({host:r.host,port:r.port,user:r.username,password:r.password,database:r.database,timezone:i,typeCast:c._typecast.bind(this),bigNumberStrings:!1,supportBigNumbers:!0,foundRows:!1},r.dialectOptions);this.sequelize.config.keepDefaultTimezone||(s.initSql?(Array.isArray(s.initSql)||(s.initSql=[s.initSql]),s.initSql.push(`SET time_zone = '${i}'`)):s.initSql=`SET time_zone = '${i}'`);try{const a=await this.lib.createConnection(s);return this.sequelize.options.databaseVersion=T.coerce(a.serverVersion()).version,g("connection acquired"),a.on("error",d=>{switch(d.code){case"ESOCKET":case"ECONNRESET":case"EPIPE":case"PROTOCOL_CONNECTION_LOST":this.pool.destroy(a)}}),a}catch(a){switch(a.code){case"ECONNREFUSED":throw new w.ConnectionRefusedError(a);case"ER_ACCESS_DENIED_ERROR":case"ER_ACCESS_DENIED_NO_PASSWORD_ERROR":throw new w.AccessDeniedError(a);case"ENOTFOUND":throw new w.HostNotFoundError(a);case"EHOSTUNREACH":case"ENETUNREACH":case"EADDRNOTAVAIL":throw new w.HostNotReachableError(a);case"EINVAL":throw new w.InvalidConnectionError(a);default:throw new w.ConnectionError(a)}}}async disconnect(r){if(!r.isValid()){g("connection tried to disconnect but was already at CLOSED state");return}return await r.end()}validate(r){return r&&r.isValid()}}return bt.exports=c,bt.exports.ConnectionManager=c,bt.exports.default=c,bt.exports}var Nt={exports:{}},Mi;function et(){if(Mi)return Nt.exports;Mi=1;var S=Object.defineProperty,e=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,f=(c,l,r)=>l in c?S(c,l,{enumerable:!0,configurable:!0,writable:!0,value:r}):c[l]=r,O=(c,l)=>{for(var r in l||(l={}))t.call(l,r)&&f(c,r,l[r]);if(e)for(var r of e(l))n.call(l,r)&&f(c,r,l[r]);return c};const T=re,E=ur(),w=Me,R=wn,_=Bt,m=Qt.v4,{safeStringifyJson:g}=fe();class N{constructor(l,r,i){this.uuid=m(),this.connection=l,this.instance=i.instance,this.model=i.model,this.sequelize=r,this.options=O({plain:!1,raw:!1,logging:console.log},i),this.checkLoggingOption(),i.rawErrors&&(this.formatError=N.prototype.formatError)}static formatBindParameters(l,r,i,s,a){if(!r)return[l,[]];if(a=a||{},typeof s!="function"&&(a=s||{},s=void 0),!s)a.skipValueReplace?s=(o,p,b)=>{if(b[p]!==void 0)return o}:s=(o,p,b,u,h)=>{if(b[p]!==void 0)return E.escape(b[p],u,h)};else if(a.skipValueReplace){const o=s;s=(p,b,u,h,A,I)=>{if(o(p,b,u,h,A,I)!==void 0)return p}}const d=null,y=Array.isArray(r);return l=l.replace(/\B\$(\$|\w+)/g,(o,p)=>{if(p==="$")return a.skipUnescape?o:p;let b;if(y?p.match(/^[1-9]\d*$/)&&(p=p-1,b=s(o,p,r,d,i,a)):p.match(/^\d*$/)||(b=s(o,p,r,d,i,a)),b===void 0)throw new Error(`Named bind parameter "${o}" has no value in the given object.`);return b}),[l,[]]}formatError(l,r){return l.stack=r,l}run(){throw new Error("The run method wasn't overwritten!")}checkLoggingOption(){this.options.logging===!0&&(_.noTrueLogging(),this.options.logging=console.log)}getInsertIdField(){return"insertId"}getUniqueConstraintErrorMessage(l){let r=l?`${l} must be unique`:"Must be unique";if(l&&this.model)for(const i of Object.keys(this.model.uniqueKeys))this.model.uniqueKeys[i].fields.includes(l.replace(/"/g,""))&&this.model.uniqueKeys[i].msg&&(r=this.model.uniqueKeys[i].msg);return r}isRawQuery(){return this.options.type===w.RAW}isVersionQuery(){return this.options.type===w.VERSION}isUpsertQuery(){return this.options.type===w.UPSERT}isInsertQuery(l,r){let i=!0;return this.options.type===w.INSERT?!0:(i=i&&this.sql.toLowerCase().startsWith("insert into"),i=i&&(!l||Object.prototype.hasOwnProperty.call(l,this.getInsertIdField())),i=i&&(!r||Object.prototype.hasOwnProperty.call(r,this.getInsertIdField())),i)}handleInsertQuery(l,r){if(this.instance){const i=this.model.autoIncrementAttribute;let s=null;s=s||l&&l[this.getInsertIdField()],s=s||r&&r[this.getInsertIdField()],this.instance[i]=s}}isShowTablesQuery(){return this.options.type===w.SHOWTABLES}handleShowTablesQuery(l){return T.flatten(l.map(r=>Object.values(r)))}isShowIndexesQuery(){return this.options.type===w.SHOWINDEXES}isShowConstraintsQuery(){return this.options.type===w.SHOWCONSTRAINTS}isDescribeQuery(){return this.options.type===w.DESCRIBE}isSelectQuery(){return this.options.type===w.SELECT}isBulkUpdateQuery(){return this.options.type===w.BULKUPDATE}isBulkDeleteQuery(){return this.options.type===w.BULKDELETE}isForeignKeysQuery(){return this.options.type===w.FOREIGNKEYS}isUpdateQuery(){return this.options.type===w.UPDATE}handleSelectQuery(l){let r=null;if(this.options.fieldMap){const i=this.options.fieldMap;l=l.map(s=>T.reduce(i,(a,d,y)=>(a[y]!==void 0&&d!==y&&(a[d]=a[y],delete a[y]),a),s))}return this.options.raw?r=l.map(i=>{let s={};for(const a in i)Object.prototype.hasOwnProperty.call(i,a)&&(s[a]=i[a]);return this.options.nest&&(s=R.transform(s)),s}):this.options.hasJoin===!0?(l=N._groupJoinData(l,{model:this.model,includeMap:this.options.includeMap,includeNames:this.options.includeNames},{checkExisting:this.options.hasMultiAssociation}),r=this.model.bulkBuild(l,{isNewRecord:!1,include:this.options.include,includeNames:this.options.includeNames,includeMap:this.options.includeMap,includeValidated:!0,attributes:this.options.originalAttributes||this.options.attributes,raw:!0})):r=this.model.bulkBuild(l,{isNewRecord:!1,raw:!0,attributes:this.options.originalAttributes||this.options.attributes}),this.options.plain&&(r=r.length===0?null:r[0]),r}isShowOrDescribeQuery(){let l=!1;return l=l||this.sql.toLowerCase().startsWith("show"),l=l||this.sql.toLowerCase().startsWith("describe"),l}isCallQuery(){return this.sql.toLowerCase().startsWith("call")}_logQuery(l,r,i){const{connection:s,options:a}=this,d=this.sequelize.options.benchmark||a.benchmark,y=this.sequelize.options.logQueryParameters||a.logQueryParameters,o=Date.now();let p="";if(y&&i){const h=l.endsWith(";")?"":";";let A;Array.isArray(i)?A=i.map(I=>g(I)).join(", "):A=g(i),p=`${h} ${A}`}const b=`(${s.uuid||"default"}): ${l}${p}`,u=`Executing ${b}`;return r(u),d||this.sequelize.log(`Executing ${b}`,a),()=>{const h=`Executed ${b}`;r(h),d&&this.sequelize.log(h,Date.now()-o,a)}}static _groupJoinData(l,r,i){if(!l.length)return[];let s,a,d,y,o,p;const b=l.length;let u,h,A,I,q,L,D,C;const $=i.checkExisting;let P,Q,j;const B=$?[]:new Array(b),F={},x={};let k,X,H,W,se,le;const pe=ue=>{Object.prototype.hasOwnProperty.call(W.includeMap,ue)&&(x[h]=W=W.includeMap[ue],le?le=`${le}.${ue}`:le=ue,x[le]=W)},Oe={},ie=(ue,me)=>(Object.prototype.hasOwnProperty.call(me,ue)||(me[ue]=ue.substr(0,ue.lastIndexOf("."))),me[ue]),ne={},oe=ue=>{if(!Object.prototype.hasOwnProperty.call(ne,ue)){const me=ue.lastIndexOf(".");ne[ue]=ue.substr(me===-1?0:me+1)}return ne[ue]},_e={},J=ue=>{if(!Object.prototype.hasOwnProperty.call(_e,ue)){const me=ie(ue,Oe);Object.prototype.hasOwnProperty.call(_e,me)||(_e[me]=me?me.split("."):[]),_e[ue]=_e[me]}return _e[ue]},M={},K=ue=>{if(!Object.prototype.hasOwnProperty.call(M,ue)){const me=J(ue),v=me.length;M[ue]=v?me[v-1]:""}return M[ue]},be=ue=>{let me=T.chain(ue.uniqueKeys);return me=me.result(`${me.findKey()}.fields`).map(v=>T.findKey(ue.attributes,G=>G.field===v)).value(),me},xe=ue=>ue instanceof Buffer?ue.toString("hex"):ue;let qe,ve,Te;for(o=0;o<b;o++){if(p=l[o],o===0&&(u=T.sortBy(Object.keys(p),ue=>[ue.split(".").length]),I=u.length),$){if(C=!1,y=r.model.primaryKeyAttributes.length,j="",y===1)j=xe(p[r.model.primaryKeyAttributes[0]]);else if(y>1)for(d=0;d<y;d++)j+=xe(p[r.model.primaryKeyAttributes[d]]);else if(!T.isEmpty(r.model.uniqueKeys))for(ve=be(r.model),d=0;d<ve.length;d++)j+=p[ve[d]]}for(D=L={},X=void 0,A=0;A<I;A++){if(h=u[A],ie(h,Oe),k=J(h),o===0&&!Object.prototype.hasOwnProperty.call(x,h)&&(k.length?(W=r,le=void 0,k.forEach(pe)):x[h]=x[""]=r),X!==void 0&&X!==k){if($){if(a=X.length,se=null,Q=null,a)for(s=0;s<a;s++){if(Te=se?`${se}.${X[s]}`:X[s],qe=x[Te].model.primaryKeyAttributes,y=qe.length,P=Te,y===1)P+=xe(p[`${Te}.${qe[0]}`]);else if(y>1)for(d=0;d<y;d++)P+=xe(p[`${Te}.${qe[d]}`]);else if(!T.isEmpty(x[Te].model.uniqueKeys))for(ve=be(x[Te].model),d=0;d<ve.length;d++)P+=p[`${Te}.${ve[d]}`];Q||(Q=j),P=Q+P,se=Te,s<a-1&&(Q=P)}else P=j;P===j?F[P]?C=!0:F[P]=L:F[P]||(se=F[Q],H=K(q),x[q].association.isSingleAssociation?se&&(se[H]=F[P]=L):(se[H]||(se[H]=[]),se[H].push(F[P]=L))),L={}}else if(W=D,a=k.length,a)for(s=0;s<a;s++)s===a-1&&(L=W[k[s]]={}),W=W[k[s]]||{}}L[oe(h)]=p[h],q=h,X=k}if($){if(a=X.length,se=null,Q=null,a)for(s=0;s<a;s++){if(Te=se?`${se}.${X[s]}`:X[s],qe=x[Te].model.primaryKeyAttributes,y=qe.length,P=Te,y===1)P+=xe(p[`${Te}.${qe[0]}`]);else if(y>0)for(d=0;d<y;d++)P+=xe(p[`${Te}.${qe[d]}`]);else if(!T.isEmpty(x[Te].model.uniqueKeys))for(ve=be(x[Te].model),d=0;d<ve.length;d++)P+=p[`${Te}.${ve[d]}`];Q||(Q=j),P=Q+P,se=Te,s<a-1&&(Q=P)}else P=j;P===j?F[P]?C=!0:F[P]=L:F[P]||(se=F[Q],H=K(q),x[q].association.isSingleAssociation?se&&(se[H]=F[P]=L):(se[H]||(se[H]=[]),se[H].push(F[P]=L))),C||B.push(D)}else B[o]=D}return B}}return Nt.exports=N,Nt.exports.AbstractQuery=N,Nt.exports.default=N,Nt.exports}var kr,$i;function Xo(){if($i)return kr;$i=1;var S=Object.defineProperty,e=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,f=(i,s,a)=>s in i?S(i,s,{enumerable:!0,configurable:!0,writable:!0,value:a}):i[s]=a,O=(i,s)=>{for(var a in s||(s={}))t.call(s,a)&&f(i,a,s[a]);if(e)for(var a of e(s))n.call(s,a)&&f(i,a,s[a]);return i};const T=et(),E=ce,w=re,R=he(),{logger:_}=ge,m=1062,g=1213,N=1451,c=1452,l=_.debugContext("sql:mariadb");class r extends T{constructor(s,a,d){super(s,a,O({showWarnings:!1},d))}static formatBindParameters(s,a,d){const y=[],o=(p,b,u)=>{if(u[b]!==void 0)return y.push(u[b]),"?"};return s=T.formatBindParameters(s,a,d,o)[0],[s,y.length>0?y:void 0]}async run(s,a){this.sql=s;const{connection:d,options:y}=this,o=this.sequelize.options.showWarnings||y.showWarnings,p=this._logQuery(s,l,a);a&&l("parameters(%j)",a);let b;const u=new Error;try{b=await d.query(this.sql,a)}catch(h){if(y.transaction&&h.errno===g){try{await y.transaction.rollback()}catch{}y.transaction.finished="rollback"}throw h.sql=s,h.parameters=a,this.formatError(h,u.stack)}finally{p()}return o&&b&&b.warningStatus>0&&await this.logWarnings(b),this.formatResults(b)}formatResults(s){let a=this.instance;if(this.isBulkUpdateQuery()||this.isBulkDeleteQuery())return s.affectedRows;if(this.isUpsertQuery())return[a,s.affectedRows===1];if(this.isInsertQuery(s)&&(this.handleInsertQuery(s),!this.instance)){if(this.model&&this.model.autoIncrementAttribute&&this.model.autoIncrementAttribute===this.model.primaryKeyAttribute&&this.model.rawAttributes[this.model.primaryKeyAttribute]){const d=s[this.getInsertIdField()];a=new Array(s.affectedRows);const y=this.model.rawAttributes[this.model.primaryKeyAttribute].field;for(let o=0;o<s.affectedRows;o++)a[o]={[y]:d+o};return[a,s.affectedRows]}return[s[this.getInsertIdField()],s.affectedRows]}if(this.isSelectQuery())return this.handleJsonSelectQuery(s),this.handleSelectQuery(s);if(this.isInsertQuery()||this.isUpdateQuery())return[a,s.affectedRows];if(this.isCallQuery())return s[0];if(this.isRawQuery()){const d=s.meta;return delete s.meta,[s,d]}if(this.isShowIndexesQuery())return this.handleShowIndexesQuery(s);if(this.isForeignKeysQuery()||this.isShowConstraintsQuery())return s;if(this.isShowTablesQuery())return this.handleShowTablesQuery(s);if(this.isDescribeQuery()){a={};for(const d of s)a[d.Field]={type:d.Type.toLowerCase().startsWith("enum")?d.Type.replace(/^enum/i,"ENUM"):d.Type.toUpperCase(),allowNull:d.Null==="YES",defaultValue:d.Default,primaryKey:d.Key==="PRI",autoIncrement:Object.prototype.hasOwnProperty.call(d,"Extra")&&d.Extra.toLowerCase()==="auto_increment",comment:d.Comment?d.Comment:null};return a}return this.isVersionQuery()?s[0].version:a}handleJsonSelectQuery(s){if(!(!this.model||!this.model.fieldRawAttributesMap))for(const a of Object.keys(this.model.fieldRawAttributesMap)){const d=this.model.fieldRawAttributesMap[a];d.type instanceof R.JSON&&(s=s.map(y=>(y[d.fieldName]&&typeof y[d.fieldName]=="string"&&!this.connection.info.hasMinVersion(10,5,2)&&(y[d.fieldName]=JSON.parse(y[d.fieldName])),R.JSON.parse?R.JSON.parse(d,this.sequelize.options,y[d.fieldName]):y)))}}async logWarnings(s){const a=await this.run("SHOW WARNINGS"),d=`MariaDB Warnings (${this.connection.uuid||"default"}): `,y=[];for(const o of a)if(!(o===void 0||typeof o[Symbol.iterator]!="function"))for(const p of o)if(Object.prototype.hasOwnProperty.call(p,"Message"))y.push(p.Message);else for(const b of p.keys())y.push([b,p[b]].join(": "));return this.sequelize.log(d+y.join("; "),this.options),s}formatError(s,a){switch(s.errno){case m:{const d=s.message.match(/Duplicate entry '([\s\S]*)' for key '?((.|\s)*?)'?\s.*$/);let y={},o="Validation error";const p=d?d[1].split("-"):void 0,b=d?d[2]:void 0,u=d?d[1]:void 0,h=this.model&&this.model.uniqueKeys[b];h?(h.msg&&(o=h.msg),y=w.zipObject(h.fields,p)):y[b]=u;const A=[];return w.forOwn(y,(I,q)=>{A.push(new E.ValidationErrorItem(this.getUniqueConstraintErrorMessage(q),"unique violation",q,I,this.instance,"not_unique"))}),new E.UniqueConstraintError({message:o,errors:A,parent:s,fields:y,stack:a})}case N:case c:{const d=s.message.match(/CONSTRAINT ([`"])(.*)\1 FOREIGN KEY \(\1(.*)\1\) REFERENCES \1(.*)\1 \(\1(.*)\1\)/),y=d?d[1]:"`",o=d?d[3].split(new RegExp(`${y}, *${y}`)):void 0;return new E.ForeignKeyConstraintError({reltype:s.errno===N?"parent":"child",table:d?d[4]:void 0,fields:o,value:o&&o.length&&this.instance&&this.instance[o[0]]||void 0,index:d?d[2]:void 0,parent:s,stack:a})}default:return new E.DatabaseError(s,{stack:a})}}handleShowTablesQuery(s){return s.map(a=>({tableName:a.TABLE_NAME,schema:a.TABLE_SCHEMA}))}handleShowIndexesQuery(s){let a;const d=[];return s.forEach(y=>{(!a||a.name!==y.Key_name)&&(a={primary:y.Key_name==="PRIMARY",fields:[],name:y.Key_name,tableName:y.Table,unique:y.Non_unique!==1,type:y.Index_type},d.push(a)),a.fields[y.Seq_in_index-1]={attribute:y.Column_name,length:y.Sub_part||void 0,order:y.Collation==="A"?"ASC":void 0}}),d}}return kr=r,kr}var Hr,Pi;function Zo(){if(Pi)return Hr;Pi=1;var S=Object.defineProperty,e=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,f=(_,m,g)=>m in _?S(_,m,{enumerable:!0,configurable:!0,writable:!0,value:g}):_[m]=g,O=(_,m)=>{for(var g in m||(m={}))t.call(m,g)&&f(_,g,m[g]);if(e)for(var g of e(m))n.call(m,g)&&f(_,g,m[g]);return _};const T=re,E=Re,w=fe();return Hr={OperatorMap:{[E.eq]:"=",[E.ne]:"!=",[E.gte]:">=",[E.gt]:">",[E.lte]:"<=",[E.lt]:"<",[E.not]:"IS NOT",[E.is]:"IS",[E.in]:"IN",[E.notIn]:"NOT IN",[E.like]:"LIKE",[E.notLike]:"NOT LIKE",[E.iLike]:"ILIKE",[E.notILike]:"NOT ILIKE",[E.startsWith]:"LIKE",[E.endsWith]:"LIKE",[E.substring]:"LIKE",[E.regexp]:"~",[E.notRegexp]:"!~",[E.iRegexp]:"~*",[E.notIRegexp]:"!~*",[E.between]:"BETWEEN",[E.notBetween]:"NOT BETWEEN",[E.overlap]:"&&",[E.contains]:"@>",[E.contained]:"<@",[E.adjacent]:"-|-",[E.strictLeft]:"<<",[E.strictRight]:">>",[E.noExtendRight]:"&<",[E.noExtendLeft]:"&>",[E.any]:"ANY",[E.all]:"ALL",[E.and]:" AND ",[E.or]:" OR ",[E.col]:"COL",[E.placeholder]:"$$PLACEHOLDER$$",[E.match]:"@@"},OperatorsAliasMap:{},setOperatorsAliases(_){!_||T.isEmpty(_)?this.OperatorsAliasMap=!1:this.OperatorsAliasMap=O({},_)},_replaceAliases(_){const m={};return this.OperatorsAliasMap?(w.getOperators(_).forEach(g=>{const N=_[g];T.isPlainObject(N)?m[g]=this._replaceAliases(N):m[g]=N}),T.forOwn(_,(g,N)=>{N=this.OperatorsAliasMap[N]||N,T.isPlainObject(g)&&(g=this._replaceAliases(g)),m[N]=g}),m):_}},Hr}var Gr,vi;function eu(){if(vi)return Gr;vi=1;const S=Qt.v4;return Gr={setIsolationLevelQuery(t,n){if(!n.parent)return`SET TRANSACTION ISOLATION LEVEL ${t};`},generateTransactionId(){return S()},startTransactionQuery(t){return t.parent?`SAVEPOINT ${this.quoteIdentifier(t.name,!0)};`:"START TRANSACTION;"},deferConstraintsQuery(){},setConstraintQuery(){},setDeferredQuery(){},setImmediateQuery(){},commitTransactionQuery(t){if(!t.parent)return"COMMIT;"},rollbackTransactionQuery(t){return t.parent?`ROLLBACK TO SAVEPOINT ${this.quoteIdentifier(t.name,!0)};`:"ROLLBACK;"}},Gr}var Vr,ji;function ut(){if(ji)return Vr;ji=1;var S=Object.defineProperty,e=Object.defineProperties,t=Object.getOwnPropertyDescriptors,n=Object.getOwnPropertySymbols,f=Object.prototype.hasOwnProperty,O=Object.prototype.propertyIsEnumerable,T=(b,u,h)=>u in b?S(b,u,{enumerable:!0,configurable:!0,writable:!0,value:h}):b[u]=h,E=(b,u)=>{for(var h in u||(u={}))f.call(u,h)&&T(b,h,u[h]);if(n)for(var h of n(u))O.call(u,h)&&T(b,h,u[h]);return b},w=(b,u)=>e(b,t(u));const R=Ae,_=re,m=Qt.v4,g=fe(),N=ur(),c=he(),l=Zn,r=nt,i=at,s=Ut,a=Et,d=Re,y=ce,o=na;class p{constructor(u){if(!u.sequelize)throw new Error("QueryGenerator initialized without options.sequelize");if(!u._dialect)throw new Error("QueryGenerator initialized without options._dialect");this.sequelize=u.sequelize,this.options=u.sequelize.options,this.dialect=u._dialect.name,this._dialect=u._dialect,this._initQuoteIdentifier()}extractTableDetails(u,h){return h=h||{},u=u||{},{schema:u.schema||h.schema||this.options.schema||"public",tableName:_.isPlainObject(u)?u.tableName:u,delimiter:u.delimiter||h.delimiter||"."}}addSchema(u){if(!u._schema)return u.tableName||u;const h=this;return{tableName:u.tableName||u,table:u.tableName||u,name:u.name||u,schema:u._schema,delimiter:u._schemaDelimiter||".",toString(){return h.quoteTable(this)}}}dropSchema(u,h){return this.dropTableQuery(u,h)}describeTableQuery(u,h,A){return`DESCRIBE ${this.quoteTable(this.addSchema({tableName:u,_schema:h,_schemaDelimiter:A}))};`}dropTableQuery(u){return`DROP TABLE IF EXISTS ${this.quoteTable(u)};`}renameTableQuery(u,h){return`ALTER TABLE ${this.quoteTable(u)} RENAME TO ${this.quoteTable(h)};`}populateInsertQueryReturnIntoBinds(){}insertQuery(u,h,A,I){I=I||{},_.defaults(I,this.options);const q={},L=I.bind||[],D=[],C=[],$=[],P=[],Q=this.quoteTable(u),j=I.bindParam===void 0?this.bindParam(L):I.bindParam,B=[];let F,x="",k="",X="",H="",W=!1,se="";if(A&&_.each(A,(ie,ne)=>{q[ne]=ie,ie.field&&(q[ie.field]=ie)}),this._dialect.supports["DEFAULT VALUES"]?k+=" DEFAULT VALUES":this._dialect.supports["VALUES ()"]&&(k+=" VALUES ()"),(this._dialect.supports.returnValues||this._dialect.supports.returnIntoValues)&&I.returning){const ie=this.generateReturnValues(A,I);C.push(...ie.returnFields),this._dialect.supports.returnIntoValues&&$.push(...ie.returnTypes),H=ie.returningFragment,se=ie.tmpTable||"",X=ie.outputFragment||""}(_.get(this,["sequelize","options","dialectOptions","prependSearchPath"])||I.searchPath)&&(I.bindParam=!1),this._dialect.supports.EXCEPTION&&I.exception&&(I.bindParam=!1),h=g.removeNullValuesFromHash(h,this.options.omitNull);for(const ie in h)if(Object.prototype.hasOwnProperty.call(h,ie)){const ne=h[ie];D.push(this.quoteIdentifier(ie)),q&&q[ie]&&q[ie].autoIncrement===!0&&ne==null?this._dialect.supports.autoIncrement.defaultValue?this._dialect.supports.DEFAULT?P.push("DEFAULT"):P.push(this.escape(null)):D.splice(-1,1):(q&&q[ie]&&q[ie].autoIncrement===!0&&(W=!0),ne instanceof g.SequelizeMethod||I.bindParam===!1?P.push(this.escape(ne,q&&q[ie]||void 0,{context:"INSERT"})):P.push(this.format(ne,q&&q[ie]||void 0,{context:"INSERT"},j)))}let le="";if(!_.isEmpty(I.conflictWhere)&&!this._dialect.supports.inserts.onConflictWhere)throw new Error("missing dialect support for conflictWhere option");if(this._dialect.supports.inserts.updateOnDuplicate&&I.updateOnDuplicate)if(this._dialect.supports.inserts.updateOnDuplicate==" ON CONFLICT DO UPDATE SET"){const ie=I.upsertKeys.map(_e=>this.quoteIdentifier(_e)),ne=I.updateOnDuplicate.map(_e=>`${this.quoteIdentifier(_e)}=EXCLUDED.${this.quoteIdentifier(_e)}`),oe=["ON CONFLICT","(",ie.join(","),")"];_.isEmpty(I.conflictWhere)||oe.push(this.whereQuery(I.conflictWhere,I)),_.isEmpty(ne)?oe.push("DO NOTHING"):oe.push("DO UPDATE SET",ne.join(",")),le=` ${g.joinSQLFragments(oe)}`}else{const ie=I.updateOnDuplicate.map(ne=>`${this.quoteIdentifier(ne)}=VALUES(${this.quoteIdentifier(ne)})`);if(_.isEmpty(ie)&&I.upsertKeys&&ie.push(...I.upsertKeys.map(ne=>`${this.quoteIdentifier(ne)}=${this.quoteIdentifier(ne)}`)),_.isEmpty(ie))throw new Error("No update values found for ON DUPLICATE KEY UPDATE clause, and no identifier fields could be found to use instead.");le+=`${this._dialect.supports.inserts.updateOnDuplicate} ${ie.join(",")}`}const pe={ignoreDuplicates:I.ignoreDuplicates?this._dialect.supports.inserts.ignoreDuplicates:"",onConflictDoNothing:I.ignoreDuplicates?this._dialect.supports.inserts.onConflictDoNothing:"",attributes:D.join(","),output:X,values:P.join(","),tmpTable:se};if(x=`${se}INSERT${pe.ignoreDuplicates} INTO ${Q} (${pe.attributes})${pe.output} VALUES (${pe.values})${le}${pe.onConflictDoNothing}${x}`,k=`${se}INSERT${pe.ignoreDuplicates} INTO ${Q}${pe.output}${le}${pe.onConflictDoNothing}${k}`,this._dialect.supports.EXCEPTION&&I.exception){const ie="DROP FUNCTION IF EXISTS pg_temp.testfunc()";C.length===0&&C.push("*");const ne=`$func_${m().replace(/-/g,"")}$`,oe=`SELECT (testfunc.response).${C.join(", (testfunc.response).")}, testfunc.sequelize_caught_exception FROM pg_temp.testfunc();`;I.exception="WHEN unique_violation THEN GET STACKED DIAGNOSTICS sequelize_caught_exception = PG_EXCEPTION_DETAIL;",x=`CREATE OR REPLACE FUNCTION pg_temp.testfunc(OUT response ${Q}, OUT sequelize_caught_exception text) RETURNS RECORD AS ${ne} BEGIN ${x} RETURNING * INTO response; EXCEPTION ${I.exception} END ${ne} LANGUAGE plpgsql; ${oe} ${ie}`}else x+=H,k+=H;this._dialect.supports.returnIntoValues&&I.returning&&this.populateInsertQueryReturnIntoBinds(C,$,L.length,B,I),F=`${pe.attributes.length?x:k}${B.join(",")};`,this._dialect.supports.finalTable&&(F=`SELECT * FROM FINAL TABLE(${pe.attributes.length?x:k});`),W&&this._dialect.supports.autoIncrement.identityInsert&&(F=`SET IDENTITY_INSERT ${Q} ON; ${F} SET IDENTITY_INSERT ${Q} OFF;`);const Oe={query:F};return I.bindParam!==!1&&(Oe.bind=L),Oe}bulkInsertQuery(u,h,A,I){A=A||{},I=I||{};const q=[],L={},D=[];let C="";for(const B of h)_.forOwn(B,(F,x)=>{D.includes(x)||D.push(x),I[x]&&I[x].autoIncrement===!0&&(L[x]=!0)});for(const B of h){const F=D.map(x=>this._dialect.supports.bulkDefault&&L[x]===!0?B[x]!=null?B[x]:"DEFAULT":this.escape(B[x],I[x],{context:"INSERT"}));q.push(`(${F.join(",")})`)}if(this._dialect.supports.inserts.updateOnDuplicate&&A.updateOnDuplicate)if(this._dialect.supports.inserts.updateOnDuplicate==" ON CONFLICT DO UPDATE SET"){const B=A.upsertKeys.map(k=>this.quoteIdentifier(k)),F=A.updateOnDuplicate.map(k=>`${this.quoteIdentifier(k)}=EXCLUDED.${this.quoteIdentifier(k)}`);let x=!1;if(A.conflictWhere){if(!this._dialect.supports.inserts.onConflictWhere)throw new Error(`conflictWhere not supported for dialect ${this._dialect.name}`);x=this.whereQuery(A.conflictWhere,A)}C=["ON CONFLICT","(",B.join(","),")",x,"DO UPDATE SET",F.join(",")]}else{if(A.conflictWhere)throw new Error(`conflictWhere not supported for dialect ${this._dialect.name}`);const B=A.updateOnDuplicate.map(F=>`${this.quoteIdentifier(F)}=VALUES(${this.quoteIdentifier(F)})`);C=`${this._dialect.supports.inserts.updateOnDuplicate} ${B.join(",")}`}const $=A.ignoreDuplicates?this._dialect.supports.inserts.ignoreDuplicates:"",P=D.map(B=>this.quoteIdentifier(B)).join(","),Q=A.ignoreDuplicates?this._dialect.supports.inserts.onConflictDoNothing:"";let j="";if(this._dialect.supports.returnValues&&A.returning){const B=this.generateReturnValues(I,A);j+=B.returningFragment}return g.joinSQLFragments(["INSERT",$,"INTO",this.quoteTable(u),`(${P})`,"VALUES",q.join(","),C,Q,j,";"])}updateQuery(u,h,A,I,q){I=I||{},_.defaults(I,this.options),h=g.removeNullValuesFromHash(h,I.omitNull,I);const L=[],D=[],C={};let $="",P="",Q="";(_.get(this,["sequelize","options","dialectOptions","prependSearchPath"])||I.searchPath)&&(I.bindParam=!1);const j=I.bindParam===void 0?this.bindParam(D):I.bindParam;if(this._dialect.supports["LIMIT ON UPDATE"]&&I.limit&&(["mssql","db2","oracle"].includes(this.dialect)?this.dialect==="oracle"&&(A&&(A.length&&A.length>0||Object.keys(A).length>0)?Q+=" AND ":Q+=" WHERE ",Q+=`rownum <= ${this.escape(I.limit)} `):Q=` LIMIT ${this.escape(I.limit)} `),this._dialect.supports.returnValues&&I.returning){const k=this.generateReturnValues(q,I);Q+=k.returningFragment,P=k.tmpTable||"",$=k.outputFragment||"",!this._dialect.supports.returnValues.output&&I.returning&&(I.mapToModel=!0)}q&&_.each(q,(k,X)=>{C[X]=k,k.field&&(C[k.field]=k)});for(const k in h){if(C&&C[k]&&C[k].autoIncrement===!0&&!this._dialect.supports.autoIncrement.update)continue;const X=h[k];X instanceof g.SequelizeMethod||I.bindParam===!1?L.push(`${this.quoteIdentifier(k)}=${this.escape(X,C&&C[k]||void 0,{context:"UPDATE"})}`):L.push(`${this.quoteIdentifier(k)}=${this.format(X,C&&C[k]||void 0,{context:"UPDATE"},j)}`)}const B=w(E({},I),{bindParam:j});if(L.length===0)return"";const x={query:`${P}UPDATE ${this.quoteTable(u)} SET ${L.join(",")}${$} ${this.whereQuery(A,B)}${Q}`.trim()};return I.bindParam!==!1&&(x.bind=D),x}arithmeticQuery(u,h,A,I,q,L){L=L||{},_.defaults(L,{returning:!0}),q=g.removeNullValuesFromHash(q,this.options.omitNull);let D="",C="";if(this._dialect.supports.returnValues&&L.returning){const P=this.generateReturnValues(null,L);D=P.outputFragment,C=P.returningFragment}const $=[];for(const P in I){const Q=I[P],j=this.quoteIdentifier(P),B=this.escape(Q);$.push(`${j}=${j}${u} ${B}`)}for(const P in q){const Q=q[P],j=this.quoteIdentifier(P),B=this.escape(Q);$.push(`${j}=${B}`)}return g.joinSQLFragments(["UPDATE",this.quoteTable(h),"SET",$.join(","),D,this.whereQuery(A),C])}addIndexQuery(u,h,A,I){A=A||{},Array.isArray(h)?A.fields=h:(A=h,h=void 0),A.prefix=A.prefix||I||u,A.prefix&&typeof A.prefix=="string"&&(A.prefix=A.prefix.replace(/\./g,"_"),A.prefix=A.prefix.replace(/("|')/g,""));const q=A.fields.map(C=>{if(C instanceof g.SequelizeMethod)return this.handleSequelizeMethod(C);typeof C=="string"&&(C={name:C});let $="";if(C.attribute&&(C.name=C.attribute),!C.name)throw new Error(`The following index field has no name: ${R.inspect(C)}`);if($+=this.quoteIdentifier(C.name),this._dialect.supports.index.collate&&C.collate&&($+=` COLLATE ${this.quoteIdentifier(C.collate)}`),this._dialect.supports.index.operator){const P=C.operator||A.operator;P&&($+=` ${P}`)}return this._dialect.supports.index.length&&C.length&&($+=`(${C.length})`),C.order&&($+=` ${C.order}`),$});A.name||(A=g.nameIndex(A,A.prefix)),A=l._conformIndex(A),this._dialect.supports.index.type||delete A.type,A.where&&(A.where=this.whereQuery(A.where)),typeof u=="string"?u=this.quoteIdentifiers(u):u=this.quoteTable(u);const L=this._dialect.supports.index.concurrently&&A.concurrently?"CONCURRENTLY":void 0;let D;return this._dialect.supports.indexViaAlter?D=["ALTER TABLE",u,L,"ADD"]:D=["CREATE"],D=D.concat(A.unique?"UNIQUE":"",A.type,"INDEX",this._dialect.supports.indexViaAlter?void 0:L,this.quoteIdentifiers(A.name),this._dialect.supports.index.using===1&&A.using?`USING ${A.using}`:"",this._dialect.supports.indexViaAlter?void 0:`ON ${u}`,this._dialect.supports.index.using===2&&A.using?`USING ${A.using}`:"",`(${q.join(", ")})`,this._dialect.supports.index.parser&&A.parser?`WITH PARSER ${A.parser}`:void 0,this._dialect.supports.index.where&&A.where?A.where:void 0),_.compact(D).join(" ")}addConstraintQuery(u,h){return typeof u=="string"?u=this.quoteIdentifiers(u):u=this.quoteTable(u),g.joinSQLFragments(["ALTER TABLE",u,"ADD",this.getConstraintSnippet(u,h||{}),";"])}getConstraintSnippet(u,h){let A,I;const q=h.fields.map(C=>{if(typeof C=="string")return this.quoteIdentifier(C);if(C instanceof g.SequelizeMethod)return this.handleSequelizeMethod(C);if(C.attribute&&(C.name=C.attribute),!C.name)throw new Error(`The following index field has no name: ${C}`);return this.quoteIdentifier(C.name)}),L=q.join(", "),D=q.join("_");switch(h.type.toUpperCase()){case"UNIQUE":I=this.quoteIdentifier(h.name||`${u}_${D}_uk`),A=`CONSTRAINT ${I} UNIQUE (${L})`;break;case"CHECK":h.where=this.whereItemsQuery(h.where),I=this.quoteIdentifier(h.name||`${u}_${D}_ck`),A=`CONSTRAINT ${I} CHECK (${h.where})`;break;case"DEFAULT":if(h.defaultValue===void 0)throw new Error("Default value must be specified for DEFAULT CONSTRAINT");if(this._dialect.name!=="mssql")throw new Error("Default constraints are supported only for MSSQL dialect.");I=this.quoteIdentifier(h.name||`${u}_${D}_df`),A=`CONSTRAINT ${I} DEFAULT (${this.escape(h.defaultValue)}) FOR ${q[0]}`;break;case"PRIMARY KEY":I=this.quoteIdentifier(h.name||`${u}_${D}_pk`),A=`CONSTRAINT ${I} PRIMARY KEY (${L})`;break;case"FOREIGN KEY":const C=h.references;if(!C||!C.table||!(C.field||C.fields))throw new Error("references object with table and field must be specified");I=this.quoteIdentifier(h.name||`${u}_${D}_${C.table}_fk`);const $=typeof C.field<"u"?this.quoteIdentifier(C.field):C.fields.map(Q=>this.quoteIdentifier(Q)).join(", "),P=`${this.quoteTable(C.table)} (${$})`;A=`CONSTRAINT ${I} `,A+=`FOREIGN KEY (${L}) REFERENCES ${P}`,h.onUpdate&&(A+=` ON UPDATE ${h.onUpdate.toUpperCase()}`),h.onDelete&&(A+=` ON DELETE ${h.onDelete.toUpperCase()}`);break;default:throw new Error(`${h.type} is invalid.`)}return h.deferrable&&["UNIQUE","PRIMARY KEY","FOREIGN KEY"].includes(h.type.toUpperCase())&&(A+=` ${this.deferConstraintsQuery(h)}`),A}removeConstraintQuery(u,h){return typeof u=="string"?u=this.quoteIdentifiers(u):u=this.quoteTable(u),g.joinSQLFragments(["ALTER TABLE",u,"DROP CONSTRAINT",this.quoteIdentifiers(h)])}quote(u,h,A){const I=["ASC","DESC","ASC NULLS LAST","DESC NULLS LAST","ASC NULLS FIRST","DESC NULLS FIRST","NULLS FIRST","NULLS LAST"];if(A=A||".",typeof u=="string")return this.quoteIdentifiers(u);if(Array.isArray(u)){u.forEach((P,Q)=>{const j=u[Q-1];let B,F;if(!j&&h!==void 0?F=h:j&&j instanceof r&&(B=j,F=j.target),F&&F.prototype instanceof l){let x,k;if(typeof P=="function"&&P.prototype instanceof l?x=P:_.isPlainObject(P)&&P.model&&P.model.prototype instanceof l&&(x=P.model,k=P.as),x&&(!k&&B&&B instanceof r&&B.through&&B.through.model===x?P=new r(F,x,{as:x.name}):(P=F.getAssociationForAlias(x,k),P||(P=F.getAssociationForAlias(x,x.name))),!(P instanceof r)))throw new Error(R.format("Unable to find a valid association for model, '%s'",x.name))}if(typeof P=="string"){const x=I.indexOf(P.toUpperCase());if(Q>0&&x!==-1)P=this.sequelize.literal(` ${I[x]}`);else if(F&&F.prototype instanceof l){if(F.associations!==void 0&&F.associations[P])P=F.associations[P];else if(F.rawAttributes!==void 0&&F.rawAttributes[P]&&P!==F.rawAttributes[P].field)P=F.rawAttributes[P].field;else if(P.includes(".")&&F.rawAttributes!==void 0){const k=P.split(".");if(F.rawAttributes[k[0]].type instanceof c.JSON){const X=this.quoteIdentifiers(`${F.name}.${F.rawAttributes[k[0]].field}`),H=k.slice(1);P=this.jsonPathExtractionQuery(X,H),P=this.sequelize.literal(P)}}}}u[Q]=P},this);const q=u.length,L=[];let D,C=0;for(C=0;C<q-1&&(D=u[C],!(typeof D=="string"||D._modelAttribute||D instanceof g.SequelizeMethod));C++)D instanceof r&&(L[C]=D.as);let $="";return C>0?$+=`${this.quoteIdentifier(L.join(A))}.`:typeof u[0]=="string"&&h&&($+=`${this.quoteIdentifier(h.name)}.`),u.slice(C).forEach(P=>{$+=this.quote(P,h,A)},this),$}if(u._modelAttribute)return`${this.quoteTable(u.Model.name)}.${this.quoteIdentifier(u.fieldName)}`;if(u instanceof g.SequelizeMethod)return this.handleSequelizeMethod(u);throw _.isPlainObject(u)&&u.raw?new Error('The `{raw: "..."}` syntax is no longer supported.  Use `sequelize.literal` instead.'):new Error(`Unknown structure passed to order / group: ${R.inspect(u)}`)}_initQuoteIdentifier(){this._quoteIdentifier=this.quoteIdentifier,this.quoteIdentifier=function(u,h){return u==="*"?u:this._quoteIdentifier(u,h)}}quoteIdentifier(u,h){throw new Error(`quoteIdentifier for Dialect "${this.dialect}" is not implemented`)}quoteIdentifiers(u){if(u.includes(".")){u=u.split(".");const h=u.slice(0,u.length-1).join("->"),A=u[u.length-1];return`${this.quoteIdentifier(h)}.${this.quoteIdentifier(A)}`}return this.quoteIdentifier(u)}quoteAttribute(u,h){return h&&u in h.rawAttributes?this.quoteIdentifier(u):this.quoteIdentifiers(u)}getAliasToken(){return"AS"}quoteTable(u,h){let A="";return h===!0&&(h=u.as||u.name||u),_.isObject(u)?this._dialect.supports.schemas?(u.schema&&(A+=`${this.quoteIdentifier(u.schema)}.`),A+=this.quoteIdentifier(u.tableName)):(u.schema&&(A+=u.schema+(u.delimiter||".")),A+=u.tableName,A=this.quoteIdentifier(A)):A=this.quoteIdentifier(u),h&&(A+=` ${this.getAliasToken()} ${this.quoteIdentifier(h)}`),A}escape(u,h,A){if(A=A||{},u!=null){if(u instanceof g.SequelizeMethod)return this.handleSequelizeMethod(u);if(h&&h.type&&(this.validate(u,h,A),h.type.stringify)){const I=q=>N.escape(q,this.options.timezone,this.dialect);if(u=h.type.stringify(u,{escape:I,field:h,timezone:this.options.timezone,operation:A.operation}),h.type.escape===!1)return u}}return N.escape(u,this.options.timezone,this.dialect)}bindParam(u){return h=>(u.push(h),`$${u.length}`)}format(u,h,A,I){if(A=A||{},u!=null){if(u instanceof g.SequelizeMethod)throw new Error("Cannot pass SequelizeMethod as a bind parameter - use escape instead");if(h&&h.type&&(this.validate(u,h,A),h.type.bindParam))return h.type.bindParam(u,{escape:_.identity,field:h,timezone:this.options.timezone,operation:A.operation,bindParam:I})}return I(u)}validate(u,h,A){if(this.typeValidation&&h.type.validate&&u)try{if(A.isList&&Array.isArray(u))for(const I of u)h.type.validate(I,A);else h.type.validate(u,A)}catch(I){throw I instanceof y.ValidationError&&I.errors.push(new y.ValidationErrorItem(I.message,"Validation error",h.fieldName,u,null,`${h.type.key} validator`)),I}}isIdentifierQuoted(u){return/^\s*(?:([`"'])(?:(?!\1).|\1{2})*\1\.?)+\s*$/i.test(u)}jsonPathExtractionQuery(u,h,A){let I=_.toPath(h),q;const L=this.isIdentifierQuoted(u)?u:this.quoteIdentifier(u);switch(this.dialect){case"mysql":case"mariadb":case"sqlite":return this.dialect==="mysql"&&(I=I.map(C=>/\D/.test(C)?g.addTicks(C,'"'):C)),q=this.escape(["$"].concat(I).join(".").replace(/\.(\d+)(?:(?=\.)|$)/g,(C,$)=>`[${$}]`)),this.dialect==="sqlite"?`json_extract(${L},${q})`:`json_unquote(json_extract(${L},${q}))`;case"postgres":const D=A?"#>":"#>>";return q=this.escape(`{${I.join(",")}}`),`(${L}${D}${q})`;default:throw new Error(`Unsupported ${this.dialect} for JSON operations`)}}selectQuery(u,h,A){h=h||{};const I=h.limit,q=[],L=[],D=h.subQuery===void 0?I&&h.hasMultiAssociation:h.subQuery,C={main:h.attributes&&h.attributes.slice(),subQuery:null},$={name:u,quotedName:null,as:null,model:A},P={names:$,options:h,subQuery:D};let Q=[],j=[],B;if(this.options.minifyAliases&&!h.aliasesMapping&&(h.aliasesMapping=new Map,h.aliasesByTable={},h.includeAliases=new Map),h.tableAs?$.as=this.quoteIdentifier(h.tableAs):!Array.isArray($.name)&&$.model&&($.as=this.quoteIdentifier($.model.name)),$.quotedName=Array.isArray($.name)?u.map(x=>Array.isArray(x)?this.quoteTable(x[0],x[1]):this.quoteTable(x,!0)).join(", "):this.quoteTable($.name),D&&C.main)for(const x of $.model.primaryKeyAttributes)C.main.some(k=>x===k||x===k[0]||x===k[1])||C.main.push($.model.rawAttributes[x].field?[x,$.model.rawAttributes[x].field]:x);if(C.main=this.escapeAttributes(C.main,h,$.as),C.main=C.main||(h.include?[`${$.as}.*`]:["*"]),(D||h.groupedLimit)&&(C.subQuery=C.main,C.main=[`${$.as||$.quotedName}.*`]),h.include)for(const x of h.include){if(x.separate)continue;const k=this.generateInclude(x,{externalAs:$.as,internalAs:$.as},P);j=j.concat(k.subQuery),Q=Q.concat(k.mainQuery),k.attributes.main.length>0&&(C.main=_.uniq(C.main.concat(k.attributes.main))),k.attributes.subQuery.length>0&&(C.subQuery=_.uniq(C.subQuery.concat(k.attributes.subQuery)))}if(D)L.push(this.selectFromTableFragment(h,$.model,C.subQuery,$.quotedName,$.as)),L.push(j.join(""));else{if(h.groupedLimit){$.as||($.as=$.quotedName);const x=E({},h.where);let k,X,H,W=$.as;if(typeof h.groupedLimit.on=="string"?X=h.groupedLimit.on:h.groupedLimit.on instanceof a&&(X=h.groupedLimit.on.foreignKeyField),h.groupedLimit.on instanceof s){W=h.groupedLimit.on.manyFromSource.as;const Oe=l._validateIncludedElements({include:[{association:h.groupedLimit.on.manyFromSource,duplicating:!1,required:!0,where:E({[d.placeholder]:!0},h.groupedLimit.through&&h.groupedLimit.through.where)}],model:A});h.hasJoin=!0,h.hasMultiAssociation=!0,h.includeMap=Object.assign(Oe.includeMap,h.includeMap),h.includeNames=Oe.includeNames.concat(h.includeNames||[]),H=Oe.include,Array.isArray(h.order)&&(h.order.forEach((ie,ne)=>{Array.isArray(ie)&&(ie=ie[0]);let oe=`subquery_order_${ne}`;h.attributes.push([ie,oe]),oe=this.sequelize.literal(this.quote(oe)),Array.isArray(h.order[ne])?h.order[ne][0]=oe:h.order[ne]=oe}),k=h.order)}else k=h.order,this._dialect.supports.topLevelOrderByRequired||delete h.order,x[d.placeholder]=!0;const se=`SELECT * FROM (${this.selectQuery(u,{attributes:h.attributes,offset:h.offset,limit:h.groupedLimit.limit,order:k,aliasesMapping:h.aliasesMapping,aliasesByTable:h.aliasesByTable,where:x,include:H,model:A},A).replace(/;$/,"")}) ${this.getAliasToken()} sub`,le=this.whereItemQuery(d.placeholder,!0,{model:A}),pe=se.indexOf(le);q.push(this.selectFromTableFragment(h,$.model,C.main,`(${h.groupedLimit.values.map(Oe=>{let ie;return X&&(ie={[X]:Oe}),H&&(ie={[h.groupedLimit.on.foreignIdentifierField]:Oe}),g.spliceStr(se,pe,le.length,this.getWhereConditions(ie,W))}).join(this._dialect.supports["UNION ALL"]?" UNION ALL ":" UNION ")})`,$.as))}else q.push(this.selectFromTableFragment(h,$.model,C.main,$.quotedName,$.as));q.push(Q.join(""))}if(Object.prototype.hasOwnProperty.call(h,"where")&&!h.groupedLimit&&(h.where=this.getWhereConditions(h.where,$.as||u,A,h),h.where&&(D?L.push(` WHERE ${h.where}`):(q.push(` WHERE ${h.where}`),q.forEach((x,k)=>{x.startsWith("SELECT")&&(q[k]=this.selectFromTableFragment(h,A,C.main,$.quotedName,$.as,h.where))})))),h.group&&(h.group=Array.isArray(h.group)?h.group.map(x=>this.aliasGrouping(x,A,$.as,h)).join(", "):this.aliasGrouping(h.group,A,$.as,h),D&&h.group?L.push(` GROUP BY ${h.group}`):h.group&&q.push(` GROUP BY ${h.group}`)),Object.prototype.hasOwnProperty.call(h,"having")&&(h.having=this.getWhereConditions(h.having,u,A,h,!1),h.having&&(D?L.push(` HAVING ${h.having}`):q.push(` HAVING ${h.having}`))),h.order){const x=this.getQueryOrders(h,A,D);x.mainQueryOrder.length&&q.push(` ORDER BY ${x.mainQueryOrder.join(", ")}`),x.subQueryOrder.length&&L.push(` ORDER BY ${x.subQueryOrder.join(", ")}`)}const F=this.addLimitAndOffset(h,$.model);if(F&&!h.groupedLimit&&(D?L.push(F):q.push(F)),D?(this._throwOnEmptyAttributes(C.main,{modelName:A&&A.name,as:$.as}),B=`SELECT ${C.main.join(", ")} FROM (${L.join("")}) ${this.getAliasToken()} ${$.as}${Q.join("")}${q.join("")}`):B=q.join(""),h.lock&&this._dialect.supports.lock){let x=h.lock;typeof h.lock=="object"&&(x=h.lock.level),this._dialect.supports.lockKey&&["KEY SHARE","NO KEY UPDATE"].includes(x)?B+=` FOR ${x}`:x==="SHARE"?B+=` ${this._dialect.supports.forShare}`:B+=" FOR UPDATE",this._dialect.supports.lockOf&&h.lock.of&&h.lock.of.prototype instanceof l&&(B+=` OF ${this.quoteTable(h.lock.of.name)}`),this._dialect.supports.skipLocked&&h.skipLocked&&(B+=" SKIP LOCKED")}return`${B};`}aliasGrouping(u,h,A,I){const q=Array.isArray(u)?u[0]:u;return this.quote(this._getAliasForField(A,q,I)||q,h)}escapeAttributes(u,h,A){return u&&u.map(I=>{let q=!0;if(I instanceof g.SequelizeMethod)return this.handleSequelizeMethod(I);if(Array.isArray(I)){if(I.length!==2)throw new Error(`${JSON.stringify(I)} is not a valid attribute definition. Please use the following format: ['attribute definition', 'alias']`);if(I=I.slice(),I[0]instanceof g.SequelizeMethod)I[0]=this.handleSequelizeMethod(I[0]),q=!1;else if(this.options.attributeBehavior==="escape"||!I[0].includes("(")&&!I[0].includes(")"))I[0]=this.quoteIdentifier(I[0]);else if(this.options.attributeBehavior!=="unsafe-legacy")throw new Error(`Attributes cannot include parentheses in Sequelize 6:
In order to fix the vulnerability CVE-2023-22578, we had to remove support for treating attributes as raw SQL if they included parentheses.
Sequelize 7 escapes all attributes, even if they include parentheses.
For Sequelize 6, because we're introducing this change in a minor release, we've opted for throwing an error instead of silently escaping the attribute as a way to warn you about this change.

Here is what you can do to fix this error:
- Wrap the attribute in a literal() call. This will make Sequelize treat it as raw SQL.
- Set the "attributeBehavior" sequelize option to "escape" to make Sequelize escape the attribute, like in Sequelize v7. We highly recommend this option.
- Set the "attributeBehavior" sequelize option to "unsafe-legacy" to make Sequelize escape the attribute, like in Sequelize v5.

We sincerely apologize for the inconvenience this may cause you. You can find more information on the following threads:
https://github.com/sequelize/sequelize/security/advisories/GHSA-f598-mfpv-gmfx
https://github.com/sequelize/sequelize/discussions/15694`);let L=I[1];this.options.minifyAliases&&(L=this._getMinifiedAlias(L,A,h)),I=[I[0],this.quoteIdentifier(L)].join(" AS ")}else I=!I.includes(g.TICK_CHAR)&&!I.includes('"')?this.quoteAttribute(I,h.model):this.escape(I);return!_.isEmpty(h.include)&&(!I.includes(".")||h.dotNotation)&&q&&(I=`${A}.${I}`),I})}generateInclude(u,h,A){const I={mainQuery:[],subQuery:[]},q=[],L=[];let D=!1;const C={internalAs:u.as,externalAs:u.as},$={main:[],subQuery:[]};let P;if(A.options.keysEscaped=!0,A.names.name!==h.externalAs&&A.names.as!==h.externalAs&&(C.internalAs=`${h.internalAs}->${u.as}`,C.externalAs=`${h.externalAs}.${u.as}`),A.options.includeIgnoreAttributes!==!1){u.model._expandAttributes(u),g.mapFinderOptions(u,u.model);const Q=u.attributes.map(j=>{let B=j,F=!1;if(Array.isArray(j)&&j.length===2&&(j[0]instanceof g.SequelizeMethod&&(j[0]instanceof g.Literal||j[0]instanceof g.Cast||j[0]instanceof g.Fn)&&(F=!0),j=j.map(X=>X instanceof g.SequelizeMethod?this.handleSequelizeMethod(X):X),B=j[1],j=j[0]),j instanceof g.Literal)return j.val;if(j instanceof g.Cast||j instanceof g.Fn)throw new Error("Tried to select attributes using Sequelize.cast or Sequelize.fn without specifying an alias for the result, during eager loading. This means the attribute will not be added to the returned instance");let x;F===!0?x=j:/#>>|->>/.test(j)?x=`(${this.quoteIdentifier(C.internalAs)}.${j.replace(/\(|\)/g,"")})`:/json_extract\(/.test(j)?x=j.replace(/json_extract\(/i,`json_extract(${this.quoteIdentifier(C.internalAs)}.`):/json_value\(/.test(j)?x=j.replace(/json_value\(/i,`json_value(${this.quoteIdentifier(C.internalAs)}.`):x=`${this.quoteIdentifier(C.internalAs)}.${this.quoteIdentifier(j)}`;let k=`${C.externalAs}.${B}`;return this.options.minifyAliases&&(k=this._getMinifiedAlias(k,C.internalAs,A.options)),g.joinSQLFragments([x,"AS",this.quoteIdentifier(k,!0)])});if(u.subQuery&&A.subQuery)for(const j of Q)$.subQuery.push(j);else for(const j of Q)$.main.push(j)}if(u.through?P=this.generateThroughJoin(u,C,h.internalAs,A):(this._generateSubQueryFilter(u,C,A),P=this.generateJoin(u,A)),P.attributes.main.length>0&&($.main=$.main.concat(P.attributes.main)),P.attributes.subQuery.length>0&&($.subQuery=$.subQuery.concat(P.attributes.subQuery)),u.include)for(const Q of u.include){if(Q.separate||Q._pseudo)continue;const j=this.generateInclude(Q,C,A);u.required===!1&&Q.required===!0&&(D=!0),Q.subQuery&&A.subQuery&&L.push(j.subQuery),j.mainQuery&&q.push(j.mainQuery),j.attributes.main.length>0&&($.main=$.main.concat(j.attributes.main)),j.attributes.subQuery.length>0&&($.subQuery=$.subQuery.concat(j.attributes.subQuery))}return u.subQuery&&A.subQuery?(D&&L.length>0?I.subQuery.push(` ${P.join} ( ${P.body}${L.join("")} ) ON ${P.condition}`):(I.subQuery.push(` ${P.join} ${P.body} ON ${P.condition}`),L.length>0&&I.subQuery.push(L.join(""))),I.mainQuery.push(q.join(""))):(D&&q.length>0?I.mainQuery.push(` ${P.join} ( ${P.body}${q.join("")} ) ON ${P.condition}`):(I.mainQuery.push(` ${P.join} ${P.body} ON ${P.condition}`),q.length>0&&I.mainQuery.push(q.join(""))),I.subQuery.push(L.join(""))),{mainQuery:I.mainQuery.join(""),subQuery:I.subQuery.join(""),attributes:$}}_getMinifiedAlias(u,h,A){if(A.aliasesByTable[`${h}${u}`])return A.aliasesByTable[`${h}${u}`];if(u.match(/subquery_order_[0-9]/))return u;const I=`_${A.aliasesMapping.size}`;return A.aliasesMapping.set(I,u),A.aliasesByTable[`${h}${u}`]=I,I}_getAliasForField(u,h,A){return this.options.minifyAliases&&A.aliasesByTable[`${u}${h}`]?A.aliasesByTable[`${u}${h}`]:null}generateJoin(u,h){const A=u.association,I=u.parent,q=!!I&&!u.parent.association&&u.parent.model.name===h.options.model.name;let L,D;const C=A.source,$=A instanceof i?A.identifier:A.sourceKeyAttribute||C.primaryKeyAttribute,P=A instanceof i?A.identifierField:C.rawAttributes[A.sourceKeyAttribute||C.primaryKeyAttribute].field;let Q;const j=u.model,B=j.getTableName(),F=A instanceof i?j.rawAttributes[A.targetIdentifier||j.primaryKeyAttribute].field:A.identifierField;let x=u.as;for(;(L=L&&L.parent||u.parent)&&L.association;)Q?Q=`${L.as}->${Q}`:Q=L.as;Q?x=`${Q}->${x}`:Q=I.as||I.model.name;let k=`${this.quoteTable(Q)}.${this.quoteIdentifier(P)}`;const X=[];if(h.options.groupedLimit&&q||h.subQuery&&u.parent.subQuery&&!u.subQuery)if(q){const H=this.quoteTable(I.as||I.model.name);if(k=this._getAliasForField(H,$,h.options)||`${H}.${this.quoteIdentifier($)}`,h.subQuery){const W=`${H}.${this.quoteIdentifier(P)}`;X.push(W!==k?`${W} AS ${this.quoteIdentifier($)}`:W)}}else{const H=`${Q.replace(/->/g,".")}.${$}`;k=this._getAliasForField(Q,H,h.options)||this.quoteIdentifier(H)}return k+=` = ${this.quoteIdentifier(x)}.${this.quoteIdentifier(F)}`,u.on&&(k=this.whereItemsQuery(u.on,{prefix:this.sequelize.literal(this.quoteIdentifier(x)),model:u.model})),u.where&&(D=this.whereItemsQuery(u.where,{prefix:this.sequelize.literal(this.quoteIdentifier(x)),model:u.model}),D&&(u.or?k+=` OR ${D}`:k+=` AND ${D}`)),this.aliasAs(x,h),{join:u.required?"INNER JOIN":u.right&&this._dialect.supports["RIGHT JOIN"]?"RIGHT OUTER JOIN":"LEFT OUTER JOIN",body:this.quoteTable(B,x),condition:k,attributes:{main:[],subQuery:X}}}generateReturnValues(u,h){const A=[],I=[];let q="",L="",D="";return Array.isArray(h.returning)?A.push(...h.returning.map(C=>this.quoteIdentifier(C))):u&&_.each(u,C=>{C.type instanceof c.VIRTUAL||(A.push(this.quoteIdentifier(C.field)),I.push(C.type))}),_.isEmpty(A)&&A.push("*"),this._dialect.supports.returnValues.returning?L=` RETURNING ${A.join(",")}`:this._dialect.supports.returnIntoValues?L=` RETURNING ${A.join(",")} INTO `:this._dialect.supports.returnValues.output&&(q=` OUTPUT ${A.map(C=>`INSERTED.${C}`).join(",")}`,h.hasTrigger&&this._dialect.supports.tmpTableTrigger&&(D=`DECLARE @tmp TABLE (${A.map(($,P)=>`${$} ${I[P].toSql()}`).join(",")}); `,q+=" INTO @tmp",L="; SELECT * FROM @tmp")),{outputFragment:q,returnFields:A,returnTypes:I,returningFragment:L,tmpTable:D}}generateThroughJoin(u,h,A,I){const q=u.through,L=q.model.getTableName(),D=`${h.internalAs}->${q.as}`,C=`${h.externalAs}.${q.as}`,$=q.attributes.map(oe=>{let _e=`${C}.${Array.isArray(oe)?oe[1]:oe}`;return this.options.minifyAliases&&(_e=this._getMinifiedAlias(_e,D,I.options)),g.joinSQLFragments([`${this.quoteIdentifier(D)}.${this.quoteIdentifier(Array.isArray(oe)?oe[0]:oe)}`,"AS",this.quoteIdentifier(_e)])}),P=u.association,Q=!u.parent.association&&u.parent.model.name===I.options.model.name,j=A,B=P.identifierField,F=h.internalAs,x=P.foreignIdentifierField,k=P.targetKeyField,X=u.required?"INNER JOIN":u.right&&this._dialect.supports["RIGHT JOIN"]?"RIGHT OUTER JOIN":"LEFT OUTER JOIN";let H,W;const se={main:[],subQuery:[]};let le=P.sourceKey,pe,Oe,ie,ne;if(I.options.includeIgnoreAttributes!==!1)for(const oe of $)se.main.push(oe);if(I.subQuery||(le=P.sourceKeyField),I.subQuery&&!u.subQuery&&!u.parent.subQuery&&u.parent.model!==I.options.mainModel&&(le=P.sourceKeyField),I.subQuery&&!u.subQuery&&u.parent.subQuery&&!Q){const oe=this._getAliasForField(j,`${j}.${le}`,I.options)||`${j}.${le}`;pe=`${this.quoteIdentifier(oe)} = `}else{const oe=this._getAliasForField(j,le,I.options)||le;pe=`${this.quoteTable(j)}.${this.quoteIdentifier(oe)} = `}return pe+=`${this.quoteIdentifier(D)}.${this.quoteIdentifier(B)}`,Oe=`${this.quoteIdentifier(F)}.${this.quoteIdentifier(k)} = `,Oe+=`${this.quoteIdentifier(D)}.${this.quoteIdentifier(x)}`,q.where&&(ie=this.getWhereConditions(q.where,this.sequelize.literal(this.quoteIdentifier(D)),q.model)),this.aliasAs(h.internalAs,I),H=`( ${this.quoteTable(L,D)} INNER JOIN ${this.quoteTable(u.model.getTableName(),h.internalAs)} ON ${Oe}`,ie&&(H+=` AND ${ie}`),H+=")",W=pe,(u.where||u.through.where)&&u.where&&(ne=this.getWhereConditions(u.where,this.sequelize.literal(this.quoteIdentifier(h.internalAs)),u.model,I.options),ne&&(W+=` AND ${ne}`)),this._generateSubQueryFilter(u,h,I),{join:X,body:H,condition:W,attributes:se}}aliasAs(u,h){if(this.options.minifyAliases&&u.length>=64){const A=`%${h.options.includeAliases.size}`;h.options.includeAliases.set(A,u)}}_generateSubQueryFilter(u,h,A){if(!A.subQuery||!u.subQueryFilter)return;A.options.where||(A.options.where={});let I=u,q=u,L=this._getRequiredClosure(u).include,D;for(;I=I.parent;){if(I.parent&&!I.required||I.subQueryFilter)return;L=[w(E({},q),{include:L,attributes:[]})],q=I}const C=L[0],$=C.parent,P=C.association;if(C.association=void 0,C.through&&Object(C.through.model)===C.through.model)D=this.selectQuery(C.through.model.getTableName(),{attributes:[C.through.model.primaryKeyField],include:l._validateIncludedElements({model:C.through.model,include:[{association:P.toTarget,required:!0,where:C.where,include:C.include}]}).include,model:C.through.model,where:{[d.and]:[this.sequelize.literal([`${this.quoteTable($.model.name)}.${this.quoteIdentifier($.model.primaryKeyField)}`,`${this.quoteIdentifier(C.through.model.name)}.${this.quoteIdentifier(P.identifierField)}`].join(" = ")),C.through.where]},limit:1,includeIgnoreAttributes:!1},C.through.model);else{const Q=P.associationType==="BelongsTo",j=Q?P.identifierField:P.sourceKeyField||$.model.primaryKeyField,B=Q?P.sourceKeyField||C.model.primaryKeyField:P.identifierField,F=[`${this.quoteIdentifier(C.as)}.${this.quoteIdentifier(B)}`,`${this.quoteTable($.as||$.model.name)}.${this.quoteIdentifier(j)}`].join(" = ");D=this.selectQuery(C.model.getTableName(),{attributes:[B],include:l._validateIncludedElements(C).include,model:C.model,where:{[d.and]:[C.where,{[d.join]:this.sequelize.literal(F)}]},limit:1,tableAs:C.as,includeIgnoreAttributes:!1},C.model)}A.options.where[d.and]||(A.options.where[d.and]=[]),A.options.where[`__${h.internalAs}`]=this.sequelize.literal(["(",D.replace(/;$/,""),")","IS NOT NULL"].join(" "))}_getRequiredClosure(u){const h=w(E({},u),{attributes:[],include:[]});return Array.isArray(u.include)&&(h.include=u.include.filter(A=>A.required).map(A=>this._getRequiredClosure(A))),h}getQueryOrders(u,h,A){const I=[],q=[];if(Array.isArray(u.order))for(let L of u.order){if(Array.isArray(L)||(L=[L]),A&&Array.isArray(L)&&L[0]&&!(L[0]instanceof r)&&!(typeof L[0]=="function"&&L[0].prototype instanceof l)&&!(typeof L[0].model=="function"&&L[0].model.prototype instanceof l)&&!(typeof L[0]=="string"&&h&&h.associations!==void 0&&h.associations[L[0]])){const D=h.rawAttributes[L[0]]?h.rawAttributes[L[0]].field:L[0],C=this._getAliasForField(this.quoteIdentifier(h.name),D,u);let $=null,P=[];C===null?(P=L,$=h):(P=[C,L.length>1?L[1]:"ASC"],$=null),q.push(this.quote(P,$,"->"))}if(u.attributes&&h){const D=u.attributes.find(C=>Array.isArray(C)&&C[1]&&(C[0]===L[0]||C[1]===L[0]));if(D){const C=this.quoteIdentifier(h.name),$=this._getAliasForField(C,D[1],u);L[0]=new g.Col($||D[1])}}I.push(this.quote(L,h,"->"))}else if(u.order instanceof g.SequelizeMethod){const L=this.quote(u.order,h,"->");A&&q.push(L),I.push(L)}else throw new Error("Order must be type of array or instance of a valid sequelize method.");return{mainQueryOrder:I,subQueryOrder:q}}_throwOnEmptyAttributes(u,h={}){if(u.length>0)return;const A=h.as&&`as ${h.as}`||"",q=`Attempted a SELECT query ${h.modelName&&`for model '${h.modelName}'`||""} ${A} without selecting any columns`;throw new y.QueryError(q.replace(/ +/g," "))}selectFromTableFragment(u,h,A,I,q){this._throwOnEmptyAttributes(A,{modelName:h&&h.name,as:q});let L=`SELECT ${A.join(", ")} FROM ${I}`;if(q&&(L+=` ${this.getAliasToken()} ${q}`),u.indexHints&&this._dialect.supports.indexHints)for(const D of u.indexHints)o[D.type]&&(L+=` ${o[D.type]} INDEX (${D.values.map(C=>this.quoteIdentifiers(C)).join(",")})`);return L}addLimitAndOffset(u){let h="";return u.offset!=null&&u.limit==null?h+=" LIMIT "+this.escape(u.offset)+", "+1e13:u.limit!=null&&(u.offset!=null?h+=" LIMIT "+this.escape(u.offset)+", "+this.escape(u.limit):h+=" LIMIT "+this.escape(u.limit)),h}handleSequelizeMethod(u,h,A,I,q){let L;if(Object.prototype.hasOwnProperty.call(this.OperatorMap,u.comparator)&&(u.comparator=this.OperatorMap[u.comparator]),u instanceof g.Where){let D=u.logic,C;return u.attribute instanceof g.SequelizeMethod?C=this.getWhereConditions(u.attribute,h,A,I,q):C=`${this.quoteTable(u.attribute.Model.name)}.${this.quoteIdentifier(u.attribute.field||u.attribute.fieldName)}`,D&&D instanceof g.SequelizeMethod?(D=this.getWhereConditions(D,h,A,I,q),D==="NULL"&&(u.comparator==="="&&(u.comparator="IS"),u.comparator==="!="&&(u.comparator="IS NOT")),[C,D].join(` ${u.comparator} `)):_.isPlainObject(D)?this.whereItemQuery(u.attribute,D,{model:A}):([this.OperatorMap[d.between],this.OperatorMap[d.notBetween]].includes(u.comparator)?D=`${this.escape(D[0])} AND ${this.escape(D[1])}`:typeof D=="boolean"?D=this.booleanValue(D):D=this.escape(D),D==="NULL"&&(u.comparator==="="&&(u.comparator="IS"),u.comparator==="!="&&(u.comparator="IS NOT")),[C,D].join(` ${u.comparator} `))}if(u instanceof g.Literal)return u.val;if(u instanceof g.Cast)return u.val instanceof g.SequelizeMethod?L=this.handleSequelizeMethod(u.val,h,A,I,q):_.isPlainObject(u.val)?L=this.whereItemsQuery(u.val):L=this.escape(u.val),`CAST(${L} AS ${u.type.toUpperCase()})`;if(u instanceof g.Fn)return`${u.fn}(${u.args.map(D=>D instanceof g.SequelizeMethod?this.handleSequelizeMethod(D,h,A,I,q):_.isPlainObject(D)?this.whereItemsQuery(D):this.escape(typeof D=="string"?D.replace(/\$/g,"$$$"):D)).join(", ")})`;if(u instanceof g.Col){if(Array.isArray(u.col)&&!A)throw new Error("Cannot call Sequelize.col() with array outside of order / group clause");return u.col.startsWith("*")?"*":this.quote(u.col,A)}return u.toString(this,A)}whereQuery(u,h){const A=this.whereItemsQuery(u,h);return A&&A.length?`WHERE ${A}`:""}whereItemsQuery(u,h,A){if(u==null||g.getComplexSize(u)===0)return"";if(typeof u=="string")throw new Error("Support for `{where: 'raw query'}` has been removed.");const I=[];return A=A||"AND",A[0]!==" "&&(A=` ${A} `),_.isPlainObject(u)?g.getComplexKeys(u).forEach(q=>{const L=u[q];I.push(this.whereItemQuery(q,L,h))}):I.push(this.whereItemQuery(void 0,u,h)),I.length&&I.filter(q=>q&&q.length).join(A)||""}whereItemQuery(u,h,A={}){if(h===void 0)throw new Error(`WHERE parameter "${u}" has invalid "undefined" value`);if(typeof u=="string"&&u.includes(".")&&A.model){const P=u.split(".");if(A.model.rawAttributes[P[0]]&&A.model.rawAttributes[P[0]].type instanceof c.JSON){const Q={},j=A.model.rawAttributes[P[0]];return _.set(Q,P.slice(1),h),this.whereItemQuery(j.field||P[0],Q,E({field:j},A))}}const I=this._findField(u,A),q=I&&I.type||A.type,L=_.isPlainObject(h),D=!L&&Array.isArray(h);u=this.OperatorsAliasMap&&this.OperatorsAliasMap[u]||u,L&&(h=this._replaceAliases(h));const C=L&&g.getComplexKeys(h);if(u===void 0){if(typeof h=="string")return h;if(L&&C.length===1)return this.whereItemQuery(C[0],h[C[0]],A)}if(h===null){const P=A.bindParam?"NULL":this.escape(h,I);return this._joinKeyValue(u,P,this.OperatorMap[d.is],A.prefix)}if(!h){const P=A.bindParam?this.format(h,I,A,A.bindParam):this.escape(h,I);return this._joinKeyValue(u,P,this.OperatorMap[d.eq],A.prefix)}if(h instanceof g.SequelizeMethod&&!(u!==void 0&&h instanceof g.Fn))return this.handleSequelizeMethod(h);if(u===void 0&&D)if(g.canTreatArrayAsAnd(h))u=d.and;else throw new Error("Support for literal replacements in the `where` object has been removed.");if(u===d.or||u===d.and||u===d.not)return this._whereGroupBind(u,h,A);if(h[d.or])return this._whereBind(this.OperatorMap[d.or],u,h[d.or],A);if(h[d.and])return this._whereBind(this.OperatorMap[d.and],u,h[d.and],A);if(D&&q instanceof c.ARRAY){const P=A.bindParam?this.format(h,I,A,A.bindParam):this.escape(h,I);return this._joinKeyValue(u,P,this.OperatorMap[d.eq],A.prefix)}if(L&&q instanceof c.JSON&&A.json!==!1)return this._whereJSON(u,h,A);if(L&&C.length>1)return this._whereBind(this.OperatorMap[d.and],u,h,A);if(D)return this._whereParseSingleValueObject(u,I,d.in,h,A);if(L)return this.OperatorMap[C[0]]?this._whereParseSingleValueObject(u,I,C[0],h[C[0]],A):this._whereParseSingleValueObject(u,I,this.OperatorMap[d.eq],h,A);if(u===d.placeholder){const P=A.bindParam?this.format(h,I,A,A.bindParam):this.escape(h,I);return this._joinKeyValue(this.OperatorMap[u],P,this.OperatorMap[d.eq],A.prefix)}const $=A.bindParam?this.format(h,I,A,A.bindParam):this.escape(h,I);return this._joinKeyValue(u,$,this.OperatorMap[d.eq],A.prefix)}_findField(u,h){if(h.field)return h.field;if(h.model&&h.model.rawAttributes&&h.model.rawAttributes[u])return h.model.rawAttributes[u];if(h.model&&h.model.fieldRawAttributesMap&&h.model.fieldRawAttributesMap[u])return h.model.fieldRawAttributesMap[u]}_whereGroupBind(u,h,A){const I=u===d.or?this.OperatorMap[d.or]:this.OperatorMap[d.and],q=u===d.not?"NOT ":"";return Array.isArray(h)?(h=h.map(L=>{let D=this.whereItemsQuery(L,A,this.OperatorMap[d.and]);return D&&D.length&&(Array.isArray(L)||_.isPlainObject(L))&&g.getComplexSize(L)>1&&(D=`(${D})`),D}).filter(L=>L&&L.length),h=h.length&&h.join(I)):h=this.whereItemsQuery(h,A,I),(u===d.or||u===d.not)&&!h?"0 = 1":h?`${q}(${h})`:void 0}_whereBind(u,h,A,I){return _.isPlainObject(A)?A=g.getComplexKeys(A).map(q=>{const L=A[q];return this.whereItemQuery(h,{[q]:L},I)}):A=A.map(q=>this.whereItemQuery(h,q,I)),A=A.filter(q=>q&&q.length),A.length?`(${A.join(u)})`:void 0}_whereJSON(u,h,A){const I=[];let q=this.quoteIdentifier(u);A.prefix&&(A.prefix instanceof g.Literal?q=`${this.handleSequelizeMethod(A.prefix)}.${q}`:q=`${this.quoteTable(A.prefix)}.${q}`),g.getOperators(h).forEach(D=>{const C={[D]:h[D]};I.push(this.whereItemQuery(u,C,w(E({},A),{json:!1})))}),_.forOwn(h,(D,C)=>{this._traverseJSON(I,q,C,D,[C])});const L=I.join(this.OperatorMap[d.and]);return I.length>1?`(${L})`:L}_traverseJSON(u,h,A,I,q){let L;if(q[q.length-1].includes("::")){const C=q[q.length-1].split("::");L=C[1],q[q.length-1]=C[0]}let D=this.jsonPathExtractionQuery(h,q);if(_.isPlainObject(I)){g.getOperators(I).forEach(C=>{const $=this._toJSONValue(I[C]);let P=!1;if(typeof $=="string"&&C===d.contains)try{JSON.stringify($),P=!0}catch{}D=this.jsonPathExtractionQuery(h,q,P),u.push(this.whereItemQuery(this._castKey(D,$,L),{[C]:$}))}),_.forOwn(I,(C,$)=>{this._traverseJSON(u,h,$,C,q.concat([$]))});return}I=this._toJSONValue(I),u.push(this.whereItemQuery(this._castKey(D,I,L),{[d.eq]:I}))}_toJSONValue(u){return u}_castKey(u,h,A,I){return A=A||this._getJsonCast(Array.isArray(h)?h[0]:h),A?new g.Literal(this.handleSequelizeMethod(new g.Cast(new g.Literal(u),A,I))):new g.Literal(u)}_getJsonCast(u){if(typeof u=="number")return"double precision";if(u instanceof Date)return"timestamptz";if(typeof u=="boolean")return"boolean"}_joinKeyValue(u,h,A,I){if(!u)return h;if(A===void 0)throw new Error(`${u} and ${h} has no comparator`);return u=this._getSafeKey(u,I),[u,h].join(` ${A} `)}_getSafeKey(u,h){return u instanceof g.SequelizeMethod?(u=this.handleSequelizeMethod(u),this._prefixKey(this.handleSequelizeMethod(u),h)):g.isColString(u)?(u=u.substr(1,u.length-2).split("."),u.length>2&&(u=[u.slice(0,-1).join("->"),u[u.length-1]]),u.map(A=>this.quoteIdentifier(A)).join(".")):this._prefixKey(this.quoteIdentifier(u),h)}_prefixKey(u,h){return h?h instanceof g.Literal?[this.handleSequelizeMethod(h),u].join("."):[this.quoteTable(h),u].join("."):u}_whereParseSingleValueObject(u,h,A,I,q){A===d.not&&(Array.isArray(I)?A=d.notIn:I!==null&&I!==!0&&I!==!1&&(A=d.ne));let L=this.OperatorMap[A]||this.OperatorMap[d.eq];switch(A){case d.in:case d.notIn:return I instanceof g.Literal?this._joinKeyValue(u,I.val,L,q.prefix):I.length?this._joinKeyValue(u,`(${I.map($=>this.escape($,h)).join(", ")})`,L,q.prefix):L===this.OperatorMap[d.in]?this._joinKeyValue(u,"(NULL)",L,q.prefix):"";case d.any:case d.all:return L=`${this.OperatorMap[d.eq]} ${L}`,I[d.values]?this._joinKeyValue(u,`(VALUES ${I[d.values].map($=>`(${this.escape($)})`).join(", ")})`,L,q.prefix):this._joinKeyValue(u,`(${this.escape(I,h)})`,L,q.prefix);case d.between:case d.notBetween:return this._joinKeyValue(u,`${this.escape(I[0],h)} AND ${this.escape(I[1],h)}`,L,q.prefix);case d.raw:throw new Error("The `$raw` where property is no longer supported.  Use `sequelize.literal` instead.");case d.col:return L=this.OperatorMap[d.eq],I=I.split("."),I.length>2&&(I=[I.slice(0,-1).join("->"),I[I.length-1]]),this._joinKeyValue(u,I.map($=>this.quoteIdentifier($)).join("."),L,q.prefix);case d.startsWith:case d.endsWith:case d.substring:L=this.OperatorMap[d.like],I instanceof g.Literal&&(I=I.val);let C=`${I}%`;return A===d.endsWith&&(C=`%${I}`),A===d.substring&&(C=`%${I}%`),this._joinKeyValue(u,this.escape(C),L,q.prefix)}const D={acceptStrings:L.includes(this.OperatorMap[d.like])};if(_.isPlainObject(I)){if(I[d.col])return this._joinKeyValue(u,this.whereItemQuery(null,I),L,q.prefix);if(I[d.any])return D.isList=!0,this._joinKeyValue(u,`(${this.escape(I[d.any],h,D)})`,`${L} ${this.OperatorMap[d.any]}`,q.prefix);if(I[d.all])return D.isList=!0,this._joinKeyValue(u,`(${this.escape(I[d.all],h,D)})`,`${L} ${this.OperatorMap[d.all]}`,q.prefix)}return I===null&&L===this.OperatorMap[d.eq]?this._joinKeyValue(u,this.escape(I,h,D),this.OperatorMap[d.is],q.prefix):I===null&&L===this.OperatorMap[d.ne]?this._joinKeyValue(u,this.escape(I,h,D),this.OperatorMap[d.not],q.prefix):this._joinKeyValue(u,this.escape(I,h,D),L,q.prefix)}getWhereConditions(u,h,A,I,q){const L={};if(Array.isArray(h)&&(h=h[0],Array.isArray(h)&&(h=h[1])),I=I||{},q===void 0&&(q=!0),u&&u instanceof g.SequelizeMethod)return this.handleSequelizeMethod(u,h,A,I,q);if(_.isPlainObject(u))return this.whereItemsQuery(u,{model:A,prefix:q&&h,type:I.type});if(typeof u=="number"||typeof u=="bigint"){let D=A?Object.keys(A.primaryKeys):[];return D.length>0?D=D[0]:D="id",L[D]=u,this.whereItemsQuery(L,{model:A,prefix:q&&h})}if(typeof u=="string")return this.whereItemsQuery(u,{model:A,prefix:q&&h});if(Buffer.isBuffer(u))return this.escape(u);if(Array.isArray(u)){if(u.length===0||u.length>0&&u[0].length===0)return"1=1";if(g.canTreatArrayAsAnd(u)){const D={[d.and]:u};return this.getWhereConditions(D,h,A,I,q)}throw new Error("Support for literal replacements in the `where` object has been removed.")}if(u==null)return this.whereItemsQuery(u,{model:A,prefix:q&&h});throw new Error(`Unsupported where option value: ${R.inspect(u)}. Please refer to the Sequelize documentation to learn more about which values are accepted as part of the where option.`)}parseConditionObject(u,h){return h=h||[],_.reduce(u,(A,I,q)=>_.isObject(I)?A.concat(this.parseConditionObject(I,h.concat(q))):(A.push({path:h.concat(q),value:I}),A),[])}booleanValue(u){return u}authTestQuery(){return"SELECT 1+1 AS result"}}return Object.assign(p.prototype,Zo()),Object.assign(p.prototype,eu()),Vr=p,Vr}var Yr,xi;function vs(){if(xi)return Yr;xi=1;var S=Object.defineProperty,e=Object.defineProperties,t=Object.getOwnPropertyDescriptors,n=Object.getOwnPropertySymbols,f=Object.prototype.hasOwnProperty,O=Object.prototype.propertyIsEnumerable,T=(y,o,p)=>o in y?S(y,o,{enumerable:!0,configurable:!0,writable:!0,value:p}):y[o]=p,E=(y,o)=>{for(var p in o||(o={}))f.call(o,p)&&T(y,p,o[p]);if(n)for(var p of n(o))O.call(o,p)&&T(y,p,o[p]);return y},w=(y,o)=>e(y,t(o));const R=re,_=fe(),m=ut(),g=Ae,N=Re,c=/^\s*((?:[a-z]+_){0,2}jsonb?(?:_[a-z]+){0,2})\([^)]*\)/i,l=/^\s*(->>?|@>|<@|\?[|&]?|\|{2}|#-)/i,r=/^\s*((?:([`"'])(?:(?!\2).|\2{2})*\2)|[\w\d\s]+|[().,;+-])/i,i=["CONSTRAINT_NAME as constraint_name","CONSTRAINT_NAME as constraintName","CONSTRAINT_SCHEMA as constraintSchema","CONSTRAINT_SCHEMA as constraintCatalog","TABLE_NAME as tableName","TABLE_SCHEMA as tableSchema","TABLE_SCHEMA as tableCatalog","COLUMN_NAME as columnName","REFERENCED_TABLE_SCHEMA as referencedTableSchema","REFERENCED_TABLE_SCHEMA as referencedTableCatalog","REFERENCED_TABLE_NAME as referencedTableName","REFERENCED_COLUMN_NAME as referencedColumnName"].join(","),s=new Set(["BLOB","TEXT","GEOMETRY","JSON"]);class a extends m{constructor(o){super(o),this.OperatorMap=w(E({},this.OperatorMap),{[N.regexp]:"REGEXP",[N.notRegexp]:"NOT REGEXP"})}createDatabaseQuery(o,p){return p=E({charset:null,collate:null},p),_.joinSQLFragments(["CREATE DATABASE IF NOT EXISTS",this.quoteIdentifier(o),p.charset&&`DEFAULT CHARACTER SET ${this.escape(p.charset)}`,p.collate&&`DEFAULT COLLATE ${this.escape(p.collate)}`,";"])}dropDatabaseQuery(o){return`DROP DATABASE IF EXISTS ${this.quoteIdentifier(o)};`}createSchema(){return"SHOW TABLES"}showSchemasQuery(){return"SHOW TABLES"}versionQuery(){return"SELECT VERSION() as `version`"}createTableQuery(o,p,b){b=E({engine:"InnoDB",charset:null,rowFormat:null},b);const u=[],h={},A=[];for(const D in p){if(!Object.prototype.hasOwnProperty.call(p,D))continue;const C=p[D];let $;C.includes("PRIMARY KEY")?(u.push(D),C.includes("REFERENCES")?($=C.match(/^(.+) (REFERENCES.*)$/),A.push(`${this.quoteIdentifier(D)} ${$[1].replace("PRIMARY KEY","")}`),h[D]=$[2]):A.push(`${this.quoteIdentifier(D)} ${C.replace("PRIMARY KEY","")}`)):C.includes("REFERENCES")?($=C.match(/^(.+) (REFERENCES.*)$/),A.push(`${this.quoteIdentifier(D)} ${$[1]}`),h[D]=$[2]):A.push(`${this.quoteIdentifier(D)} ${C}`)}const I=this.quoteTable(o);let q=A.join(", ");const L=u.map(D=>this.quoteIdentifier(D)).join(", ");b.uniqueKeys&&R.each(b.uniqueKeys,(D,C)=>{D.customIndex&&(typeof C!="string"&&(C=`uniq_${o}_${D.fields.join("_")}`),q+=`, UNIQUE ${this.quoteIdentifier(C)} (${D.fields.map($=>this.quoteIdentifier($)).join(", ")})`)}),L.length>0&&(q+=`, PRIMARY KEY (${L})`);for(const D in h)Object.prototype.hasOwnProperty.call(h,D)&&(q+=`, FOREIGN KEY (${this.quoteIdentifier(D)}) ${h[D]}`);return _.joinSQLFragments(["CREATE TABLE IF NOT EXISTS",I,`(${q})`,`ENGINE=${b.engine}`,b.comment&&typeof b.comment=="string"&&`COMMENT ${this.escape(b.comment)}`,b.charset&&`DEFAULT CHARSET=${b.charset}`,b.collate&&`COLLATE ${b.collate}`,b.initialAutoIncrement&&`AUTO_INCREMENT=${b.initialAutoIncrement}`,b.rowFormat&&`ROW_FORMAT=${b.rowFormat}`,";"])}describeTableQuery(o,p,b){return`SHOW FULL COLUMNS FROM ${this.quoteTable(this.addSchema({tableName:o,_schema:p,_schemaDelimiter:b}))};`}showTablesQuery(o){let p="SELECT TABLE_NAME FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'BASE TABLE'";return o?p+=` AND TABLE_SCHEMA = ${this.escape(o)}`:p+=" AND TABLE_SCHEMA NOT IN ('MYSQL', 'INFORMATION_SCHEMA', 'PERFORMANCE_SCHEMA', 'SYS', 'mysql', 'information_schema', 'performance_schema', 'sys')",`${p};`}tableExistsQuery(o){return`SELECT TABLE_NAME FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'BASE TABLE' AND TABLE_NAME = ${this.escape(this.quoteTable(o).slice(1,-1))} AND TABLE_SCHEMA = ${this.escape(this.sequelize.config.database)}`}addColumnQuery(o,p,b){return _.joinSQLFragments(["ALTER TABLE",this.quoteTable(o),"ADD",this.quoteIdentifier(p),this.attributeToSQL(b,{context:"addColumn",tableName:o,foreignKey:p}),";"])}removeColumnQuery(o,p){return _.joinSQLFragments(["ALTER TABLE",this.quoteTable(o),"DROP",this.quoteIdentifier(p),";"])}changeColumnQuery(o,p){const b=[],u=[];for(const h in p){let A=p[h];if(A.includes("REFERENCES")){const I=this.quoteIdentifier(h);A=A.replace(/.+?(?=REFERENCES)/,""),u.push(`FOREIGN KEY (${I}) ${A}`)}else b.push(`\`${h}\` \`${h}\` ${A}`)}return _.joinSQLFragments(["ALTER TABLE",this.quoteTable(o),b.length&&`CHANGE ${b.join(", ")}`,u.length&&`ADD ${u.join(", ")}`,";"])}renameColumnQuery(o,p,b){const u=[];for(const h in b){const A=b[h];u.push(`\`${p}\` \`${h}\` ${A}`)}return _.joinSQLFragments(["ALTER TABLE",this.quoteTable(o),"CHANGE",u.join(", "),";"])}handleSequelizeMethod(o,p,b,u,h){if(o instanceof _.Json){if(o.conditions)return this.parseConditionObject(o.conditions).map(I=>`${this.jsonPathExtractionQuery(I.path[0],R.tail(I.path))} = '${I.value}'`).join(" AND ");if(o.path){let A;if(this._checkValidJsonStatement(o.path))A=o.path;else{const I=R.toPath(o.path),q=I.shift();A=this.jsonPathExtractionQuery(q,I)}return o.value&&(A+=g.format(" = %s",this.escape(o.value))),A}}else o instanceof _.Cast&&(/timestamp/i.test(o.type)?o.type="datetime":o.json&&/boolean/i.test(o.type)?o.type="char":/double precision/i.test(o.type)||/boolean/i.test(o.type)||/integer/i.test(o.type)?o.type="decimal":/text/i.test(o.type)&&(o.type="char"));return super.handleSequelizeMethod(o,p,b,u,h)}_toJSONValue(o){return typeof o=="boolean"?o.toString():o===null?"null":o}truncateTableQuery(o){return`TRUNCATE ${this.quoteTable(o)}`}deleteQuery(o,p,b={},u){let h="",A=`DELETE FROM ${this.quoteTable(o)}`;return b.limit&&(h=` LIMIT ${this.escape(b.limit)}`),p=this.getWhereConditions(p,null,u,b),p&&(A+=` WHERE ${p}`),A+h}showIndexesQuery(o,p){return _.joinSQLFragments([`SHOW INDEX FROM ${this.quoteTable(o)}`,p&&p.database&&`FROM \`${p.database}\``])}showConstraintsQuery(o,p){const b=o.tableName||o,u=o.schema;return _.joinSQLFragments(["SELECT CONSTRAINT_CATALOG AS constraintCatalog,","CONSTRAINT_NAME AS constraintName,","CONSTRAINT_SCHEMA AS constraintSchema,","CONSTRAINT_TYPE AS constraintType,","TABLE_NAME AS tableName,","TABLE_SCHEMA AS tableSchema","from INFORMATION_SCHEMA.TABLE_CONSTRAINTS",`WHERE table_name='${b}'`,p&&`AND constraint_name = '${p}'`,u&&`AND TABLE_SCHEMA = '${u}'`,";"])}removeIndexQuery(o,p){let b=p;return typeof b!="string"&&(b=_.underscore(`${o}_${p.join("_")}`)),_.joinSQLFragments(["DROP INDEX",this.quoteIdentifier(b),"ON",this.quoteTable(o)])}attributeToSQL(o,p){R.isPlainObject(o)||(o={type:o});const b=o.type.toString({escape:this.escape.bind(this)});let u=b;if(o.allowNull===!1&&(u+=" NOT NULL"),o.autoIncrement&&(u+=" auto_increment"),!s.has(b)&&o.type._binary!==!0&&_.defaultValueSchemable(o.defaultValue)&&(u+=` DEFAULT ${this.escape(o.defaultValue)}`),o.unique===!0&&(u+=" UNIQUE"),o.primaryKey&&(u+=" PRIMARY KEY"),o.comment&&(u+=` COMMENT ${this.escape(o.comment)}`),o.first&&(u+=" FIRST"),o.after&&(u+=` AFTER ${this.quoteIdentifier(o.after)}`),(!p||!p.withoutForeignKeyConstraints)&&o.references){if(p&&p.context==="addColumn"&&p.foreignKey){const h=this.quoteIdentifier(p.foreignKey),A=this.quoteIdentifier(`${p.tableName}_${h}_foreign_idx`);u+=`, ADD CONSTRAINT ${A} FOREIGN KEY (${h})`}u+=` REFERENCES ${this.quoteTable(o.references.model)}`,o.references.key?u+=` (${this.quoteIdentifier(o.references.key)})`:u+=` (${this.quoteIdentifier("id")})`,o.onDelete&&(u+=` ON DELETE ${o.onDelete.toUpperCase()}`),o.onUpdate&&(u+=` ON UPDATE ${o.onUpdate.toUpperCase()}`)}return u}attributesToSQL(o,p){const b={};for(const u in o){const h=o[u];b[h.field||u]=this.attributeToSQL(h,p)}return b}_checkValidJsonStatement(o){if(typeof o!="string")return!1;let p=0,b=0,u=0,h=!1,A=!1;for(;p<o.length;){const I=o.substr(p),q=c.exec(I);if(q){p+=q[0].indexOf("("),h=!0;continue}const L=l.exec(I);if(L){p+=L[0].length,h=!0;continue}const D=r.exec(I);if(D){const C=D[1];if(C==="(")b++;else if(C===")")u++;else if(C===";"){A=!0;break}p+=D[0].length;continue}break}if(h&&(A||b!==u))throw new Error(`Invalid json statement: ${o}`);return h}getForeignKeysQuery(o,p){const b=o.tableName||o;return _.joinSQLFragments(["SELECT",i,`FROM INFORMATION_SCHEMA.KEY_COLUMN_USAGE where TABLE_NAME = '${b}'`,`AND CONSTRAINT_NAME!='PRIMARY' AND CONSTRAINT_SCHEMA='${p}'`,"AND REFERENCED_TABLE_NAME IS NOT NULL",";"])}getForeignKeyQuery(o,p){const b=o.schema?d(o.schema):"",u=d(o.tableName||o),h=d(p);return _.joinSQLFragments(["SELECT",i,"FROM INFORMATION_SCHEMA.KEY_COLUMN_USAGE","WHERE (",[`REFERENCED_TABLE_NAME = ${u}`,o.schema&&`AND REFERENCED_TABLE_SCHEMA = ${b}`,`AND REFERENCED_COLUMN_NAME = ${h}`],") OR (",[`TABLE_NAME = ${u}`,o.schema&&`AND TABLE_SCHEMA = ${b}`,`AND COLUMN_NAME = ${h}`,"AND REFERENCED_TABLE_NAME IS NOT NULL"],")"])}dropForeignKeyQuery(o,p){return _.joinSQLFragments(["ALTER TABLE",this.quoteTable(o),"DROP FOREIGN KEY",this.quoteIdentifier(p),";"])}quoteIdentifier(o,p){return _.addTicks(_.removeTicks(o,"`"),"`")}}function d(y){return _.addTicks(y,"'")}return Yr=a,Yr}var Wr,Qi;function tu(){if(Qi)return Wr;Qi=1;var S=Object.defineProperty,e=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,f=(R,_,m)=>_ in R?S(R,_,{enumerable:!0,configurable:!0,writable:!0,value:m}):R[_]=m,O=(R,_)=>{for(var m in _||(_={}))t.call(_,m)&&f(R,m,_[m]);if(e)for(var m of e(_))n.call(_,m)&&f(R,m,_[m]);return R};const T=vs(),E=fe();class w extends T{createSchema(_,m){return m=O({charset:null,collate:null},m),E.joinSQLFragments(["CREATE SCHEMA IF NOT EXISTS",this.quoteIdentifier(_),m.charset&&`DEFAULT CHARACTER SET ${this.escape(m.charset)}`,m.collate&&`DEFAULT COLLATE ${this.escape(m.collate)}`,";"])}dropSchema(_){return`DROP SCHEMA IF EXISTS ${this.quoteIdentifier(_)};`}showSchemasQuery(_){const m=["'MYSQL'","'INFORMATION_SCHEMA'","'PERFORMANCE_SCHEMA'"];if(_.skip&&Array.isArray(_.skip)&&_.skip.length>0)for(const g of _.skip)m.push(this.escape(g));return E.joinSQLFragments(["SELECT SCHEMA_NAME as schema_name","FROM INFORMATION_SCHEMA.SCHEMATA",`WHERE SCHEMA_NAME NOT IN (${m.join(", ")})`,";"])}showTablesQuery(_){let m="SELECT TABLE_NAME, TABLE_SCHEMA FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'BASE TABLE'";return _?m+=` AND TABLE_SCHEMA = ${this.escape(_)}`:m+=" AND TABLE_SCHEMA NOT IN ('MYSQL', 'INFORMATION_SCHEMA', 'PERFORMANCE_SCHEMA')",`${m};`}quoteIdentifier(_,m){return E.addTicks(E.removeTicks(_,"`"),"`")}}return Wr=w,Wr}var Jr={},Fi;function ua(){if(Fi)return Jr;Fi=1;var S=Object.defineProperty,e=Object.defineProperties,t=Object.getOwnPropertyDescriptors,n=Object.getOwnPropertySymbols,f=Object.prototype.hasOwnProperty,O=Object.prototype.propertyIsEnumerable,T=(N,c,l)=>c in N?S(N,c,{enumerable:!0,configurable:!0,writable:!0,value:l}):N[c]=l,E=(N,c)=>{for(var l in c||(c={}))f.call(c,l)&&T(N,l,c[l]);if(n)for(var l of n(c))O.call(c,l)&&T(N,l,c[l]);return N},w=(N,c)=>e(N,t(c));const R=ce,{QueryInterface:_}=He,m=Me;class g extends _{async removeColumn(c,l,r){r=r||{};const[i]=await this.sequelize.query(this.queryGenerator.getForeignKeyQuery(c.tableName?c:{tableName:c,schema:this.sequelize.config.database},l),E({raw:!0},r));return i.length&&i[0].constraint_name!=="PRIMARY"&&await Promise.all(i.map(s=>this.sequelize.query(this.queryGenerator.dropForeignKeyQuery(c,s.constraint_name),E({raw:!0},r)))),await this.sequelize.query(this.queryGenerator.removeColumnQuery(c,l),E({raw:!0},r))}async upsert(c,l,r,i,s){s=E({},s),s.type=m.UPSERT,s.updateOnDuplicate=Object.keys(r),s.upsertKeys=Object.values(s.model.primaryKeys).map(y=>y.field);const a=s.model,d=this.queryGenerator.insertQuery(c,l,a.rawAttributes,s);return await this.sequelize.query(d,s)}async removeConstraint(c,l,r){const i=this.queryGenerator.showConstraintsQuery(c.tableName?c:{tableName:c,schema:this.sequelize.config.database},l),a=(await this.sequelize.query(i,w(E({},r),{type:this.sequelize.QueryTypes.SHOWCONSTRAINTS})))[0];let d;if(!a||!a.constraintType)throw new R.UnknownConstraintError({message:`Constraint ${l} on table ${c} does not exist`,constraint:l,table:c});return a.constraintType==="FOREIGN KEY"?d=this.queryGenerator.dropForeignKeyQuery(c,l):d=this.queryGenerator.removeIndexQuery(a.tableName,a.constraintName),await this.sequelize.query(d,r)}}return Jr.MySQLQueryInterface=g,Jr}var Xr,Ui;function ru(){if(Ui)return Xr;Ui=1;const S=re,e=Xe(),t=Jo(),n=Xo(),f=tu(),{MySQLQueryInterface:O}=ua(),T=he().mariadb;class E extends e{constructor(R){super(),this.sequelize=R,this.connectionManager=new t(this,R),this.queryGenerator=new f({_dialect:this,sequelize:R}),this.queryInterface=new O(R,this.queryGenerator)}canBackslashEscape(){return!0}}return E.prototype.supports=S.merge(S.cloneDeep(e.prototype.supports),{"VALUES ()":!0,"LIMIT ON UPDATE":!0,lock:!0,forShare:"LOCK IN SHARE MODE",settingIsolationLevelDuringTransaction:!1,schemas:!0,inserts:{ignoreDuplicates:" IGNORE",updateOnDuplicate:" ON DUPLICATE KEY UPDATE"},index:{collate:!1,length:!0,parser:!0,type:!0,using:1},constraints:{dropConstraint:!1,check:!1},indexViaAlter:!0,indexHints:!0,NUMERIC:!0,GEOMETRY:!0,JSON:!0,REGEXP:!0}),E.prototype.defaultVersion="10.1.44",E.prototype.Query=n,E.prototype.QueryGenerator=f,E.prototype.DataTypes=T,E.prototype.name="mariadb",E.prototype.TICK_CHAR="`",E.prototype.TICK_CHAR_LEFT=E.prototype.TICK_CHAR,E.prototype.TICK_CHAR_RIGHT=E.prototype.TICK_CHAR,Xr=E,Xr}var wt={exports:{}},Ki;function su(){if(Ki)return wt.exports;Ki=1;const S=Ze(),e=Ss.default,{logger:t}=ge,n=ce,f=he().mssql,O=je()("mssql"),T=t.debugContext("connection:mssql"),E=t.debugContext("connection:mssql:tedious");class w extends S{constructor(_,m){m.config.port=m.config.port||1433,super(_,m),this.lib=this._loadDialectModule("tedious"),this.refreshTypeParser(f)}_refreshTypeParser(_){O.refresh(_)}_clearTypeParser(){O.clear()}async connect(_){const m={server:_.host,authentication:{type:"default",options:{userName:_.username||void 0,password:_.password||void 0}},options:{port:parseInt(_.port,10),database:_.database,trustServerCertificate:!0}};_.dialectOptions&&(_.dialectOptions.options&&_.dialectOptions.options.instanceName&&delete m.options.port,_.dialectOptions.authentication&&Object.assign(m.authentication,_.dialectOptions.authentication),Object.assign(m.options,_.dialectOptions.options));try{return await new Promise((g,N)=>{const c=new this.lib.Connection(m);c.state===c.STATE.INITIALIZED&&c.connect(),c.queue=new e,c.lib=this.lib;const l=s=>{if(c.removeListener("end",r),c.removeListener("error",i),s)return N(s);T("connection acquired"),g(c)},r=()=>{c.removeListener("connect",l),c.removeListener("error",i),N(new Error("Connection was closed by remote server"))},i=s=>{c.removeListener("connect",l),c.removeListener("end",r),N(s)};c.once("error",i),c.once("end",r),c.once("connect",l),c.on("error",s=>{switch(s.code){case"ESOCKET":case"ECONNRESET":this.pool.destroy(c)}}),_.dialectOptions&&_.dialectOptions.debug&&c.on("debug",E.log.bind(E))})}catch(g){if(!g.code)throw new n.ConnectionError(g);switch(g.code){case"ESOCKET":throw g.message.includes("connect EHOSTUNREACH")?new n.HostNotReachableError(g):g.message.includes("connect ENETUNREACH")?new n.HostNotReachableError(g):g.message.includes("connect EADDRNOTAVAIL")?new n.HostNotReachableError(g):g.message.includes("connect EAFNOSUPPORT")?new n.HostNotReachableError(g):g.message.includes("getaddrinfo ENOTFOUND")?new n.HostNotFoundError(g):g.message.includes("connect ECONNREFUSED")?new n.ConnectionRefusedError(g):new n.ConnectionError(g);case"ER_ACCESS_DENIED_ERROR":case"ELOGIN":throw new n.AccessDeniedError(g);case"EINVAL":throw new n.InvalidConnectionError(g);default:throw new n.ConnectionError(g)}}}async disconnect(_){if(!_.closed)return _.queue.close(),new Promise(m=>{_.on("end",m),_.close(),T("connection closed")})}validate(_){return _&&(_.loggedIn||_.state.name==="LoggedIn")}}return wt.exports=w,wt.exports.ConnectionManager=w,wt.exports.default=w,wt.exports}var It={exports:{}},Bi;function iu(){if(Bi)return It.exports;Bi=1;const S=et(),e=ce,t=je()("mssql"),n=re,{logger:f}=ge,O=f.debugContext("sql:mssql"),T=BigInt(Number.MIN_SAFE_INTEGER),E=BigInt(Number.MAX_SAFE_INTEGER);function w(_){if(!Number.isFinite(_))return 0;let m=1;for(;Math.round(_*m)/m!==_;)m*=10;return Math.log10(m)}class R extends S{getInsertIdField(){return"id"}getSQLTypeFromJsType(m,g){const N={type:g.NVarChar,typeOptions:{},value:m};if(typeof m=="number")Number.isInteger(m)?m>=-2147483648&&m<=2147483647?N.type=g.Int:N.type=g.BigInt:(N.type=g.Numeric,N.typeOptions={precision:30,scale:w(m)});else if(typeof m=="bigint")if(m<T||m>E)N.type=g.VarChar,N.value=m.toString();else return this.getSQLTypeFromJsType(Number(m),g);else typeof m=="boolean"&&(N.type=g.Bit);return Buffer.isBuffer(m)&&(N.type=g.VarBinary),N}async _run(m,g,N,c){this.sql=g;const{options:l}=this,r=this._logQuery(g,O,N),i=new Promise((d,y)=>{if(g.startsWith("BEGIN TRANSACTION"))return m.beginTransaction(b=>b?y(b):d([]),l.transaction.name,m.lib.ISOLATION_LEVEL[l.isolationLevel]);if(g.startsWith("COMMIT TRANSACTION"))return m.commitTransaction(b=>b?y(b):d([]));if(g.startsWith("ROLLBACK TRANSACTION"))return m.rollbackTransaction(b=>b?y(b):d([]),l.transaction.name);if(g.startsWith("SAVE TRANSACTION"))return m.saveTransaction(b=>b?y(b):d([]),l.transaction.name);const o=[],p=new m.lib.Request(g,(b,u)=>b?y(b):d([o,u]));N&&n.forOwn(N,(b,u)=>{const h=this.getSQLTypeFromJsType(b,m.lib.TYPES);p.addParameter(u,h.type,b,h.typeOptions)}),p.on("row",b=>{o.push(b)}),m.execSql(p)});let s,a;try{[s,a]=await i}catch(d){throw d.sql=g,d.parameters=N,this.formatError(d,c)}return r(),Array.isArray(s)&&(s=s.map(d=>{const y={};for(const o of d){const p=o.metadata.type.id,b=t.get(p);let u=o.value;u!==null&!!b&&(u=b(u)),y[o.metadata.colName]=u}return y})),this.formatResults(s,a)}run(m,g){const N=new Error;return this.connection.queue.enqueue(()=>this._run(this.connection,m,g,N.stack))}static formatBindParameters(m,g,N){const c={},l=(r,i,s)=>{if(s[i]!==void 0)return c[i]=s[i],`@${i}`};return m=S.formatBindParameters(m,g,N,l)[0],[m,c]}formatResults(m,g){if(this.isInsertQuery(m))return this.handleInsertQuery(m),[this.instance||m,g];if(this.isShowTablesQuery())return this.handleShowTablesQuery(m);if(this.isDescribeQuery()){const N={};for(const c of m)c.Default&&(c.Default=c.Default.replace("('","").replace("')","").replace(/'/g,"")),N[c.Name]={type:c.Type.toUpperCase(),allowNull:c.IsNull==="YES",defaultValue:c.Default,primaryKey:c.Constraint==="PRIMARY KEY",autoIncrement:c.IsIdentity===1,comment:c.Comment},N[c.Name].type.includes("CHAR")&&c.Length&&(c.Length===-1?N[c.Name].type+="(MAX)":N[c.Name].type+=`(${c.Length})`);return N}return this.isSelectQuery()?this.handleSelectQuery(m):this.isShowIndexesQuery()?this.handleShowIndexesQuery(m):this.isCallQuery()?m[0]:this.isBulkUpdateQuery()?this.options.returning?this.handleSelectQuery(m):g:this.isBulkDeleteQuery()?m[0]?m[0].AFFECTEDROWS:0:this.isVersionQuery()?m[0].version:this.isForeignKeysQuery()?m:this.isUpsertQuery()?m&&m.length===0?[this.instance||m,!1]:(this.handleInsertQuery(m),[this.instance||m,m[0].$action==="INSERT"]):this.isUpdateQuery()?[this.instance||m,g]:this.isShowConstraintsQuery()?this.handleShowConstraintsQuery(m):this.isRawQuery()?[m,g]:m}handleShowTablesQuery(m){return m.map(g=>({tableName:g.TABLE_NAME,schema:g.TABLE_SCHEMA}))}handleShowConstraintsQuery(m){return m.slice(1).map(g=>{const N={};for(const c in g)N[n.camelCase(c)]=g[c];return N})}formatError(m,g){let N;if(N=m.message.match(/Violation of (?:UNIQUE|PRIMARY) KEY constraint '([^']*)'. Cannot insert duplicate key in object '.*'.(:? The duplicate key value is \((.*)\).)?/),N=N||m.message.match(/Cannot insert duplicate key row in object .* with unique index '(.*)'/),N&&N.length>1){let c={};const l=this.model&&this.model.uniqueKeys[N[1]];let r="Validation error";if(l&&l.msg&&(r=l.msg),N[3]){const s=N[3].split(",").map(a=>a.trim());l?c=n.zipObject(l.fields,s):c[N[1]]=N[3]}const i=[];return n.forOwn(c,(s,a)=>{i.push(new e.ValidationErrorItem(this.getUniqueConstraintErrorMessage(a),"unique violation",a,s,this.instance,"not_unique"))}),new e.UniqueConstraintError({message:r,errors:i,parent:m,fields:c,stack:g})}if(N=m.message.match(/Failed on step '(.*)'.Could not create constraint. See previous errors./)||m.message.match(/The DELETE statement conflicted with the REFERENCE constraint "(.*)". The conflict occurred in database "(.*)", table "(.*)", column '(.*)'./)||m.message.match(/The (?:INSERT|MERGE|UPDATE) statement conflicted with the FOREIGN KEY constraint "(.*)". The conflict occurred in database "(.*)", table "(.*)", column '(.*)'./),N&&N.length>0)return new e.ForeignKeyConstraintError({fields:null,index:N[1],parent:m,stack:g});if(N=m.message.match(/Could not drop constraint. See previous errors./),N&&N.length>0){let c=m.sql.match(/(?:constraint|index) \[(.+?)\]/i);c=c?c[1]:void 0;let l=m.sql.match(/table \[(.+?)\]/i);return l=l?l[1]:void 0,new e.UnknownConstraintError({message:N[1],constraint:c,table:l,parent:m,stack:g})}return new e.DatabaseError(m,{stack:g})}isShowOrDescribeQuery(){let m=!1;return m=m||this.sql.toLowerCase().startsWith("select c.column_name as 'name', c.data_type as 'type', c.is_nullable as 'isnull'"),m=m||this.sql.toLowerCase().startsWith("select tablename = t.name, name = ind.name,"),m=m||this.sql.toLowerCase().startsWith("exec sys.sp_helpindex @objname"),m}isShowIndexesQuery(){return this.sql.toLowerCase().startsWith("exec sys.sp_helpindex @objname")}handleShowIndexesQuery(m){return m=m.reduce((g,N)=>(N.index_name in g||(g[N.index_name]=N,N.fields=[]),N.index_keys.split(",").forEach(c=>{let l=c.trim();l.includes("(-)")&&(l=l.replace("(-)","")),g[N.index_name].fields.push({attribute:l,length:void 0,order:c.includes("(-)")?"DESC":"ASC",collate:void 0})}),delete N.index_keys,g),{}),n.map(m,g=>({primary:g.index_name.toLowerCase().startsWith("pk"),fields:g.fields,name:g.index_name,tableName:void 0,unique:g.index_description.toLowerCase().includes("unique"),type:void 0}))}handleInsertQuery(m,g){if(this.instance){const N=this.model.autoIncrementAttribute;let c=null,l=null;if(Object.prototype.hasOwnProperty.call(this.model.rawAttributes,N)&&this.model.rawAttributes[N].field!==void 0&&(l=this.model.rawAttributes[N].field),c=c||m&&m[0][this.getInsertIdField()],c=c||g&&g[this.getInsertIdField()],c=c||m&&m[0][N],c=c||l&&m&&m[0][l],this.instance[N]=c,this.instance.dataValues){for(const r in m[0])if(Object.prototype.hasOwnProperty.call(m[0],r)){const i=m[0][r],s=n.find(this.model.rawAttributes,a=>a.fieldName===r||a.field===r);this.instance.dataValues[s&&s.fieldName||r]=i}}}}}return It.exports=R,It.exports.Query=R,It.exports.default=R,It.exports}var Zr,zi;function nu(){if(zi)return Zr;zi=1;var S=Object.defineProperty,e=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,f=(i,s,a)=>s in i?S(i,s,{enumerable:!0,configurable:!0,writable:!0,value:a}):i[s]=a,O=(i,s)=>{for(var a in s||(s={}))t.call(s,a)&&f(i,a,s[a]);if(e)for(var a of e(s))n.call(s,a)&&f(i,a,s[a]);return i};const T=re,E=fe(),w=he(),R=sa,_=ut(),m=Ae.randomBytes,g=yt(),N=Re,c=function(i){throw new Error(`The method "${i}" is not defined! Please add it to your sql dialect.`)};class l extends _{createDatabaseQuery(s,a){a=O({collate:null},a);const d=a.collate?`COLLATE ${this.escape(a.collate)}`:"";return["IF NOT EXISTS (SELECT * FROM sys.databases WHERE name =",r(s),")","BEGIN","CREATE DATABASE",this.quoteIdentifier(s),`${d};`,"END;"].join(" ")}dropDatabaseQuery(s){return["IF EXISTS (SELECT * FROM sys.databases WHERE name =",r(s),")","BEGIN","DROP DATABASE",this.quoteIdentifier(s),";","END;"].join(" ")}createSchema(s){return["IF NOT EXISTS (SELECT schema_name","FROM information_schema.schemata","WHERE schema_name =",r(s),")","BEGIN","EXEC sp_executesql N'CREATE SCHEMA",this.quoteIdentifier(s),";'","END;"].join(" ")}dropSchema(s){const a=r(s);return["IF EXISTS (SELECT schema_name","FROM information_schema.schemata","WHERE schema_name =",a,")","BEGIN","DECLARE @id INT, @ms_sql NVARCHAR(2000);","DECLARE @cascade TABLE (","id INT NOT NULL IDENTITY PRIMARY KEY,","ms_sql NVARCHAR(2000) NOT NULL );","INSERT INTO @cascade ( ms_sql )","SELECT CASE WHEN o.type IN ('F','PK')","THEN N'ALTER TABLE ['+ s.name + N'].[' + p.name + N'] DROP CONSTRAINT [' + o.name + N']'","ELSE N'DROP TABLE ['+ s.name + N'].[' + o.name + N']' END","FROM sys.objects o","JOIN sys.schemas s on o.schema_id = s.schema_id","LEFT OUTER JOIN sys.objects p on o.parent_object_id = p.object_id","WHERE o.type IN ('F', 'PK', 'U') AND s.name = ",a,"ORDER BY o.type ASC;","SELECT TOP 1 @id = id, @ms_sql = ms_sql FROM @cascade ORDER BY id;","WHILE @id IS NOT NULL","BEGIN","BEGIN TRY EXEC sp_executesql @ms_sql; END TRY","BEGIN CATCH BREAK; THROW; END CATCH;","DELETE FROM @cascade WHERE id = @id;","SELECT @id = NULL, @ms_sql = NULL;","SELECT TOP 1 @id = id, @ms_sql = ms_sql FROM @cascade ORDER BY id;","END","EXEC sp_executesql N'DROP SCHEMA",this.quoteIdentifier(s),";'","END;"].join(" ")}showSchemasQuery(){return['SELECT "name" as "schema_name" FROM sys.schemas as s','WHERE "s"."name" NOT IN (',"'INFORMATION_SCHEMA', 'dbo', 'guest', 'sys', 'archive'",")","AND",'"s"."name" NOT LIKE',"'db_%'"].join(" ")}versionQuery(){return["DECLARE @ms_ver NVARCHAR(20);","SET @ms_ver = REVERSE(CONVERT(NVARCHAR(20), SERVERPROPERTY('ProductVersion')));","SELECT REVERSE(SUBSTRING(@ms_ver, CHARINDEX('.', @ms_ver)+1, 20)) AS 'version'"].join(" ")}createTableQuery(s,a,d){const y=[],o={},p=[];let b="";for(const A in a)if(Object.prototype.hasOwnProperty.call(a,A)){let I=a[A],q;if(I.includes("COMMENT ")){const L=I.match(/^(.+) (COMMENT.*)$/),D=L[2].replace("COMMENT","").trim();b+=this.commentTemplate(D,s,A),I=L[1]}I.includes("PRIMARY KEY")?(y.push(A),I.includes("REFERENCES")?(q=I.match(/^(.+) (REFERENCES.*)$/),p.push(`${this.quoteIdentifier(A)} ${q[1].replace("PRIMARY KEY","")}`),o[A]=q[2]):p.push(`${this.quoteIdentifier(A)} ${I.replace("PRIMARY KEY","")}`)):I.includes("REFERENCES")?(q=I.match(/^(.+) (REFERENCES.*)$/),p.push(`${this.quoteIdentifier(A)} ${q[1]}`),o[A]=q[2]):p.push(`${this.quoteIdentifier(A)} ${I}`)}const u=y.map(A=>this.quoteIdentifier(A)).join(", ");d.uniqueKeys&&T.each(d.uniqueKeys,(A,I)=>{A.customIndex&&(typeof I!="string"&&(I=`uniq_${s}_${A.fields.join("_")}`),p.push(`CONSTRAINT ${this.quoteIdentifier(I)} UNIQUE (${A.fields.map(q=>this.quoteIdentifier(q)).join(", ")})`))}),u.length>0&&p.push(`PRIMARY KEY (${u})`);for(const A in o)Object.prototype.hasOwnProperty.call(o,A)&&p.push(`FOREIGN KEY (${this.quoteIdentifier(A)}) ${o[A]}`);const h=this.quoteTable(s);return E.joinSQLFragments([`IF OBJECT_ID('${h}', 'U') IS NULL`,`CREATE TABLE ${h} (${p.join(", ")})`,";",b])}describeTableQuery(s,a){let d=["SELECT","c.COLUMN_NAME AS 'Name',","c.DATA_TYPE AS 'Type',","c.CHARACTER_MAXIMUM_LENGTH AS 'Length',","c.IS_NULLABLE as 'IsNull',","COLUMN_DEFAULT AS 'Default',","pk.CONSTRAINT_TYPE AS 'Constraint',","COLUMNPROPERTY(OBJECT_ID('[' + c.TABLE_SCHEMA + '].[' + c.TABLE_NAME + ']'), c.COLUMN_NAME, 'IsIdentity') as 'IsIdentity',","CAST(prop.value AS NVARCHAR) AS 'Comment'","FROM","INFORMATION_SCHEMA.TABLES t","INNER JOIN","INFORMATION_SCHEMA.COLUMNS c ON t.TABLE_NAME = c.TABLE_NAME AND t.TABLE_SCHEMA = c.TABLE_SCHEMA","LEFT JOIN (SELECT tc.table_schema, tc.table_name, ","cu.column_name, tc.CONSTRAINT_TYPE ","FROM INFORMATION_SCHEMA.TABLE_CONSTRAINTS tc ","JOIN INFORMATION_SCHEMA.KEY_COLUMN_USAGE  cu ","ON tc.table_schema=cu.table_schema and tc.table_name=cu.table_name ","and tc.constraint_name=cu.constraint_name ","and tc.CONSTRAINT_TYPE='PRIMARY KEY') pk ","ON pk.table_schema=c.table_schema ","AND pk.table_name=c.table_name ","AND pk.column_name=c.column_name ","INNER JOIN sys.columns AS sc","ON sc.object_id = OBJECT_ID('[' + t.TABLE_SCHEMA + '].[' + t.TABLE_NAME + ']') AND sc.name = c.column_name","LEFT JOIN sys.extended_properties prop ON prop.major_id = sc.object_id","AND prop.minor_id = sc.column_id","AND prop.name = 'MS_Description'","WHERE t.TABLE_NAME =",r(s)].join(" ");return a&&(d+=`AND t.TABLE_SCHEMA =${r(a)}`),d}renameTableQuery(s,a){return`EXEC sp_rename ${this.quoteTable(s)}, ${this.quoteTable(a)};`}showTablesQuery(){return"SELECT TABLE_NAME, TABLE_SCHEMA FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'BASE TABLE';"}tableExistsQuery(s){const a=s.tableName||s,d=s.schema||"dbo";return`SELECT TABLE_NAME, TABLE_SCHEMA FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'BASE TABLE' AND TABLE_NAME = ${this.escape(a)} AND TABLE_SCHEMA = ${this.escape(d)}`}dropTableQuery(s){const a=this.quoteTable(s);return E.joinSQLFragments([`IF OBJECT_ID('${a}', 'U') IS NOT NULL`,"DROP TABLE",a,";"])}addColumnQuery(s,a,d){d.field=a;let y="";return d.comment&&T.isString(d.comment)&&(y=this.commentTemplate(d.comment,s,a),delete d.comment),E.joinSQLFragments(["ALTER TABLE",this.quoteTable(s),"ADD",this.quoteIdentifier(a),this.attributeToSQL(d,{context:"addColumn"}),";",y])}commentTemplate(s,a,d){return` EXEC sp_addextendedproperty @name = N'MS_Description', @value = ${this.escape(s)}, @level0type = N'Schema', @level0name = 'dbo', @level1type = N'Table', @level1name = ${this.quoteIdentifier(a)}, @level2type = N'Column', @level2name = ${this.quoteIdentifier(d)};`}removeColumnQuery(s,a){return E.joinSQLFragments(["ALTER TABLE",this.quoteTable(s),"DROP COLUMN",this.quoteIdentifier(a),";"])}changeColumnQuery(s,a){const d=[],y=[];let o="";for(const p in a){const b=this.quoteIdentifier(p);let u=a[p];if(u.includes("COMMENT ")){const h=u.match(/^(.+) (COMMENT.*)$/),A=h[2].replace("COMMENT","").trim();o+=this.commentTemplate(A,s,p),u=h[1]}u.includes("REFERENCES")?y.push(`FOREIGN KEY (${b}) ${u.replace(/.+?(?=REFERENCES)/,"")}`):d.push(`${b} ${u}`)}return E.joinSQLFragments(["ALTER TABLE",this.quoteTable(s),d.length&&`ALTER COLUMN ${d.join(", ")}`,y.length&&`ADD ${y.join(", ")}`,";",o])}renameColumnQuery(s,a,d){const y=Object.keys(d)[0];return E.joinSQLFragments(["EXEC sp_rename",`'${this.quoteTable(s)}.${a}',`,`'${y}',`,"'COLUMN'",";"])}bulkInsertQuery(s,a,d,y){const o=this.quoteTable(s);d=d||{},y=y||{};const p=[],b=[],u=[];let h=!1,A="";d.returning&&(A=this.generateReturnValues(y,d).outputFragment);const I=`INSERT INTO ${o}${A} DEFAULT VALUES`;if(a.forEach(C=>{const $=Object.keys(C),P=y[$[0]];if($.length===1&&P&&P.autoIncrement&&C[$[0]]===null){u.push(I);return}T.forOwn(C,(Q,j)=>{if(Q!==null&&y[j]&&y[j].autoIncrement&&(h=!0),!b.includes(j)){if(Q===null&&y[j]&&y[j].autoIncrement)return;b.push(j)}})}),b.length>0){a.forEach($=>{p.push(`(${b.map(P=>this.escape($[P])).join(",")})`)});const C=b.map($=>this.quoteIdentifier($)).join(",");u.push($=>`INSERT INTO ${o} (${C})${A} VALUES ${$};`)}const q=[];let L=0;const D=Math.floor(250/(b.length+1))+1;for(;L<Math.max(p.length,1);){const C=p.slice(L,Math.min(p.length,L+D));let $=u.map(P=>typeof P=="string"?P:P(C)).join(";");h&&($=`SET IDENTITY_INSERT ${o} ON; ${$}; SET IDENTITY_INSERT ${o} OFF;`),q.push($),L+=D}return q.join(";")}updateQuery(s,a,d,y,o){const p=super.updateQuery(s,a,d,y,o);if(y.limit){const b=`UPDATE TOP(${this.escape(y.limit)})`;p.query=p.query.replace("UPDATE",b)}return p}upsertQuery(s,a,d,y,o){const p=this.quoteTable(`${s}_target`),b=this.quoteTable(`${s}_source`),u=[],h=[],A=[],I=this.quoteTable(s);let q=!1;for(const H in o.rawAttributes)o.rawAttributes[H].primaryKey&&u.push(o.rawAttributes[H].field||H),o.rawAttributes[H].unique&&A.push(o.rawAttributes[H].field||H),o.rawAttributes[H].autoIncrement&&h.push(o.rawAttributes[H].field||H);for(const H of o._indexes)if(H.unique&&H.fields)for(const W of H.fields){const se=typeof W=="string"?W:W.name||W.attribute;!A.includes(se)&&o.rawAttributes[se]&&A.push(se)}const L=Object.keys(d),D=Object.keys(a),C=D.map(H=>this.quoteIdentifier(H)).join(", "),$=D.map(H=>this.escape(a[H])).join(", "),P=`VALUES(${$})`;let Q;h.forEach(H=>{a[H]&&a[H]!==null&&(q=!0)});const j=y[N.or].filter(H=>{let W=!0;for(const se in H)if(typeof H[se]>"u"||H[se]==null){W=!1;break}return W}),B=H=>H.map(W=>(W=this.quoteIdentifier(W),`${p}.${W} = ${b}.${W}`));if(j.length===0)throw new Error("Primary Key or Unique key should be passed to upsert query");for(const H in j){const W=Object.keys(j[H]);if(u.includes(W[0])){Q=B(u).join(" AND ");break}}Q||(Q=B(A).join(" AND "));const F=L.filter(H=>!h.includes(H)).map(H=>{const W=this.escape(d[H]);return H=this.quoteIdentifier(H),`${p}.${H} = ${W}`}),x=F.length>0?`WHEN MATCHED THEN UPDATE SET ${F.join(", ")}`:"",k=`(${C}) VALUES(${$})`;let X=`MERGE INTO ${I} WITH(HOLDLOCK) AS ${p} USING (${P}) AS ${b}(${C}) ON ${Q}`;return X+=` ${x} WHEN NOT MATCHED THEN INSERT ${k} OUTPUT $action, INSERTED.*;`,q&&(X=`SET IDENTITY_INSERT ${I} ON; ${X} SET IDENTITY_INSERT ${I} OFF;`),X}truncateTableQuery(s){return`TRUNCATE TABLE ${this.quoteTable(s)}`}deleteQuery(s,a,d={},y){const o=this.quoteTable(s),p=this.getWhereConditions(a,null,y,d);return E.joinSQLFragments(["DELETE",d.limit&&`TOP(${this.escape(d.limit)})`,"FROM",o,p&&`WHERE ${p}`,";","SELECT @@ROWCOUNT AS AFFECTEDROWS",";"])}showIndexesQuery(s){return`EXEC sys.sp_helpindex @objname = N'${this.quoteTable(s)}';`}showConstraintsQuery(s){return`EXEC sp_helpconstraint @objname = ${this.escape(this.quoteTable(s))};`}removeIndexQuery(s,a){let d=a;return typeof d!="string"&&(d=E.underscore(`${s}_${a.join("_")}`)),`DROP INDEX ${this.quoteIdentifiers(d)} ON ${this.quoteIdentifiers(s)}`}attributeToSQL(s,a){T.isPlainObject(s)||(s={type:s}),s.references&&s.Model&&s.Model.tableName===s.references.model&&(this.sequelize.log("MSSQL does not support self referencial constraints, we will remove it but we recommend restructuring your query"),s.onDelete="",s.onUpdate="");let d;return s.type instanceof w.ENUM?(s.type.values&&!s.values&&(s.values=s.type.values),d=s.type.toSql(),d+=` CHECK (${this.quoteIdentifier(s.field)} IN(${s.values.map(y=>this.escape(y)).join(", ")}))`,d):(d=s.type.toString(),s.allowNull===!1?d+=" NOT NULL":!s.primaryKey&&!E.defaultValueSchemable(s.defaultValue)&&(d+=" NULL"),s.autoIncrement&&(d+=" IDENTITY(1,1)"),s.type!=="TEXT"&&s.type._binary!==!0&&E.defaultValueSchemable(s.defaultValue)&&(d+=` DEFAULT ${this.escape(s.defaultValue)}`),s.unique===!0&&(d+=" UNIQUE"),s.primaryKey&&(d+=" PRIMARY KEY"),(!a||!a.withoutForeignKeyConstraints)&&s.references&&(d+=` REFERENCES ${this.quoteTable(s.references.model)}`,s.references.key?d+=` (${this.quoteIdentifier(s.references.key)})`:d+=` (${this.quoteIdentifier("id")})`,s.onDelete&&(d+=` ON DELETE ${s.onDelete.toUpperCase()}`),s.onUpdate&&(d+=` ON UPDATE ${s.onUpdate.toUpperCase()}`)),s.comment&&typeof s.comment=="string"&&(d+=` COMMENT ${s.comment}`),d)}attributesToSQL(s,a){const d={},y=[];let o,p;for(o in s)p=s[o],p.references&&(y.includes(p.references.model.toString())?(p.onDelete="",p.onUpdate=""):(y.push(p.references.model.toString()),p.onUpdate="")),o&&!p.field&&(p.field=o),d[p.field||o]=this.attributeToSQL(p,a);return d}createTrigger(){c("createTrigger")}dropTrigger(){c("dropTrigger")}renameTrigger(){c("renameTrigger")}createFunction(){c("createFunction")}dropFunction(){c("dropFunction")}renameFunction(){c("renameFunction")}_getForeignKeysQueryPrefix(s){return`SELECT constraint_name = OBJ.NAME, constraintName = OBJ.NAME, ${s?`constraintCatalog = '${s}', `:""}constraintSchema = SCHEMA_NAME(OBJ.SCHEMA_ID), tableName = TB.NAME, tableSchema = SCHEMA_NAME(TB.SCHEMA_ID), ${s?`tableCatalog = '${s}', `:""}columnName = COL.NAME, referencedTableSchema = SCHEMA_NAME(RTB.SCHEMA_ID), ${s?`referencedCatalog = '${s}', `:""}referencedTableName = RTB.NAME, referencedColumnName = RCOL.NAME FROM sys.foreign_key_columns FKC INNER JOIN sys.objects OBJ ON OBJ.OBJECT_ID = FKC.CONSTRAINT_OBJECT_ID INNER JOIN sys.tables TB ON TB.OBJECT_ID = FKC.PARENT_OBJECT_ID INNER JOIN sys.columns COL ON COL.COLUMN_ID = PARENT_COLUMN_ID AND COL.OBJECT_ID = TB.OBJECT_ID INNER JOIN sys.tables RTB ON RTB.OBJECT_ID = FKC.REFERENCED_OBJECT_ID INNER JOIN sys.columns RCOL ON RCOL.COLUMN_ID = REFERENCED_COLUMN_ID AND RCOL.OBJECT_ID = RTB.OBJECT_ID`}getForeignKeysQuery(s,a){const d=s.tableName||s;let y=`${this._getForeignKeysQueryPrefix(a)} WHERE TB.NAME =${r(d)}`;return s.schema&&(y+=` AND SCHEMA_NAME(TB.SCHEMA_ID) =${r(s.schema)}`),y}getForeignKeyQuery(s,a){const d=s.tableName||s;return E.joinSQLFragments([this._getForeignKeysQueryPrefix(),"WHERE",`TB.NAME =${r(d)}`,"AND",`COL.NAME =${r(a)}`,s.schema&&`AND SCHEMA_NAME(TB.SCHEMA_ID) =${r(s.schema)}`])}getPrimaryKeyConstraintQuery(s,a){const d=r(s.tableName||s);return E.joinSQLFragments(["SELECT K.TABLE_NAME AS tableName,","K.COLUMN_NAME AS columnName,","K.CONSTRAINT_NAME AS constraintName","FROM INFORMATION_SCHEMA.TABLE_CONSTRAINTS AS C","JOIN INFORMATION_SCHEMA.KEY_COLUMN_USAGE AS K","ON C.TABLE_NAME = K.TABLE_NAME","AND C.CONSTRAINT_CATALOG = K.CONSTRAINT_CATALOG","AND C.CONSTRAINT_SCHEMA = K.CONSTRAINT_SCHEMA","AND C.CONSTRAINT_NAME = K.CONSTRAINT_NAME","WHERE C.CONSTRAINT_TYPE = 'PRIMARY KEY'",`AND K.COLUMN_NAME = ${r(a)}`,`AND K.TABLE_NAME = ${d}`,";"])}dropForeignKeyQuery(s,a){return E.joinSQLFragments(["ALTER TABLE",this.quoteTable(s),"DROP",this.quoteIdentifier(a)])}getDefaultConstraintQuery(s,a){const d=this.quoteTable(s);return E.joinSQLFragments(["SELECT name FROM sys.default_constraints",`WHERE PARENT_OBJECT_ID = OBJECT_ID('${d}', 'U')`,`AND PARENT_COLUMN_ID = (SELECT column_id FROM sys.columns WHERE NAME = ('${a}')`,`AND object_id = OBJECT_ID('${d}', 'U'))`,";"])}dropConstraintQuery(s,a){return E.joinSQLFragments(["ALTER TABLE",this.quoteTable(s),"DROP CONSTRAINT",this.quoteIdentifier(a),";"])}setIsolationLevelQuery(){}generateTransactionId(){return m(10).toString("hex")}startTransactionQuery(s){return s.parent?`SAVE TRANSACTION ${this.quoteIdentifier(s.name)};`:"BEGIN TRANSACTION;"}commitTransactionQuery(s){if(!s.parent)return"COMMIT TRANSACTION;"}rollbackTransactionQuery(s){return s.parent?`ROLLBACK TRANSACTION ${this.quoteIdentifier(s.name)};`:"ROLLBACK TRANSACTION;"}selectFromTableFragment(s,a,d,y,o,p){this._throwOnEmptyAttributes(d,{modelName:a&&a.name,as:o});const b=this.sequelize.options.databaseVersion,u=g.valid(b)&&g.lt(b,"11.0.0");if(u&&s.offset){const h=s.offset||0,A=s.hasIncludeWhere||s.hasIncludeRequired||s.hasMultiAssociation;let I={mainQueryOrder:[]};s.order&&(I=this.getQueryOrders(s,a,A)),I.mainQueryOrder.length===0&&I.mainQueryOrder.push(this.quoteIdentifier(a.primaryKeyField));const q=o||"OffsetTable";if(s.include){const L=s.subQuery===void 0?s.limit&&s.hasMultiAssociation:s.subQuery,C={names:{name:o,quotedName:null,as:null,model:a},options:s,subQuery:L};let $=[];for(const P of s.include){if(P.separate)continue;const Q=this.generateInclude(P,{externalAs:o,internalAs:o},C);$=$.concat(Q.mainQuery)}return E.joinSQLFragments(["SELECT TOP 100 PERCENT",d.join(", "),"FROM (",["SELECT",s.limit&&`TOP ${s.limit}`,"* FROM (",["SELECT ROW_NUMBER() OVER (",["ORDER BY",I.mainQueryOrder.join(", ")],`) as row_num, ${q}.* FROM (`,["SELECT DISTINCT",`${q}.* FROM ${y} AS ${q}`,$,p&&`WHERE ${p}`],`) AS ${q}`],`) AS ${q} WHERE row_num > ${h}`],`) AS ${q}`])}return E.joinSQLFragments(["SELECT TOP 100 PERCENT",d.join(", "),"FROM (",["SELECT",s.limit&&`TOP ${s.limit}`,"* FROM (",["SELECT ROW_NUMBER() OVER (",["ORDER BY",I.mainQueryOrder.join(", ")],`) as row_num, * FROM ${y} AS ${q}`,p&&`WHERE ${p}`],`) AS ${q} WHERE row_num > ${h}`],`) AS ${q}`])}return E.joinSQLFragments(["SELECT",u&&s.limit&&`TOP ${s.limit}`,d.join(", "),`FROM ${y}`,o&&`AS ${o}`,s.tableHint&&R[s.tableHint]&&`WITH (${R[s.tableHint]})`])}addLimitAndOffset(s,a){if(g.valid(this.sequelize.options.databaseVersion)&&g.lt(this.sequelize.options.databaseVersion,"11.0.0"))return"";const d=s.offset||0,y=s.subQuery===void 0?s.hasIncludeWhere||s.hasIncludeRequired||s.hasMultiAssociation:s.subQuery;let o="",p={};if(s.order&&(p=this.getQueryOrders(s,a,y)),s.limit||s.offset){if(!s.order||s.order.length===0||s.include&&p.subQueryOrder.length===0){let b=a.primaryKeyField;const u=`${this.quoteTable(s.tableAs||a.name)}.${this.quoteIdentifier(b)}`,h=(s.attributes||[]).find(A=>Array.isArray(A)&&A[1]&&(A[0]===b||A[1]===b));if(h){const A=this.quoteIdentifier(s.tableAs||a.name),I=this._getAliasForField(A,h[1],s);b=new E.Col(I||h[1])}!s.order||!s.order.length?o+=` ORDER BY ${u}`:(s.order||[]).map(q=>{const L=Array.isArray(q)?q[0]:q;return L instanceof E.Col?L.col:L instanceof E.Literal?L.val:L}).some(q=>q===(b.col||b))||(o+=s.order&&!y?", ":" ORDER BY ",o+=u)}(s.offset||s.limit)&&(o+=` OFFSET ${this.escape(d)} ROWS`),s.limit&&(o+=` FETCH NEXT ${this.escape(s.limit)} ROWS ONLY`)}return o}booleanValue(s){return s?1:0}quoteIdentifier(s,a){return`[${s.replace(/[[\]']+/g,"")}]`}}function r(i){return E.addTicks(E.removeTicks(i,"'"),"'")}return Zr=l,Zr}var es={},ki;function au(){if(ki)return es;ki=1;var S=Object.defineProperty,e=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,f=(g,N,c)=>N in g?S(g,N,{enumerable:!0,configurable:!0,writable:!0,value:c}):g[N]=c,O=(g,N)=>{for(var c in N||(N={}))t.call(N,c)&&f(g,c,N[c]);if(e)for(var c of e(N))n.call(N,c)&&f(g,c,N[c]);return g};const T=re,E=fe(),w=Me,R=Re,{QueryInterface:_}=He;class m extends _{async removeColumn(N,c,l){l=O({raw:!0},l||{});const r=this.queryGenerator.getDefaultConstraintQuery(N,c),[i]=await this.sequelize.query(r,l);if(i.length){const p=this.queryGenerator.dropConstraintQuery(N,i[0].name);await this.sequelize.query(p,l)}const s=this.queryGenerator.getForeignKeyQuery(N,c),[a]=await this.sequelize.query(s,l);if(a.length){const p=this.queryGenerator.dropForeignKeyQuery(N,a[0].constraint_name);await this.sequelize.query(p,l)}const d=this.queryGenerator.getPrimaryKeyConstraintQuery(N,c),[y]=await this.sequelize.query(d,l);if(y.length){const p=this.queryGenerator.dropConstraintQuery(N,y[0].constraintName);await this.sequelize.query(p,l)}const o=this.queryGenerator.removeColumnQuery(N,c);return this.sequelize.query(o,l)}async upsert(N,c,l,r,i){const s=i.model,a=[];i=O({},i),E.isWhereEmpty(r)||a.push(r);let d=Object.values(s.uniqueKeys).map(p=>p.fields);d=d.concat(Object.values(s._indexes).filter(p=>p.unique).map(p=>p.fields));const y=Object.keys(c);for(const p of d)if(T.intersection(y,p).length===p.length){r={};for(const b of p)r[b]=c[b];a.push(r)}r={[R.or]:a},i.type=w.UPSERT,i.raw=!0;const o=this.queryGenerator.upsertQuery(N,c,l,r,s,i);return await this.sequelize.query(o,i)}}return es.MSSqlQueryInterface=m,es}var ts,Hi;function ou(){if(Hi)return ts;Hi=1;const S=re,e=Xe(),t=su(),n=iu(),f=nu(),O=he().mssql,{MSSqlQueryInterface:T}=au();class E extends e{constructor(R){super(),this.sequelize=R,this.connectionManager=new t(this,R),this.queryGenerator=new f({_dialect:this,sequelize:R}),this.queryInterface=new T(R,this.queryGenerator)}}return E.prototype.supports=S.merge(S.cloneDeep(e.prototype.supports),{DEFAULT:!0,"DEFAULT VALUES":!0,"LIMIT ON UPDATE":!0,"ORDER NULLS":!1,lock:!1,transactions:!0,migrations:!1,returnValues:{output:!0},schemas:!0,autoIncrement:{identityInsert:!0,defaultValue:!1,update:!1},constraints:{restrict:!1,default:!0},index:{collate:!1,length:!1,parser:!1,type:!0,using:!1,where:!0},NUMERIC:!0,tmpTableTrigger:!0}),E.prototype.defaultVersion="12.0.2000",E.prototype.Query=n,E.prototype.name="mssql",E.prototype.TICK_CHAR='"',E.prototype.TICK_CHAR_LEFT="[",E.prototype.TICK_CHAR_RIGHT="]",E.prototype.DataTypes=O,ts=E,ts}var St={exports:{}},Gi;function uu(){if(Gi)return St.exports;Gi=1;var S=Object.defineProperty,e=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,f=(l,r,i)=>r in l?S(l,r,{enumerable:!0,configurable:!0,writable:!0,value:i}):l[r]=i,O=(l,r)=>{for(var i in r||(r={}))t.call(r,i)&&f(l,i,r[i]);if(e)for(var i of e(r))n.call(r,i)&&f(l,i,r[i]);return l};const T=Ze(),E=ce,{logger:w}=ge,R=he().mysql,_=ke,m=w.debugContext("connection:mysql"),g=je()("mysql"),{promisify:N}=Ae;class c extends T{constructor(r,i){i.config.port=i.config.port||3306,super(r,i),this.lib=this._loadDialectModule("mysql2"),this.refreshTypeParser(R)}_refreshTypeParser(r){g.refresh(r)}_clearTypeParser(){g.clear()}static _typecast(r,i){return g.get(r.type)?g.get(r.type)(r,this.sequelize.options,i):i()}async connect(r){const i=O({host:r.host,port:r.port,user:r.username,flags:"-FOUND_ROWS",password:r.password,database:r.database,timezone:this.sequelize.options.timezone,typeCast:c._typecast.bind(this),bigNumberStrings:!1,supportBigNumbers:!0},r.dialectOptions);try{const s=await new Promise((a,d)=>{const y=this.lib.createConnection(i),o=b=>{y.removeListener("connect",p),y.removeListener("error",p),d(b)},p=()=>{y.removeListener("error",o),a(y)};y.on("error",o),y.once("connect",p)});if(m("connection acquired"),s.on("error",a=>{switch(a.code){case"ESOCKET":case"ECONNRESET":case"EPIPE":case"PROTOCOL_CONNECTION_LOST":this.pool.destroy(s)}}),!this.sequelize.config.keepDefaultTimezone){let a=this.sequelize.options.timezone;a=/\//.test(a)?_.tz(a).format("Z"):a,await N(d=>s.query(`SET time_zone = '${a}'`,d))()}return s}catch(s){switch(s.code){case"ECONNREFUSED":throw new E.ConnectionRefusedError(s);case"ER_ACCESS_DENIED_ERROR":throw new E.AccessDeniedError(s);case"ENOTFOUND":throw new E.HostNotFoundError(s);case"EHOSTUNREACH":throw new E.HostNotReachableError(s);case"EINVAL":throw new E.InvalidConnectionError(s);default:throw new E.ConnectionError(s)}}}async disconnect(r){if(r._closing){m("connection tried to disconnect but was already at CLOSED state");return}return await N(i=>r.end(i))()}validate(r){return r&&!r._fatalError&&!r._protocolError&&!r._closing&&!r.stream.destroyed}}return St.exports=c,St.exports.ConnectionManager=c,St.exports.default=c,St.exports}var Rt={exports:{}},Vi;function lu(){if(Vi)return Rt.exports;Vi=1;var S=Object.defineProperty,e=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,f=(r,i,s)=>i in r?S(r,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[i]=s,O=(r,i)=>{for(var s in i||(i={}))t.call(i,s)&&f(r,s,i[s]);if(e)for(var s of e(i))n.call(i,s)&&f(r,s,i[s]);return r};const T=et(),E=ce,w=re,{logger:R}=ge,_=1062,m=1213,g=1451,N=1452,c=R.debugContext("sql:mysql");class l extends T{constructor(i,s,a){super(i,s,O({showWarnings:!1},a))}static formatBindParameters(i,s,a){const d=[],y=(o,p,b)=>{if(b[p]!==void 0)return d.push(b[p]),"?"};return i=T.formatBindParameters(i,s,a,y)[0],[i,d.length>0?d:void 0]}async run(i,s){this.sql=i;const{connection:a,options:d}=this,y=this.sequelize.options.showWarnings||d.showWarnings,o=this._logQuery(i,c,s);s&&c("parameters(%j)",s);let p;const b=new Error;try{s&&s.length?p=await new Promise((u,h)=>{a.execute(i,s,(A,I)=>A?h(A):u(I)).setMaxListeners(100)}):p=await new Promise((u,h)=>{a.query({sql:i},(A,I)=>A?h(A):u(I)).setMaxListeners(100)})}catch(u){if(d.transaction&&u.errno===m){try{await d.transaction.rollback()}catch{}d.transaction.finished="rollback"}throw u.sql=i,u.parameters=s,this.formatError(u,b.stack)}finally{o()}return y&&p&&p.warningStatus>0&&await this.logWarnings(p),this.formatResults(p)}formatResults(i){let s=this.instance;if(this.isInsertQuery(i)&&(this.handleInsertQuery(i),!this.instance))if(i.constructor.name==="ResultSetHeader"&&this.model&&this.model.autoIncrementAttribute&&this.model.autoIncrementAttribute===this.model.primaryKeyAttribute&&this.model.rawAttributes[this.model.primaryKeyAttribute]){const a=i[this.getInsertIdField()];s=[];for(let d=a;d<a+i.affectedRows;d++)s.push({[this.model.rawAttributes[this.model.primaryKeyAttribute].field]:d})}else s=i[this.getInsertIdField()];if(this.isSelectQuery())return this.handleSelectQuery(i);if(this.isShowTablesQuery())return this.handleShowTablesQuery(i);if(this.isDescribeQuery()){s={};for(const a of i){const d=/^enum/i;s[a.Field]={type:d.test(a.Type)?a.Type.replace(d,"ENUM"):a.Type.toUpperCase(),allowNull:a.Null==="YES",defaultValue:a.Default,primaryKey:a.Key==="PRI",autoIncrement:Object.prototype.hasOwnProperty.call(a,"Extra")&&a.Extra.toLowerCase()==="auto_increment",comment:a.Comment?a.Comment:null}}return s}return this.isShowIndexesQuery()?this.handleShowIndexesQuery(i):this.isCallQuery()?i[0]:this.isBulkUpdateQuery()||this.isBulkDeleteQuery()?i.affectedRows:this.isVersionQuery()?i[0].version:this.isForeignKeysQuery()?i:this.isUpsertQuery()?[s,i.affectedRows===1]:this.isInsertQuery()||this.isUpdateQuery()?[s,i.affectedRows]:this.isShowConstraintsQuery()?i:this.isRawQuery()?[i,i]:s}async logWarnings(i){const s=await this.run("SHOW WARNINGS"),a=`MySQL Warnings (${this.connection.uuid||"default"}): `,d=[];for(const y of s)if(!(y===void 0||typeof y[Symbol.iterator]!="function"))for(const o of y)if(Object.prototype.hasOwnProperty.call(o,"Message"))d.push(o.Message);else for(const p of o.keys())d.push([p,o[p]].join(": "));return this.sequelize.log(a+d.join("; "),this.options),i}formatError(i,s){const a=i.errno||i.code;switch(a){case _:{const d=i.message.match(/Duplicate entry '([\s\S]*)' for key '?((.|\s)*?)'?$/);let y={},o="Validation error";const p=d?d[1].split("-"):void 0,b=d?d[2].split(".").pop():void 0,u=d?d[1]:void 0,h=this.model&&this.model.uniqueKeys[b];h?(h.msg&&(o=h.msg),y=w.zipObject(h.fields,p)):y[b]=u;const A=[];return w.forOwn(y,(I,q)=>{A.push(new E.ValidationErrorItem(this.getUniqueConstraintErrorMessage(q),"unique violation",q,I,this.instance,"not_unique"))}),new E.UniqueConstraintError({message:o,errors:A,parent:i,fields:y,stack:s})}case g:case N:{const d=i.message.match(/CONSTRAINT ([`"])(.*)\1 FOREIGN KEY \(\1(.*)\1\) REFERENCES \1(.*)\1 \(\1(.*)\1\)/),y=d?d[1]:"`",o=d?d[3].split(new RegExp(`${y}, *${y}`)):void 0;return new E.ForeignKeyConstraintError({reltype:String(a)===String(g)?"parent":"child",table:d?d[4]:void 0,fields:o,value:o&&o.length&&this.instance&&this.instance[o[0]]||void 0,index:d?d[2]:void 0,parent:i,stack:s})}default:return new E.DatabaseError(i,{stack:s})}}handleShowIndexesQuery(i){return i=i.reduce((s,a)=>(a.Key_name in s||(s[a.Key_name]=a,a.fields=[]),s[a.Key_name].fields[a.Seq_in_index-1]={attribute:a.Column_name,length:a.Sub_part||void 0,order:a.Collation==="A"?"ASC":void 0},delete a.column_name,s),{}),w.map(i,s=>({primary:s.Key_name==="PRIMARY",fields:s.fields,name:s.Key_name,tableName:s.Table,unique:s.Non_unique!==1,type:s.Index_type}))}}return Rt.exports=l,Rt.exports.Query=l,Rt.exports.default=l,Rt.exports}var rs,Yi;function cu(){if(Yi)return rs;Yi=1;const S=re,e=Xe(),t=uu(),n=lu(),f=vs(),O=he().mysql,{MySQLQueryInterface:T}=ua();class E extends e{constructor(R){super(),this.sequelize=R,this.connectionManager=new t(this,R),this.queryGenerator=new f({_dialect:this,sequelize:R}),this.queryInterface=new T(R,this.queryGenerator)}canBackslashEscape(){return!0}}return E.prototype.supports=S.merge(S.cloneDeep(e.prototype.supports),{"VALUES ()":!0,"LIMIT ON UPDATE":!0,lock:!0,forShare:"LOCK IN SHARE MODE",settingIsolationLevelDuringTransaction:!1,inserts:{ignoreDuplicates:" IGNORE",updateOnDuplicate:" ON DUPLICATE KEY UPDATE"},index:{collate:!1,length:!0,parser:!0,type:!0,using:1},constraints:{dropConstraint:!1,check:!1},indexViaAlter:!0,indexHints:!0,NUMERIC:!0,GEOMETRY:!0,JSON:!0,REGEXP:!0}),E.prototype.defaultVersion="5.7.0",E.prototype.Query=n,E.prototype.QueryGenerator=f,E.prototype.DataTypes=O,E.prototype.name="mysql",E.prototype.TICK_CHAR="`",E.prototype.TICK_CHAR_LEFT=E.prototype.TICK_CHAR,E.prototype.TICK_CHAR_RIGHT=E.prototype.TICK_CHAR,rs=E,rs}var ss={},Wi;function hu(){return Wi||(Wi=1,function(S){var e=Object.defineProperty,t=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,f=Object.prototype.propertyIsEnumerable,O=(s,a,d)=>a in s?e(s,a,{enumerable:!0,configurable:!0,writable:!0,value:d}):s[a]=d,T=(s,a)=>{for(var d in a||(a={}))n.call(a,d)&&O(s,d,a[d]);if(t)for(var d of t(a))f.call(a,d)&&O(s,d,a[d]);return s},E=s=>e(s,"__esModule",{value:!0}),w=(s,a)=>{E(s);for(var d in a)e(s,d,{get:a[d],enumerable:!0})};w(S,{OracleConnectionManager:()=>i});const R=Ze(),_=ce,m=je()("oracle"),{logger:g}=ge,N=yt(),c=g.debugContext("connection:oracle"),l=he().oracle,{promisify:r}=Ae;class i extends R{constructor(a,d){super(a,d),this.sequelize=d,this.sequelize.config.port=this.sequelize.config.port||1521,this.lib=this._loadDialectModule("oracledb"),this.extendLib(),this.refreshTypeParser(l)}extendLib(){if(this.sequelize.config&&"dialectOptions"in this.sequelize.config){const a=this.sequelize.config.dialectOptions;a&&"maxRows"in a&&(this.lib.maxRows=this.sequelize.config.dialectOptions.maxRows),a&&"fetchAsString"in a?this.lib.fetchAsString=this.sequelize.config.dialectOptions.fetchAsString:this.lib.fetchAsString=[this.lib.CLOB]}this.lib.fetchAsBuffer=[this.lib.BLOB]}buildConnectString(a){if(!a.host||a.host.length===0)return a.database;let d=a.host;return a.port&&a.port>0?d+=`:${a.port}`:d+=":1521",a.database&&a.database.length>0&&(d+=`/${a.database}`),d}_refreshTypeParser(a){m.refresh(a)}_clearTypeParser(){m.clear()}async connect(a){const d=T({user:a.username,password:a.password,externalAuth:a.externalAuth,stmtCacheSize:0,connectString:this.buildConnectString(a)},a.dialectOptions);try{const y=await this.lib.getConnection(d);return this.sequelize.options.databaseVersion=N.coerce(y.oracleServerVersionString).version,c("connection acquired"),y.on("error",o=>{switch(o.code){case"ESOCKET":case"ECONNRESET":case"EPIPE":case"PROTOCOL_CONNECTION_LOST":this.pool.destroy(y)}}),y}catch(y){let o=y.message.split(":");switch(o=o[0],o){case"ORA-12560":case"ORA-12154":case"ORA-12505":case"ORA-12514":case"NJS-511":case"NJS-516":case"NJS-517":case"NJS-520":throw new _.ConnectionRefusedError(y);case"ORA-28000":case"ORA-28040":case"ORA-01017":case"NJS-506":throw new _.AccessDeniedError(y);case"ORA-12541":case"NJS-503":case"NJS-508":case"NJS-507":throw new _.HostNotReachableError(y);case"NJS-512":case"NJS-515":case"NJS-518":case"NJS-519":throw new _.InvalidConnectionError(y);case"ORA-12170":case"NJS-510":throw new _.ConnectionTimedOutError(y);default:throw new _.ConnectionError(y)}}}async disconnect(a){if(!a.isHealthy()){c("connection tried to disconnect but was already at CLOSED state");return}return await r(d=>a.close(d))()}validate(a){return a&&a.isHealthy()}}}(ss)),ss}var is={},Ji;function fu(){return Ji||(Ji=1,function(S){var e=Object.defineProperty,t=Object.defineProperties,n=Object.getOwnPropertyDescriptors,f=Object.getOwnPropertySymbols,O=Object.prototype.hasOwnProperty,T=Object.prototype.propertyIsEnumerable,E=(d,y,o)=>y in d?e(d,y,{enumerable:!0,configurable:!0,writable:!0,value:o}):d[y]=o,w=(d,y)=>{for(var o in y||(y={}))O.call(y,o)&&E(d,o,y[o]);if(f)for(var o of f(y))T.call(y,o)&&E(d,o,y[o]);return d},R=(d,y)=>t(d,n(y)),_=d=>e(d,"__esModule",{value:!0}),m=(d,y)=>{_(d);for(var o in y)e(d,o,{get:y[o],enumerable:!0})};m(S,{OracleQuery:()=>a});const g=et(),N=ce,c=je()("oracle"),l=re,r=fe(),{logger:i}=ge,s=i.debugContext("sql:oracle");class a extends g{constructor(y,o,p){super(y,o,p),this.options=l.extend({logging:console.log,plain:!1,raw:!1},p||{}),this.checkLoggingOption(),this.outFormat=p.outFormat||this.sequelize.connectionManager.lib.OBJECT}getInsertIdField(){return"id"}getExecOptions(){const y={outFormat:this.outFormat,autoCommit:this.autoCommit},o=this.sequelize.connectionManager.lib;if(this.model&&this.isSelectQuery()){const p={},b=Object.keys(this.model.tableAttributes);for(const u of b){const h=this.model.tableAttributes[u];h.type.key==="DECIMAL"&&(p[u]={type:o.STRING}),h.type.key==="BIGINT"&&(p[u]={type:o.STRING})}p&&(y.fetchInfo=p)}return y}_convertBindAttributes(y,o){if(this.model&&this.options[y]){const p=Object.keys(this.model.tableAttributes);for(const b of p)if(this.model.tableAttributes[b].type.key==="BIGINT"){const h=this.options[y][b];h&&(this.options[y][b]=R(w({},h),{type:o.STRING,maxSize:1e7}))}}}async run(y,o){const p=this.sequelize.connectionManager.lib,b=this._logQuery(y,s,o),u=[],h=[],A=[];if(y.match(/END;$/)?this.sql=y:this.sql=y.replace(/; *$/,""),this.options.outBindAttributes&&(Array.isArray(o)||l.isPlainObject(o))&&(this._convertBindAttributes("outBindAttributes",p),u.push(...Object.values(this.options.outBindAttributes)),this.isUpsertQuery()&&u.push({dir:p.BIND_OUT})),this.bindParameters=u,(Array.isArray(o)||l.isPlainObject(o))&&(this.options.executeMany?(this._convertBindAttributes("inbindAttributes",p),A.push(...Object.values(this.options.inbindAttributes)),A.push(...u),this.bindParameters=o):this.isRawQuery()?this.bindParameters=o:(Object.values(o).forEach(L=>{h.push(L)}),h.push(...u),Object.assign(this.bindParameters,h))),this.sql.startsWith("BEGIN TRANSACTION"))return this.autocommit=!1,Promise.resolve();if(this.sql.startsWith("SET AUTOCOMMIT ON"))return this.autocommit=!0,Promise.resolve();if(this.sql.startsWith("SET AUTOCOMMIT OFF"))return this.autocommit=!1,Promise.resolve();if(this.sql.startsWith("DECLARE x NUMBER")){this.autoCommit===void 0&&(this.connection.uuid?this.autoCommit=!1:this.autoCommit=!0);try{return await this.connection.execute(this.sql,this.bindParameters,{autoCommit:this.autoCommit}),Object.create(null)}catch(L){throw this.formatError(L)}finally{b()}}if(this.sql.startsWith("BEGIN")){this.autoCommit===void 0&&(this.connection.uuid?this.autoCommit=!1:this.autoCommit=!0);try{const L=await this.connection.execute(this.sql,this.bindParameters,{outFormat:this.outFormat,autoCommit:this.autoCommit});return Array.isArray(L.outBinds)?L.outBinds:[L.outBinds]}catch(L){throw this.formatError(L)}finally{b()}}if(this.sql.startsWith("COMMIT TRANSACTION"))try{return await this.connection.commit(),Object.create(null)}catch(L){throw this.formatError(L)}finally{b()}if(this.sql.startsWith("ROLLBACK TRANSACTION"))try{return await this.connection.rollback(),Object.create(null)}catch(L){throw this.formatError(L)}finally{b()}if(this.sql.startsWith("SET TRANSACTION"))try{return await this.connection.execute(this.sql,[],{autoCommit:!1}),Object.create(null)}catch(L){throw this.formatError(L)}finally{b()}this.autoCommit===void 0&&(this.connection.uuid?this.autoCommit=!1:this.autoCommit=!0),"inputParameters"in this.options&&this.options.inputParameters!==null&&Object.assign(this.bindParameters,this.options.inputParameters);const I=this.getExecOptions();this.options.executeMany&&A.length>0&&(I.bindDefs=A);const q=this.options.executeMany?this.connection.executeMany(this.sql,this.bindParameters,I):this.connection.execute(this.sql,this.bindParameters,I);try{const L=await q;return this.formatResults(L)}catch(L){throw this.formatError(L)}finally{b()}}static formatBindParameters(y,o,p){const b=(u,h,A)=>{if(A[h]!==void 0)return`:${h}`};return y=g.formatBindParameters(y,o,p,b)[0],[y,o]}_getAttributeMap(y,o){y=Object.assign(y,l.reduce(o,(p,b,u)=>{const h=this.sequelize.queryInterface.queryGenerator.getCatalogName(u);return p[h]=u,p},{}))}_processRows(y){let o=y,p={};if(this.sequelize.options.quoteIdentifiers===!1){if(p=l.reduce(this.options.attributes,(b,u)=>{typeof u=="object"&&(u=u[1]);const h=this.sequelize.queryInterface.queryGenerator.getCatalogName(u);return b[h]=u,b},{}),this.model&&this._getAttributeMap(p,this.model.rawAttributes),this.options.aliasesMapping){const b=Object.fromEntries(this.options.aliasesMapping);y=y.map(u=>l.toPairs(u).reduce((h,[A,I])=>{const q=Object.values(b).find(L=>this.sequelize.queryInterface.queryGenerator.getCatalogName(L)===A);return q&&(h[q||A]=I),h},{}))}o=y.map(b=>l.mapKeys(b,(u,h)=>{const A=p[h];return typeof A=="string"&&A!==h?A:h}))}return this.model&&(o=o.map(b=>l.mapValues(b,(u,h)=>{if(this.model.rawAttributes[h]&&this.model.rawAttributes[h].type){let A=this.model.rawAttributes[h].type.toLocaleString();this.model.rawAttributes[h].type.key==="JSON"&&(u=JSON.parse(u)),A.indexOf("(")>-1&&this.model.rawAttributes[h].type.key!=="BOOLEAN"&&(A=A.substr(0,A.indexOf("(")));const I=c.get(A);u!==null&!!I&&(u=I(u))}return u}))),o}formatResults(y){let o=this.instance;if(this.isInsertQuery(y)){let p;if(y.outBinds){const b=Object.keys(this.options.outBindAttributes);p=y.outBinds,this.instance&&(p=[p]);const u=p.map(h=>{const A={};return h.forEach((I,q)=>{A[b[q]]=I[0]}),A});p=u,this.instance||(o=u)}return this.handleInsertQuery(p),[o,y.rowsAffected]}if(this.isShowTablesQuery())o=this.handleShowTablesQuery(y.rows);else if(this.isDescribeQuery()){o={};const p=Object.keys(this.sequelize.models),b={};this.sequelize.models&&p.length>0&&this._getAttributeMap(b,this.sequelize.models[p[0]].rawAttributes),y.rows.forEach(u=>{if(u.Default&&(u.Default=u.Default.replace("('","").replace("')","").replace(/'/g,"")),!(b[u.COLUMN_NAME]in o)){let h=b[u.COLUMN_NAME];h||(h=u.COLUMN_NAME),o[h]={type:u.DATA_TYPE.toUpperCase(),allowNull:u.NULLABLE!=="N",defaultValue:void 0,primaryKey:u.CONSTRAINT_TYPE==="P"}}})}else if(this.isShowIndexesQuery())o=this.handleShowIndexesQuery(y.rows);else if(this.isSelectQuery()){const p=y.rows,b=this._processRows(p);return this.handleSelectQuery(b)}else if(this.isCallQuery())o=y.rows[0];else if(this.isUpdateQuery())o=[o,y.rowsAffected];else if(this.isBulkUpdateQuery())o=y.rowsAffected;else if(this.isBulkDeleteQuery())o=y.rowsAffected;else if(this.isVersionQuery()){const p=y.rows[0].VERSION_FULL;if(p){const b=p.split(".");o=`${b[0]}.${b[1]}.${b[2]}`}else o="0.0.0"}else if(this.isForeignKeysQuery())o=y.rows;else if(this.isUpsertQuery()){y=y.outBinds;const p=Object.keys(this.options.outBindAttributes),b={};for(const u in p)b[p[u]]=y[u];b.isUpdate=y[y.length-1],y=b,o=[{isNewRecord:y.isUpdate,value:y},y.isUpdate==0]}else if(this.isShowConstraintsQuery())o=this.handleShowConstraintsQuery(y);else if(this.isRawQuery())return y&&y.rows?[y.rows,y.metaData]:[y,y];return o}handleShowConstraintsQuery(y){return y.rows.map(o=>{const p={};for(const b in o)p[l.camelCase(b)]=o[b].toLowerCase();return p})}handleShowTablesQuery(y){return y.map(o=>({tableName:o.TABLE_NAME,schema:o.TABLE_SCHEMA}))}formatError(y){let o;if(o=y.message.match(/unique constraint ([\s\S]*) violated/),o&&o.length>1){o[1]=o[1].replace("(","").replace(")","").split(".")[1];const p=[];let b=[],u="Validation error",h=null;if(this.model){const I=Object.keys(this.model.uniqueKeys).find(q=>q.toUpperCase()===o[1].toUpperCase()||q.toUpperCase()===`"${o[1].toUpperCase()}"`);I&&(h=this.model.uniqueKeys[I],b=h.fields),h&&h.msg&&(u=h.msg),b.forEach(q=>{p.push(new N.ValidationErrorItem(this.getUniqueConstraintErrorMessage(q),"unique violation",q,null))})}return new N.UniqueConstraintError({message:u,errors:p,err:y,fields:b})}return o=y.message.match(/ORA-02291/)||y.message.match(/ORA-02292/),o&&o.length>0?new N.ForeignKeyConstraintError({fields:null,index:o[1],parent:y}):(o=y.message.match(/ORA-02443/),o&&o.length>0?new N.UnknownConstraintError(o[1]):new N.DatabaseError(y))}isShowIndexesQuery(){return this.sql.indexOf("SELECT i.index_name,i.table_name, i.column_name, u.uniqueness")>-1}isSelectCountQuery(){return this.sql.toUpperCase().indexOf("SELECT COUNT(")>-1}handleShowIndexesQuery(y){const o=[];y.forEach(u=>{o[u.INDEX_NAME]||(o[u.INDEX_NAME]={unique:u.UNIQUENESS==="UNIQUE",primary:u.CONSTRAINT_TYPE==="P",name:u.INDEX_NAME.toLowerCase(),tableName:u.TABLE_NAME.toLowerCase(),type:void 0},o[u.INDEX_NAME].fields=[]),o[u.INDEX_NAME].fields.push({attribute:u.COLUMN_NAME,length:void 0,order:u.DESCEND,collate:void 0})});const p=[],b=Object.keys(o);for(const u of b){const h={};h.fields=o[u].fields,o[u].name.match(/sys_c[0-9]*/)&&(o[u].name=r.nameIndex(h,o[u].tableName).name),p.push(o[u])}return p}handleInsertQuery(y,o){if(this.instance&&y.length>0){"pkReturnVal"in y[0]&&(y[0][this.model.primaryKeyAttribute]=y[0].pkReturnVal,delete y[0].pkReturnVal);const p=this.model.autoIncrementAttribute;let b=null,u=null;Object.prototype.hasOwnProperty.call(this.model.rawAttributes,p)&&this.model.rawAttributes[p].field!==void 0&&(b=this.model.rawAttributes[p].field),u=u||y&&y[0][this.getInsertIdField()],u=u||o&&o[this.getInsertIdField()],u=u||y&&y[0][p],u=u||b&&y&&y[0][b],this.instance[p]=u}}}}(is)),is}var ns={},Xi;function du(){return Xi||(Xi=1,function(S){var e=Object.defineProperty,t=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,f=Object.prototype.propertyIsEnumerable,O=(y,o,p)=>o in y?e(y,o,{enumerable:!0,configurable:!0,writable:!0,value:p}):y[o]=p,T=(y,o)=>{for(var p in o||(o={}))n.call(o,p)&&O(y,p,o[p]);if(t)for(var p of t(o))f.call(o,p)&&O(y,p,o[p]);return y},E=y=>e(y,"__esModule",{value:!0}),w=(y,o)=>{E(y);for(var p in o)e(y,p,{get:o[p],enumerable:!0})};w(S,{OracleQueryGenerator:()=>a});const R=fe(),_=he(),m=ut(),g=re,N=Ae,c=_r,l=["ACCESS","ADD","ALL","ALTER","AND","ANY","ARRAYLEN","AS","ASC","AUDIT","BETWEEN","BY","CHAR","CHECK","CLUSTER","COLUMN","COMMENT","COMPRESS","CONNECT","CREATE","CURRENT","DATE","DECIMAL","DEFAULT","DELETE","DESC","DISTINCT","DROP","ELSE","EXCLUSIVE","EXISTS","FILE","FLOAT","FOR","FROM","GRANT","GROUP","HAVING","IDENTIFIED","IMMEDIATE","IN","INCREMENT","INDEX","INITIAL","INSERT","INTEGER","INTERSECT","INTO","IS","LEVEL","LIKE","LOCK","LONG","MAXEXTENTS","MINUS","MODE","MODIFY","NOAUDIT","NOCOMPRESS","NOT","NOTFOUND","NOWAIT","NULL","NUMBER","OF","OFFLINE","ON","ONLINE","OPTION","OR","ORDER","PCTFREE","PRIOR","PRIVILEGES","PUBLIC","RAW","RENAME","RESOURCE","REVOKE","ROW","ROWID","ROWLABEL","ROWNUM","ROWS","SELECT","SESSION","SET","SHARE","SIZE","SMALLINT","SQLBUF","START","SUCCESSFUL","SYNONYM","SYSDATE","TABLE","THEN","TO","TRIGGER","UID","UNION","UNIQUE","UPDATE","USER","VALIDATE","VALUES","VARCHAR","VARCHAR2","VIEW","WHENEVER","WHERE","WITH"],r=/^\s*((?:[a-z]+_){0,2}jsonb?(?:_[a-z]+){0,2})\([^)]*\)/i,i=/^\s*(->>?|@>|<@|\?[|&]?|\|{2}|#-)/i,s=/^\s*((?:([`"'])(?:(?!\2).|\2{2})*\2)|[\w\d\s]+|[().,;+-])/i;class a extends m{constructor(o){super(o)}getCatalogName(o){return o&&this.options.quoteIdentifiers===!1&&this.quoteIdentifier(o)===o&&(o=o.toUpperCase()),o}getSchemaNameAndTableName(o){const p=this.getCatalogName(o.tableName||o),b=this.getCatalogName(o.schema);return[p,b]}createSchema(o){const p=this.quoteIdentifier(o);return["DECLARE","USER_FOUND BOOLEAN := FALSE;","BEGIN"," BEGIN","   EXECUTE IMMEDIATE ",this.escape(`CREATE USER ${p} IDENTIFIED BY 12345 DEFAULT TABLESPACE USERS`),";","   EXCEPTION WHEN OTHERS THEN","     IF SQLCODE != -1920 THEN","       RAISE;","     ELSE","       USER_FOUND := TRUE;","     END IF;"," END;"," IF NOT USER_FOUND THEN","    EXECUTE IMMEDIATE ",this.escape(`GRANT "CONNECT" TO ${p}`),";","    EXECUTE IMMEDIATE ",this.escape(`GRANT CREATE TABLE TO ${p}`),";","    EXECUTE IMMEDIATE ",this.escape(`GRANT CREATE VIEW TO ${p}`),";","    EXECUTE IMMEDIATE ",this.escape(`GRANT CREATE ANY TRIGGER TO ${p}`),";","    EXECUTE IMMEDIATE ",this.escape(`GRANT CREATE ANY PROCEDURE TO ${p}`),";","    EXECUTE IMMEDIATE ",this.escape(`GRANT CREATE SEQUENCE TO ${p}`),";","    EXECUTE IMMEDIATE ",this.escape(`GRANT CREATE SYNONYM TO ${p}`),";","    EXECUTE IMMEDIATE ",this.escape(`ALTER USER ${p} QUOTA UNLIMITED ON USERS`),";"," END IF;","END;"].join(" ")}showSchemasQuery(){return`SELECT USERNAME AS "schema_name" FROM ALL_USERS WHERE COMMON = ('NO') AND USERNAME != user`}dropSchema(o){return["BEGIN","EXECUTE IMMEDIATE ",this.escape(`DROP USER ${this.quoteTable(o)} CASCADE`),";","EXCEPTION WHEN OTHERS THEN","  IF SQLCODE != -1918 THEN","    RAISE;","  END IF;","END;"].join(" ")}versionQuery(){return"SELECT VERSION_FULL FROM PRODUCT_COMPONENT_VERSION WHERE PRODUCT LIKE 'Oracle%'"}createTableQuery(o,p,b){const u=[],h=Object.create(null),A=[],I=[],q={table:this.quoteTable(o)};for(let C in p){if(!Object.prototype.hasOwnProperty.call(p,C))continue;const $=p[C];if(C=this.quoteIdentifier(C),$.includes("PRIMARY KEY"))if(u.push(C),$.includes("REFERENCES")){const P=$.match(/^(.+) (REFERENCES.*)$/);A.push(`${C} ${P[1].replace(/PRIMARY KEY/,"")}`),h[C]=P[2]}else A.push(`${C} ${$.replace(/PRIMARY KEY/,"").trim()}`);else if($.includes("REFERENCES")){const P=$.match(/^(.+) (REFERENCES.*)$/);A.push(`${C} ${P[1]}`),h[C]=P[2]}else A.push(`${C} ${$}`)}q.attributes=A.join(", ");const L=u.map(C=>this.quoteIdentifier(C)).join(", ");L.length>0&&(q.attributes+=`,PRIMARY KEY (${L})`);for(const C in h)Object.prototype.hasOwnProperty.call(h,C)&&(h[C].indexOf("ON DELETE NO ACTION")>-1&&(h[C]=h[C].replace("ON DELETE NO ACTION","")),q.attributes+=`,FOREIGN KEY (${this.quoteIdentifier(C)}) ${h[C]}`);if(I.length>0&&(q.attributes+=`, ${I.join(", ")}`),b&&b.indexes&&b.indexes.length>0){const C=[];b.indexes.forEach(($,P)=>{if("unique"in $&&($.unique===!0||$.unique.length>0&&$.unique!==!1)){const Q=$.fields.map(B=>typeof B=="string"?B:B.attribute);let j=!0;if(b.uniqueKeys){const B=Object.keys(b.uniqueKeys);for(let F=0;F<B.length;F++){const x=b.uniqueKeys[B[F]];if(x.fields.length===Q.length)for(let k=0;k<x.fields.length;k++){const X=x.fields[k];if(g.includes(Q,X))j=!1;else{j=!0;break}}}if(j){const F="name"in $?$.name:"",x={name:F,fields:Q};"uniqueKeys"in b||(b.uniqueKeys={}),b.uniqueKeys[F]=x,C.push(P)}else C.push(P)}}}),C.forEach($=>{b.indexes.splice($,1)})}b&&b.uniqueKeys&&g.each(b.uniqueKeys,(C,$)=>{let P=!1;if(u.forEach(Q=>{Q=Q.replace(/"/g,""),g.includes(C.fields,Q)||(P=!0)}),C.fields.forEach(Q=>{let j="";if(g.isString(Q)?j=Q.replace(/[.,"\s]/g,""):j=Q.attribute.replace(/[.,"\s]/g,""),j in p&&p[j].toUpperCase().indexOf("UNIQUE")>-1&&P){const B=p[j].replace("UNIQUE","");q.attributes=q.attributes.replace(p[j],B)}}),P){const Q=b.uniqueKeys[C.name];delete b.uniqueKeys[C.name],$=$.replace(/[.,\s]/g,""),C.name=$,b.uniqueKeys[$]=Q,$.length===0?q.attributes+=`,UNIQUE (${C.fields.map(j=>this.quoteIdentifier(j)).join(", ")})`:q.attributes+=`, CONSTRAINT ${this.quoteIdentifier($)} UNIQUE (${C.fields.map(j=>this.quoteIdentifier(j)).join(", ")})`}});const D=R.joinSQLFragments(["CREATE TABLE",q.table,`(${q.attributes})`]);return R.joinSQLFragments(["BEGIN","EXECUTE IMMEDIATE",`${this.escape(D)};`,"EXCEPTION WHEN OTHERS THEN","IF SQLCODE != -955 THEN","RAISE;","END IF;","END;"])}tableExistsQuery(o){const[p,b]=this.getSchemaNameAndTableName(o);return`SELECT TABLE_NAME FROM ALL_TABLES WHERE TABLE_NAME = ${this.escape(p)} AND OWNER = ${o.schema?this.escape(b):"USER"}`}describeTableQuery(o,p){const b=this.getCatalogName(o.tableName||o);return p=this.getCatalogName(p),["SELECT atc.COLUMN_NAME, atc.DATA_TYPE, atc.DATA_LENGTH, atc.CHAR_LENGTH, atc.DEFAULT_LENGTH, atc.NULLABLE, ucc.constraint_type ","FROM all_tab_columns atc ","LEFT OUTER JOIN ","(SELECT acc.column_name, acc.table_name, ac.constraint_type FROM all_cons_columns acc INNER JOIN all_constraints ac ON acc.constraint_name = ac.constraint_name) ucc ","ON (atc.table_name = ucc.table_name AND atc.COLUMN_NAME = ucc.COLUMN_NAME) ",p?`WHERE (atc.OWNER = ${this.escape(p)}) `:"WHERE atc.OWNER = USER ",`AND (atc.TABLE_NAME = ${this.escape(b)})`,"ORDER BY atc.COLUMN_NAME, CONSTRAINT_TYPE DESC"].join("")}renameTableQuery(o,p){return R.joinSQLFragments(["ALTER TABLE",this.quoteTable(o),"RENAME TO",this.quoteTable(p)])}showConstraintsQuery(o){const p=this.getCatalogName(o.tableName||o);return`SELECT CONSTRAINT_NAME constraint_name FROM user_cons_columns WHERE table_name = ${this.escape(p)}`}showTablesQuery(){return`SELECT owner as table_schema, table_name, 0 as lvl FROM all_tables where OWNER IN(SELECT USERNAME AS "schema_name" FROM ALL_USERS WHERE ORACLE_MAINTAINED = 'N')`}dropTableQuery(o){return R.joinSQLFragments(["BEGIN ","EXECUTE IMMEDIATE 'DROP TABLE",this.quoteTable(o),"CASCADE CONSTRAINTS PURGE';","EXCEPTION WHEN OTHERS THEN"," IF SQLCODE != -942 THEN","   RAISE;"," END IF;","END;"])}addIndexQuery(o,p,b,u){return typeof o!="string"&&p.name&&(p.name=`${o.schema}.${p.name}`),super.addIndexQuery(o,p,b,u)}addConstraintQuery(o,p){p=p||{},p.onUpdate&&delete p.onUpdate,p.onDelete&&p.onDelete.toUpperCase()==="NO ACTION"&&delete p.onDelete;const b=this.getConstraintSnippet(o,p);return o=this.quoteTable(o),`ALTER TABLE ${o} ADD ${b};`}addColumnQuery(o,p,b){b.field=p;const u=R.joinSQLFragments([this.quoteIdentifier(p),this.attributeToSQL(b,{attributeName:p,context:"addColumn"})]);return R.joinSQLFragments(["ALTER TABLE",this.quoteTable(o),"ADD",u])}removeColumnQuery(o,p){return R.joinSQLFragments(["ALTER TABLE",this.quoteTable(o),"DROP COLUMN",this.quoteIdentifier(p),";"])}_alterForeignKeyConstraint(o,p,b){const[u,h]=this.getSchemaNameAndTableName(p),A=this.escape(this.getCatalogName(b)),I=p.schema?this.escape(this.getCatalogName(h)):"USER",q=this.escape(this.getCatalogName(u)),L=["SELECT constraint_name INTO cons_name","FROM (","  SELECT DISTINCT cc.owner, cc.table_name, cc.constraint_name, cc.column_name AS cons_columns","  FROM all_cons_columns cc, all_constraints c","  WHERE cc.owner = c.owner","  AND cc.table_name = c.table_name","  AND cc.constraint_name = c.constraint_name","  AND c.constraint_type = 'R'","  GROUP BY cc.owner, cc.table_name, cc.constraint_name, cc.column_name",")","WHERE owner =",I,"AND table_name =",q,"AND cons_columns =",A,";"].join(" "),D=R.joinSQLFragments([`ALTER TABLE ${this.quoteIdentifier(u)}`,"ADD FOREIGN KEY",`(${this.quoteIdentifier(b)})`,o.replace(/.+?(?=REFERENCES)/,"")]);return["BEGIN",L,"EXCEPTION","WHEN NO_DATA_FOUND THEN"," CONS_NAME := NULL;","END;","IF CONS_NAME IS NOT NULL THEN",` EXECUTE IMMEDIATE 'ALTER TABLE ${this.quoteTable(p)} DROP CONSTRAINT "'||CONS_NAME||'"';`,"END IF;",`EXECUTE IMMEDIATE ${this.escape(D)};`].join(" ")}_modifyQuery(o,p,b){const u=R.joinSQLFragments(["ALTER TABLE",this.quoteTable(p),"MODIFY",this.quoteIdentifier(b),o]),h=u.replace("NOT NULL","").replace("NULL","");return["BEGIN",`EXECUTE IMMEDIATE ${this.escape(u)};`,"EXCEPTION","WHEN OTHERS THEN"," IF SQLCODE = -1442 OR SQLCODE = -1451 THEN",`   EXECUTE IMMEDIATE ${this.escape(h)};`," ELSE","   RAISE;"," END IF;","END;"].join(" ")}changeColumnQuery(o,p){const b=["DECLARE","CONS_NAME VARCHAR2(200);","BEGIN"];for(const u in p){if(!Object.prototype.hasOwnProperty.call(p,u))continue;const h=p[u];h.match(/REFERENCES/)?b.push(this._alterForeignKeyConstraint(h,o,u)):b.push(this._modifyQuery(h,o,u))}return b.push("END;"),b.join(" ")}renameColumnQuery(o,p,b){const u=Object.keys(b)[0];return`ALTER TABLE ${this.quoteTable(o)} RENAME COLUMN ${this.quoteIdentifier(p)} TO ${this.quoteIdentifier(u)}`}populateInsertQueryReturnIntoBinds(o,p,b,u,h){const A=this.sequelize.connectionManager.lib,I=Object.create(null),q=[],L=this.bindParam(q,b);o.forEach((D,C)=>{D.startsWith('"')&&(D=D.substring(1,D.length-1)),I[D]=Object.assign(p[C]._getBindDef(A),{dir:A.BIND_OUT});const $=`${this.format(void 0,void 0,{context:"INSERT"},L)}`;u.push($)}),h.outBindAttributes=I}upsertQuery(o,p,b,u,h,A){const I=h.rawAttributes,q=this.updateQuery(o,b,u,A,I);A.bind=q.bind;const L=this.insertQuery(o,p,I,A),$={query:["DECLARE ","BEGIN ",q.query?[q.query,"; "," IF ( SQL%ROWCOUNT = 0 ) THEN ",L.query," :isUpdate := 0; ","ELSE "," :isUpdate := 1; "," END IF; "].join(""):[L.query," :isUpdate := 0; ","EXCEPTION WHEN OTHERS THEN"," IF SQLCODE != -1 THEN","   RAISE;"," END IF;"].join(""),"END;"].join("")};return A.bindParam!==!1&&($.bind=q.bind||L.bind),$}bulkInsertQuery(o,p,b,u){b=b||{},b.executeMany=!0,u=u||{};const h=[],A={},I={},q={},L=this.sequelize.connectionManager.lib;for(const B of p)g.forOwn(B,(F,x)=>{A[x]=u[x]&&u[x].autoIncrement===!0&&F===null});let D;for(const B of p){const F=[],x=b.bindParam===void 0?this.bindParam(F):b.bindParam,k=Object.keys(A).map(X=>{if(A[X]===!0){if(B[X]!==null)throw Error("For an auto-increment column either all row must be null or non-null, a mix of null and non-null is not allowed!");return"DEFAULT"}return this.format(B[X],u[X],{context:"INSERT"},x)});D||(D=k),h.push(F)}const C=[],$=[],P=[];for(const B of Object.keys(A)){if(u[B]){const F=u[B].type._getBindDef(L);A[B]?(F.dir=L.BIND_OUT,q[B]=F,C.push(this.quoteIdentifier(B)),$.push(`:${h[0].length+C.length}`)):(F.dir=L.BIND_IN,I[B]=F)}P.push(this.quoteIdentifier(B))}let Q=R.joinSQLFragments(["INSERT","INTO",this.quoteTable(o),`(${P.join(",")})`,"VALUES",`(${D})`]);C.length>0&&(b.outBindAttributes=q,Q=R.joinSQLFragments([Q,"RETURNING",`${C.join(",")}`,"INTO",`${$}`]));const j={query:Q};return j.bind=h,b.inbindAttributes=I,j}truncateTableQuery(o){return`TRUNCATE TABLE ${this.quoteTable(o)}`}deleteQuery(o,p,b,u){b=b||{};const h=o;p=this.getWhereConditions(p,null,u,b);let A;if(b.limit){const I=p?` AND ${p}`:"";A=`DELETE FROM ${this.quoteTable(h)} WHERE rowid IN (SELECT rowid FROM ${this.quoteTable(h)} WHERE rownum <= ${this.escape(b.limit)}${I})`}else{const I=p?` WHERE ${p}`:"";A=`DELETE FROM ${this.quoteTable(h)}${I}`}return A}showIndexesQuery(o){const[p,b]=this.getSchemaNameAndTableName(o);return["SELECT i.index_name,i.table_name, i.column_name, u.uniqueness, i.descend, c.constraint_type ","FROM all_ind_columns i ","INNER JOIN all_indexes u ","ON (u.table_name = i.table_name AND u.index_name = i.index_name) ","LEFT OUTER JOIN all_constraints c ","ON (c.table_name = i.table_name AND c.index_name = i.index_name) ",`WHERE i.table_name = ${this.escape(p)}`," AND u.table_owner = ",b?this.escape(b):"USER"," ORDER BY index_name, column_position"].join("")}removeIndexQuery(o,p){let b=p;return typeof b!="string"&&(b=R.underscore(`${o}_${p.join("_")}`)),`DROP INDEX ${this.quoteIdentifier(b)}`}attributeToSQL(o,p){g.isPlainObject(o)||(o={type:o}),o.onUpdate="",o.references&&o.Model&&o.Model.tableName===o.references.model&&(this.sequelize.log("Oracle does not support self referencial constraints, we will remove it but we recommend restructuring your query"),o.onDelete="");let b;if(b=o.type.toSql?o.type.toSql():"",o.type instanceof _.JSON)return b+=` CHECK (${this.quoteIdentifier(p.attributeName)} IS JSON)`,b;if(R.defaultValueSchemable(o.defaultValue)&&(b+=` DEFAULT ${this.escape(o.defaultValue)}`),o.allowNull===!1&&(b+=" NOT NULL"),o.type instanceof _.ENUM)return o.type.values&&!o.values&&(o.values=o.type.values),b+=` CHECK (${this.quoteIdentifier(p.attributeName)} IN(${g.map(o.values,u=>this.escape(u)).join(", ")}))`,b;if(o.type instanceof _.BOOLEAN)return b+=` CHECK (${this.quoteIdentifier(p.attributeName)} IN('1', '0'))`,b;if(o.autoIncrement)b=" NUMBER(*,0) GENERATED BY DEFAULT ON NULL AS IDENTITY";else if(o.type&&o.type.key===_.DOUBLE.key)b=o.type.toSql();else if(o.type){let u="";o.type._unsigned&&(o.type._unsigned=!1,u+=` check(${this.quoteIdentifier(p.attributeName)} >= 0)`),b=o.type.toString(),o.type&&o.type!=="TEXT"&&o.type._binary!==!0&&R.defaultValueSchemable(o.defaultValue)&&(b+=` DEFAULT ${this.escape(o.defaultValue)}`),o.autoIncrement||(o.allowNull===!1?b+=" NOT NULL":!o.primaryKey&&!R.defaultValueSchemable(o.defaultValue)&&(b+=" NULL")),b+=u}else b="";return o.unique===!0&&!o.primaryKey&&(b+=" UNIQUE"),o.primaryKey&&(b+=" PRIMARY KEY"),(!p||!p.withoutForeignKeyConstraints)&&o.references&&(b+=` REFERENCES ${this.quoteTable(o.references.model)}`,o.references.key?b+=` (${this.quoteIdentifier(o.references.key)})`:b+=` (${this.quoteIdentifier("id")})`,o.onDelete&&o.onDelete.toUpperCase()!=="NO ACTION"&&(b+=` ON DELETE ${o.onDelete.toUpperCase()}`)),b}attributesToSQL(o,p){const b={};for(const u in o){const h=o[u],A=h.field||u;b[A]=this.attributeToSQL(h,T({attributeName:A},p))}return b}createTrigger(){d("createTrigger")}dropTrigger(){d("dropTrigger")}renameTrigger(){d("renameTrigger")}createFunction(){d("createFunction")}dropFunction(){d("dropFunction")}renameFunction(){d("renameFunction")}getConstraintsOnColumn(o,p){const[b,u]=this.getSchemaNameAndTableName(o);return p=this.getCatalogName(p),["SELECT CONSTRAINT_NAME FROM user_cons_columns WHERE TABLE_NAME = ",this.escape(b)," and OWNER = ",o.schema?this.escape(u):"USER"," and COLUMN_NAME = ",this.escape(p)," AND POSITION IS NOT NULL ORDER BY POSITION"].join("")}getForeignKeysQuery(o){const[p,b]=this.getSchemaNameAndTableName(o);return['SELECT DISTINCT  a.table_name "tableName", a.constraint_name "constraintName", a.owner "owner",  a.column_name "columnName",',' b.table_name "referencedTableName", b.column_name "referencedColumnName"'," FROM all_cons_columns a"," JOIN all_constraints c ON a.owner = c.owner AND a.constraint_name = c.constraint_name"," JOIN all_cons_columns b ON c.owner = b.owner AND c.r_constraint_name = b.constraint_name"," WHERE c.constraint_type  = 'R'"," AND a.table_name = ",this.escape(p)," AND a.owner = ",o.schema?this.escape(b):"USER"," ORDER BY a.table_name, a.constraint_name"].join("")}dropForeignKeyQuery(o,p){return this.dropConstraintQuery(o,p)}getPrimaryKeyConstraintQuery(o){const[p,b]=this.getSchemaNameAndTableName(o);return["SELECT cols.column_name, atc.identity_column ","FROM all_constraints cons, all_cons_columns cols ","INNER JOIN all_tab_columns atc ON(atc.table_name = cols.table_name AND atc.COLUMN_NAME = cols.COLUMN_NAME )","WHERE cols.table_name = ",this.escape(p),"AND cols.owner = ",o.schema?this.escape(b):"USER ","AND cons.constraint_type = 'P' ","AND cons.constraint_name = cols.constraint_name ","AND cons.owner = cols.owner ","ORDER BY cols.table_name, cols.position"].join("")}dropConstraintQuery(o,p){return`ALTER TABLE ${this.quoteTable(o)} DROP CONSTRAINT ${p}`}setIsolationLevelQuery(o,p){if(!p.parent)switch(o){case c.ISOLATION_LEVELS.READ_UNCOMMITTED:case c.ISOLATION_LEVELS.READ_COMMITTED:return"SET TRANSACTION ISOLATION LEVEL READ COMMITTED;";case c.ISOLATION_LEVELS.REPEATABLE_READ:return"SET TRANSACTION ISOLATION LEVEL SERIALIZABLE;";default:throw new Error(`isolation level "${o}" is not supported`)}}getAliasToken(){return""}startTransactionQuery(o){return o.parent?`SAVEPOINT ${this.quoteIdentifier(o.name)}`:"BEGIN TRANSACTION"}commitTransactionQuery(o){if(!o.parent)return"COMMIT TRANSACTION"}rollbackTransactionQuery(o){return o.parent?`ROLLBACK TO SAVEPOINT ${this.quoteIdentifier(o.name)}`:"ROLLBACK TRANSACTION"}handleSequelizeMethod(o,p,b,u,h){let A;if(o instanceof R.Json){if(o.conditions)return this.parseConditionObject(o.conditions).map(q=>`${this.jsonPathExtractionQuery(q.path[0],g.tail(q.path))} = '${q.value}'`).join(" AND ");if(o.path){if(this._checkValidJsonStatement(o.path))A=o.path;else{const I=g.toPath(o.path),q=I.shift();A=this.jsonPathExtractionQuery(q,I)}return o.value&&(A+=N.format(" = %s",this.escape(o.value))),A}}if(o instanceof R.Cast&&o.val instanceof R.SequelizeMethod){if(A=this.handleSequelizeMethod(o.val,p,b,u,h),o.type==="boolean")return A=`(CASE WHEN ${A}='true' THEN 1 ELSE 0 END)`,`CAST(${A} AS NUMBER)`;if(o.type==="timestamptz"&&/json_value\(/.test(A))return A=A.slice(0,-1),`${A} RETURNING TIMESTAMP WITH TIME ZONE)`}return super.handleSequelizeMethod(o,p,b,u,h)}_checkValidJsonStatement(o){if(typeof o!="string")return!1;let p=0,b=0,u=0,h=!1,A=!1;for(;p<o.length;){const I=o.substr(p),q=r.exec(I);if(q){p+=q[0].indexOf("("),h=!0;continue}const L=i.exec(I);if(L){p+=L[0].length,h=!0;continue}const D=s.exec(I);if(D){const C=D[1];if(C==="(")b++;else if(C===")")u++;else if(C===";"){A=!0;break}p+=D[0].length;continue}break}if(h&&(A||b!==u))throw new Error(`Invalid json statement: ${o}`);return h}jsonPathExtractionQuery(o,p){let b=g.toPath(p);const u=this.isIdentifierQuoted(o)?o:this.quoteIdentifier(o);b=b.map(A=>/\D/.test(A)?R.addTicks(A,'"'):A);const h=this.escape(["$"].concat(b).join(".").replace(/\.(\d+)(?:(?=\.)|$)/g,(A,I)=>`[${I}]`));return`json_value(${u},${h})`}addLimitAndOffset(o,p){let b="";const u=o.offset||0,h=o.hasIncludeWhere||o.hasIncludeRequired||o.hasMultiAssociation;let A={};if(o.order&&(A=this.getQueryOrders(o,p,h)),o.limit||o.offset){if(!A.mainQueryOrder||!A.mainQueryOrder.length||h&&(!A.subQueryOrder||!A.subQueryOrder.length)){const I=`${this.quoteTable(o.tableAs||p.name)}.${this.quoteIdentifier(p.primaryKeyField)}`;b+=` ORDER BY ${I}`}(o.offset||o.limit)&&(b+=` OFFSET ${this.escape(u)} ROWS`),o.limit&&(b+=` FETCH NEXT ${this.escape(o.limit)} ROWS ONLY`)}return b}booleanValue(o){return o?1:0}quoteIdentifier(o,p=!1){const b=p,u=this.options.quoteIdentifiers!==!1,h=R.removeTicks(o,'"');return b!==!0&&u===!1&&/^(([\w][\w\d_]*))$/g.test(h)&&!l.includes(h.toUpperCase())?h:R.addTicks(h,'"')}bindParam(o,p=0){return b=>(o.push(b),`:${o.length+p}`)}authTestQuery(){return"SELECT 1+1 AS result FROM DUAL"}}function d(y){throw new Error(`The method "${y}" is not defined! Please add it to your sql dialect.`)}}(ns)),ns}var as={},Zi;function pu(){return Zi||(Zi=1,function(S){var e=Object.defineProperty,t=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,f=Object.prototype.propertyIsEnumerable,O=(N,c,l)=>c in N?e(N,c,{enumerable:!0,configurable:!0,writable:!0,value:l}):N[c]=l,T=(N,c)=>{for(var l in c||(c={}))n.call(c,l)&&O(N,l,c[l]);if(t)for(var l of t(c))f.call(c,l)&&O(N,l,c[l]);return N},E=N=>e(N,"__esModule",{value:!0}),w=(N,c)=>{E(N);for(var l in c)e(N,l,{get:c[l],enumerable:!0})};w(S,{OracleQueryInterface:()=>g});const{QueryInterface:R}=He,_=Me,m=re;class g extends R{async upsert(c,l,r,i,s){s=T({},s);const a=s.model,d=Object.values(a.primaryKeys).map(u=>u.field),y=Object.values(a.uniqueKeys).filter(u=>u.fields.length>0).map(u=>u.fields),o=Object.values(a._indexes).filter(u=>u.unique&&u.fields.length>0).map(u=>u.fields);s.type=_.UPSERT,s.updateOnDuplicate=Object.keys(r),s.upsertKeys=[];for(const u of s.updateOnDuplicate){const h=y.find(I=>I.includes(u));if(h){s.upsertKeys=h;break}const A=o.find(I=>I.includes(u));if(A){s.upsertKeys=A;break}}(s.upsertKeys.length===0||m.intersection(s.updateOnDuplicate,d).length)&&(s.upsertKeys=d),s.upsertKeys=m.uniq(s.upsertKeys);let p=!1;d.forEach(u=>{i[u]===null&&(p=!0)}),p===!0&&(i=s.upsertKeys.reduce((u,h)=>(u[h]=l[h],u),{}));const b=this.queryGenerator.upsertQuery(c,l,r,i,a,s);return b.bind&&(s.bind=void 0),await this.sequelize.query(b,s)}}}(as)),as}var os,en;function yu(){if(en)return os;en=1;const S=re,{AbstractDialect:e}=Xe(),{OracleConnectionManager:t}=hu(),{OracleQuery:n}=fu(),{OracleQueryGenerator:f}=du(),O=he().oracle,{OracleQueryInterface:T}=pu();class E extends e{constructor(R){super(),this.sequelize=R,this.connectionManager=new t(this,R),this.connectionManager.initPools(),this.queryGenerator=new f({_dialect:this,sequelize:R}),this.queryInterface=new T(R,this.queryGenerator)}}return E.prototype.supports=S.merge(S.cloneDeep(e.prototype.supports),{"VALUES ()":!0,"LIMIT ON UPDATE":!0,IGNORE:" IGNORE",lock:!0,lockOuterJoinFailure:!0,forShare:"FOR UPDATE",skipLocked:!0,index:{collate:!1,length:!1,parser:!1,type:!1,using:!1},constraints:{restrict:!1},returnValues:!1,returnIntoValues:!0,"ORDER NULLS":!0,schemas:!0,updateOnDuplicate:!1,indexViaAlter:!1,NUMERIC:!0,JSON:!0,upserts:!0,bulkDefault:!0,topLevelOrderByRequired:!0,GEOMETRY:!1}),E.prototype.defaultVersion="18.0.0",E.prototype.Query=n,E.prototype.queryGenerator=f,E.prototype.DataTypes=O,E.prototype.name="oracle",E.prototype.TICK_CHAR='"',E.prototype.TICK_CHAR_LEFT=E.prototype.TICK_CHAR,E.prototype.TICK_CHAR_RIGHT=E.prototype.TICK_CHAR,os=E,os}var qt={exports:{}},Ct={exports:{}},tn;function mu(){if(tn)return Ct.exports;tn=1;const S=re,e=Ze(),{logger:t}=ge,n=t.debugContext("connection:pg"),f=ce,O=yt(),T=he(),E=ke,{promisify:w}=Ae;class R extends e{constructor(m,g){g.config.port=g.config.port||5432,super(m,g);const N=this._loadDialectModule("pg");this.lib=this.sequelize.config.native?N.native:N,this._clearDynamicOIDs(),this._clearTypeParser(),this.refreshTypeParser(T.postgres)}_refreshTypeParser(m){const g=r=>i=>this.lib.types.arrayParser.create(i,r).parse(),N=r=>i=>m.parse(i,{parser:r});if(m.key.toLowerCase()==="range"){for(const r in this.nameOidMap){const i=this.nameOidMap[r];if(!i.rangeOid)continue;const s=N(this.getTypeParser(i.oid)),a=g(s);this.oidParserMap.set(i.rangeOid,s),i.arrayRangeOid&&this.oidParserMap.set(i.arrayRangeOid,a)}return}const c=r=>m.parse(r),l=g(c);if(m.key.toLowerCase()==="enum"){this.enumOids.oids.forEach(r=>{this.oidParserMap.set(r,c)}),this.enumOids.arrayOids.forEach(r=>{this.oidParserMap.set(r,l)});return}m.types.postgres.forEach(r=>{this.nameOidMap[r]&&(this.oidParserMap.set(this.nameOidMap[r].oid,c),this.nameOidMap[r].arrayOid&&this.oidParserMap.set(this.nameOidMap[r].arrayOid,l))})}_clearTypeParser(){this.oidParserMap=new Map}getTypeParser(m,...g){return this.oidParserMap.get(m)?this.oidParserMap.get(m):this.lib.types.getTypeParser(m,...g)}async connect(m){m.user=m.username;const g=S.pick(m,["user","password","host","database","port"]);g.types={getTypeParser:R.prototype.getTypeParser.bind(this)},m.dialectOptions&&S.merge(g,S.pick(m.dialectOptions,["application_name","ssl","client_encoding","binary","keepAlive","statement_timeout","query_timeout","connectionTimeoutMillis","idle_in_transaction_session_timeout","lock_timeout","options","stream"]));const N=await new Promise((l,r)=>{let i=!1;const s=new this.lib.Client(g),a=y=>{switch(y.parameterName){case"server_version":if(this.sequelize.options.databaseVersion===0){const o=O.coerce(y.parameterValue).version;this.sequelize.options.databaseVersion=O.valid(o)?o:this.dialect.defaultVersion}break;case"standard_conforming_strings":s.standard_conforming_strings=y.parameterValue;break}},d=()=>{n("connection timeout"),i||r(new f.ConnectionTimedOutError(new Error("Connection timed out")))};s.once("end",d),this.sequelize.config.native||s.connection.on("parameterStatus",a),s.connect(y=>{if(i=!0,this.sequelize.config.native||s.connection.removeListener("parameterStatus",a),y)if(y.code)switch(y.code){case"ECONNREFUSED":r(new f.ConnectionRefusedError(y));break;case"ENOTFOUND":r(new f.HostNotFoundError(y));break;case"EHOSTUNREACH":r(new f.HostNotReachableError(y));break;case"EINVAL":r(new f.InvalidConnectionError(y));break;default:r(new f.ConnectionError(y));break}else r(new f.ConnectionError(y));else n("connection acquired"),s.removeListener("end",d),l(s)})});N.on("error",l=>{N._invalid=!0,n(`connection error ${l.code||l.message}`),this.pool.destroy(N)});let c="";if(this.sequelize.options.standardConformingStrings!==!1&&N.standard_conforming_strings!=="on"&&(c+="SET standard_conforming_strings=on;"),this.sequelize.options.clientMinMessages!==void 0&&(console.warn('Usage of "options.clientMinMessages" is deprecated and will be removed in v7.'),console.warn('Please use the sequelize option "dialectOptions.clientMinMessages" instead.')),!(m.dialectOptions&&m.dialectOptions.clientMinMessages&&m.dialectOptions.clientMinMessages.toLowerCase()==="ignore"||this.sequelize.options.clientMinMessages===!1)){const l=m.dialectOptions&&m.dialectOptions.clientMinMessages||this.sequelize.options.clientMinMessages||"warning";c+=`SET client_min_messages TO ${l};`}return this.sequelize.config.keepDefaultTimezone||(!!E.tz.zone(this.sequelize.options.timezone)?c+=`SET TIME ZONE '${this.sequelize.options.timezone}';`:c+=`SET TIME ZONE INTERVAL '${this.sequelize.options.timezone}' HOUR TO MINUTE;`),c&&await N.query(c),Object.keys(this.nameOidMap).length===0&&this.enumOids.oids.length===0&&this.enumOids.arrayOids.length===0&&await this._refreshDynamicOIDs(N),N}async disconnect(m){if(m._ending){n("connection tried to disconnect but was already at ENDING state");return}return await w(g=>m.end(g))()}validate(m){return!m._invalid&&!m._ending}async _refreshDynamicOIDs(m){const g=this.sequelize.options.databaseVersion;if((g&&O.gte(g,"8.3.0"))===!1)return;const c=await(m||this.sequelize).query("WITH ranges AS (  SELECT pg_range.rngtypid, pg_type.typname AS rngtypname,         pg_type.typarray AS rngtyparray, pg_range.rngsubtype    FROM pg_range LEFT OUTER JOIN pg_type ON pg_type.oid = pg_range.rngtypid)SELECT pg_type.typname, pg_type.typtype, pg_type.oid, pg_type.typarray,       ranges.rngtypname, ranges.rngtypid, ranges.rngtyparray  FROM pg_type LEFT OUTER JOIN ranges ON pg_type.oid = ranges.rngsubtype WHERE (pg_type.typtype IN('b', 'e'));");let l=Array.isArray(c)?c.pop():c;Array.isArray(l)&&l[0].command==="SET"&&(l=l.pop());const r={},i={oids:[],arrayOids:[]};for(const s of l.rows){if(s.typtype==="e"){i.oids.push(s.oid),s.typarray&&i.arrayOids.push(s.typarray);continue}r[s.typname]={oid:s.oid},s.typarray&&(r[s.typname].arrayOid=s.typarray),s.rngtypid&&(r[s.typname].rangeOid=s.rngtypid,s.rngtyparray&&(r[s.typname].arrayRangeOid=s.rngtyparray))}this.nameOidMap=r,this.enumOids=i,this.refreshTypeParser(T.postgres)}_clearDynamicOIDs(){this.nameOidMap={},this.enumOids={oids:[],arrayOids:[]}}}return Ct.exports=R,Ct.exports.ConnectionManager=R,Ct.exports.default=R,Ct.exports}var Lt={exports:{}},rn;function Eu(){if(rn)return Lt.exports;rn=1;const S=et(),e=Me,t=ce,n=re,{logger:f}=ge,O=f.debugContext("sql:pg");class T extends S{static formatBindParameters(w,R,_){const m=N=>typeof N=="string"?N.replace(/\0/g,"\\0"):N;let g;if(Array.isArray(R))g=R.map(m),w=S.formatBindParameters(w,R,_,{skipValueReplace:!0})[0];else{g=[];let N=0;const c={},l=(r,i,s)=>{if(c[i]!==void 0)return c[i];if(s[i]!==void 0)return N=N+1,g.push(m(s[i])),c[i]=`$${N}`,`$${N}`};w=S.formatBindParameters(w,R,_,l)[0]}return[w,g]}async run(w,R){const{connection:_}=this;n.isEmpty(this.options.searchPath)||(w=this.sequelize.getQueryInterface().queryGenerator.setSearchPath(this.options.searchPath)+w),this.sequelize.options.minifyAliases&&this.options.includeAliases&&n.toPairs(this.options.includeAliases).sort((a,d)=>d[1].length-a[1].length).forEach(([a,d])=>{const y=new RegExp(n.escapeRegExp(d),"g");w=w.replace(y,a)}),this.sql=w;const m=R&&R.length?new Promise((a,d)=>_.query(w,R,(y,o)=>y?d(y):a(o))):new Promise((a,d)=>_.query(w,(y,o)=>y?d(y):a(o))),g=this._logQuery(w,O,R);let N;const c=new Error;try{N=await m}catch(a){throw(a.code==="ECONNRESET"||/Unable to set non-blocking to true/i.test(a)||/SSL SYSCALL error: EOF detected/i.test(a)||/Local: Authentication failure/i.test(a)||a.message==="Query read timeout")&&(_._invalid=!0),a.sql=w,a.parameters=R,this.formatError(a,c.stack)}g();let l=Array.isArray(N)?N.reduce((a,d)=>a.concat(d.rows||[]),[]):N.rows;const r=Array.isArray(N)?N.reduce((a,d)=>Number.isFinite(d.rowCount)?a+d.rowCount:a,0):N.rowCount||0;this.sequelize.options.minifyAliases&&this.options.aliasesMapping&&(l=l.map(a=>n.toPairs(a).reduce((d,[y,o])=>{const p=this.options.aliasesMapping.get(y);return d[p||y]=o,d},{})));const i=w.startsWith("SELECT table_name FROM information_schema.tables");if(w.startsWith("SELECT relname FROM pg_class WHERE oid IN"))return l.map(a=>({name:a.relname,tableName:a.relname.split("_")[0]}));if(i)return l.map(a=>Object.values(a));if(l[0]&&l[0].sequelize_caught_exception!==void 0){if(l[0].sequelize_caught_exception!==null)throw this.formatError({sql:w,parameters:R,code:"23505",detail:l[0].sequelize_caught_exception});for(const a of l)delete a.sequelize_caught_exception}if(this.isShowIndexesQuery()){for(const a of l){const d=/ON .*? (?:USING .*?\s)?\(([^]*)\)/gi.exec(a.definition)[1].split(","),y=n.zipObject(a.column_indexes,this.sequelize.getQueryInterface().queryGenerator.fromArray(a.column_names));delete a.column_indexes,delete a.column_names;let o,p;a.fields=a.indkey.split(" ").map((b,u)=>(o=y[b],o?(p=d[u],{attribute:o,collate:p.match(/COLLATE "(.*?)"/)?/COLLATE "(.*?)"/.exec(p)[1]:void 0,order:p.includes("DESC")?"DESC":p.includes("ASC")?"ASC":void 0,length:void 0}):null)).filter(b=>b!==null),delete a.columns}return l}if(this.isForeignKeysQuery()){const a=[];for(const d of l){let y;if(d.condef!==void 0&&(y=d.condef.match(/FOREIGN KEY \((.+)\) REFERENCES (.+)\((.+)\)( ON (UPDATE|DELETE) (CASCADE|RESTRICT))?( ON (UPDATE|DELETE) (CASCADE|RESTRICT))?/))){d.id=d.constraint_name,d.table=y[2],d.from=y[1],d.to=y[3];let o;for(o=5;o<=8;o+=3)/(UPDATE|DELETE)/.test(y[o])&&(d[`on_${y[o].toLowerCase()}`]=y[o+1])}a.push(d)}return a}if(this.isSelectQuery()){let a=l;if(this.options.raw===!1&&this.sequelize.options.quoteIdentifiers===!1){const d=n.reduce(this.model.rawAttributes,(y,o,p)=>(y[p.toLowerCase()]=p,y),{});a=l.map(y=>n.mapKeys(y,(o,p)=>{const b=d[p];return typeof b=="string"&&b!==p?b:p}))}return this.handleSelectQuery(a)}if(e.DESCRIBE===this.options.type){const a={};for(const d of l)if(a[d.Field]={type:d.Type.toUpperCase(),allowNull:d.Null==="YES",defaultValue:d.Default,comment:d.Comment,special:d.special?this.sequelize.getQueryInterface().queryGenerator.fromArray(d.special):[],primaryKey:d.Constraint==="PRIMARY KEY"},a[d.Field].type==="BOOLEAN"&&(a[d.Field].defaultValue={false:!1,true:!0}[a[d.Field].defaultValue],a[d.Field].defaultValue===void 0&&(a[d.Field].defaultValue=null)),typeof a[d.Field].defaultValue=="string"&&(a[d.Field].defaultValue=a[d.Field].defaultValue.replace(/'/g,""),a[d.Field].defaultValue.includes("::"))){const y=a[d.Field].defaultValue.split("::");y[1].toLowerCase()!=="regclass)"&&(a[d.Field].defaultValue=y[0])}return a}if(this.isVersionQuery())return l[0].server_version;if(this.isShowOrDescribeQuery())return l;if(e.BULKUPDATE===this.options.type)return this.options.returning?this.handleSelectQuery(l):parseInt(r,10);if(e.BULKDELETE===this.options.type)return parseInt(r,10);if(this.isInsertQuery()||this.isUpdateQuery()||this.isUpsertQuery()){if(this.instance&&this.instance.dataValues){if(this.isInsertQuery()&&!this.isUpsertQuery()&&r===0)throw new t.EmptyResultError;for(const a in l[0])if(Object.prototype.hasOwnProperty.call(l[0],a)){const d=l[0][a],y=n.find(this.model.rawAttributes,o=>o.fieldName===a||o.field===a);this.instance.dataValues[y&&y.fieldName||a]=d}}return this.isUpsertQuery()?[this.instance,null]:[this.instance||l&&(this.options.plain&&l[0]||l)||void 0,r]}return this.isRawQuery()?[l,N]:l}formatError(w,R){let _,m,g,N,c,l;const r=w.code||w.sqlState,i=w.message||w.messagePrimary,s=w.detail||w.messageDetail;switch(r){case"23503":return g=i.match(/violates foreign key constraint "(.+?)"/),g=g?g[1]:void 0,m=i.match(/on table "(.+?)"/),m=m?m[1]:void 0,new t.ForeignKeyConstraintError({message:i,fields:null,index:g,table:m,parent:w,stack:R});case"23505":return s&&(_=s.replace(/"/g,"").match(/Key \((.*?)\)=\((.*?)\)/))?(N=n.zipObject(_[1].split(", "),_[2].split(", ")),c=[],l="Validation error",n.forOwn(N,(a,d)=>{c.push(new t.ValidationErrorItem(this.getUniqueConstraintErrorMessage(d),"unique violation",d,a,this.instance,"not_unique"))}),this.model&&this.model.uniqueKeys&&n.forOwn(this.model.uniqueKeys,a=>{if(n.isEqual(a.fields,Object.keys(N))&&a.msg)return l=a.msg,!1}),new t.UniqueConstraintError({message:l,errors:c,parent:w,fields:N,stack:R})):new t.UniqueConstraintError({message:i,parent:w,stack:R});case"23P01":return _=s.match(/Key \((.*?)\)=\((.*?)\)/),_&&(N=n.zipObject(_[1].split(", "),_[2].split(", "))),l="Exclusion constraint error",new t.ExclusionConstraintError({message:l,constraint:w.constraint,fields:N,table:w.table,parent:w,stack:R});case"42704":if(w.sql&&/(CONSTRAINT|INDEX)/gi.test(w.sql))throw l="Unknown constraint error",g=i.match(/(?:constraint|index) "(.+?)"/i),g=g?g[1]:void 0,m=i.match(/relation "(.+?)"/i),m=m?m[1]:void 0,new t.UnknownConstraintError({message:l,constraint:g,fields:N,table:m,parent:w,stack:R});default:return new t.DatabaseError(w,{stack:R})}}isForeignKeysQuery(){return/SELECT conname as constraint_name, pg_catalog\.pg_get_constraintdef\(r\.oid, true\) as condef FROM pg_catalog\.pg_constraint r WHERE r\.conrelid = \(SELECT oid FROM pg_class WHERE relname = '.*' LIMIT 1\) AND r\.contype = 'f' ORDER BY 1;/.test(this.sql)}getInsertIdField(){return"id"}}return Lt.exports=T,Lt.exports.Query=T,Lt.exports.default=T,Lt.exports}var us,sn;function gu(){if(sn)return us;sn=1;var S=Object.defineProperty,e=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,f=(c,l,r)=>l in c?S(c,l,{enumerable:!0,configurable:!0,writable:!0,value:r}):c[l]=r,O=(c,l)=>{for(var r in l||(l={}))t.call(l,r)&&f(c,r,l[r]);if(e)for(var r of e(l))n.call(l,r)&&f(c,r,l[r]);return c};const T=fe(),E=Ae,w=he(),R=ut(),_=yt(),m=re,g="all,analyse,analyze,and,any,array,as,asc,asymmetric,authorization,binary,both,case,cast,check,collate,collation,column,concurrently,constraint,create,cross,current_catalog,current_date,current_role,current_schema,current_time,current_timestamp,current_user,default,deferrable,desc,distinct,do,else,end,except,false,fetch,for,foreign,freeze,from,full,grant,group,having,ilike,in,initially,inner,intersect,into,is,isnull,join,lateral,leading,left,like,limit,localtime,localtimestamp,natural,not,notnull,null,offset,on,only,or,order,outer,overlaps,placing,primary,references,returning,right,select,session_user,similar,some,symmetric,table,tablesample,then,to,trailing,true,union,unique,user,using,variadic,verbose,when,where,window,with".split(",");class N extends R{setSearchPath(l){return`SET search_path to ${l};`}createDatabaseQuery(l,r){r=O({encoding:null,collate:null},r);const i={database:this.quoteTable(l),encoding:r.encoding?` ENCODING = ${this.escape(r.encoding)}`:"",collation:r.collate?` LC_COLLATE = ${this.escape(r.collate)}`:"",ctype:r.ctype?` LC_CTYPE = ${this.escape(r.ctype)}`:"",template:r.template?` TEMPLATE = ${this.escape(r.template)}`:""};return`CREATE DATABASE ${i.database}${i.encoding}${i.collation}${i.ctype}${i.template};`}dropDatabaseQuery(l){return`DROP DATABASE IF EXISTS ${this.quoteTable(l)};`}createSchema(l){const r=m.get(this,"sequelize.options.databaseVersion",0);return r&&_.gte(r,"9.2.0")?`CREATE SCHEMA IF NOT EXISTS ${this.quoteIdentifier(l)};`:`CREATE SCHEMA ${this.quoteIdentifier(l)};`}dropSchema(l){return`DROP SCHEMA IF EXISTS ${this.quoteIdentifier(l)} CASCADE;`}showSchemasQuery(){return"SELECT schema_name FROM information_schema.schemata WHERE schema_name <> 'information_schema' AND schema_name != 'public' AND schema_name !~ E'^pg_';"}versionQuery(){return"SHOW SERVER_VERSION"}createTableQuery(l,r,i){i=O({},i);const s=m.get(this,"sequelize.options.databaseVersion",0),a=[];let d="",y="";const o=this.quoteTable(l);i.comment&&typeof i.comment=="string"&&(d+=`; COMMENT ON TABLE ${o} IS ${this.escape(i.comment)}`);for(const u in r){const h=this.quoteIdentifier(u),A=r[u].indexOf("COMMENT ");if(A!==-1){const q=this.escape(r[u].substring(A+8));y+=`; COMMENT ON COLUMN ${o}.${h} IS ${q}`,r[u]=r[u].substring(0,A)}const I=this.dataTypeMapping(l,u,r[u]);a.push(`${h} ${I}`)}let p=a.join(", ");i.uniqueKeys&&m.each(i.uniqueKeys,u=>{u.customIndex&&(p+=`, UNIQUE (${u.fields.map(h=>this.quoteIdentifier(h)).join(", ")})`)});const b=m.reduce(r,(u,h,A)=>(h.includes("PRIMARY KEY")&&u.push(this.quoteIdentifier(A)),u),[]).join(",");return b.length>0&&(p+=`, PRIMARY KEY (${b})`),`CREATE TABLE ${s===0||_.gte(s,"9.1.0")?"IF NOT EXISTS ":""}${o} (${p})${d}${y};`}dropTableQuery(l,r){return r=r||{},`DROP TABLE IF EXISTS ${this.quoteTable(l)}${r.cascade?" CASCADE":""};`}showTablesQuery(){const l=this.options.schema||"public";return`SELECT table_name FROM information_schema.tables WHERE table_schema = ${this.escape(l)} AND table_type LIKE '%TABLE' AND table_name != 'spatial_ref_sys';`}tableExistsQuery(l){const r=l.tableName||l,i=l.schema||"public";return`SELECT table_name FROM information_schema.tables WHERE table_schema = ${this.escape(i)} AND table_name = ${this.escape(r)}`}describeTableQuery(l,r){return r=r||this.options.schema||"public",`SELECT pk.constraint_type as "Constraint",c.column_name as "Field", c.column_default as "Default",c.is_nullable as "Null", (CASE WHEN c.udt_name = 'hstore' THEN c.udt_name ELSE c.data_type END) || (CASE WHEN c.character_maximum_length IS NOT NULL THEN '(' || c.character_maximum_length || ')' ELSE '' END) as "Type", (SELECT array_agg(e.enumlabel) FROM pg_catalog.pg_type t JOIN pg_catalog.pg_enum e ON t.oid=e.enumtypid WHERE t.typname=c.udt_name) AS "special", (SELECT pgd.description FROM pg_catalog.pg_statio_all_tables AS st INNER JOIN pg_catalog.pg_description pgd on (pgd.objoid=st.relid) WHERE c.ordinal_position=pgd.objsubid AND c.table_name=st.relname) AS "Comment" FROM information_schema.columns c LEFT JOIN (SELECT tc.table_schema, tc.table_name, cu.column_name, tc.constraint_type FROM information_schema.TABLE_CONSTRAINTS tc JOIN information_schema.KEY_COLUMN_USAGE  cu ON tc.table_schema=cu.table_schema and tc.table_name=cu.table_name and tc.constraint_name=cu.constraint_name and tc.constraint_type='PRIMARY KEY') pk ON pk.table_schema=c.table_schema AND pk.table_name=c.table_name AND pk.column_name=c.column_name WHERE c.table_name = ${this.escape(l)} AND c.table_schema = ${this.escape(r)}`}_checkValidJsonStatement(l){if(typeof l!="string")return!1;const r=/^\s*((?:[a-z]+_){0,2}jsonb?(?:_[a-z]+){0,2})\([^)]*\)/i,i=/^\s*(->>?|#>>?|@>|<@|\?[|&]?|\|{2}|#-)/i,s=/^\s*((?:([`"'])(?:(?!\2).|\2{2})*\2)|[\w\d\s]+|[().,;+-])/i;let a=0,d=0,y=0,o=!1,p=!1;for(;a<l.length;){const b=l.substr(a),u=r.exec(b);if(u){a+=u[0].indexOf("("),o=!0;continue}const h=i.exec(b);if(h){a+=h[0].length,o=!0;continue}const A=s.exec(b);if(A){const I=A[1];if(I==="(")d++;else if(I===")")y++;else if(I===";"){p=!0;break}a+=A[0].length;continue}break}if(p|=d!==y,o&&p)throw new Error(`Invalid json statement: ${l}`);return o}handleSequelizeMethod(l,r,i,s,a){if(l instanceof T.Json){if(l.conditions)return this.parseConditionObject(l.conditions).map(y=>`${this.jsonPathExtractionQuery(y.path[0],m.tail(y.path))} = '${y.value}'`).join(" AND ");if(l.path){let d;if(this._checkValidJsonStatement(l.path))d=l.path;else{const y=m.toPath(l.path),o=y.shift();d=this.jsonPathExtractionQuery(o,y)}return l.value&&(d+=E.format(" = %s",this.escape(l.value))),d}}return super.handleSequelizeMethod.call(this,l,r,i,s,a)}addColumnQuery(l,r,i){const s=this.attributeToSQL(i,{context:"addColumn",table:l,key:r}),a=i.type||i,d=this.dataTypeMapping(l,r,s),y=this.quoteIdentifier(r);let p=`ALTER TABLE ${this.quoteTable(this.extractTableDetails(l))} ADD COLUMN ${y} ${d};`;return a instanceof w.ENUM?p=this.pgEnum(l,r,a)+p:a.type&&a.type instanceof w.ENUM&&(p=this.pgEnum(l,r,a.type)+p),p}removeColumnQuery(l,r){const i=this.quoteTable(this.extractTableDetails(l)),s=this.quoteIdentifier(r);return`ALTER TABLE ${i} DROP COLUMN ${s};`}changeColumnQuery(l,r){const i=a=>`ALTER TABLE ${this.quoteTable(l)} ALTER COLUMN ${a};`,s=[];for(const a in r){let d=this.dataTypeMapping(l,a,r[a]),y="";d.includes("NOT NULL")?(y+=i(`${this.quoteIdentifier(a)} SET NOT NULL`),d=d.replace("NOT NULL","").trim()):d.includes("REFERENCES")||(y+=i(`${this.quoteIdentifier(a)} DROP NOT NULL`)),d.includes("DEFAULT")?(y+=i(`${this.quoteIdentifier(a)} SET DEFAULT ${d.match(/DEFAULT ([^;]+)/)[1]}`),d=d.replace(/(DEFAULT[^;]+)/,"").trim()):d.includes("REFERENCES")||(y+=i(`${this.quoteIdentifier(a)} DROP DEFAULT`)),r[a].startsWith("ENUM(")&&(y+=this.pgEnum(l,a,r[a]),d=d.replace(/^ENUM\(.+\)/,this.pgEnumName(l,a,{schema:!1})),d+=` USING (${this.quoteIdentifier(a)}::${this.pgEnumName(l,a)})`),d.match(/UNIQUE;*$/)&&(d=d.replace(/UNIQUE;*$/,""),y+=i(`ADD UNIQUE (${this.quoteIdentifier(a)})`).replace("ALTER COLUMN","")),d.includes("REFERENCES")?(d=d.replace(/.+?(?=REFERENCES)/,""),y+=i(`ADD FOREIGN KEY (${this.quoteIdentifier(a)}) ${d}`).replace("ALTER COLUMN","")):y+=i(`${this.quoteIdentifier(a)} TYPE ${d}`),s.push(y)}return s.join("")}renameColumnQuery(l,r,i){const s=[];for(const a in i)s.push(`${this.quoteIdentifier(r)} TO ${this.quoteIdentifier(a)}`);return`ALTER TABLE ${this.quoteTable(l)} RENAME COLUMN ${s.join(", ")};`}fn(l,r,i,s,a,d){return l=l||"testfunc",d=d||"plpgsql",a=a?`RETURNS ${a}`:"",i=i||"",`CREATE OR REPLACE FUNCTION pg_temp.${l}(${i}) ${a} AS $func$ BEGIN ${s} END; $func$ LANGUAGE ${d}; SELECT * FROM pg_temp.${l}();`}truncateTableQuery(l,r={}){return[`TRUNCATE ${this.quoteTable(l)}`,r.restartIdentity?" RESTART IDENTITY":"",r.cascade?" CASCADE":""].join("")}deleteQuery(l,r,i={},s){const a=this.quoteTable(l);let d=this.getWhereConditions(r,null,s,i);const y=i.limit?` LIMIT ${this.escape(i.limit)}`:"";let o="",p="";if(d&&(d=` WHERE ${d}`),i.limit){if(!s)throw new Error("Cannot LIMIT delete without a model.");const b=Object.values(s.primaryKeys).map(u=>this.quoteIdentifier(u.field)).join(",");return o=s.primaryKeyAttributes.length>1?`(${b})`:b,p=b,`DELETE FROM ${a} WHERE ${o} IN (SELECT ${p} FROM ${a}${d}${y})`}return`DELETE FROM ${a}${d}`}showIndexesQuery(l){let r="",i="";return typeof l!="string"&&(r=", pg_namespace s",i=` AND s.oid = t.relnamespace AND s.nspname = '${l.schema}'`,l=l.tableName),`SELECT i.relname AS name, ix.indisprimary AS primary, ix.indisunique AS unique, ix.indkey AS indkey, array_agg(a.attnum) as column_indexes, array_agg(a.attname) AS column_names, pg_get_indexdef(ix.indexrelid) AS definition FROM pg_class t, pg_class i, pg_index ix, pg_attribute a${r} WHERE t.oid = ix.indrelid AND i.oid = ix.indexrelid AND a.attrelid = t.oid AND t.relkind = 'r' and t.relname = '${l}'${i} GROUP BY i.relname, ix.indexrelid, ix.indisprimary, ix.indisunique, ix.indkey ORDER BY i.relname;`}showConstraintsQuery(l){return['SELECT constraint_catalog AS "constraintCatalog",','constraint_schema AS "constraintSchema",','constraint_name AS "constraintName",','table_catalog AS "tableCatalog",','table_schema AS "tableSchema",','table_name AS "tableName",','constraint_type AS "constraintType",','is_deferrable AS "isDeferrable",','initially_deferred AS "initiallyDeferred"',"from INFORMATION_SCHEMA.table_constraints",`WHERE table_name='${l}';`].join(" ")}removeIndexQuery(l,r,i){let s=r;return typeof s!="string"&&(s=T.underscore(`${l}_${r.join("_")}`)),["DROP INDEX",i&&i.concurrently&&"CONCURRENTLY",`IF EXISTS ${this.quoteIdentifiers(s)}`].filter(Boolean).join(" ")}addLimitAndOffset(l){let r="";return l.limit!=null&&(r+=" LIMIT "+this.escape(l.limit)),l.offset!=null&&(r+=" OFFSET "+this.escape(l.offset)),r}attributeToSQL(l,r){m.isPlainObject(l)||(l={type:l});let i;if(l.type instanceof w.ENUM||l.type instanceof w.ARRAY&&l.type.type instanceof w.ENUM){const a=l.type.type||l.type;let d=l.values;if(a.values&&!l.values&&(d=a.values),Array.isArray(d)&&d.length>0)i=`ENUM(${d.map(y=>this.escape(y)).join(", ")})`,l.type instanceof w.ARRAY&&(i+="[]");else throw new Error("Values for ENUM haven't been defined.")}i||(i=l.type);let s=i.toString();if(Object.prototype.hasOwnProperty.call(l,"allowNull")&&!l.allowNull&&(s+=" NOT NULL"),l.autoIncrement&&(l.autoIncrementIdentity?s+=" GENERATED BY DEFAULT AS IDENTITY":s+=" SERIAL"),T.defaultValueSchemable(l.defaultValue)&&(s+=` DEFAULT ${this.escape(l.defaultValue,l)}`),l.unique===!0&&(s+=" UNIQUE"),l.primaryKey&&(s+=" PRIMARY KEY"),l.references){let a=this.quoteTable(l.references.model),d;r.schema?d=r.schema:(!l.references.model||typeof l.references.model=="string")&&r.table&&r.table.schema&&(d=r.table.schema),d&&(a=this.quoteTable(this.addSchema({tableName:a,_schema:d})));let y;r.withoutForeignKeyConstraints||(l.references.key?y=this.quoteIdentifiers(l.references.key):y=this.quoteIdentifier("id"),s+=` REFERENCES ${a} (${y})`,l.onDelete&&(s+=` ON DELETE ${l.onDelete.toUpperCase()}`),l.onUpdate&&(s+=` ON UPDATE ${l.onUpdate.toUpperCase()}`),l.references.deferrable&&(s+=` ${l.references.deferrable.toString(this)}`))}if(l.comment&&typeof l.comment=="string")if(r&&["addColumn","changeColumn"].includes(r.context)){const a=this.quoteIdentifier(r.key),d=this.escape(l.comment);s+=`; COMMENT ON COLUMN ${this.quoteTable(r.table)}.${a} IS ${d}`}else s+=` COMMENT ${l.comment}`;return s}deferConstraintsQuery(l){return l.deferrable.toString(this)}setConstraintQuery(l,r){let i="ALL";return l&&(i=l.map(s=>this.quoteIdentifier(s)).join(", ")),`SET CONSTRAINTS ${i} ${r}`}setDeferredQuery(l){return this.setConstraintQuery(l,"DEFERRED")}setImmediateQuery(l){return this.setConstraintQuery(l,"IMMEDIATE")}attributesToSQL(l,r){const i={};for(const s in l){const a=l[s];i[a.field||s]=this.attributeToSQL(a,O({key:s},r))}return i}createTrigger(l,r,i,s,a,d,y){const o=this.decodeTriggerEventType(i),p=this.expandTriggerEventSpec(s),b=this.expandOptions(y),u=this._expandFunctionParamList(d);return`CREATE ${this.triggerEventTypeIsConstraint(i)}TRIGGER ${this.quoteIdentifier(r)} ${o} ${p} ON ${this.quoteTable(l)}${b?` ${b}`:""} EXECUTE PROCEDURE ${a}(${u});`}dropTrigger(l,r){return`DROP TRIGGER ${this.quoteIdentifier(r)} ON ${this.quoteTable(l)} RESTRICT;`}renameTrigger(l,r,i){return`ALTER TRIGGER ${this.quoteIdentifier(r)} ON ${this.quoteTable(l)} RENAME TO ${this.quoteIdentifier(i)};`}createFunction(l,r,i,s,a,d,y){if(!l||!i||!s||!a)throw new Error("createFunction missing some parameters. Did you pass functionName, returnType, language and body?");const o=this._expandFunctionParamList(r),p=y&&y.variables?this._expandFunctionVariableList(y.variables):"",b=this.expandOptions(d);return`${y&&y.force?"CREATE OR REPLACE FUNCTION":"CREATE FUNCTION"} ${l}(${o}) RETURNS ${i} AS $func$ ${p} BEGIN ${a} END; $func$ language '${s}'${b};`}dropFunction(l,r){if(!l)throw new Error("requires functionName");const i=this._expandFunctionParamList(r);return`DROP FUNCTION ${l}(${i}) RESTRICT;`}renameFunction(l,r,i){const s=this._expandFunctionParamList(r);return`ALTER FUNCTION ${l}(${s}) RENAME TO ${i};`}pgEscapeAndQuote(l){return this.quoteIdentifier(T.removeTicks(this.escape(l),"'"))}_expandFunctionParamList(l){if(l===void 0||!Array.isArray(l))throw new Error("_expandFunctionParamList: function parameters array required, including an empty one for no arguments");const r=[];return l.forEach(i=>{const s=[];if(i.type)i.direction&&s.push(i.direction),i.name&&s.push(i.name),s.push(i.type);else throw new Error("function or trigger used with a parameter without any type");const a=s.join(" ");a&&r.push(a)}),r.join(", ")}_expandFunctionVariableList(l){if(!Array.isArray(l))throw new Error("_expandFunctionVariableList: function variables must be an array");const r=[];return l.forEach(i=>{if(!i.name||!i.type)throw new Error("function variable must have a name and type");let s=`DECLARE ${i.name} ${i.type}`;i.default&&(s+=` := ${i.default}`),s+=";",r.push(s)}),r.join(" ")}expandOptions(l){return l===void 0||m.isEmpty(l)?"":l.join(" ")}decodeTriggerEventType(l){const r={after:"AFTER",before:"BEFORE",instead_of:"INSTEAD OF",after_constraint:"AFTER"};if(!r[l])throw new Error(`Invalid trigger event specified: ${l}`);return r[l]}triggerEventTypeIsConstraint(l){return l==="after_constraint"?"CONSTRAINT ":""}expandTriggerEventSpec(l){if(m.isEmpty(l))throw new Error("no table change events specified to trigger on");return m.map(l,(r,i)=>{const s={insert:"INSERT",update:"UPDATE",delete:"DELETE",truncate:"TRUNCATE"};if(!s[r])throw new Error(`parseTriggerEventSpec: undefined trigger event ${i}`);let a=s[r];return a==="UPDATE"&&Array.isArray(r)&&r.length>0&&(a+=` OF ${r.join(", ")}`),a}).join(" OR ")}pgEnumName(l,r,i){i=i||{};const s=this.extractTableDetails(l,i);let a=T.addTicks(T.generateEnumName(s.tableName,r),'"');return i.schema!==!1&&s.schema&&(a=this.quoteIdentifier(s.schema)+s.delimiter+a),a}pgListEnums(l,r,i){let s="";const a=this.extractTableDetails(l,i);return a.tableName&&r&&(s=` AND t.typname=${this.pgEnumName(a.tableName,r,{schema:!1}).replace(/"/g,"'")}`),`SELECT t.typname enum_name, array_agg(e.enumlabel ORDER BY enumsortorder) enum_value FROM pg_type t JOIN pg_enum e ON t.oid = e.enumtypid JOIN pg_catalog.pg_namespace n ON n.oid = t.typnamespace WHERE n.nspname = '${a.schema}'${s} GROUP BY 1`}pgEnum(l,r,i,s){const a=this.pgEnumName(l,r,s);let d;i.values?d=`ENUM(${i.values.map(o=>this.escape(o)).join(", ")})`:d=i.toString().match(/^ENUM\(.+\)/)[0];let y=`DO ${this.escape(`BEGIN CREATE TYPE ${a} AS ${d}; EXCEPTION WHEN duplicate_object THEN null; END`)};`;return s&&s.force===!0&&(y=this.pgEnumDrop(l,r)+y),y}pgEnumAdd(l,r,i,s){let d=`ALTER TYPE ${this.pgEnumName(l,r)} ADD VALUE `;return _.gte(this.sequelize.options.databaseVersion,"9.3.0")&&(d+="IF NOT EXISTS "),d+=this.escape(i),s.before?d+=` BEFORE ${this.escape(s.before)}`:s.after&&(d+=` AFTER ${this.escape(s.after)}`),d}pgEnumDrop(l,r,i){return i=i||this.pgEnumName(l,r),`DROP TYPE IF EXISTS ${i}; `}fromArray(l){l=l.replace(/^{/,"").replace(/}$/,"");let r=l.match(/("(?:\\.|[^"\\\\])*"|[^,]*)(?:\s*,\s*|\s*$)/ig);return r.length<1?[]:(r=r.map(i=>i.replace(/",$/,"").replace(/,$/,"").replace(/(^"|"$)/g,"")),r.slice(0,-1))}dataTypeMapping(l,r,i){return i.includes("PRIMARY KEY")&&(i=i.replace("PRIMARY KEY","")),i.includes("SERIAL")&&(i.includes("BIGINT")?(i=i.replace("SERIAL","BIGSERIAL"),i=i.replace("BIGINT","")):i.includes("SMALLINT")?(i=i.replace("SERIAL","SMALLSERIAL"),i=i.replace("SMALLINT","")):i=i.replace("INTEGER",""),i=i.replace("NOT NULL","")),i.startsWith("ENUM(")&&(i=i.replace(/^ENUM\(.+\)/,this.pgEnumName(l,r))),i}getForeignKeysQuery(l){return`SELECT conname as constraint_name, pg_catalog.pg_get_constraintdef(r.oid, true) as condef FROM pg_catalog.pg_constraint r WHERE r.conrelid = (SELECT oid FROM pg_class WHERE relname = '${l}' LIMIT 1) AND r.contype = 'f' ORDER BY 1;`}_getForeignKeyReferencesQueryPrefix(){return"SELECT DISTINCT tc.constraint_name as constraint_name, tc.constraint_schema as constraint_schema, tc.constraint_catalog as constraint_catalog, tc.table_name as table_name,tc.table_schema as table_schema,tc.table_catalog as table_catalog,tc.initially_deferred as initially_deferred,tc.is_deferrable as is_deferrable,kcu.column_name as column_name,ccu.table_schema  AS referenced_table_schema,ccu.table_catalog  AS referenced_table_catalog,ccu.table_name  AS referenced_table_name,ccu.column_name AS referenced_column_name FROM information_schema.table_constraints AS tc JOIN information_schema.key_column_usage AS kcu ON tc.constraint_name = kcu.constraint_name JOIN information_schema.constraint_column_usage AS ccu ON ccu.constraint_name = tc.constraint_name "}getForeignKeyReferencesQuery(l,r,i){return`${this._getForeignKeyReferencesQueryPrefix()}WHERE constraint_type = 'FOREIGN KEY' AND tc.table_name = '${l}'${r?` AND tc.table_catalog = '${r}'`:""}${i?` AND tc.table_schema = '${i}'`:""}`}getForeignKeyReferenceQuery(l,r){const i=l.tableName||l,s=l.schema;return`${this._getForeignKeyReferencesQueryPrefix()}WHERE constraint_type = 'FOREIGN KEY' AND tc.table_name='${i}' AND  kcu.column_name = '${r}'${s?` AND tc.table_schema = '${s}'`:""}`}dropForeignKeyQuery(l,r){return`ALTER TABLE ${this.quoteTable(l)} DROP CONSTRAINT ${this.quoteIdentifier(r)};`}quoteIdentifier(l,r){const i=r||!1,s=this.options.quoteIdentifiers!==!1,a=T.removeTicks(l,'"');return i===!0||s!==!1||l.includes(".")||l.includes("->")||g.includes(a.toLowerCase())?T.addTicks(a,'"'):a}}return us=N,us}var ls={},nn;function _u(){if(nn)return ls;nn=1;var S=Object.defineProperty,e=Object.defineProperties,t=Object.getOwnPropertyDescriptors,n=Object.getOwnPropertySymbols,f=Object.prototype.hasOwnProperty,O=Object.prototype.propertyIsEnumerable,T=(r,i,s)=>i in r?S(r,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[i]=s,E=(r,i)=>{for(var s in i||(i={}))f.call(i,s)&&T(r,s,i[s]);if(n)for(var s of n(i))O.call(i,s)&&T(r,s,i[s]);return r},w=(r,i)=>e(r,t(i)),R=(r,i)=>{var s={};for(var a in r)f.call(r,a)&&i.indexOf(a)<0&&(s[a]=r[a]);if(r!=null&&n)for(var a of n(r))i.indexOf(a)<0&&O.call(r,a)&&(s[a]=r[a]);return s};const _=he(),m=Me,{QueryInterface:g}=He,N=fe(),c=ea;class l extends g{async ensureEnums(i,s,a,d){const y=Object.keys(s),o=y.length;let p="",b=[],u=0;for(u=0;u<o;u++){const L=s[y[u]],D=L.type;(D instanceof _.ENUM||D instanceof _.ARRAY&&D.type instanceof _.ENUM)&&(p=this.queryGenerator.pgListEnums(i,L.field||y[u],a),b.push(this.sequelize.query(p,w(E({},a),{plain:!0,raw:!0,type:m.SELECT}))))}const h=await Promise.all(b);b=[];let A=0;const I=(L,D,C,$="before",P=b.length)=>{const Q=E({},a);switch(Q.before=null,Q.after=null,$){case"after":Q.after=C;break;case"before":default:Q.before=C;break}b.splice(P,0,()=>this.sequelize.query(this.queryGenerator.pgEnumAdd(i,L,D,Q),Q))};for(u=0;u<o;u++){const L=s[y[u]],D=L.type,C=D.type||D,$=L.field||y[u];if(D instanceof _.ENUM||D instanceof _.ARRAY&&C instanceof _.ENUM){if(!h[A])b.push(()=>this.sequelize.query(this.queryGenerator.pgEnum(i,$,C,a),w(E({},a),{raw:!0})));else if(h[A]&&d){const P=this.queryGenerator.fromArray(h[A].enum_value),Q=C.values;let j,B=-1;for(let F=0;F<P.length;F++){const x=P[F],k=Q.indexOf(x);if(j=x,k===-1)continue;const X=Q.slice(0,k),H=b.length;for(let W=X.length-1;W>=0&&!~P.indexOf(X[W]);W--)I($,X[W],j,"before",H);k>B&&(B=k)}if(j&&B<Q.length-1){const F=Q.slice(B+1);for(let x=F.length-1;x>=0;x--)I($,F[x],j,"after")}A++}}}const q=await b.reduce(async(L,D)=>await D(await L),Promise.resolve());return b.length&&await this.sequelize.dialect.connectionManager._refreshDynamicOIDs(),q}async getForeignKeyReferencesForTable(i,s){const a=w(E({},s),{type:m.FOREIGNKEYS}),d=this.queryGenerator.getForeignKeyReferencesQuery(i.tableName||i,this.sequelize.config.database);return(await this.sequelize.query(d,a)).map(o=>{const p=N.camelizeObjectKeys(o),{initiallyDeferred:b,isDeferrable:u}=p,h=R(p,["initiallyDeferred","isDeferrable"]);return w(E({},h),{deferrable:u==="NO"?c.NOT:b==="NO"?c.INITIALLY_IMMEDIATE:c.INITIALLY_DEFERRED})})}async dropEnum(i,s){return s=s||{},this.sequelize.query(this.queryGenerator.pgEnumDrop(null,null,this.queryGenerator.pgEscapeAndQuote(i)),w(E({},s),{raw:!0}))}async dropAllEnums(i){i=i||{};const s=await this.pgListEnums(null,i);return await Promise.all(s.map(a=>this.sequelize.query(this.queryGenerator.pgEnumDrop(null,null,this.queryGenerator.pgEscapeAndQuote(a.enum_name)),w(E({},i),{raw:!0}))))}async pgListEnums(i,s){s=s||{};const a=this.queryGenerator.pgListEnums(i);return this.sequelize.query(a,w(E({},s),{plain:!1,raw:!0,type:m.SELECT}))}async dropTable(i,s){await super.dropTable(i,s);const a=[],d=this.sequelize.modelManager.getModel(i,{attribute:"tableName"});if(!d)return;const y=(!s||!s.schema||s.schema==="public"?"":`${s.schema}_`)+i,o=Object.keys(d.rawAttributes),p=o.length;for(let b=0;b<p;b++)if(d.rawAttributes[o[b]].type instanceof _.ENUM){const u=this.queryGenerator.pgEnumDrop(y,o[b]);s.supportsSearchPath=!1,a.push(this.sequelize.query(u,w(E({},s),{raw:!0})))}await Promise.all(a)}}return ls.PostgresQueryInterface=l,ls}var an;function Au(){if(an)return qt.exports;an=1;const S=re,e=Xe(),t=mu(),n=Eu(),f=gu(),O=he().postgres,{PostgresQueryInterface:T}=_u();class E extends e{constructor(R){super(),this.sequelize=R,this.connectionManager=new t(this,R),this.queryGenerator=new f({_dialect:this,sequelize:R}),this.queryInterface=new T(R,this.queryGenerator)}canBackslashEscape(){return!this.sequelize.options.standardConformingStrings}}return E.prototype.supports=S.merge(S.cloneDeep(e.prototype.supports),{"DEFAULT VALUES":!0,EXCEPTION:!0,"ON DUPLICATE KEY":!1,"ORDER NULLS":!0,returnValues:{returning:!0},bulkDefault:!0,schemas:!0,lock:!0,lockOf:!0,lockKey:!0,lockOuterJoinFailure:!0,skipLocked:!0,forShare:"FOR SHARE",index:{concurrently:!0,using:2,where:!0,functionBased:!0,operator:!0},inserts:{onConflictDoNothing:" ON CONFLICT DO NOTHING",updateOnDuplicate:" ON CONFLICT DO UPDATE SET",conflictFields:!0,onConflictWhere:!0},NUMERIC:!0,ARRAY:!0,RANGE:!0,GEOMETRY:!0,REGEXP:!0,GEOGRAPHY:!0,JSON:!0,JSONB:!0,HSTORE:!0,TSVECTOR:!0,deferrableConstraints:!0,searchPath:!0,escapeStringConstants:!0}),E.prototype.defaultVersion="9.5.0",E.prototype.Query=n,E.prototype.DataTypes=O,E.prototype.name="postgres",E.prototype.TICK_CHAR='"',E.prototype.TICK_CHAR_LEFT=E.prototype.TICK_CHAR,E.prototype.TICK_CHAR_RIGHT=E.prototype.TICK_CHAR,qt.exports=E,qt.exports.default=E,qt.exports.PostgresDialect=E,qt.exports}var Dt={exports:{}},Mt={exports:{}},on;function Ou(){if(on)return Mt.exports;on=1;const S=Ae,e=Ae,t=Ze(),{logger:n}=ge,f=n.debugContext("connection:sqlite"),O=he().sqlite,T=ce,E=je()("sqlite"),{promisify:w}=Ae;class R extends t{constructor(m,g){super(m,g),this.sequelize.options.host==="localhost"&&delete this.sequelize.options.host,this.connections={},this.lib=this._loadDialectModule("sqlite3"),this.refreshTypeParser(O)}async _onProcessExit(){return await Promise.all(Object.getOwnPropertyNames(this.connections).map(m=>w(g=>this.connections[m].close(g))())),super._onProcessExit.call(this)}_refreshTypeParser(m){E.refresh(m)}_clearTypeParser(){E.clear()}async getConnection(m){m=m||{},m.uuid=m.uuid||"default",!!this.sequelize.options.storage!==null&&this.sequelize.options.storage!==void 0?m.storage=this.sequelize.options.storage:m.storage=this.sequelize.options.host||":memory:",m.inMemory=m.storage===":memory:"?1:0;const g=this.sequelize.options.dialectOptions,N=this.lib.OPEN_READWRITE|this.lib.OPEN_CREATE;if(m.readWriteMode=g&&g.mode||N,this.connections[m.inMemory||m.uuid])return this.connections[m.inMemory||m.uuid];!m.inMemory&&m.readWriteMode&this.lib.OPEN_CREATE&&S.mkdirSync(e.dirname(m.storage),{recursive:!0});const c=await new Promise((l,r)=>{this.connections[m.inMemory||m.uuid]=new this.lib.Database(m.storage,m.readWriteMode,i=>{if(i)return r(new T.ConnectionError(i));f(`connection acquired ${m.uuid}`),l(this.connections[m.inMemory||m.uuid])})});return this.sequelize.config.password&&c.run(`PRAGMA KEY=${this.sequelize.escape(this.sequelize.config.password)}`),this.sequelize.options.foreignKeys!==!1&&c.run("PRAGMA FOREIGN_KEYS=ON"),c}releaseConnection(m,g){m.filename===":memory:"&&g!==!0||m.uuid&&(m.close(),f(`connection released ${m.uuid}`),delete this.connections[m.uuid])}}return Mt.exports=R,Mt.exports.ConnectionManager=R,Mt.exports.default=R,Mt.exports}var $t={exports:{}},un;function bu(){if(un)return $t.exports;un=1;const S=re,e=fe(),t=et(),n=Me,f=ce,O=je()("sqlite"),{logger:T}=ge,E=T.debugContext("sql:sqlite");function w(_){return typeof _=="bigint"?_.toString():_}class R extends t{getInsertIdField(){return"lastID"}static formatBindParameters(m,g,N){let c;if(Array.isArray(g))c={},g.forEach((l,r)=>{c[`$${r+1}`]=l}),m=t.formatBindParameters(m,g,N,{skipValueReplace:!0})[0];else{if(c={},typeof g=="object")for(const l of Object.keys(g))c[`$${l}`]=g[l];m=t.formatBindParameters(m,g,N,{skipValueReplace:!0})[0]}return[m,c]}_collectModels(m,g){const N={};if(m)for(const c of m){let l;g?l=`${g}.${c.as}`:l=c.as,N[l]=c.model,c.include&&S.merge(N,this._collectModels(c.include,l))}return N}_handleQueryResponse(m,g,N,c,l){if(N)throw N.sql=this.sql,this.formatError(N,l);let r=this.instance;if((this.isInsertQuery(c,m)||this.isUpsertQuery())&&(this.handleInsertQuery(c,m),!this.instance))if(m.constructor.name==="Statement"&&this.model&&this.model.autoIncrementAttribute&&this.model.autoIncrementAttribute===this.model.primaryKeyAttribute&&this.model.rawAttributes[this.model.primaryKeyAttribute]){const i=m[this.getInsertIdField()]-m.changes+1;r=[];for(let s=i;s<i+m.changes;s++)r.push({[this.model.rawAttributes[this.model.primaryKeyAttribute].field]:s})}else r=m[this.getInsertIdField()];if(this.isShowTablesQuery())return c.map(i=>i.name);if(this.isShowConstraintsQuery())return r=c,c&&c[0]&&c[0].sql&&(r=this.parseConstraintsFromSql(c[0].sql)),r;if(this.isSelectQuery()){if(this.options.raw)return this.handleSelectQuery(c);const i=this._collectModels(this.options.include);return c=c.map(s=>S.mapValues(s,(a,d)=>{let y;if(d.includes(".")){const b=d.lastIndexOf(".");y=i[d.substr(0,b)],d=d.substr(b+1)}else y=this.options.model;const o=y.getTableName().toString().replace(/`/g,""),p=g[o]||{};return p&&!(d in p)&&S.forOwn(y.rawAttributes,(b,u)=>{if(d===u&&b.field)return d=b.field,!1}),Object.prototype.hasOwnProperty.call(p,d)?this.applyParsers(p[d],a):a})),this.handleSelectQuery(c)}if(this.isShowOrDescribeQuery())return c;if(this.sql.includes("PRAGMA INDEX_LIST"))return this.handleShowIndexesQuery(c);if(this.sql.includes("PRAGMA INDEX_INFO"))return c;if(this.sql.includes("PRAGMA TABLE_INFO")){r={};let i;for(const s of c)s.dflt_value===null?i=void 0:s.dflt_value==="NULL"?i=null:i=s.dflt_value,r[s.name]={type:s.type,allowNull:s.notnull===0,defaultValue:i,primaryKey:s.pk!==0},r[s.name].type==="TINYINT(1)"&&(r[s.name].defaultValue={0:!1,1:!0}[r[s.name].defaultValue]),typeof r[s.name].defaultValue=="string"&&(r[s.name].defaultValue=r[s.name].defaultValue.replace(/'/g,""));return r}return this.sql.includes("PRAGMA foreign_keys;")?c[0]:this.sql.includes("PRAGMA foreign_keys")||this.sql.includes("PRAGMA foreign_key_list")?c:[n.BULKUPDATE,n.BULKDELETE].includes(this.options.type)?m.changes:this.options.type===n.VERSION?c[0].version:this.options.type===n.RAW?[c,m]:this.isUpsertQuery()?[r,null]:this.isUpdateQuery()||this.isInsertQuery()?[r,m.changes]:r}async run(m,g){const N=this.connection;this.sql=m;const c=this.getDatabaseMethod(),l=this._logQuery(m,E,g);return new Promise((r,i)=>N.serialize(async()=>{const s={},a=new Error,d=()=>{if(m.startsWith("-- "))return r();const y=this;function o(p,b){try{l(),r(y._handleQueryResponse(this,s,p,b,a.stack));return}catch(u){i(u)}}if(g||(g=[]),S.isPlainObject(g)){const p=Object.create(null);for(const b of Object.keys(g))p[`${b}`]=w(g[b]);g=p}else g=g.map(w);return N[c](m,g,o),null};if(this.getDatabaseMethod()==="all"){let y=[];if(this.options&&this.options.tableNames?y=this.options.tableNames:/FROM `(.*?)`/i.exec(this.sql)&&y.push(/FROM `(.*?)`/i.exec(this.sql)[1]),y=y.filter(o=>!(o in s)&&o!=="sqlite_master"),!y.length)return d();await Promise.all(y.map(o=>new Promise(p=>{o=o.replace(/`/g,""),s[o]={},N.all(`PRAGMA table_info(\`${o}\`)`,(b,u)=>{if(!b)for(const h of u)s[o][h.name]=h.type;p()})})))}return d()}))}parseConstraintsFromSql(m){let g=m.split("CONSTRAINT "),N,c,l,r;return g.splice(0,1),g=g.map(i=>{if(i.includes("REFERENCES")){l=i.match(/ON UPDATE (CASCADE|SET NULL|RESTRICT|NO ACTION|SET DEFAULT){1}/),r=i.match(/ON DELETE (CASCADE|SET NULL|RESTRICT|NO ACTION|SET DEFAULT){1}/),l&&(l=l[1]),r&&(r=r[1]);const d=/REFERENCES.+\((?:[^)(]+|\((?:[^)(]+|\([^)(]*\))*\))*\)/,y=i.match(d)[0].split(" ");N=e.removeTicks(y[1]);let o=y[2];o=o.replace(/\(|\)/g,"").split(", "),c=o.map(p=>e.removeTicks(p))}const s=i.match(/\((?:[^)(]+|\((?:[^)(]+|\([^)(]*\))*\))*\)/)[0];i=i.replace(/\(.+\)/,"");const a=i.split(" ");return["PRIMARY","FOREIGN"].includes(a[1])&&(a[1]+=" KEY"),{constraintName:e.removeTicks(a[0]),constraintType:a[1],updateAction:l,deleteAction:r,sql:m.replace(/"/g,"`"),constraintCondition:s,referenceTableName:N,referenceTableKeys:c}}),g}applyParsers(m,g){m.includes("(")&&(m=m.substr(0,m.indexOf("("))),m=m.replace("UNSIGNED","").replace("ZEROFILL",""),m=m.trim().toUpperCase();const N=O.get(m);return g!==null&&N?N(g,{timezone:this.sequelize.options.timezone}):g}formatError(m,g){switch(m.code){case"SQLITE_CONSTRAINT_UNIQUE":case"SQLITE_CONSTRAINT_PRIMARYKEY":case"SQLITE_CONSTRAINT_TRIGGER":case"SQLITE_CONSTRAINT_FOREIGNKEY":case"SQLITE_CONSTRAINT":{if(m.message.includes("FOREIGN KEY constraint failed"))return new f.ForeignKeyConstraintError({parent:m,stack:g});let N=[],c=m.message.match(/columns (.*?) are/);c!==null&&c.length>=2?N=c[1].split(", "):(c=m.message.match(/UNIQUE constraint failed: (.*)/),c!==null&&c.length>=2&&(N=c[1].split(", ").map(i=>i.split(".")[1])));const l=[];let r="Validation error";for(const i of N)l.push(new f.ValidationErrorItem(this.getUniqueConstraintErrorMessage(i),"unique violation",i,this.instance&&this.instance[i],this.instance,"not_unique"));return this.model&&S.forOwn(this.model.uniqueKeys,i=>{if(S.isEqual(i.fields,N)&&i.msg)return r=i.msg,!1}),new f.UniqueConstraintError({message:r,errors:l,parent:m,fields:N,stack:g})}case"SQLITE_BUSY":return new f.TimeoutError(m,{stack:g});default:return new f.DatabaseError(m,{stack:g})}}async handleShowIndexesQuery(m){return Promise.all(m.reverse().map(async g=>{g.fields=[],g.primary=!1,g.unique=!!g.unique,g.constraintName=g.name;const N=await this.run(`PRAGMA INDEX_INFO(\`${g.name}\`)`);for(const c of N)g.fields[c.seqno]={attribute:c.name,length:void 0,order:void 0};return g}))}getDatabaseMethod(){return this.isInsertQuery()||this.isUpdateQuery()||this.isUpsertQuery()||this.isBulkUpdateQuery()||this.sql.toLowerCase().includes("CREATE TEMPORARY TABLE".toLowerCase())||this.options.type===n.BULKDELETE?"run":"all"}}return $t.exports=R,$t.exports.Query=R,$t.exports.default=R,$t.exports}var cs,ln;function Tu(){if(ln)return cs;ln=1;var S=Object.defineProperty,e=Object.defineProperties,t=Object.getOwnPropertyDescriptors,n=Object.getOwnPropertySymbols,f=Object.prototype.hasOwnProperty,O=Object.prototype.propertyIsEnumerable,T=(l,r,i)=>r in l?S(l,r,{enumerable:!0,configurable:!0,writable:!0,value:i}):l[r]=i,E=(l,r)=>{for(var i in r||(r={}))f.call(r,i)&&T(l,i,r[i]);if(n)for(var i of n(r))O.call(r,i)&&T(l,i,r[i]);return l},w=(l,r)=>e(l,t(r));const R=fe(),_=_r,m=re,g=vs(),N=ut();class c extends g{createSchema(){return"SELECT name FROM `sqlite_master` WHERE type='table' and name!='sqlite_sequence';"}showSchemasQuery(){return"SELECT name FROM `sqlite_master` WHERE type='table' and name!='sqlite_sequence';"}versionQuery(){return"SELECT sqlite_version() as `version`"}createTableQuery(r,i,s){s=s||{};const a=[],d=Object.values(i).filter(h=>h.includes("PRIMARY KEY")).length>1,y=[];for(const h in i)if(Object.prototype.hasOwnProperty.call(i,h)){const A=i[h],I=A.includes("AUTOINCREMENT");let q=A;A.includes("PRIMARY KEY")&&(A.includes("INT")&&(q=I?"INTEGER PRIMARY KEY AUTOINCREMENT":"INTEGER PRIMARY KEY",A.includes(" REFERENCES")&&(q+=A.substr(A.indexOf(" REFERENCES")))),d&&(a.push(h),A.includes("NOT NULL")?q=A.replace(" PRIMARY KEY",""):q=A.replace("PRIMARY KEY","NOT NULL"))),y.push(`${this.quoteIdentifier(h)} ${q}`)}const o=this.quoteTable(r);let p=y.join(", ");const b=a.map(h=>this.quoteIdentifier(h)).join(", ");s.uniqueKeys&&m.each(s.uniqueKeys,h=>{h.customIndex&&(p+=`, UNIQUE (${h.fields.map(A=>this.quoteIdentifier(A)).join(", ")})`)}),b.length>0&&(p+=`, PRIMARY KEY (${b})`);const u=`CREATE TABLE IF NOT EXISTS ${o} (${p});`;return this.replaceBooleanDefaults(u)}booleanValue(r){return r?1:0}_checkValidJsonStatement(r){if(typeof r!="string")return!1;const i=/^\s*(json(?:_[a-z]+){0,2})\([^)]*\)/i,s=/^\s*((?:([`"'])(?:(?!\2).|\2{2})*\2)|[\w\d\s]+|[().,;+-])/i;let a=0,d=0,y=0,o=!1,p=!1;for(;a<r.length;){const b=r.substr(a),u=i.exec(b);if(u){a+=u[0].indexOf("("),o=!0;continue}const h=s.exec(b);if(h){const A=h[1];if(A==="(")d++;else if(A===")")y++;else if(A===";"){p=!0;break}a+=h[0].length;continue}break}if(p|=d!==y,o&&p)throw new Error(`Invalid json statement: ${r}`);return o}_toJSONValue(r){return r instanceof Date?r.toISOString():Array.isArray(r)&&r[0]instanceof Date?r.map(i=>i.toISOString()):r}handleSequelizeMethod(r,i,s,a,d){return r instanceof R.Json?super.handleSequelizeMethod(r,i,s,a,d):(r instanceof R.Cast&&/timestamp/i.test(r.type)&&(r.type="datetime"),N.prototype.handleSequelizeMethod.call(this,r,i,s,a,d))}addColumnQuery(r,i,s){const a={};a[i]=s;const d=this.attributesToSQL(a,{context:"addColumn"}),y=`${this.quoteIdentifier(i)} ${d[i]}`,o=`ALTER TABLE ${this.quoteTable(r)} ADD ${y};`;return this.replaceBooleanDefaults(o)}showTablesQuery(){return"SELECT name FROM `sqlite_master` WHERE type='table' and name!='sqlite_sequence';"}updateQuery(r,i,s,a,d){a=a||{},m.defaults(a,this.options),i=R.removeNullValuesFromHash(i,a.omitNull,a);const y={},o=[],p=[],b=a.bindParam||this.bindParam(p);d&&m.each(d,(A,I)=>{y[I]=A,A.field&&(y[A.field]=A)});for(const A in i){const I=i[A];I instanceof R.SequelizeMethod||a.bindParam===!1?o.push(`${this.quoteIdentifier(A)}=${this.escape(I,y&&y[A]||void 0,{context:"UPDATE"})}`):o.push(`${this.quoteIdentifier(A)}=${this.format(I,y&&y[A]||void 0,{context:"UPDATE"},b)}`)}let u;const h=w(E({},a),{bindParam:b});return a.limit?u=`UPDATE ${this.quoteTable(r)} SET ${o.join(",")} WHERE rowid IN (SELECT rowid FROM ${this.quoteTable(r)} ${this.whereQuery(s,h)} LIMIT ${this.escape(a.limit)})`:u=`UPDATE ${this.quoteTable(r)} SET ${o.join(",")} ${this.whereQuery(s,h)}`,{query:u,bind:p}}truncateTableQuery(r,i={}){return[`DELETE FROM ${this.quoteTable(r)}`,i.restartIdentity?`; DELETE FROM ${this.quoteTable("sqlite_sequence")} WHERE ${this.quoteIdentifier("name")} = ${R.addTicks(R.removeTicks(this.quoteTable(r),"`"),"'")};`:""].join("")}deleteQuery(r,i,s={},a){m.defaults(s,this.options);let d=this.getWhereConditions(i,null,a,s);return d&&(d=`WHERE ${d}`),s.limit&&(d=`WHERE rowid IN (SELECT rowid FROM ${this.quoteTable(r)} ${d} LIMIT ${this.escape(s.limit)})`),`DELETE FROM ${this.quoteTable(r)} ${d}`}attributesToSQL(r){const i={};for(const s in r){const a=r[s],d=a.field||s;if(m.isObject(a)){let y=a.type.toString();if(Object.prototype.hasOwnProperty.call(a,"allowNull")&&!a.allowNull&&(y+=" NOT NULL"),R.defaultValueSchemable(a.defaultValue)&&(y+=` DEFAULT ${this.escape(a.defaultValue,a)}`),a.unique===!0&&(y+=" UNIQUE"),a.primaryKey&&(y+=" PRIMARY KEY",a.autoIncrement&&(y+=" AUTOINCREMENT")),a.references){const o=this.quoteTable(a.references.model);let p;a.references.key?p=this.quoteIdentifier(a.references.key):p=this.quoteIdentifier("id"),y+=` REFERENCES ${o} (${p})`,a.onDelete&&(y+=` ON DELETE ${a.onDelete.toUpperCase()}`),a.onUpdate&&(y+=` ON UPDATE ${a.onUpdate.toUpperCase()}`)}i[d]=y}else i[d]=a}return i}showIndexesQuery(r){return`PRAGMA INDEX_LIST(${this.quoteTable(r)})`}showConstraintsQuery(r,i){let s=`SELECT sql FROM sqlite_master WHERE tbl_name='${r}'`;return i&&(s+=` AND sql LIKE '%${i}%'`),`${s};`}removeIndexQuery(r,i){let s=i;return typeof s!="string"&&(s=R.underscore(`${r}_${i.join("_")}`)),`DROP INDEX IF EXISTS ${this.quoteIdentifier(s)}`}describeTableQuery(r,i,s){const a={_schema:i,_schemaDelimiter:s,tableName:r};return`PRAGMA TABLE_INFO(${this.quoteTable(this.addSchema(a))});`}describeCreateTableQuery(r){return`SELECT sql FROM sqlite_master WHERE tbl_name='${r}';`}removeColumnQuery(r,i){i=this.attributesToSQL(i);let s;typeof r=="object"?s={tableName:`${r.tableName}_backup`,schema:r.schema}:s=`${r}_backup`;const a=this.quoteTable(r),d=this.quoteTable(s),y=Object.keys(i).map(o=>this.quoteIdentifier(o)).join(", ");return`${this.createTableQuery(s,i)}INSERT INTO ${d} SELECT ${y} FROM ${a};DROP TABLE ${a};${this.createTableQuery(r,i)}INSERT INTO ${a} SELECT ${y} FROM ${d};DROP TABLE ${d};`}_alterConstraintQuery(r,i,s){let a;i=this.attributesToSQL(i),typeof r=="object"?a={tableName:`${r.tableName}_backup`,schema:r.schema}:a=`${r}_backup`;const d=this.quoteTable(r),y=this.quoteTable(a),o=Object.keys(i).map(p=>this.quoteIdentifier(p)).join(", ");return`${s.replace(`CREATE TABLE ${d}`,`CREATE TABLE ${y}`).replace(`CREATE TABLE ${d.replace(/`/g,'"')}`,`CREATE TABLE ${y}`)}INSERT INTO ${y} SELECT ${o} FROM ${d};DROP TABLE ${d};ALTER TABLE ${y} RENAME TO ${d};`}renameColumnQuery(r,i,s,a){let d;a=this.attributesToSQL(a),typeof r=="object"?d={tableName:`${r.tableName}_backup`,schema:r.schema}:d=`${r}_backup`;const y=this.quoteTable(r),o=this.quoteTable(d),p=Object.keys(a).map(u=>s===u?`${this.quoteIdentifier(i)} AS ${this.quoteIdentifier(u)}`:this.quoteIdentifier(u)).join(", "),b=Object.keys(a).map(u=>this.quoteIdentifier(u)).join(", ");return`${this.createTableQuery(d,a)}INSERT INTO ${o} SELECT ${p} FROM ${y};DROP TABLE ${y};${this.createTableQuery(r,a)}INSERT INTO ${y} SELECT ${b} FROM ${o};DROP TABLE ${o};`}startTransactionQuery(r){return r.parent?`SAVEPOINT ${this.quoteIdentifier(r.name)};`:`BEGIN ${r.options.type} TRANSACTION;`}setIsolationLevelQuery(r){switch(r){case _.ISOLATION_LEVELS.REPEATABLE_READ:return"-- SQLite is not able to choose the isolation level REPEATABLE READ.";case _.ISOLATION_LEVELS.READ_UNCOMMITTED:return"PRAGMA read_uncommitted = ON;";case _.ISOLATION_LEVELS.READ_COMMITTED:return"PRAGMA read_uncommitted = OFF;";case _.ISOLATION_LEVELS.SERIALIZABLE:return"-- SQLite's default isolation level is SERIALIZABLE. Nothing to do.";default:throw new Error(`Unknown isolation level: ${r}`)}}replaceBooleanDefaults(r){return r.replace(/DEFAULT '?false'?/g,"DEFAULT 0").replace(/DEFAULT '?true'?/g,"DEFAULT 1")}getForeignKeysQuery(r){return`PRAGMA foreign_key_list(${this.quoteTable(this.addSchema(r))})`}tableExistsQuery(r){return`SELECT name FROM sqlite_master WHERE type='table' AND name=${this.escape(this.addSchema(r))};`}quoteIdentifier(r,i){return R.addTicks(R.removeTicks(r,"`"),"`")}}return cs=c,cs}var hs={},cn;function Nu(){if(cn)return hs;cn=1;var S=Object.defineProperty,e=Object.defineProperties,t=Object.getOwnPropertyDescriptors,n=Object.getOwnPropertySymbols,f=Object.prototype.hasOwnProperty,O=Object.prototype.propertyIsEnumerable,T=(l,r,i)=>r in l?S(l,r,{enumerable:!0,configurable:!0,writable:!0,value:i}):l[r]=i,E=(l,r)=>{for(var i in r||(r={}))f.call(r,i)&&T(l,i,r[i]);if(n)for(var i of n(r))O.call(r,i)&&T(l,i,r[i]);return l},w=(l,r)=>e(l,t(r));const R=ce,_=Me,{QueryInterface:m}=He,{cloneDeep:g}=fe(),N=re;class c extends m{async removeColumn(r,i,s){s=s||{};const a=await this.describeTable(r,s);delete a[i];const y=this.queryGenerator.removeColumnQuery(r,a).split(";").filter(o=>o!=="");for(const o of y)await this.sequelize.query(`${o};`,E({raw:!0},s))}async changeColumn(r,i,s,a){a=a||{};const d=await this.describeTable(r,a);Object.assign(d[i],this.normalizeAttribute(s));const o=this.queryGenerator.removeColumnQuery(r,d).split(";").filter(p=>p!=="");for(const p of o)await this.sequelize.query(`${p};`,E({raw:!0},a))}async renameColumn(r,i,s,a){a=a||{};const d=await this.assertTableHasColumn(r,i,a);d[s]=E({},d[i]),delete d[i];const o=this.queryGenerator.renameColumnQuery(r,i,s,d).split(";").filter(p=>p!=="");for(const p of o)await this.sequelize.query(`${p};`,E({raw:!0},a))}async removeConstraint(r,i,s){let a;const y=(await this.showConstraint(r,i)).find(h=>h.constraintName===i);if(!y)throw new R.UnknownConstraintError({message:`Constraint ${i} on table ${r} does not exist`,constraint:i,table:r});a=y.sql,y.constraintName=this.queryGenerator.quoteIdentifier(y.constraintName);let o=`, CONSTRAINT ${y.constraintName} ${y.constraintType} ${y.constraintCondition}`;if(y.constraintType==="FOREIGN KEY"){const h=this.queryGenerator.quoteTable(y.referenceTableName);y.referenceTableKeys=y.referenceTableKeys.map(I=>this.queryGenerator.quoteIdentifier(I));const A=y.referenceTableKeys.join(", ");o+=` REFERENCES ${h} (${A})`,o+=` ON UPDATE ${y.updateAction}`,o+=` ON DELETE ${y.deleteAction}`}a=a.replace(o,""),a+=";";const p=await this.describeTable(r,s),u=this.queryGenerator._alterConstraintQuery(r,p,a).split(";").filter(h=>h!=="");for(const h of u)await this.sequelize.query(`${h};`,E({raw:!0},s))}async addConstraint(r,i){if(!i.fields)throw new Error("Fields must be specified through options.fields");if(!i.type)throw new Error("Constraint type must be specified through options.type");i=g(i);const s=this.queryGenerator.getConstraintSnippet(r,i),a=this.queryGenerator.describeCreateTableQuery(r);let y=(await this.sequelize.query(a,w(E({},i),{type:_.SELECT,raw:!0})))[0].sql;const o=y.length-1,p=`${y.substr(0,o)}, ${s})${y.substr(o+1)};`,b=await this.describeTable(r,i);y=this.queryGenerator._alterConstraintQuery(r,b,p);const u=y.split(";").filter(h=>h!=="");for(const h of u)await this.sequelize.query(`${h};`,E({raw:!0},i))}async getForeignKeyReferencesForTable(r,i){const s=this.sequelize.config.database,a=this.queryGenerator.getForeignKeysQuery(r,s);return(await this.sequelize.query(a,i)).map(y=>({tableName:r,columnName:y.from,referencedTableName:y.table,referencedColumnName:y.to,tableCatalog:s,referencedTableCatalog:s}))}async dropAllTables(r){r=r||{};const i=r.skip||[],s=await this.showAllTables(r);await this.sequelize.query("PRAGMA foreign_keys = OFF",r),await this._dropAllTables(s,i,r),await this.sequelize.query("PRAGMA foreign_keys = ON",r)}async describeTable(r,i){let s=null,a=null;typeof i=="string"?s=i:typeof i=="object"&&i!==null&&(s=i.schema||null,a=i.schemaDelimiter||null),typeof r=="object"&&r!==null&&(s=r.schema,r=r.tableName);const d=this.queryGenerator.describeTableQuery(r,s,a);i=w(E({},i),{type:_.DESCRIBE});const y=this.queryGenerator.showIndexesQuery(r);try{const o=await this.sequelize.query(d,i);if(N.isEmpty(o))throw new Error(`No description found for "${r}" table. Check the table name and schema; remember, they _are_ case sensitive.`);const p=await this.sequelize.query(y,i);for(const u in o)o[u].unique=!1;for(const u of p)for(const h of u.fields)u.unique!==void 0&&(o[h.attribute].unique=u.unique);const b=await this.getForeignKeyReferencesForTable(r,i);for(const u of b)o[u.columnName].references={model:u.referencedTableName,key:u.referencedColumnName};return o}catch(o){throw o.original&&o.original.code==="ER_NO_SUCH_TABLE"?new Error(`No description found for "${r}" table. Check the table name and schema; remember, they _are_ case sensitive.`):o}}}return hs.SQLiteQueryInterface=c,hs}var hn;function wu(){if(hn)return Dt.exports;hn=1;const S=re,e=Xe(),t=Ou(),n=bu(),f=Tu(),O=he().sqlite,{SQLiteQueryInterface:T}=Nu();class E extends e{constructor(R){super(),this.sequelize=R,this.connectionManager=new t(this,R),this.queryGenerator=new f({_dialect:this,sequelize:R}),this.queryInterface=new T(R,this.queryGenerator)}}return E.prototype.supports=S.merge(S.cloneDeep(e.prototype.supports),{DEFAULT:!1,"DEFAULT VALUES":!0,"UNION ALL":!1,"RIGHT JOIN":!1,inserts:{ignoreDuplicates:" OR IGNORE",updateOnDuplicate:" ON CONFLICT DO UPDATE SET",conflictFields:!0,onConflictWhere:!0},index:{using:!1,where:!0,functionBased:!0},transactionOptions:{type:!0},constraints:{addConstraint:!1,dropConstraint:!1},groupedLimit:!1,JSON:!0}),E.prototype.defaultVersion="3.8.0",E.prototype.Query=n,E.prototype.DataTypes=O,E.prototype.name="sqlite",E.prototype.TICK_CHAR="`",E.prototype.TICK_CHAR_LEFT=E.prototype.TICK_CHAR,E.prototype.TICK_CHAR_RIGHT=E.prototype.TICK_CHAR,Dt.exports=E,Dt.exports.SqliteDialect=E,Dt.exports.default=E,Dt.exports}var Pt={exports:{}},fn;function Iu(){if(fn)return Pt.exports;fn=1;const S=Ze(),e=ce,{logger:t}=ge,n=he().db2,f=t.debugContext("connection:db2"),O=je()("db2");class T extends S{constructor(w,R){R.config.port=R.config.port||3306,super(w,R),this.lib=this._loadDialectModule("ibm_db"),this.refreshTypeParser(n)}static _typecast(w,R){return O.get(w.type)?O.get(w.type)(w,this.sequelize.options,R):R()}_refreshTypeParser(w){O.refresh(w)}_clearTypeParser(){O.clear()}async connect(w){const R={database:w.database,hostname:w.host,port:w.port,uid:w.username,pwd:w.password};if(w.ssl&&(R.security=w.ssl),w.sslcertificate&&(R.SSLServerCertificate=w.sslcertificate),w.dialectOptions)for(const _ of Object.keys(w.dialectOptions))R[_]=w.dialectOptions[_];try{return await new Promise((m,g)=>{const N=new this.lib.Database;N.lib=this.lib,N.open(R,c=>c?c.message&&c.message.includes("SQL30081N")?g(new e.ConnectionRefusedError(c)):g(new e.ConnectionError(c)):m(N))})}catch(_){throw new e.ConnectionError(_)}}disconnect(w){return w.connected&&w.close(R=>{f(R||"connection closed")}),Promise.resolve()}validate(w){return w&&w.connected}_disconnect(w){return this.dialect.connectionManager.disconnect(w)}}return Pt.exports=T,Pt.exports.ConnectionManager=T,Pt.exports.default=T,Pt.exports}var vt={exports:{}},dn;function Su(){if(dn)return vt.exports;dn=1;const S=Ae,e=et(),t=ce,n=je()("db2"),f=re,{logger:O}=ge,T=ze,E=O.debugContext("sql:db2");class w extends e{getInsertIdField(){return"id"}getSQLTypeFromJsType(_){return Buffer.isBuffer(_)?{ParamType:"INPUT",DataType:"BLOB",Data:_}:typeof _=="bigint"?_.toString():_}async _run(_,m,g){this.sql=m;const N=this.sequelize.options.benchmark||this.options.benchmark;let c;N?c=Date.now():this.sequelize.log(`Executing (${this.connection.uuid||"default"}): ${this.sql}`,this.options);const l=new Error().stack;return new Promise((r,i)=>{if(f.startsWith(this.sql,"BEGIN TRANSACTION"))_.beginTransaction(s=>{s?i(this.formatError(s,l)):r(this.formatResults())});else if(f.startsWith(this.sql,"COMMIT TRANSACTION"))_.commitTransaction(s=>{s?i(this.formatError(s,l)):r(this.formatResults())});else if(f.startsWith(this.sql,"ROLLBACK TRANSACTION"))_.rollbackTransaction(s=>{s?i(this.formatError(s,l)):r(this.formatResults())});else if(f.startsWith(this.sql,"SAVE TRANSACTION"))_.commitTransaction(s=>{s?i(this.formatError(s,l)):_.beginTransaction(a=>{a?i(this.formatError(a,l)):r(this.formatResults())})},this.options.transaction.name);else{const s=[];g&&f.forOwn(g,(y,o)=>{const p=this.getSQLTypeFromJsType(y,o);s.push(p)});const a=this.sql.toUpperCase();let d=this.sql;(this.isSelectQuery()||f.startsWith(a,"SELECT "))&&a.indexOf(" FROM ",8)===-1&&(this.sql.charAt(this.sql.length-1)===";"&&(d=this.sql.slice(0,this.sql.length-1)),d+=" FROM SYSIBM.SYSDUMMY1;"),_.prepare(d,(y,o)=>{y&&i(this.formatError(y,l)),o.execute(s,(p,b,u)=>{if(E(`executed(${this.connection.uuid||"default"}):${d} ${g?S.inspect(g,{compact:!0,breakLength:1/0}):""}`),N&&this.sequelize.log(`Executed (${this.connection.uuid||"default"}): ${d} ${g?S.inspect(g,{compact:!0,breakLength:1/0}):""}`,Date.now()-c,this.options),p&&p.message&&(p=this.filterSQLError(p,this.sql,_),p===null&&(o.closeSync(),r(this.formatResults([],0)))),p)p.sql=m,o.closeSync(),i(this.formatError(p,l,_,g));else{let h=[],A=[],I=0;typeof b=="object"&&(f.startsWith(this.sql,"DELETE FROM ")?I=b.getAffectedRowsSync():(h=b.fetchAllSync(),A=b.getColumnMetadataSync()),b.closeSync()),o.closeSync();const q=h.length;if(q>0){const L={};for(let D=0;D<A.length;D++)L[A[D].SQL_DESC_NAME]=A[D].SQL_DESC_TYPE_NAME;for(let D=0;D<q;D++)for(const C in h[D]){const $=n.get(L[C]),P=h[D][C];P!==null&&($?h[D][C]=$(P):L[C]==="TIMESTAMP"?h[D][C]=new Date(T.utc(P)):L[C]==="BLOB"?h[D][C]=new Buffer.from(P):L[C].indexOf("FOR BIT DATA")>0&&(h[D][C]=new Buffer.from(P,"hex")))}u&&u.length&&h.unshift(u),r(this.formatResults(h,q,A,_))}else r(this.formatResults(h,I))}})})}})}async run(_,m){return await this._run(this.connection,_,m)}static formatBindParameters(_,m,g){let N={};const c=(l,r,i)=>{if(i[r]!==void 0)return N[r]=i[r],"?"};return _=e.formatBindParameters(_,m,g,c)[0],Array.isArray(m)&&typeof m[0]=="object"&&(N=m),[_,N]}filterSQLError(_,m,g){if(_.message.search("SQL0204N")!=-1&&f.startsWith(m,"DROP "))_=null;else if(_.message.search("SQL0443N")!=-1)this.isDropSchemaQuery()&&(g.querySync("DROP TABLE ERRORSCHEMA.ERRORTABLE;"),g.querySync(this.sql)),_=null;else if(_.message.search("SQL0601N")!=-1){const N=_.message.match(/SQL0601N {2}The name of the object to be created is identical to the existing name "(.*)" of type "(.*)"./);if(N&&N.length>1&&N[2]==="TABLE"){let c;const l=N[1].split(".");l[1]?c=`"${l[0]}"."${l[1]}"`:c=`"${l[0]}"`,g.dropTable!==!1?(g.querySync(`DROP TABLE ${c}`),_=g.querySync(m)):_=null}else _=null}else _.message.search("SQL0911N")!=-1?_.message.search('Reason code "2"')!=-1&&(_=null):_.message.search("SQL0605W")!=-1?_=null:_.message.search("SQL0668N")!=-1&&f.startsWith(m,"ALTER TABLE ")&&(g.querySync(`CALL SYSPROC.ADMIN_CMD('REORG TABLE ${m.substring(12).split(" ")[0]}')`),_=g.querySync(m));return _&&_.length===0&&(_=null),_}formatResults(_,m,g,N){let c=this.instance;if(this.isInsertQuery(_,g)&&(this.handleInsertQuery(_,g),!this.instance))if(this.options.plain){const l=_[0];c=l[Object.keys(l)[0]]}else c=_;if(this.isShowTablesQuery())c=_;else if(this.isDescribeQuery()){c={};for(const l of _)l.Default&&(l.Default=l.Default.replace("('","").replace("')","").replace(/'/g,"")),c[l.Name]={type:l.Type.toUpperCase(),allowNull:l.IsNull==="Y",defaultValue:l.Default,primaryKey:l.KeySeq>0,autoIncrement:l.IsIdentity==="Y",comment:l.Comment}}else this.isShowIndexesQuery()?c=this.handleShowIndexesQuery(_):this.isSelectQuery()?c=this.handleSelectQuery(_):this.isUpsertQuery()?c=_:this.isDropSchemaQuery()?(c=_[0],N&&N.querySync("DROP TABLE ERRORSCHEMA.ERRORTABLE")):this.isCallQuery()?c=_:this.isBulkUpdateQuery()?c=_.length:this.isBulkDeleteQuery()?c=m:this.isVersionQuery()?c=_[0].VERSION:this.isForeignKeysQuery()?c=_:this.isInsertQuery()||this.isUpdateQuery()?c=[c,m]:this.isShowConstraintsQuery()?c=this.handleShowConstraintsQuery(_):this.isRawQuery()?c=[_,g]:c=_;return c}handleShowTablesQuery(_){return _.map(m=>({tableName:m.TABLE_NAME,schema:m.TABLE_SCHEMA}))}handleShowConstraintsQuery(_){return f.remove(_,m=>!f.startsWith(m.constraintName,"SQL"))}formatError(_,m,g,N){let c;if(_&&_.message||(_.message="No error message found."),c=_.message.match(/SQL0803N {2}One or more values in the INSERT statement, UPDATE statement, or foreign key update caused by a DELETE statement are not valid because the primary key, unique constraint or unique index identified by "(\d)+" constrains table "(.*)\.(.*)" from having duplicate values for the index key./),c&&c.length>0){let l="",r="";const i={};let s=_.message;const a=`SELECT INDNAME FROM SYSCAT.INDEXES  WHERE IID = ${c[1]} AND TABSCHEMA = '${c[2]}' AND TABNAME = '${c[3]}'`;g&&c.length>3&&(l=g.querySync(a),l=l[0].INDNAME),this.model&&l&&(r=this.model.uniqueKeys[l]),!r&&this.options.fields&&(r=this.options.fields[c[1]-1]),r&&(this.options.where&&this.options.where[r.column]!==void 0?i[r.column]=this.options.where[r.column]:this.options.instance&&this.options.instance.dataValues&&this.options.instance.dataValues[r.column]?i[r.column]=this.options.instance.dataValues[r.column]:N&&(i[r.column]=N[0])),r&&r.msg&&(s=r.msg);const d=[];return f.forOwn(i,(y,o)=>{d.push(new t.ValidationErrorItem(this.getUniqueConstraintErrorMessage(o),"unique violation",o,y,this.instance,"not_unique"))}),new t.UniqueConstraintError({message:s,errors:d,parent:_,fields:i,stack:m})}if(c=_.message.match(/SQL0532N {2}A parent row cannot be deleted because the relationship "(.*)" restricts the deletion/)||_.message.match(/SQL0530N/)||_.message.match(/SQL0531N/),c&&c.length>0)return new t.ForeignKeyConstraintError({fields:null,index:c[1],parent:_,stack:m});if(c=_.message.match(/SQL0204N {2}"(.*)" is an undefined name./),c&&c.length>1){const l=c[1];let r=_.sql.match(/table "(.+?)"/i);return r=r?r[1]:void 0,new t.UnknownConstraintError({message:c[0],constraint:l,table:r,parent:_,stack:m})}return new t.DatabaseError(_,{stack:m})}isDropSchemaQuery(){let _=!1;return f.startsWith(this.sql,"CALL SYSPROC.ADMIN_DROP_SCHEMA")&&(_=!0),_}isShowOrDescribeQuery(){let _=!1;return _=_||this.sql.toLowerCase().startsWith("select c.column_name as 'name', c.data_type as 'type', c.is_nullable as 'isnull'"),_=_||this.sql.toLowerCase().startsWith("select tablename = t.name, name = ind.name,"),_=_||this.sql.toLowerCase().startsWith("exec sys.sp_helpindex @objname"),_}isShowIndexesQuery(){let _=!1;return _=_||this.sql.toLowerCase().startsWith("exec sys.sp_helpindex @objname"),_=_||this.sql.startsWith('SELECT NAME AS "name", TBNAME AS "tableName", UNIQUERULE AS "keyType", COLNAMES, INDEXTYPE AS "type" FROM SYSIBM.SYSINDEXES'),_}handleShowIndexesQuery(_){let m;const g=[];return _.forEach(N=>{(!m||m.name!==N.Key_name)&&(m={primary:N.keyType==="P",fields:[],name:N.name,tableName:N.tableName,unique:N.keyType==="U",type:N.type},f.forEach(N.COLNAMES.replace(/\+|-/g,c=>` ${c}`).split(" "),c=>{let l=c.trim();l&&(l=l.replace(/\+|-/,""),m.fields.push({attribute:l,length:void 0,order:c.indexOf("-")===-1?"ASC":"DESC",collate:void 0}))}),g.push(m))}),g}handleInsertQuery(_,m){if(this.instance){const g=this.model.autoIncrementAttribute;let N=null,c=null;Object.prototype.hasOwnProperty.call(this.model.rawAttributes,g)&&this.model.rawAttributes[g].field!==void 0&&(c=this.model.rawAttributes[g].field),N=N||_&&_[0][this.getInsertIdField()],N=N||m&&m[this.getInsertIdField()],N=N||_&&_[0][g],N=N||c&&_&&_[0][c],this.instance[g]=N}}}return vt.exports=w,vt.exports.Query=w,vt.exports.default=w,vt.exports}var fs,pn;function Ru(){if(pn)return fs;pn=1;var S=Object.defineProperty,e=Object.defineProperties,t=Object.getOwnPropertyDescriptors,n=Object.getOwnPropertySymbols,f=Object.prototype.hasOwnProperty,O=Object.prototype.propertyIsEnumerable,T=(s,a,d)=>a in s?S(s,a,{enumerable:!0,configurable:!0,writable:!0,value:d}):s[a]=d,E=(s,a)=>{for(var d in a||(a={}))f.call(a,d)&&T(s,d,a[d]);if(n)for(var d of n(a))O.call(a,d)&&T(s,d,a[d]);return s},w=(s,a)=>e(s,t(a));const R=re,_=fe(),m=he(),g=ut(),N=Ae.randomBytes,c=Re,l=function(s){throw new Error(`The method "${s}" is not defined! Please add it to your sql dialect.`)};class r extends g{constructor(a){super(a),this.OperatorMap=w(E({},this.OperatorMap),{[c.regexp]:"REGEXP_LIKE",[c.notRegexp]:"NOT REGEXP_LIKE"}),this.autoGenValue=1}createSchema(a){return["CREATE SCHEMA",this.quoteIdentifier(a),";"].join(" ")}dropSchema(a){const y={query:`CALL SYSPROC.ADMIN_DROP_SCHEMA(${i(a.trim())}, NULL, ? , ?)`};return y.bind=[{ParamType:"INOUT",Data:"ERRORSCHEMA"},{ParamType:"INOUT",Data:"ERRORTABLE"}],y}showSchemasQuery(){return`SELECT SCHEMANAME AS "schema_name" FROM SYSCAT.SCHEMATA WHERE (SCHEMANAME NOT LIKE 'SYS%') AND SCHEMANAME NOT IN ('NULLID', 'SQLJ', 'ERRORSCHEMA')`}versionQuery(){return"select service_level as VERSION from TABLE (sysproc.env_get_inst_info()) as A"}createTableQuery(a,d,y){const o="CREATE TABLE <%= table %> (<%= attributes %>)",p=[],b={},u=[],h=" -- <%= comment %>, TableName = <%= table %>, ColumnName = <%= column %>;";let A="";for(const L in d)if(Object.prototype.hasOwnProperty.call(d,L)){let D=d[L],C;if(D.includes("COMMENT ")){const $=D.match(/^(.+) (COMMENT.*)$/);if($&&$.length>2){const P=$[2].replace(/COMMENT/,"").trim();A+=R.template(h,this._templateSettings)({table:this.quoteIdentifier(a),comment:this.escape(P),column:this.quoteIdentifier(L)}),D=$[1]}}if(R.includes(D,"PRIMARY KEY"))p.push(L),R.includes(D,"REFERENCES")?(C=D.match(/^(.+) (REFERENCES.*)$/),u.push(`${this.quoteIdentifier(L)} ${C[1].replace(/PRIMARY KEY/,"")}`),b[L]=C[2]):u.push(`${this.quoteIdentifier(L)} ${D.replace(/PRIMARY KEY/,"")}`);else if(R.includes(D,"REFERENCES"))C=D.match(/^(.+) (REFERENCES.*)$/),u.push(`${this.quoteIdentifier(L)} ${C[1]}`),b[L]=C[2];else{if(y&&y.uniqueKeys){for(const $ in y.uniqueKeys)if(y.uniqueKeys[$].fields.includes(L)&&!R.includes(D,"NOT NULL")){D+=" NOT NULL";break}}u.push(`${this.quoteIdentifier(L)} ${D}`)}}const I={table:this.quoteTable(a),attributes:u.join(", ")},q=p.map(L=>this.quoteIdentifier(L)).join(", ");y&&y.uniqueKeys&&R.each(y.uniqueKeys,(L,D)=>{L.customIndex&&(R.isString(D)||(D=`uniq_${a}_${L.fields.join("_")}`),I.attributes+=`, CONSTRAINT ${this.quoteIdentifier(D)} UNIQUE (${L.fields.map(C=>this.quoteIdentifier(C)).join(", ")})`)}),q.length>0&&(I.attributes+=`, PRIMARY KEY (${q})`);for(const L in b)Object.prototype.hasOwnProperty.call(b,L)&&(I.attributes+=`, FOREIGN KEY (${this.quoteIdentifier(L)}) ${b[L]}`);return`${R.template(o,this._templateSettings)(I).trim()};${A}`}describeTableQuery(a,d){let y=['SELECT NAME AS "Name", TBNAME AS "Table", TBCREATOR AS "Schema",','TRIM(COLTYPE) AS "Type", LENGTH AS "Length", SCALE AS "Scale",','NULLS AS "IsNull", DEFAULT AS "Default", COLNO AS "Colno",','IDENTITY AS "IsIdentity", KEYSEQ AS "KeySeq", REMARKS AS "Comment"',"FROM","SYSIBM.SYSCOLUMNS","WHERE TBNAME =",i(a)].join(" ");return d?y+=` AND TBCREATOR =${i(d)}`:y+=" AND TBCREATOR = USER",`${y};`}renameTableQuery(a,d){return R.template("RENAME TABLE <%= before %> TO <%= after %>;",this._templateSettings)({before:this.quoteTable(a),after:this.quoteTable(d)})}showTablesQuery(){return`SELECT TABNAME AS "tableName", TRIM(TABSCHEMA) AS "tableSchema" FROM SYSCAT.TABLES WHERE TABSCHEMA = USER AND TYPE = 'T' ORDER BY TABSCHEMA, TABNAME`}tableExistsQuery(a){const d=a.tableName||a,y=a.schema||this.sequelize.config.username.toUpperCase();return`SELECT name FROM sysibm.systables WHERE NAME = ${i(d)} AND CREATOR = ${i(y)}`}dropTableQuery(a){const d="DROP TABLE <%= table %>",y={table:this.quoteTable(a)};return`${R.template(d,this._templateSettings)(y).trim()};`}addColumnQuery(a,d,y){y.field=d;const o="ALTER TABLE <%= table %> ADD <%= attribute %>;",p=R.template("<%= key %> <%= definition %>",this._templateSettings)({key:this.quoteIdentifier(d),definition:this.attributeToSQL(y,{context:"addColumn"})});return R.template(o,this._templateSettings)({table:this.quoteTable(a),attribute:p})}removeColumnQuery(a,d){return R.template("ALTER TABLE <%= tableName %> DROP COLUMN <%= attributeName %>;",this._templateSettings)({tableName:this.quoteTable(a),attributeName:this.quoteIdentifier(d)})}changeColumnQuery(a,d){const y="ALTER TABLE <%= tableName %> <%= query %>;",o=[],p=[];for(const u in d){const h=d[u];let A=[h];Array.isArray(h)&&(A=h);for(let I=0;I<A.length;I++){const q=A[I];q.match(/REFERENCES/)?p.push(R.template("<%= fkName %> FOREIGN KEY (<%= attrName %>) <%= definition %>",this._templateSettings)({fkName:this.quoteIdentifier(`${u}_foreign_idx`),attrName:this.quoteIdentifier(u),definition:q.replace(/.+?(?=REFERENCES)/,"")})):R.startsWith(q,"DROP ")?o.push(R.template("<%= attrName %> <%= definition %>",this._templateSettings)({attrName:this.quoteIdentifier(u),definition:q})):o.push(R.template("<%= attrName %> SET <%= definition %>",this._templateSettings)({attrName:this.quoteIdentifier(u),definition:q}))}}let b="";return o.length&&(b+=`ALTER COLUMN ${o.join(" ALTER COLUMN ")}`,b+=p.length?" ":""),p.length&&(b+=`ADD CONSTRAINT ${p.join(" ADD CONSTRAINT ")}`),R.template(y,this._templateSettings)({tableName:this.quoteTable(a),query:b})}renameColumnQuery(a,d,y){const o="ALTER TABLE <%= tableName %> RENAME COLUMN <%= before %> TO <%= after %>;",p=Object.keys(y)[0];return R.template(o,this._templateSettings)({tableName:this.quoteTable(a),before:this.quoteIdentifier(d),after:this.quoteIdentifier(p)})}addConstraintQuery(a,d){d=d||{},d.onUpdate&&d.onUpdate.toUpperCase()==="CASCADE"&&delete d.onUpdate;const y=this.getConstraintSnippet(a,d);return typeof a=="string"?a=this.quoteIdentifiers(a):a=this.quoteTable(a),`ALTER TABLE ${a} ADD ${y};`}bulkInsertQuery(a,d,y,o){y=y||{},o=o||{};let p="INSERT INTO <%= table %> (<%= attributes %>)<%= output %> VALUES <%= tuples %>;";y.returning&&(p="SELECT * FROM FINAL TABLE( INSERT INTO <%= table %> (<%= attributes %>)<%= output %> VALUES <%= tuples %>);");const b="INSERT INTO <%= table %>",u=[],h=[],A=[];let I;const q=[];y.returning&&(I=""),R.forEach(d,C=>{const $=Object.keys(C),P=o[$[0]];if($.length===1&&P&&P.autoIncrement&&C[$[0]]===null){q.push(`(${this.autoGenValue++})`);return}R.forOwn(C,(Q,j)=>{if(h.indexOf(j)===-1){if(Q===null&&o[j]&&o[j].autoIncrement)return;h.push(j)}})}),q.length>0&&A.push(`${b} VALUES ${q.join(",")}`),h.length>0&&(R.forEach(d,C=>{u.push(`(${h.map($=>this.escape(C[$]),void 0,{context:"INSERT"}).join(",")})`)}),A.push(p));const L={table:this.quoteTable(a),attributes:h.map(C=>this.quoteIdentifier(C)).join(","),tuples:u,output:I};return R.template(A.join(";"),this._templateSettings)(L)}updateQuery(a,d,y,o,p){const b=super.updateQuery(a,d,y,o,p);if(o=o||{},R.defaults(o,this.options),!o.limit)return b.query=`SELECT * FROM FINAL TABLE (${b.query});`,b;d=_.removeNullValuesFromHash(d,o.omitNull,o);const u={},h=[],A=[],I=o.bindParam||this.bindParam(A);p&&R.each(p,(D,C)=>{u[C]=D,D.field&&(u[D.field]=D)});for(const D in d){const C=d[D];C instanceof _.SequelizeMethod||o.bindParam===!1?h.push(`${this.quoteIdentifier(D)}=${this.escape(C,u&&u[D]||void 0,{context:"UPDATE"})}`):h.push(`${this.quoteIdentifier(D)}=${this.format(C,u&&u[D]||void 0,{context:"UPDATE"},I)}`)}let q;const L=R.defaults({bindParam:I},o);return q=`UPDATE (SELECT * FROM ${this.quoteTable(a)} ${this.whereQuery(y,L)} FETCH NEXT ${this.escape(o.limit)} ROWS ONLY) SET ${h.join(",")}`,q=`SELECT * FROM FINAL TABLE (${q});`,{query:q,bind:A}}upsertQuery(a,d,y,o,p){const b=this.quoteTable(`${a}_target`),u=this.quoteTable(`${a}_source`),h=[],A=[],I=[],q=this.quoteTable(a);for(const H in p.rawAttributes)p.rawAttributes[H].primaryKey&&h.push(p.rawAttributes[H].field||H),p.rawAttributes[H].unique&&I.push(p.rawAttributes[H].field||H),p.rawAttributes[H].autoIncrement&&A.push(p.rawAttributes[H].field||H);for(const H of p._indexes)if(H.unique&&H.fields)for(const W of H.fields){const se=typeof W=="string"?W:W.name||W.attribute;I.indexOf(se)===-1&&p.rawAttributes[se]&&I.push(se)}const L=Object.keys(y),D=Object.keys(d),C=D.map(H=>this.quoteIdentifier(H)).join(", "),$=D.map(H=>this.escape(d[H])).join(", "),P=`VALUES(${$})`;let Q;const j=o[c.or].filter(H=>{let W=!0;for(const se in H)if(!H[se]){W=!1;break}return W}),B=H=>H.map(W=>(W=this.quoteIdentifier(W),`${b}.${W} = ${u}.${W}`));if(j.length===0)throw new Error("Primary Key or Unique key should be passed to upsert query");for(const H in j){const W=Object.keys(j[H]);if(h.indexOf(W[0])!==-1){Q=B(h).join(" AND ");break}}Q||(Q=B(I).join(" AND "));const F=L.filter(H=>A.indexOf(H)===-1).map(H=>{const W=this.escape(y[H]);return H=this.quoteIdentifier(H),`${b}.${H} = ${W}`}).join(", "),x=F.length>0?`WHEN MATCHED THEN UPDATE SET ${F}`:"",k=`(${C}) VALUES(${$})`;let X=`MERGE INTO ${q} AS ${b} USING (${P}) AS ${u}(${C}) ON ${Q}`;return X+=` ${x} WHEN NOT MATCHED THEN INSERT ${k};`,X}truncateTableQuery(a){return`TRUNCATE TABLE ${this.quoteTable(a)} IMMEDIATE`}deleteQuery(a,d,y={},o){const p=this.quoteTable(a),b="DELETE FROM <%= table %><%= where %><%= limit %>";d=this.getWhereConditions(d,null,o,y);let u="";y.offset>0&&(u=` OFFSET ${this.escape(y.offset)} ROWS`),y.limit&&(u+=` FETCH NEXT ${this.escape(y.limit)} ROWS ONLY`);const h={limit:u,table:p,where:d};return h.where&&(h.where=` WHERE ${h.where}`),R.template(b,this._templateSettings)(h)}showIndexesQuery(a){let d='SELECT NAME AS "name", TBNAME AS "tableName", UNIQUERULE AS "keyType", COLNAMES, INDEXTYPE AS "type" FROM SYSIBM.SYSINDEXES WHERE TBNAME = <%= tableName %>',y;return R.isObject(a)&&(y=a.schema,a=a.tableName),y&&(d=`${d} AND TBCREATOR = <%= schemaName %>`),d=`${d} ORDER BY NAME;`,R.template(d,this._templateSettings)({tableName:i(a),schemaName:i(y)})}showConstraintsQuery(a,d){let y=`SELECT CONSTNAME AS "constraintName", TRIM(TABSCHEMA) AS "schemaName", TABNAME AS "tableName" FROM SYSCAT.TABCONST WHERE TABNAME = '${a}'`;return d&&(y+=` AND CONSTNAME LIKE '%${d}%'`),`${y} ORDER BY CONSTNAME;`}removeIndexQuery(a,d){const y="DROP INDEX <%= indexName %>";let o=d;typeof o!="string"&&(o=_.underscore(`${a}_${d.join("_")}`));const p={tableName:this.quoteIdentifiers(a),indexName:this.quoteIdentifiers(o)};return R.template(y,this._templateSettings)(p)}attributeToSQL(a,d){R.isPlainObject(a)||(a={type:a});let y,o=1;if(a.type instanceof m.ENUM?(a.type.values&&!a.values&&(a.values=a.type.values),y=a.type.toSql(),y+=` CHECK (${this.quoteIdentifier(a.field)} IN(${a.values.map(p=>this.escape(p)).join(", ")}))`):y=a.type.toString(),d&&d.context==="changeColumn"&&a.type?y=`DATA TYPE ${y}`:(a.allowNull===!1||a.primaryKey===!0||a.unique)&&(y+=" NOT NULL",o=0),a.autoIncrement){let p=1;a.initialAutoIncrement&&(p=a.initialAutoIncrement),y+=` GENERATED BY DEFAULT AS IDENTITY(START WITH ${p}, INCREMENT BY 1)`}if(a.type!=="TEXT"&&a.type._binary!==!0&&_.defaultValueSchemable(a.defaultValue)&&(y+=` DEFAULT ${this.escape(a.defaultValue)}`),a.unique===!0&&(y+=" UNIQUE"),a.primaryKey&&(y+=" PRIMARY KEY"),(!d||!d.withoutForeignKeyConstraints)&&a.references){if(d&&d.context==="addColumn"&&d.foreignKey){const p=this.quoteIdentifier(d.foreignKey),b=`${d.tableName}_${p}_fidx`;y+=`, CONSTRAINT ${b} FOREIGN KEY (${p})`}y+=` REFERENCES ${this.quoteTable(a.references.model)}`,a.references.key?y+=` (${this.quoteIdentifier(a.references.key)})`:y+=` (${this.quoteIdentifier("id")})`,a.onDelete&&(y+=` ON DELETE ${a.onDelete.toUpperCase()}`),a.onUpdate&&a.onUpdate.toUpperCase()!="CASCADE"&&(y+=` ON UPDATE ${a.onUpdate.toUpperCase()}`)}return d&&d.context==="changeColumn"&&o===1&&a.allowNull!==void 0&&(y=[y],a.allowNull?y.push("DROP NOT NULL"):y.push("NOT NULL")),a.comment&&typeof a.comment=="string"&&(y+=` COMMENT ${a.comment}`),y}attributesToSQL(a,d){const y={},o=[];let p,b;for(p in a)b=a[p],b.references&&(o.indexOf(b.references.model.toString())!==-1||b.unique&&b.unique===!0?(b.onDelete="",b.onUpdate=""):o.push(b.references.model.toString())),p&&!b.field&&typeof b=="object"&&(b.field=p),y[b.field||p]=this.attributeToSQL(b,d);return y}createTrigger(){l("createTrigger")}dropTrigger(){l("dropTrigger")}renameTrigger(){l("renameTrigger")}createFunction(){l("createFunction")}dropFunction(){l("dropFunction")}renameFunction(){l("renameFunction")}_getForeignKeysQuerySQL(a){return`SELECT R.CONSTNAME AS "constraintName", TRIM(R.TABSCHEMA) AS "constraintSchema", R.TABNAME AS "tableName", TRIM(R.TABSCHEMA) AS "tableSchema", LISTAGG(C.COLNAME,', ') WITHIN GROUP (ORDER BY C.COLNAME) AS "columnName", TRIM(R.REFTABSCHEMA) AS "referencedTableSchema", R.REFTABNAME AS "referencedTableName", TRIM(R.PK_COLNAMES) AS "referencedColumnName" FROM SYSCAT.REFERENCES R, SYSCAT.KEYCOLUSE C WHERE R.CONSTNAME = C.CONSTNAME AND R.TABSCHEMA = C.TABSCHEMA AND R.TABNAME = C.TABNAME${a} GROUP BY R.REFTABSCHEMA, R.REFTABNAME, R.TABSCHEMA, R.TABNAME, R.CONSTNAME, R.PK_COLNAMES`}getForeignKeysQuery(a,d){const y=a.tableName||a;d=a.schema||d;let o="";return y&&(o=` AND R.TABNAME = ${i(y)}`),d&&(o+=` AND R.TABSCHEMA = ${i(d)}`),this._getForeignKeysQuerySQL(o)}getForeignKeyQuery(a,d){const y=a.tableName||a,o=a.schema;let p="";return y&&(p=` AND R.TABNAME = ${i(y)}`),o&&(p+=` AND R.TABSCHEMA = ${i(o)}`),d&&(p+=` AND C.COLNAME = ${i(d)}`),this._getForeignKeysQuerySQL(p)}getPrimaryKeyConstraintQuery(a,d){const y=i(a.tableName||a);return['SELECT TABNAME AS "tableName",','COLNAME AS "columnName",','CONSTNAME AS "constraintName"',"FROM SYSCAT.KEYCOLUSE WHERE CONSTNAME LIKE 'PK_%'",`AND COLNAME = ${i(d)}`,`AND TABNAME = ${y};`].join(" ")}dropForeignKeyQuery(a,d){return R.template("ALTER TABLE <%= table %> DROP <%= key %>",this._templateSettings)({table:this.quoteTable(a),key:this.quoteIdentifier(d)})}dropConstraintQuery(a,d){return R.template("ALTER TABLE <%= table %> DROP CONSTRAINT <%= constraint %>;",this._templateSettings)({table:this.quoteTable(a),constraint:this.quoteIdentifier(d)})}setAutocommitQuery(){return""}setIsolationLevelQuery(){}generateTransactionId(){return N(10).toString("hex")}startTransactionQuery(a){return a.parent?`SAVE TRANSACTION ${this.quoteIdentifier(a.name)};`:"BEGIN TRANSACTION;"}commitTransactionQuery(a){if(!a.parent)return"COMMIT TRANSACTION;"}rollbackTransactionQuery(a){return a.parent?`ROLLBACK TRANSACTION ${this.quoteIdentifier(a.name)};`:"ROLLBACK TRANSACTION;"}addLimitAndOffset(a){const d=a.offset||0;let y="";return d>0&&(y+=` OFFSET ${this.escape(d)} ROWS`),a.limit&&(y+=` FETCH NEXT ${this.escape(a.limit)} ROWS ONLY`),y}booleanValue(a){return a?1:0}addUniqueFields(a,d,y){y=y===void 0?1:y;for(const o in d)d[o].unique&&a[o]===void 0&&(d[o].type instanceof m.DATE?a[o]=_.now("db2"):d[o].type instanceof m.STRING?a[o]=`unique${y++}`:d[o].type instanceof m.INTEGER?a[o]=y++:d[o].type instanceof m.BOOLEAN&&(a[o]=new m.BOOLEAN(!1)));return y}quoteIdentifier(a,d){return _.addTicks(_.removeTicks(a,'"'),'"')}}function i(s){return s?`'${s}'`:""}return fs=r,fs}var ds={},yn;function qu(){if(yn)return ds;yn=1;var S=Object.defineProperty,e=Object.defineProperties,t=Object.getOwnPropertyDescriptors,n=Object.getOwnPropertySymbols,f=Object.prototype.hasOwnProperty,O=Object.prototype.propertyIsEnumerable,T=(l,r,i)=>r in l?S(l,r,{enumerable:!0,configurable:!0,writable:!0,value:i}):l[r]=i,E=(l,r)=>{for(var i in r||(r={}))f.call(r,i)&&T(l,i,r[i]);if(n)for(var i of n(r))O.call(r,i)&&T(l,i,r[i]);return l},w=(l,r)=>e(l,t(r));const R=re,_=fe(),m=Re,{QueryInterface:g}=He,N=Me;class c extends g{async getForeignKeyReferencesForTable(r,i){const s=w(E({},i),{type:N.FOREIGNKEYS}),a=this.queryGenerator.getForeignKeysQuery(r,this.sequelize.config.username.toUpperCase());return this.sequelize.query(a,s)}async upsert(r,i,s,a,d){d=E({},d);const y=d.model,o=[],p=Object.keys(i);let b=[],u;d=R.clone(d),_.isWhereEmpty(a)||o.push(a),b=R.map(y.uniqueKeys,I=>I.fields),y._indexes.forEach(I=>{I.unique&&(u=I.fields.map(q=>R.isPlainObject(q)?q.attribute:q),b.push(u))});for(const I of b)if(R.intersection(p,I).length===I.length){a={};for(const q of I)a[q]=i[q];o.push(a)}a={[m.or]:o},d.type=N.UPSERT,d.raw=!0;const h=this.queryGenerator.upsertQuery(r,i,s,a,y,d);return[await this.sequelize.query(h,d),void 0]}async createTable(r,i,s,a){let d="";return s=E({},s),s&&s.uniqueKeys&&R.forOwn(s.uniqueKeys,y=>{y.customIndex===void 0&&(y.customIndex=!0)}),a&&(s.uniqueKeys=s.uniqueKeys||a.uniqueKeys),i=R.mapValues(i,y=>this.sequelize.normalizeAttribute(y)),s.indexes&&s.indexes.forEach(y=>{const o=y.fields;o.length===1&&o.forEach(p=>{for(const b in i)p===i[b].field&&(i[b].unique=!0)})}),s.alter&&s.indexes&&s.indexes.forEach(y=>{const o=y.fields;o.length===1&&o.forEach(p=>{for(const b in i)p===i[b].field&&i[b].unique&&(i[b].unique=!1)})}),!r.schema&&(s.schema||a&&a._schema)&&(r=this.queryGenerator.addSchema({tableName:r,_schema:!!a&&a._schema||s.schema})),i=this.queryGenerator.attributesToSQL(i,{table:r,context:"createTable",withoutForeignKeyConstraints:s.withoutForeignKeyConstraints}),d=this.queryGenerator.createTableQuery(r,i,s),await this.sequelize.query(d,s)}}return ds.Db2QueryInterface=c,ds}var ps,mn;function Cu(){if(mn)return ps;mn=1;const S=re,e=Xe(),t=Iu(),n=Su(),f=Ru(),O=he().db2,{Db2QueryInterface:T}=qu();class E extends e{constructor(R){super(),this.sequelize=R,this.connectionManager=new t(this,R),this.queryGenerator=new f({_dialect:this,sequelize:R}),this.queryInterface=new T(R,this.queryGenerator)}}return E.prototype.supports=S.merge(S.cloneDeep(e.prototype.supports),{DEFAULT:!0,"DEFAULT VALUES":!1,"VALUES ()":!1,"LIMIT ON UPDATE":!1,"ORDER NULLS":!1,lock:!1,transactions:!0,migrations:!1,returnValues:!1,schemas:!0,finalTable:!0,autoIncrement:{identityInsert:!1,defaultValue:!1,update:!0},constraints:{restrict:!0,default:!1},index:{collate:!1,length:!1,parser:!1,type:!1,using:!1,where:!0},NUMERIC:!0,tmpTableTrigger:!0}),E.prototype.defaultVersion="1.0.0",E.prototype.Query=n,E.prototype.name="db2",E.prototype.TICK_CHAR='"',E.prototype.TICK_CHAR_LEFT='"',E.prototype.TICK_CHAR_RIGHT='"',E.prototype.DataTypes=O,ps=E,ps}var jt={exports:{}},En;function Lu(){if(En)return jt.exports;En=1;var S=Object.defineProperty,e=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,f=(N,c,l)=>c in N?S(N,c,{enumerable:!0,configurable:!0,writable:!0,value:l}):N[c]=l,O=(N,c)=>{for(var l in c||(c={}))t.call(c,l)&&f(N,l,c[l]);if(e)for(var l of e(c))n.call(c,l)&&f(N,l,c[l]);return N};const T=Ze(),E=ce,{logger:w}=ge,R=he().snowflake,_=w.debugContext("connection:snowflake"),m=je()("snowflake");class g extends T{constructor(c,l){l.config.port=l.config.port||3306,super(c,l),this.lib=this._loadDialectModule("snowflake-sdk"),this.refreshTypeParser(R)}_refreshTypeParser(c){m.refresh(c)}_clearTypeParser(){m.clear()}static _typecast(c,l){return m.get(c.type)?m.get(c.type)(c,this.sequelize.options,l):l()}async connect(c){const l=O({account:c.host,username:c.username,password:c.password,database:c.database,warehouse:c.warehouse,role:c.role},c.dialectOptions);try{const r=await new Promise((i,s)=>{this.lib.createConnection(l).connect((a,d)=>{a?(console.log(a),s(a)):i(d)})});if(_("connection acquired"),!this.sequelize.config.keepDefaultTimezone){const i=this.sequelize.options.timezone==="+00:00"?"Etc/UTC":this.sequelize.options.timezone;if(/\//.test(i))await new Promise((a,d)=>{r.execute({sqlText:`ALTER SESSION SET timezone = '${i}'`,complete(y){y?(console.log(y),d(y)):a()}})});else throw Error("only support time zone name for snowflake!")}return r}catch(r){switch(r.code){case"ECONNREFUSED":throw new E.ConnectionRefusedError(r);case"ER_ACCESS_DENIED_ERROR":throw new E.AccessDeniedError(r);case"ENOTFOUND":throw new E.HostNotFoundError(r);case"EHOSTUNREACH":throw new E.HostNotReachableError(r);case"EINVAL":throw new E.InvalidConnectionError(r);default:throw new E.ConnectionError(r)}}}async disconnect(c){if(!c.isUp()){_("connection tried to disconnect but was already at CLOSED state");return}return new Promise((l,r)=>{c.destroy(i=>{i?(console.error(`Unable to disconnect: ${i.message}`),r(i)):(console.log(`Disconnected connection with id: ${c.getId()}`),l(c.getId()))})})}validate(c){return c.isUp()}}return jt.exports=g,jt.exports.ConnectionManager=g,jt.exports.default=g,jt.exports}var xt={exports:{}},gn;function Du(){if(gn)return xt.exports;gn=1;const S=et(),e=ce,t=re,{logger:n}=ge,f=1062,O=1213,T=1451,E=1452,w=n.debugContext("sql:snowflake");class R extends S{static formatBindParameters(m,g,N){const c=[],l=(r,i,s)=>{if(s[i]!==void 0)return c.push(s[i]),"?"};return m=S.formatBindParameters(m,g,N,l)[0],[m,c.length>0?c:void 0]}async run(m,g){this.sql=m;const{connection:N,options:c}=this,l=this.sequelize.options.showWarnings||c.showWarnings,r=this._logQuery(m,w,g);g&&w("parameters(%j)",g);let i;try{i=await new Promise((s,a)=>{N.execute({sqlText:m,binds:g,complete(d,y,o){d?a(d):s(o)}})})}catch(s){if(c.transaction&&s.errno===O){try{await c.transaction.rollback()}catch{}c.transaction.finished="rollback"}throw s.sql=m,s.parameters=g,this.formatError(s)}finally{r()}return l&&i&&i.warningStatus>0&&await this.logWarnings(i),this.formatResults(i)}formatResults(m){let g=this.instance;if(this.isInsertQuery(m)&&(this.handleInsertQuery(m),!this.instance))if(m.constructor.name==="ResultSetHeader"&&this.model&&this.model.autoIncrementAttribute&&this.model.autoIncrementAttribute===this.model.primaryKeyAttribute&&this.model.rawAttributes[this.model.primaryKeyAttribute]){const N=m[this.getInsertIdField()];g=[];for(let c=N;c<N+m.affectedRows;c++)g.push({[this.model.rawAttributes[this.model.primaryKeyAttribute].field]:c})}else g=m[this.getInsertIdField()];if(this.isSelectQuery()){if(this.options.raw===!1&&this.sequelize.options.quoteIdentifiers===!1){const N=t.reduce(this.model.rawAttributes,(c,l,r)=>(c[r.toUpperCase()]=r,c),{});m=m.map(c=>t.reduce(c,(l,r,i)=>(r!==void 0&&N[i]&&(l[N[i]]=r,delete l[i]),l),c))}return this.options.fieldMap=t.mapKeys(this.options.fieldMap,(N,c)=>c.toUpperCase()),this.handleSelectQuery(m)}if(this.isShowTablesQuery())return this.handleShowTablesQuery(m);if(this.isDescribeQuery()){g={};for(const N of m)g[N.Field]={type:N.Type.toUpperCase(),allowNull:N.Null==="YES",defaultValue:N.Default,primaryKey:N.Key==="PRI",autoIncrement:Object.prototype.hasOwnProperty.call(N,"Extra")&&N.Extra.toLowerCase()==="auto_increment",comment:N.Comment?N.Comment:null};return g}return this.isShowIndexesQuery()?this.handleShowIndexesQuery(m):this.isCallQuery()?m[0]:this.isBulkUpdateQuery()||this.isBulkDeleteQuery()?m[0]["number of rows updated"]:this.isVersionQuery()?m[0].version:this.isForeignKeysQuery()?m:this.isUpsertQuery()?[g,m.affectedRows===1]:this.isInsertQuery()||this.isUpdateQuery()?[g,m.affectedRows]:this.isShowConstraintsQuery()?m:this.isRawQuery()?[m,m]:g}async logWarnings(m){const g=await this.run("SHOW WARNINGS"),N=`Snowflake Warnings (${this.connection.uuid||"default"}): `,c=[];for(const l of g)if(!(l===void 0||typeof l[Symbol.iterator]!="function"))for(const r of l)if(Object.prototype.hasOwnProperty.call(r,"Message"))c.push(r.Message);else for(const i of r.keys())c.push([i,r[i]].join(": "));return this.sequelize.log(N+c.join("; "),this.options),m}formatError(m){const g=m.errno||m.code;switch(g){case f:{const N=m.message.match(/Duplicate entry '([\s\S]*)' for key '?((.|\s)*?)'?$/);let c={},l="Validation error";const r=N?N[1].split("-"):void 0,i=N?N[2]:void 0,s=N?N[1]:void 0,a=this.model&&this.model.uniqueKeys[i];a?(a.msg&&(l=a.msg),c=t.zipObject(a.fields,r)):c[i]=s;const d=[];return t.forOwn(c,(y,o)=>{d.push(new e.ValidationErrorItem(this.getUniqueConstraintErrorMessage(o),"unique violation",o,y,this.instance,"not_unique"))}),new e.UniqueConstraintError({message:l,errors:d,parent:m,fields:c})}case T:case E:{const N=m.message.match(/CONSTRAINT ([`"])(.*)\1 FOREIGN KEY \(\1(.*)\1\) REFERENCES \1(.*)\1 \(\1(.*)\1\)/),c=N?N[1]:"`",l=N?N[3].split(new RegExp(`${c}, *${c}`)):void 0;return new e.ForeignKeyConstraintError({reltype:String(g)===String(T)?"parent":"child",table:N?N[4]:void 0,fields:l,value:l&&l.length&&this.instance&&this.instance[l[0]]||void 0,index:N?N[2]:void 0,parent:m})}default:return new e.DatabaseError(m)}}handleShowIndexesQuery(m){return m=m.reduce((g,N)=>(N.Key_name in g||(g[N.Key_name]=N,N.fields=[]),g[N.Key_name].fields[N.Seq_in_index-1]={attribute:N.Column_name,length:N.Sub_part||void 0,order:N.Collation==="A"?"ASC":void 0},delete N.column_name,g),{}),t.map(m,g=>({primary:g.Key_name==="PRIMARY",fields:g.fields,name:g.Key_name,tableName:g.Table,unique:g.Non_unique!==1,type:g.Index_type}))}}return xt.exports=R,xt.exports.Query=R,xt.exports.default=R,xt.exports}var ys,_n;function Mu(){if(_n)return ys;_n=1;var S=Object.defineProperty,e=Object.defineProperties,t=Object.getOwnPropertyDescriptors,n=Object.getOwnPropertySymbols,f=Object.prototype.hasOwnProperty,O=Object.prototype.propertyIsEnumerable,T=(o,p,b)=>p in o?S(o,p,{enumerable:!0,configurable:!0,writable:!0,value:b}):o[p]=b,E=(o,p)=>{for(var b in p||(p={}))f.call(p,b)&&T(o,b,p[b]);if(n)for(var b of n(p))O.call(p,b)&&T(o,b,p[b]);return o},w=(o,p)=>e(o,t(p));const R=re,_=fe(),m=ut(),g=Ae,N=Re,c=/^\s*((?:[a-z]+_){0,2}jsonb?(?:_[a-z]+){0,2})\([^)]*\)/i,l=/^\s*(->>?|@>|<@|\?[|&]?|\|{2}|#-)/i,r=/^\s*((?:([`"'])(?:(?!\2).|\2{2})*\2)|[\w\d\s]+|[().,;+-])/i,i=["CONSTRAINT_NAME as constraint_name","CONSTRAINT_NAME as constraintName","CONSTRAINT_SCHEMA as constraintSchema","CONSTRAINT_SCHEMA as constraintCatalog","TABLE_NAME as tableName","TABLE_SCHEMA as tableSchema","TABLE_SCHEMA as tableCatalog","COLUMN_NAME as columnName","REFERENCED_TABLE_SCHEMA as referencedTableSchema","REFERENCED_TABLE_SCHEMA as referencedTableCatalog","REFERENCED_TABLE_NAME as referencedTableName","REFERENCED_COLUMN_NAME as referencedColumnName"].join(","),s="account,all,alter,and,any,as,between,by,case,cast,check,column,connect,connections,constraint,create,cross,current,current_date,current_time,current_timestamp,current_user,database,delete,distinct,drop,else,exists,false,following,for,from,full,grant,group,gscluster,having,ilike,in,increment,inner,insert,intersect,into,is,issue,join,lateral,left,like,localtime,localtimestamp,minus,natural,not,null,of,on,or,order,organization,qualify,regexp,revoke,right,rlike,row,rows,sample,schema,select,set,some,start,table,tablesample,then,to,trigger,true,try_cast,union,unique,update,using,values,view,when,whenever,where,with".split(","),a=new Set(["BLOB","TEXT","GEOMETRY","JSON"]);class d extends m{constructor(p){super(p),this.OperatorMap=w(E({},this.OperatorMap),{[N.regexp]:"REGEXP",[N.notRegexp]:"NOT REGEXP"})}createDatabaseQuery(p,b){return b=E({charset:null,collate:null},b),_.joinSQLFragments(["CREATE DATABASE IF NOT EXISTS",this.quoteIdentifier(p),b.charset&&`DEFAULT CHARACTER SET ${this.escape(b.charset)}`,b.collate&&`DEFAULT COLLATE ${this.escape(b.collate)}`,";"])}dropDatabaseQuery(p){return`DROP DATABASE IF EXISTS ${this.quoteIdentifier(p)};`}createSchema(){return"SHOW TABLES"}showSchemasQuery(){return"SHOW TABLES"}versionQuery(){return"SELECT CURRENT_VERSION()"}createTableQuery(p,b,u){u=E({charset:null,rowFormat:null},u);const h=[],A={},I=[];for(const C in b){if(!Object.prototype.hasOwnProperty.call(b,C))continue;const $=b[C];let P;$.includes("PRIMARY KEY")?(h.push(C),$.includes("REFERENCES")?(P=$.match(/^(.+) (REFERENCES.*)$/),I.push(`${this.quoteIdentifier(C)} ${P[1].replace("PRIMARY KEY","")}`),A[C]=P[2]):I.push(`${this.quoteIdentifier(C)} ${$.replace("PRIMARY KEY","")}`)):$.includes("REFERENCES")?(P=$.match(/^(.+) (REFERENCES.*)$/),I.push(`${this.quoteIdentifier(C)} ${P[1]}`),A[C]=P[2]):I.push(`${this.quoteIdentifier(C)} ${$}`)}const q=this.quoteTable(p);let L=I.join(", ");const D=h.map(C=>this.quoteIdentifier(C)).join(", ");u.uniqueKeys&&R.each(u.uniqueKeys,(C,$)=>{C.customIndex&&(typeof $!="string"&&($=`uniq_${p}_${C.fields.join("_")}`),L+=`, UNIQUE ${this.quoteIdentifier($)} (${C.fields.map(P=>this.quoteIdentifier(P)).join(", ")})`)}),D.length>0&&(L+=`, PRIMARY KEY (${D})`);for(const C in A)Object.prototype.hasOwnProperty.call(A,C)&&(L+=`, FOREIGN KEY (${this.quoteIdentifier(C)}) ${A[C]}`);return _.joinSQLFragments(["CREATE TABLE IF NOT EXISTS",q,`(${L})`,u.comment&&typeof u.comment=="string"&&`COMMENT ${this.escape(u.comment)}`,u.charset&&`DEFAULT CHARSET=${u.charset}`,u.collate&&`COLLATE ${u.collate}`,u.rowFormat&&`ROW_FORMAT=${u.rowFormat}`,";"])}describeTableQuery(p,b,u){return`SHOW FULL COLUMNS FROM ${this.quoteTable(this.addSchema({tableName:p,_schema:b,_schemaDelimiter:u}))};`}showTablesQuery(p){return _.joinSQLFragments(["SELECT TABLE_NAME FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'BASE TABLE'",p?`AND TABLE_SCHEMA = ${this.escape(p)}`:"AND TABLE_SCHEMA NOT IN ( 'INFORMATION_SCHEMA', 'PERFORMANCE_SCHEMA', 'SYS')",";"])}tableExistsQuery(p){const b=p.tableName||p,u=p.schema;return _.joinSQLFragments(["SELECT TABLE_NAME FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'BASE TABLE'",`AND TABLE_SCHEMA = ${u!==void 0?this.escape(u):"CURRENT_SCHEMA()"}`,`AND TABLE_NAME = ${this.escape(b)}`,";"])}addColumnQuery(p,b,u){return _.joinSQLFragments(["ALTER TABLE",this.quoteTable(p),"ADD",this.quoteIdentifier(b),this.attributeToSQL(u,{context:"addColumn",tableName:p,foreignKey:b}),";"])}removeColumnQuery(p,b){return _.joinSQLFragments(["ALTER TABLE",this.quoteTable(p),"DROP",this.quoteIdentifier(b),";"])}changeColumnQuery(p,b){const u=(...A)=>_.joinSQLFragments(["ALTER TABLE",this.quoteTable(p),"ALTER COLUMN",...A,";"]),h=[];for(const A in b){let I=this.dataTypeMapping(p,A,b[A]);const q=[];I.includes("NOT NULL")?(q.push(u(this.quoteIdentifier(A),"SET NOT NULL")),I=I.replace("NOT NULL","").trim()):I.includes("REFERENCES")||q.push(u(this.quoteIdentifier(A),"DROP NOT NULL")),I.includes("DEFAULT")?(q.push(u(this.quoteIdentifier(A),"SET DEFAULT",I.match(/DEFAULT ([^;]+)/)[1])),I=I.replace(/(DEFAULT[^;]+)/,"").trim()):I.includes("REFERENCES")||q.push(u(this.quoteIdentifier(A),"DROP DEFAULT")),I.match(/UNIQUE;*$/)&&(I=I.replace(/UNIQUE;*$/,""),q.push(u("ADD UNIQUE (",this.quoteIdentifier(A),")").replace("ALTER COLUMN",""))),I.includes("REFERENCES")?(I=I.replace(/.+?(?=REFERENCES)/,""),q.push(u("ADD FOREIGN KEY (",this.quoteIdentifier(A),")",I).replace("ALTER COLUMN",""))):q.push(u(this.quoteIdentifier(A),"TYPE",I)),h.push(q.join(""))}return h.join("")}renameColumnQuery(p,b,u){const h=[];for(const A in u){const I=u[A];h.push(`'${b}' '${A}' ${I}`)}return _.joinSQLFragments(["ALTER TABLE",this.quoteTable(p),"RENAME COLUMN",h.join(" to "),";"])}handleSequelizeMethod(p,b,u,h,A){if(p instanceof _.Json){if(p.conditions)return this.parseConditionObject(p.conditions).map(q=>`${this.jsonPathExtractionQuery(q.path[0],R.tail(q.path))} = '${q.value}'`).join(" AND ");if(p.path){let I;if(this._checkValidJsonStatement(p.path))I=p.path;else{const q=R.toPath(p.path),L=q.shift();I=this.jsonPathExtractionQuery(L,q)}return p.value&&(I+=g.format(" = %s",this.escape(p.value))),I}}else p instanceof _.Cast&&(/timestamp/i.test(p.type)?p.type="datetime":p.json&&/boolean/i.test(p.type)?p.type="char":/double precision/i.test(p.type)||/boolean/i.test(p.type)||/integer/i.test(p.type)?p.type="decimal":/text/i.test(p.type)&&(p.type="char"));return super.handleSequelizeMethod(p,b,u,h,A)}truncateTableQuery(p){return _.joinSQLFragments(["TRUNCATE",this.quoteTable(p)])}deleteQuery(p,b,u={},h){const A=this.quoteTable(p);let I=this.getWhereConditions(b,null,h,u);const q=u.limit&&` LIMIT ${this.escape(u.limit)}`;let L="",D="";if(I&&(I=`WHERE ${I}`),q){if(!h)throw new Error("Cannot LIMIT delete without a model.");const C=Object.values(h.primaryKeys).map($=>this.quoteIdentifier($.field)).join(",");return L=h.primaryKeyAttributes.length>1?`(${C})`:C,D=C,_.joinSQLFragments(["DELETE FROM",A,"WHERE",L,"IN (SELECT",D,"FROM",A,I,q,")",";"])}return _.joinSQLFragments(["DELETE FROM",A,I,";"])}showIndexesQuery(){return"SELECT '' FROM DUAL"}showConstraintsQuery(p,b){const u=p.tableName||p,h=p.schema;return _.joinSQLFragments(["SELECT CONSTRAINT_CATALOG AS constraintCatalog,","CONSTRAINT_NAME AS constraintName,","CONSTRAINT_SCHEMA AS constraintSchema,","CONSTRAINT_TYPE AS constraintType,","TABLE_NAME AS tableName,","TABLE_SCHEMA AS tableSchema","from INFORMATION_SCHEMA.TABLE_CONSTRAINTS",`WHERE table_name='${u}'`,b&&`AND constraint_name = '${b}'`,h&&`AND TABLE_SCHEMA = '${h}'`,";"])}removeIndexQuery(p,b){let u=b;return typeof u!="string"&&(u=_.underscore(`${p}_${b.join("_")}`)),_.joinSQLFragments(["DROP INDEX",this.quoteIdentifier(u),"ON",this.quoteTable(p),";"])}attributeToSQL(p,b){R.isPlainObject(p)||(p={type:p});const u=p.type.toString({escape:this.escape.bind(this)});let h=u;if(p.allowNull===!1&&(h+=" NOT NULL"),p.autoIncrement&&(h+=" AUTOINCREMENT"),!a.has(u)&&p.type._binary!==!0&&_.defaultValueSchemable(p.defaultValue)&&(h+=` DEFAULT ${this.escape(p.defaultValue)}`),p.unique===!0&&(h+=" UNIQUE"),p.primaryKey&&(h+=" PRIMARY KEY"),p.comment&&(h+=` COMMENT ${this.escape(p.comment)}`),p.first&&(h+=" FIRST"),p.after&&(h+=` AFTER ${this.quoteIdentifier(p.after)}`),p.references){if(b&&b.context==="addColumn"&&b.foreignKey){const A=this.quoteIdentifier(b.foreignKey),I=this.quoteIdentifier(`${b.tableName}_${A}_foreign_idx`);h+=`, ADD CONSTRAINT ${I} FOREIGN KEY (${A})`}h+=` REFERENCES ${this.quoteTable(p.references.model)}`,p.references.key?h+=` (${this.quoteIdentifier(p.references.key)})`:h+=` (${this.quoteIdentifier("id")})`,p.onDelete&&(h+=` ON DELETE ${p.onDelete.toUpperCase()}`),p.onUpdate&&(h+=` ON UPDATE ${p.onUpdate.toUpperCase()}`)}return h}attributesToSQL(p,b){const u={};for(const h in p){const A=p[h];u[A.field||h]=this.attributeToSQL(A,b)}return u}_checkValidJsonStatement(p){if(typeof p!="string")return!1;let b=0,u=0,h=0,A=!1,I=!1;for(;b<p.length;){const q=p.substr(b),L=c.exec(q);if(L){b+=L[0].indexOf("("),A=!0;continue}const D=l.exec(q);if(D){b+=D[0].length,A=!0;continue}const C=r.exec(q);if(C){const $=C[1];if($==="(")u++;else if($===")")h++;else if($===";"){I=!0;break}b+=C[0].length;continue}break}if(A&&(I||u!==h))throw new Error(`Invalid json statement: ${p}`);return A}dataTypeMapping(p,b,u){return u.includes("PRIMARY KEY")&&(u=u.replace("PRIMARY KEY","")),u.includes("SERIAL")&&(u.includes("BIGINT")?(u=u.replace("SERIAL","BIGSERIAL"),u=u.replace("BIGINT","")):u.includes("SMALLINT")?(u=u.replace("SERIAL","SMALLSERIAL"),u=u.replace("SMALLINT","")):u=u.replace("INTEGER",""),u=u.replace("NOT NULL","")),u}getForeignKeysQuery(p,b){const u=p.tableName||p;return _.joinSQLFragments(["SELECT",i,`FROM INFORMATION_SCHEMA.KEY_COLUMN_USAGE where TABLE_NAME = '${u}'`,`AND CONSTRAINT_NAME!='PRIMARY' AND CONSTRAINT_SCHEMA='${b}'`,"AND REFERENCED_TABLE_NAME IS NOT NULL",";"])}getForeignKeyQuery(p,b){const u=p.schema?y(p.schema):"",h=y(p.tableName||p),A=y(b);return _.joinSQLFragments(["SELECT",i,"FROM INFORMATION_SCHEMA.KEY_COLUMN_USAGE","WHERE (",[`REFERENCED_TABLE_NAME = ${h}`,p.schema&&`AND REFERENCED_TABLE_SCHEMA = ${u}`,`AND REFERENCED_COLUMN_NAME = ${A}`],") OR (",[`TABLE_NAME = ${h}`,p.schema&&`AND TABLE_SCHEMA = ${u}`,`AND COLUMN_NAME = ${A}`,"AND REFERENCED_TABLE_NAME IS NOT NULL"],")"])}dropForeignKeyQuery(p,b){return _.joinSQLFragments(["ALTER TABLE",this.quoteTable(p),"DROP FOREIGN KEY",this.quoteIdentifier(b),";"])}addLimitAndOffset(p){let b=[];return p.offset!==null&&p.offset!==void 0&&p.offset!==0?b=b.concat([" LIMIT ",this.escape(p.limit)," OFFSET ",this.escape(p.offset)]):p.limit!==null&&p.limit!==void 0&&(b=[" LIMIT ",this.escape(p.limit)]),b.join("")}quoteIdentifier(p,b){const u=b||!1,h=this.options.quoteIdentifiers!==!1,A=_.removeTicks(p,'"');return u===!0||h!==!1||p.includes(".")||p.includes("->")||s.includes(A.toLowerCase())?_.addTicks(A,'"'):A}}function y(o){return _.addTicks(o,"'")}return ys=d,ys}var ms={},An;function $u(){if(An)return ms;An=1;var S=Object.defineProperty,e=Object.defineProperties,t=Object.getOwnPropertyDescriptors,n=Object.getOwnPropertySymbols,f=Object.prototype.hasOwnProperty,O=Object.prototype.propertyIsEnumerable,T=(N,c,l)=>c in N?S(N,c,{enumerable:!0,configurable:!0,writable:!0,value:l}):N[c]=l,E=(N,c)=>{for(var l in c||(c={}))f.call(c,l)&&T(N,l,c[l]);if(n)for(var l of n(c))O.call(c,l)&&T(N,l,c[l]);return N},w=(N,c)=>e(N,t(c));const R=ce,{QueryInterface:_}=He,m=Me;class g extends _{async removeColumn(c,l,r){r=r||{};const[i]=await this.sequelize.query(this.queryGenerator.getForeignKeyQuery(c.tableName?c:{tableName:c,schema:this.sequelize.config.database},l),E({raw:!0},r));return i.length&&i[0].constraint_name!=="PRIMARY"&&await Promise.all(i.map(s=>this.sequelize.query(this.queryGenerator.dropForeignKeyQuery(c,s.constraint_name),E({raw:!0},r)))),await this.sequelize.query(this.queryGenerator.removeColumnQuery(c,l),E({raw:!0},r))}async upsert(c,l,r,i,s){s=E({},s),s.type=m.UPSERT,s.updateOnDuplicate=Object.keys(r);const a=s.model,d=this.queryGenerator.insertQuery(c,l,a.rawAttributes,s);return await this.sequelize.query(d,s)}async removeConstraint(c,l,r){const i=this.queryGenerator.showConstraintsQuery(c.tableName?c:{tableName:c,schema:this.sequelize.config.database},l),a=(await this.sequelize.query(i,w(E({},r),{type:this.sequelize.QueryTypes.SHOWCONSTRAINTS})))[0];let d;if(!a||!a.constraintType)throw new R.UnknownConstraintError({message:`Constraint ${l} on table ${c} does not exist`,constraint:l,table:c});return a.constraintType==="FOREIGN KEY"?d=this.queryGenerator.dropForeignKeyQuery(c,l):d=this.queryGenerator.removeIndexQuery(a.tableName,a.constraintName),await this.sequelize.query(d,r)}}return ms.SnowflakeQueryInterface=g,ms}var Es,On;function Pu(){if(On)return Es;On=1;const S=re,e=Xe(),t=Lu(),n=Du(),f=Mu(),O=he().snowflake,{SnowflakeQueryInterface:T}=$u();class E extends e{constructor(R){super(),this.sequelize=R,this.connectionManager=new t(this,R),this.queryGenerator=new f({_dialect:this,sequelize:R}),this.queryInterface=new T(R,this.queryGenerator)}}return E.prototype.supports=S.merge(S.cloneDeep(e.prototype.supports),{"VALUES ()":!0,"LIMIT ON UPDATE":!0,lock:!0,forShare:"LOCK IN SHARE MODE",settingIsolationLevelDuringTransaction:!1,inserts:{ignoreDuplicates:" IGNORE",updateOnDuplicate:!1},index:{collate:!1,length:!0,parser:!0,type:!0,using:1},constraints:{dropConstraint:!1,check:!1},indexViaAlter:!0,indexHints:!0,NUMERIC:!0,GEOMETRY:!1,JSON:!1,REGEXP:!0,schemas:!0}),E.prototype.defaultVersion="5.7.0",E.prototype.Query=n,E.prototype.QueryGenerator=f,E.prototype.DataTypes=O,E.prototype.name="snowflake",E.prototype.TICK_CHAR='"',E.prototype.TICK_CHAR_LEFT=E.prototype.TICK_CHAR,E.prototype.TICK_CHAR_RIGHT=E.prototype.TICK_CHAR,Es=E,Es}const vu="sequelize",ju="Sequelize is a promise-based Node.js ORM tool for Postgres, MySQL, MariaDB, SQLite, Microsoft SQL Server, Amazon Redshift and Snowflakes Data Cloud. It features solid transaction support, relations, eager and lazy loading, read replication and more.",xu="6.37.1",Qu=[{type:"opencollective",url:"https://opencollective.com/sequelize"}],Fu={type:"git",url:"https://github.com/sequelize/sequelize.git"},Uu={url:"https://github.com/sequelize/sequelize/issues"},Ku="https://sequelize.org/",Bu="./lib/index.js",zu="./types/index.d.ts",ku="commonjs",Hu={".":{types:"./types/index.d.ts",import:"./lib/index.mjs",require:"./lib/index.js"},"./lib/*":{types:"./types/*.d.ts",default:"./lib/*.js"},"./lib/errors":{types:"./types/errors/index.d.ts",default:"./lib/errors/index.js"},"./package.json":"./package.json","./types/*":{types:"./types/*.d.ts"}},Gu={node:">=10.0.0"},Vu=["lib","types","index.js"],Yu="MIT",Wu={"@types/debug":"^4.1.8","@types/validator":"^13.7.17",debug:"^4.3.4",dottie:"^2.0.6",inflection:"^1.13.4",lodash:"^4.17.21",moment:"^2.29.4","moment-timezone":"^0.5.43","pg-connection-string":"^2.6.1","retry-as-promised":"^7.0.4",semver:"^7.5.4","sequelize-pool":"^7.1.0","toposort-class":"^1.0.1",uuid:"^8.3.2",validator:"^13.9.0",wkx:"^0.5.0"},Ju={"@commitlint/cli":"^15.0.0","@commitlint/config-angular":"^15.0.0","@octokit/rest":"^18.12.0","@octokit/types":"^6.34.0","@types/chai":"^4.3.0","@types/lodash":"4.14.197","@types/mocha":"^9.0.0","@types/node":"^16.11.17","@types/sinon":"^10.0.6","@typescript-eslint/eslint-plugin":"^5.8.1","@typescript-eslint/parser":"^5.8.1",acorn:"^8.7.0",chai:"^4.3.7","chai-as-promised":"^7.1.1","chai-datetime":"^1.8.0",cheerio:"^1.0.0-rc.10","cls-hooked":"^4.2.2",copyfiles:"^2.4.1","cross-env":"^7.0.3",delay:"^5.0.0",esbuild:"0.14.3",esdoc:"^1.1.0","esdoc-ecmascript-proposal-plugin":"^1.0.0","esdoc-inject-style-plugin":"^1.0.0","esdoc-standard-plugin":"^1.0.0",eslint:"^8.5.0","eslint-plugin-jsdoc":"^37.4.0","eslint-plugin-mocha":"^9.0.0","expect-type":"^0.12.0","fast-glob":"^3.2.7","fs-jetpack":"^4.3.0",husky:"^7.0.4",ibm_db:"^2.8.1","js-combinatorics":"^0.6.1","lcov-result-merger":"^3.1.0","lint-staged":"^12.1.4",mariadb:"^2.5.5","markdownlint-cli":"^0.30.0",mocha:"^7.2.0","module-alias":"^2.2.2",mysql2:"^2.3.3","node-hook":"^1.0.0",nyc:"^15.1.0",oracledb:"^5.5.0","p-map":"^4.0.0","p-props":"^4.0.0","p-settle":"^4.1.1","p-timeout":"^4.0.0",pg:"^8.7.1","pg-hstore":"^2.3.4",rimraf:"^3.0.2","semantic-release":"^18.0.1","semantic-release-fail-on-major-bump":"^1.0.0",sinon:"^12.0.1","sinon-chai":"^3.7.0","snowflake-sdk":"^1.6.6","source-map-support":"^0.5.21",sqlite3:"^5.1.6",tedious:"8.3.0",typescript:"^4.5.4"},Xu={pg:{optional:!0},"pg-hstore":{optional:!0},mysql2:{optional:!0},ibm_db:{optional:!0},"snowflake-sdk":{optional:!0},mariadb:{optional:!0},sqlite3:{optional:!0},tedious:{optional:!0},oracledb:{optional:!0}},Zu=["mysql","mariadb","sqlite","postgresql","postgres","pg","mssql","db2","ibm_db","sql","oracledb","sqlserver","snowflake","orm","nodejs","object relational mapper","database","db"],el={extends:["@commitlint/config-angular"],rules:{"type-enum":[2,"always",["build","ci","docs","feat","fix","perf","refactor","revert","style","test","meta"]]}},tl={plugins:["@semantic-release/commit-analyzer","semantic-release-fail-on-major-bump","@semantic-release/release-notes-generator","@semantic-release/npm","@semantic-release/github"],branches:["v6",{name:"v6-beta",prerelease:"beta"}]},rl={tag:"latest"},sl={"----------------------------------------- static analysis -----------------------------------------":"",lint:"eslint src test --quiet --fix","lint-docs":"markdownlint docs","test-typings":"tsc --noEmit --emitDeclarationOnly false && tsc -b test/tsconfig.json","----------------------------------------- documentation -------------------------------------------":"",docs:"sh docs.sh","----------------------------------------- tests ---------------------------------------------------":"",mocha:"mocha -r ./test/registerEsbuild","test-unit":'yarn mocha "test/unit/**/*.test.[tj]s"',"test-integration":'yarn mocha "test/integration/**/*.test.[tj]s"',teaser:"node test/teaser.js",test:"npm run prepare && npm run test-typings && npm run teaser && npm run test-unit && npm run test-integration","----------------------------------------- coverage ------------------------------------------------":"",cover:"rimraf coverage && npm run teaser && npm run cover-integration && npm run cover-unit && npm run merge-coverage","cover-integration":`cross-env COVERAGE=true nyc --reporter=lcovonly yarn mocha "test/integration/**/*.test.[tj]s" && node -e "require('fs').renameSync('coverage/lcov.info', 'coverage/integration.info')"`,"cover-unit":`cross-env COVERAGE=true nyc --reporter=lcovonly yarn mocha "test/unit/**/*.test.[tj]s" && node -e "require('fs').renameSync('coverage/lcov.info', 'coverage/unit.info')"`,"merge-coverage":'lcov-result-merger "coverage/*.info" "coverage/lcov.info"',"----------------------------------------- local test dbs ------------------------------------------":"","start-mariadb":"bash dev/mariadb/10.3/start.sh","start-mysql":"bash dev/mysql/5.7/start.sh","start-mysql-8":"bash dev/mysql/8.0/start.sh","start-postgres":"bash dev/postgres/10/start.sh","start-mssql":"bash dev/mssql/2019/start.sh","start-db2":"bash dev/db2/11.5/start.sh","start-oracle-oldest":"bash dev/oracle/18-slim/start.sh","start-oracle-latest":"bash dev/oracle/21-slim/start.sh","stop-mariadb":"bash dev/mariadb/10.3/stop.sh","stop-mysql":"bash dev/mysql/5.7/stop.sh","stop-mysql-8":"bash dev/mysql/8.0/stop.sh","stop-postgres":"bash dev/postgres/10/stop.sh","stop-mssql":"bash dev/mssql/2019/stop.sh","stop-db2":"bash dev/db2/11.5/stop.sh","stop-oracle-oldest":"bash dev/oracle/18-slim/stop.sh","stop-oracle-latest":"bash dev/oracle/21-slim/stop.sh","restart-mariadb":"npm run start-mariadb","restart-mysql":"npm run start-mysql","restart-postgres":"npm run start-postgres","restart-mssql":"npm run start-mssql","restart-db2":"npm run start-db2","restart-oracle-oldest":"npm run start-oracle-oldest","restart-oracle-latest":"npm run start-oracle-latest","----------------------------------------- local tests ---------------------------------------------":"","test-unit-mariadb":"cross-env DIALECT=mariadb npm run test-unit","test-unit-mysql":"cross-env DIALECT=mysql npm run test-unit","test-unit-postgres":"cross-env DIALECT=postgres npm run test-unit","test-unit-postgres-native":"cross-env DIALECT=postgres-native npm run test-unit","test-unit-sqlite":"cross-env DIALECT=sqlite npm run test-unit","test-unit-mssql":"cross-env DIALECT=mssql npm run test-unit","test-unit-db2":"cross-env DIALECT=db2 npm run test-unit","test-unit-snowflake":"cross-env DIALECT=snowflake npm run test-unit","test-unit-oracle":"cross-env DIALECT=oracle npm run test-unit","test-unit-all":"npm run test-unit-mariadb && npm run test-unit-mysql && npm run test-unit-postgres && npm run test-unit-postgres-native && npm run test-unit-mssql && npm run test-unit-sqlite && npm run test-unit-snowflake && npm run test-unit-db2 && npm run test-unit-oracle","test-integration-mariadb":"cross-env DIALECT=mariadb npm run test-integration","test-integration-mysql":"cross-env DIALECT=mysql npm run test-integration","test-integration-postgres":"cross-env DIALECT=postgres npm run test-integration","test-integration-postgres-native":"cross-env DIALECT=postgres-native npm run test-integration","test-integration-sqlite":"cross-env DIALECT=sqlite npm run test-integration","test-integration-mssql":"cross-env DIALECT=mssql npm run test-integration","test-integration-db2":"cross-env DIALECT=db2 npm run test-integration","test-integration-snowflake":"cross-env DIALECT=snowflake npm run test-integration","test-integration-oracle":'cross-env LD_LIBRARY_PATH="$PWD/.oracle/instantclient/" DIALECT=oracle UV_THREADPOOL_SIZE=128 npm run test-integration',"test-mariadb":"cross-env DIALECT=mariadb npm test","test-mysql":"cross-env DIALECT=mysql npm test","test-sqlite":"cross-env DIALECT=sqlite npm test","test-postgres":"cross-env DIALECT=postgres npm test","test-postgres-native":"cross-env DIALECT=postgres-native npm test","test-mssql":"cross-env DIALECT=mssql npm test","test-db2":"cross-env DIALECT=db2 npm test","test-oracle":'cross-env LD_LIBRARY_PATH="$PWD/.oracle/instantclient/" DIALECT=oracle UV_THREADPOOL_SIZE=128 npm test',"----------------------------------------- development ---------------------------------------------":"",sscce:"node sscce.js","sscce-mariadb":"cross-env DIALECT=mariadb node sscce.js","sscce-mysql":"cross-env DIALECT=mysql node sscce.js","sscce-postgres":"cross-env DIALECT=postgres node sscce.js","sscce-postgres-native":"cross-env DIALECT=postgres-native node sscce.js","sscce-sqlite":"cross-env DIALECT=sqlite node sscce.js","sscce-mssql":"cross-env DIALECT=mssql node sscce.js","sscce-db2":"cross-env DIALECT=db2 node sscce.js","sscce-oracle":'cross-env LD_LIBRARY_PATH="$PWD/.oracle/instantclient/" DIALECT=oracle UV_THREADPOOL_SIZE=128 node sscce.js',prepare:"npm run build && husky install",build:"node ./build.js","---------------------------------------------------------------------------------------------------":""},il=!0,nl={name:vu,description:ju,version:xu,funding:Qu,repository:Fu,bugs:Uu,homepage:Ku,main:Bu,types:zu,type:ku,exports:Hu,engines:Gu,files:Vu,license:Yu,dependencies:Wu,devDependencies:Ju,peerDependenciesMeta:Xu,keywords:Zu,commitlint:el,"lint-staged":{"*!(d).[tj]s":"eslint"},release:tl,publishConfig:rl,scripts:sl,support:il};var al=Object.defineProperty,ol=Object.defineProperties,ul=Object.getOwnPropertyDescriptors,bn=Object.getOwnPropertySymbols,ll=Object.prototype.hasOwnProperty,cl=Object.prototype.propertyIsEnumerable,Tn=(S,e,t)=>e in S?al(S,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):S[e]=t,De=(S,e)=>{for(var t in e||(e={}))ll.call(e,t)&&Tn(S,t,e[t]);if(bn)for(var t of bn(e))cl.call(e,t)&&Tn(S,t,e[t]);return S},gs=(S,e)=>ol(S,ul(e));const hl=Ae,Nn=Ae,fl=pa,dl=ya.default,Ge=re,We=fe(),la=Zn,Be=he(),pl=ea,yl=Qo,ir=_r,nr=Me,ml=sa,El=na,Ns=ce,ca=yr,gl=zo,_l=Ft.validator,ws=Re,sr=Bt,{QueryInterface:Al}=He,{BelongsTo:Ol}=at,bl=fr,{BelongsToMany:Tl}=Ut,{HasMany:Nl}=Et,{withSqliteForeignKeysOff:_s}=aa,{injectReplacements:wl}=oa;let te=class Ye{constructor(e,t,n,f){let O;if(arguments.length===1&&typeof e=="object")f=e,O=Ge.pick(f,"host","port","database","username","password");else if(arguments.length===1&&typeof e=="string"||arguments.length===2&&typeof t=="object"){O={},f=t||{};const E=hl.parse(arguments[0],!0);if(f.dialect=E.protocol.replace(/:$/,""),f.host=E.hostname,f.dialect==="sqlite"&&E.pathname&&!E.pathname.startsWith("/:memory")){const w=Nn.join(f.host,E.pathname);f.storage=Nn.resolve(f.storage||w)}if(E.pathname&&(O.database=E.pathname.replace(/^\//,"")),E.port&&(f.port=E.port),E.auth){const w=E.auth.split(":");O.username=w[0],w.length>1&&(O.password=w.slice(1).join(":"))}if(E.query){if(E.query.host&&(f.host=E.query.host),f.dialectOptions)Object.assign(f.dialectOptions,E.query);else if(f.dialectOptions=E.query,E.query.options)try{const w=JSON.parse(E.query.options);f.dialectOptions.options=w}catch{}}["postgres","postgresql"].includes(f.dialect)&&Object.assign(f.dialectOptions,fl.parse(arguments[0]))}else f=f||{},O={database:e,username:t,password:n};if(Ye.runHooks("beforeInit",O,f),this.options=De({dialect:null,dialectModule:null,dialectModulePath:null,host:"localhost",protocol:"tcp",define:{},query:{},sync:{},timezone:"+00:00",standardConformingStrings:!0,logging:console.log,omitNull:!1,native:!1,replication:!1,ssl:void 0,pool:{},quoteIdentifiers:!0,hooks:{},retry:{max:5,match:["SQLITE_BUSY: database is locked"]},transactionType:ir.TYPES.DEFERRED,isolationLevel:null,databaseVersion:0,typeValidation:!1,benchmark:!1,minifyAliases:!1,logQueryParameters:!1,attributeBehavior:"throw"},f),!this.options.dialect)throw new Error("Dialect needs to be explicitly supplied as of v4.0.0");if(this.options.dialect==="postgresql"&&(this.options.dialect="postgres"),this.options.dialect==="sqlite"&&this.options.timezone!=="+00:00")throw new Error("Setting a custom timezone is not supported by SQLite, dates are always returned as UTC. Please remove the custom timezone parameter.");this.options.logging===!0&&(sr.noTrueLogging(),this.options.logging=console.log),this._setupHooks(f.hooks),this.config={database:O.database||this.options.database,username:O.username||this.options.username,password:O.password||this.options.password||null,host:O.host||this.options.host,port:O.port||this.options.port,pool:this.options.pool,protocol:this.options.protocol,native:this.options.native,ssl:this.options.ssl,replication:this.options.replication,dialectModule:this.options.dialectModule,dialectModulePath:this.options.dialectModulePath,keepDefaultTimezone:this.options.keepDefaultTimezone,dialectOptions:this.options.dialectOptions};let T;switch(this.getDialect()){case"mariadb":T=ru();break;case"mssql":T=ou();break;case"mysql":T=cu();break;case"oracle":T=yu();break;case"postgres":T=Au();break;case"sqlite":T=wu();break;case"db2":T=Cu();break;case"snowflake":T=Pu();break;default:throw new Error(`The dialect ${this.getDialect()} is not supported. Supported dialects: mssql, mariadb, mysql, oracle, postgres, db2 and sqlite.`)}this.dialect=new T(this),this.dialect.queryGenerator.typeValidation=f.typeValidation,Ge.isPlainObject(this.options.operatorsAliases)?(sr.noStringOperators(),this.dialect.queryGenerator.setOperatorsAliases(this.options.operatorsAliases)):typeof this.options.operatorsAliases=="boolean"&&sr.noBoolOperatorAliases(),this.queryInterface=this.dialect.queryInterface,this.models={},this.modelManager=new yl(this),this.connectionManager=this.dialect.connectionManager,Ye.runHooks("afterInit",this)}refreshTypes(){this.connectionManager.refreshTypeParser(Be)}getDialect(){return this.options.dialect}getDatabaseName(){return this.config.database}getQueryInterface(){return this.queryInterface}define(e,t,n={}){n.modelName=e,n.sequelize=this;const f=class extends la{};return f.init(t,n),f}model(e){if(!this.isDefined(e))throw new Error(`${e} has not been defined`);return this.modelManager.getModel(e)}isDefined(e){return!!this.modelManager.models.find(t=>t.name===e)}async query(e,t){if(t=De(De({},this.options.query),t),t.instance&&!t.model&&(t.model=t.instance.constructor),!t.instance&&!t.model&&(t.raw=!0),t.mapToModel&&(t.fieldMap=Ge.get(t,"model.fieldAttributeMap",{})),t=Ge.defaults(t,{logging:Object.prototype.hasOwnProperty.call(this.options,"logging")?this.options.logging:console.log,searchPath:Object.prototype.hasOwnProperty.call(this.options,"searchPath")?this.options.searchPath:"DEFAULT"}),t.type||(t.model||t.nest||t.plain?t.type=nr.SELECT:t.type=nr.RAW),!this.dialect.supports.searchPath||!this.options.dialectOptions||!this.options.dialectOptions.prependSearchPath||t.supportsSearchPath===!1?delete t.searchPath:t.searchPath||(t.searchPath="DEFAULT"),typeof e=="object"){if(e.values!==void 0){if(t.replacements!==void 0)throw new Error("Both `sql.values` and `options.replacements` cannot be set at the same time");t.replacements=e.values}if(e.bind!==void 0){if(t.bind!==void 0)throw new Error("Both `sql.bind` and `options.bind` cannot be set at the same time");t.bind=e.bind}e.query!==void 0&&(e=e.query)}if(e=e.trim(),t.replacements&&t.bind)throw new Error("Both `replacements` and `bind` cannot be set at the same time");t.replacements&&(e=wl(e,this.dialect,t.replacements));let n;t.bind&&([e,n]=this.dialect.Query.formatBindParameters(e,t.bind,this.options.dialect));const f=()=>{if(t.transaction&&t.transaction.finished&&!t.completesTransaction){const T=new Error(`${t.transaction.finished} has been called on this transaction(${t.transaction.id}), you can no longer use it. (The rejected query is attached as the 'sql' property of this error)`);throw T.sql=e,T}},O=De(De({},this.options.retry),t.retry);return dl(async()=>{t.transaction===void 0&&Ye._cls&&(t.transaction=Ye._cls.get("transaction")),f();const T=await(t.transaction?t.transaction.connection:this.connectionManager.getConnection(t));this.options.dialect==="db2"&&t.alter&&t.alter.drop===!1&&(T.dropTable=!1);const E=new this.dialect.Query(T,this,t);try{return await this.runHooks("beforeQuery",t,E),f(),await E.run(e,n)}finally{await this.runHooks("afterQuery",t,E),t.transaction||this.connectionManager.releaseConnection(T)}},O)}async set(e,t){if(t=De(De({},this.options.set),typeof t=="object"&&t),!["mysql","mariadb"].includes(this.options.dialect))throw new Error("sequelize.set is only supported for mysql or mariadb");if(!t.transaction||!(t.transaction instanceof ir))throw new TypeError("options.transaction is required");t.raw=!0,t.plain=!0,t.type="SET";const n=`SET ${Ge.map(e,(f,O)=>`@${O} := ${typeof f=="string"?`"${f}"`:f}`).join(", ")}`;return await this.query(n,t)}escape(e){return this.dialect.queryGenerator.escape(e)}async createSchema(e,t){return await this.getQueryInterface().createSchema(e,t)}async showAllSchemas(e){return await this.getQueryInterface().showAllSchemas(e)}async dropSchema(e,t){return await this.getQueryInterface().dropSchema(e,t)}async dropAllSchemas(e){return await this.getQueryInterface().dropAllSchemas(e)}async sync(e){if(e=gs(De(De(De({},this.options),this.options.sync),e),{hooks:e?e.hooks!==!1:!0}),e.match&&!e.match.test(this.config.database))throw new Error(`Database "${this.config.database}" does not match sync match parameter "${e.match}"`);if(e.hooks&&await this.runHooks("beforeBulkSync",e),e.force&&await this.drop(e),this.modelManager.models.length===0)await this.authenticate(e);else{const t=this.modelManager.getModelsTopoSortedByForeignKey();if(t==null)return this._syncModelsWithCyclicReferences(e);t.reverse();for(const n of t)await n.sync(e)}return e.hooks&&await this.runHooks("afterBulkSync",e),this}async _syncModelsWithCyclicReferences(e){if(this.dialect.name==="sqlite"){await _s(this,e,async()=>{for(const t of this.modelManager.models)await t.sync(e)});return}for(const t of this.modelManager.models)await t.sync(gs(De({},e),{withoutForeignKeyConstraints:!0}));for(const t of this.modelManager.models)await t.sync(gs(De({},e),{force:!1,alter:!0}))}async truncate(e){const t=this.modelManager.getModelsTopoSortedByForeignKey(),n=t||this.modelManager.models,f=t==null;if(f&&(!e||!e.cascade))throw new Error('Sequelize#truncate: Some of your models have cyclic references (foreign keys). You need to use the "cascade" option to be able to delete rows from models that have cyclic references.');if(f&&this.dialect.name==="sqlite")return _s(this,e,async()=>{await Promise.all(n.map(O=>O.truncate(e)))});if(e&&e.cascade)for(const O of n)await O.truncate(e);else await Promise.all(n.map(O=>O.truncate(e)))}async drop(e){if(e&&e.cascade)for(const n of this.modelManager.models)await n.drop(e);const t=this.modelManager.getModelsTopoSortedByForeignKey();if(t)for(const n of t)await n.drop(e);if(this.dialect.name==="sqlite"){await _s(this,e,async()=>{for(const n of this.modelManager.models)await n.drop(e)});return}for(const n of this.modelManager.models){const f=n.getTableName(),O=await this.queryInterface.getForeignKeyReferencesForTable(f,e);await Promise.all(O.map(T=>this.queryInterface.removeConstraint(f,T.constraintName,e)))}for(const n of this.modelManager.models)await n.drop(e)}async authenticate(e){e=De({raw:!0,plain:!0,type:nr.SELECT},e),await this.query(this.dialect.queryGenerator.authTestQuery(),e)}async databaseVersion(e){return await this.getQueryInterface().databaseVersion(e)}random(){return["postgres","sqlite","snowflake"].includes(this.getDialect())?this.fn("RANDOM"):this.fn("RAND")}static fn(e,...t){return new We.Fn(e,t)}static col(e){return new We.Col(e)}static cast(e,t){return new We.Cast(e,t)}static literal(e){return new We.Literal(e)}static and(...e){return{[ws.and]:e}}static or(...e){return{[ws.or]:e}}static json(e,t){return new We.Json(e,t)}static where(e,t,n){return new We.Where(e,t,n)}async transaction(e,t){typeof e=="function"&&(t=e,e=void 0);const n=new ir(this,e);return t?Ye._clsRun(async()=>{await n.prepareEnvironment(!0);let f;try{f=await t(n)}catch(O){try{await n.rollback()}catch{}throw O}return await n.commit(),f}):(await n.prepareEnvironment(!1),n)}static useCLS(e){if(!e||typeof e!="object"||typeof e.bind!="function"||typeof e.run!="function")throw new Error("Must provide CLS namespace");return Ye._cls=e,this}static _clsRun(e){const t=Ye._cls;if(!t)return e();let n;return t.run(f=>n=e(f)),n}log(...e){let t;const n=Ge.last(e);n&&Ge.isPlainObject(n)&&Object.prototype.hasOwnProperty.call(n,"logging")?(t=n,t.logging===console.log&&e.splice(e.length-1,1)):t=this.options,t.logging&&(t.logging===!0&&(sr.noTrueLogging(),t.logging=console.log),(this.options.benchmark||t.benchmark)&&t.logging===console.log&&(e=[`${e[0]} Elapsed time: ${e[1]}ms`]),t.logging(...e))}close(){return this.connectionManager.close()}normalizeDataType(e){let t=typeof e=="function"?new e:e;const n=this.dialect.DataTypes||{};if(n[t.key]&&(t=n[t.key].extend(t)),t instanceof Be.ARRAY){if(!t.type)throw new Error("ARRAY is missing type definition for its values.");n[t.type.key]&&(t.type=n[t.type.key].extend(t.type))}return t}normalizeAttribute(e){if(Ge.isPlainObject(e)||(e={type:e}),!e.type)return e;if(e.type=this.normalizeDataType(e.type),Object.prototype.hasOwnProperty.call(e,"defaultValue")&&typeof e.defaultValue=="function"&&[Be.NOW,Be.UUIDV1,Be.UUIDV4].includes(e.defaultValue)&&(e.defaultValue=new e.defaultValue),e.type instanceof Be.ENUM&&(e.values?e.type.values=e.type.options.values=e.values:e.values=e.type.values,!e.values.length))throw new Error("Values for ENUM have not been defined.");return e}};te.prototype.fn=te.fn;te.prototype.col=te.col;te.prototype.cast=te.cast;te.prototype.literal=te.literal;te.prototype.and=te.and;te.prototype.or=te.or;te.prototype.json=te.json;te.prototype.where=te.where;te.prototype.validate=te.prototype.authenticate;Object.defineProperty(te,"version",{enumerable:!0,get(){return nl.version}});te.options={hooks:{}};te.Utils=We;te.Op=ws;te.TableHints=ml;te.IndexHints=El;te.Transaction=ir;te.prototype.Sequelize=te;te.prototype.QueryTypes=te.QueryTypes=nr;te.prototype.Validator=te.Validator=_l;te.Model=la;te.QueryInterface=Al;te.BelongsTo=Ol;te.HasOne=bl;te.HasMany=Nl;te.BelongsToMany=Tl;te.DataTypes=Be;for(const S in Be)te[S]=Be[S];te.Deferrable=pl;te.prototype.Association=te.Association=gl;te.useInflection=We.useInflection;ca.applyTo(te);ca.applyTo(te.prototype);te.Error=Ns.BaseError;for(const S of Object.keys(Ns))te[S]=Ns[S];or.exports=te;or.exports.Sequelize=te;or.exports.default=te;var Il=or.exports,Sl=Il;const V=da(Sl),Wl=V.Sequelize;V.fn;V.col;V.cast;V.literal;V.and;V.or;V.json;V.where;V.QueryInterface;V.ABSTRACT;V.STRING;V.CHAR;V.TEXT;V.NUMBER;V.TINYINT;V.SMALLINT;V.MEDIUMINT;V.INTEGER;V.BIGINT;V.FLOAT;V.TIME;V.DATE;V.DATEONLY;V.BOOLEAN;V.NOW;V.BLOB;V.DECIMAL;V.NUMERIC;V.UUID;V.UUIDV1;V.UUIDV4;V.HSTORE;V.JSON;V.JSONB;V.VIRTUAL;V.ARRAY;V.ENUM;V.RANGE;V.REAL;V.DOUBLE;V.GEOMETRY;V.GEOGRAPHY;V.CIDR;V.INET;V.MACADDR;V.CITEXT;V.TSVECTOR;V.Model;V.Transaction;V.Association;V.BelongsTo;V.HasOne;V.HasMany;V.BelongsToMany;V.BaseError;V.AggregateError;V.AsyncQueueError;V.AssociationError;V.BulkRecordError;V.ConnectionError;V.DatabaseError;V.EagerLoadingError;V.EmptyResultError;V.InstanceError;V.OptimisticLockError;V.QueryError;V.SequelizeScopeError;V.ValidationError;V.ValidationErrorItem;V.AccessDeniedError;V.ConnectionAcquireTimeoutError;V.ConnectionRefusedError;V.ConnectionTimedOutError;V.HostNotFoundError;V.HostNotReachableError;V.InvalidConnectionError;V.ExclusionConstraintError;V.ForeignKeyConstraintError;V.TimeoutError;V.UnknownConstraintError;V.UniqueConstraintError;V.Error;V.useInflection;V.Utils;V.QueryTypes;V.Op;V.TableHints;V.IndexHints;V.DataTypes;V.Deferrable;V.Validator;V.ValidationErrorItemOrigin;V.ValidationErrorItemType;export{Wl as S};
